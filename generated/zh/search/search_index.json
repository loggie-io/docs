{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"","title":"Home"},{"location":"developer-guide/contributing/","text":"\u4ee3\u7801\u8d21\u732e \u00b6 Note \u5982\u679c\u4f60\uff1a \u6709\u65b0\u7684\u60f3\u6cd5 \u63d0\u4ea4Feature Bug report/fix \u8d21\u732e\u6587\u6863 Help wanted \u5efa\u8bae\u5148\u63d0 Issues \uff0c\u63cf\u8ff0\u4f60\u7684\u76ee\u7684\u6216\u8005\u95ee\u9898\u3002 \u4ee3\u7801/\u6587\u6863\u8d21\u732e\u6d41\u7a0b \u00b6 1. \u521b\u5efa\u672c\u5730\u5de5\u7a0b \u00b6 fork\u4ee3\u7801 \u00b6 \u8bbf\u95ee https://github.com/loggie-io/loggie \uff0c\u70b9\u51fb\u53f3\u4e0a\u89d2\u7684Fork\uff0cfork\u5230\u81ea\u5df1\u7684github\u4ed3\u5e93\u4e2d\u3002 clone\u5230\u672c\u5730 \u00b6 \u5c06fork\u540e\u7684\u5de5\u7a0bclone\u5230\u672c\u5730\uff1a cd ${ go -workspace } git clone git@github.com: ${ yourAccountId } /loggie.git 2. \u672c\u5730\u5f00\u53d1 \u00b6 add upstream \u00b6 \u5728\u672c\u5730\u5de5\u7a0b\u4e2d\uff0c\u6dfb\u52a0upstream remote\uff1a git remote add upstream https://github.com/loggie-io/loggie.git git remote set-url --push upstream no_push \u53ef\u4ee5\u4f7f\u7528 git remote -v \u67e5\u770b\uff0corigin\u4e3a\u4f60\u4e2a\u4eba\u8d26\u53f7fork\u7684git\u5730\u5740\uff0cupstream\u4e3aLoggie\u5b98\u65b9\u4ed3\u5e93\u5730\u5740\uff0cuptream\u4ec5\u4e3a\u672c\u5730\u540c\u6b65\u4ee3\u7801\u4f7f\u7528\uff0c\u6b63\u5e38\u65e0push\u6743\u9650\u3002 create branch \u00b6 \u57fa\u4e8e\u6700\u65b0\u7684main\u5206\u652f\uff0c\u521b\u5efa\u51fa\u4f60\u7684\u5206\u652f\uff0c\u901a\u5e38\u4ee5feat/fix/chore\u7b49\u5f00\u5934\u3002 git checkout -b feat-mywork \u5728\u8be5\u5206\u652f\u5f00\u53d1\u5b8c\u540e\uff0c\u5f85\u63d0\u4ea4\u524d\uff0c\u5efa\u8bae\u4fdd\u6301\u4ee3\u7801\u548c\u4e0a\u6e38\u4e00\u81f4\uff1a git pull upstream -r \u63d0\u4ea4\u4ee3\u7801 \u00b6 git commit git push origin feat-mywork Commit\u89c4\u8303 \u901a\u5e38\u6211\u4eec\u4f7f\u7528 <type>(<scope>): <subject> \u7684\u5f62\u5f0f\uff1a <type>: \uff08\u5fc5\u987b\uff09 feat\uff1a\u8868\u793a\u4e00\u4e2a\u65b0\u7684\u529f\u80fdfeature fix\uff1abug\u7684\u4fee\u590d chore\uff1a\u6784\u5efa\u8fc7\u7a0b\u6216\u8005\u8f85\u52a9\u5de5\u5177\u7684\u53d8\u52a8 test\uff1a\u6d4b\u8bd5\u76f8\u5173 docs\uff1a\u4fee\u6539\u4e86\u6587\u6863 perf\uff1a\u6027\u80fd\u4f18\u5316\u76f8\u5173\u6539\u52a8 refactor\uff1a\u4ee3\u7801\u91cd\u6784 <scope>: \uff08\u53ef\u9009\uff09 core\uff1aLoggie\u6846\u67b6\u7684\u6838\u5fc3\u4ee3\u7801\u6539\u52a8 source\uff1aLoggie source\u90e8\u5206\u529f\u80fd\u65b0\u589e\u6216\u6539\u52a8 sink\uff1aLoggie sink\u90e8\u5206\u529f\u80fd\u65b0\u589e\u6216\u6539\u52a8 interceptor\uff1aLoggie interceptor\u90e8\u5206\u529f\u80fd\u65b0\u589e\u6216\u6539\u52a8 discovery\uff1a\u670d\u52a1\u53d1\u73b0\u548c\u914d\u7f6e\u4e2d\u5fc3\u90e8\u5206 monitor\uff1amonitor eventbus\u90e8\u5206 <subject>: \uff08\u5fc5\u987b\uff09\u5373commit\u7684\u5185\u5bb9\u63cf\u8ff0 3. \u521b\u5efaPR \u00b6 \u63d0\u4ea4\u81f3Github \u00b6 \u8bbf\u95ee\u4f60\u7684\u4e2a\u4ebagithub\u8d26\u53f7\u91ccfork\u7684Loggie\u9879\u76ee\uff0c\u5e76 Open pull request \u3002 \u5c3d\u91cf\u63cf\u8ff0\u6e05\u695aPR\u7684\u80cc\u666f\u3001\u76ee\u7684\u548c\u6539\u52a8\u70b9\u3002 \u5982\u679c\u6709\u76f8\u5173Issues\uff0c\u9700\u5173\u8054\u3002 \u63d0\u4ea4\u524d\u8bf7\u68c0\u67e5\uff1a \u662f\u5426\u9700\u8981\u6dfb\u52a0/\u4fee\u6539\u76f8\u5173unit test/e2e/\u6027\u80fd\u6d4b\u8bd5 \u662f\u5426\u9700\u8981\u6dfb\u52a0/\u4fee\u6539\u76f8\u5173\u6587\u6863 \u5bfb\u6c42Merge \u00b6 \u4f60\u53ef\u4ee5\u5728OWNERS\u627e\u4eba\uff0c\u6216\u8005\u9ed8\u8ba4\u6dfb\u52a0loggie-robot\u8d26\u53f7\u4f5c\u4e3a\u4f60PR\u7684Reviewers\u6216Assigneees\u3002","title":"\u4ee3\u7801\u8d21\u732e"},{"location":"developer-guide/contributing/#_1","text":"Note \u5982\u679c\u4f60\uff1a \u6709\u65b0\u7684\u60f3\u6cd5 \u63d0\u4ea4Feature Bug report/fix \u8d21\u732e\u6587\u6863 Help wanted \u5efa\u8bae\u5148\u63d0 Issues \uff0c\u63cf\u8ff0\u4f60\u7684\u76ee\u7684\u6216\u8005\u95ee\u9898\u3002","title":"\u4ee3\u7801\u8d21\u732e"},{"location":"developer-guide/contributing/#_2","text":"","title":"\u4ee3\u7801/\u6587\u6863\u8d21\u732e\u6d41\u7a0b"},{"location":"developer-guide/contributing/#1","text":"","title":"1. \u521b\u5efa\u672c\u5730\u5de5\u7a0b"},{"location":"developer-guide/contributing/#fork","text":"\u8bbf\u95ee https://github.com/loggie-io/loggie \uff0c\u70b9\u51fb\u53f3\u4e0a\u89d2\u7684Fork\uff0cfork\u5230\u81ea\u5df1\u7684github\u4ed3\u5e93\u4e2d\u3002","title":"fork\u4ee3\u7801"},{"location":"developer-guide/contributing/#clone","text":"\u5c06fork\u540e\u7684\u5de5\u7a0bclone\u5230\u672c\u5730\uff1a cd ${ go -workspace } git clone git@github.com: ${ yourAccountId } /loggie.git","title":"clone\u5230\u672c\u5730"},{"location":"developer-guide/contributing/#2","text":"","title":"2. \u672c\u5730\u5f00\u53d1"},{"location":"developer-guide/contributing/#add-upstream","text":"\u5728\u672c\u5730\u5de5\u7a0b\u4e2d\uff0c\u6dfb\u52a0upstream remote\uff1a git remote add upstream https://github.com/loggie-io/loggie.git git remote set-url --push upstream no_push \u53ef\u4ee5\u4f7f\u7528 git remote -v \u67e5\u770b\uff0corigin\u4e3a\u4f60\u4e2a\u4eba\u8d26\u53f7fork\u7684git\u5730\u5740\uff0cupstream\u4e3aLoggie\u5b98\u65b9\u4ed3\u5e93\u5730\u5740\uff0cuptream\u4ec5\u4e3a\u672c\u5730\u540c\u6b65\u4ee3\u7801\u4f7f\u7528\uff0c\u6b63\u5e38\u65e0push\u6743\u9650\u3002","title":"add upstream"},{"location":"developer-guide/contributing/#create-branch","text":"\u57fa\u4e8e\u6700\u65b0\u7684main\u5206\u652f\uff0c\u521b\u5efa\u51fa\u4f60\u7684\u5206\u652f\uff0c\u901a\u5e38\u4ee5feat/fix/chore\u7b49\u5f00\u5934\u3002 git checkout -b feat-mywork \u5728\u8be5\u5206\u652f\u5f00\u53d1\u5b8c\u540e\uff0c\u5f85\u63d0\u4ea4\u524d\uff0c\u5efa\u8bae\u4fdd\u6301\u4ee3\u7801\u548c\u4e0a\u6e38\u4e00\u81f4\uff1a git pull upstream -r","title":"create branch"},{"location":"developer-guide/contributing/#_3","text":"git commit git push origin feat-mywork Commit\u89c4\u8303 \u901a\u5e38\u6211\u4eec\u4f7f\u7528 <type>(<scope>): <subject> \u7684\u5f62\u5f0f\uff1a <type>: \uff08\u5fc5\u987b\uff09 feat\uff1a\u8868\u793a\u4e00\u4e2a\u65b0\u7684\u529f\u80fdfeature fix\uff1abug\u7684\u4fee\u590d chore\uff1a\u6784\u5efa\u8fc7\u7a0b\u6216\u8005\u8f85\u52a9\u5de5\u5177\u7684\u53d8\u52a8 test\uff1a\u6d4b\u8bd5\u76f8\u5173 docs\uff1a\u4fee\u6539\u4e86\u6587\u6863 perf\uff1a\u6027\u80fd\u4f18\u5316\u76f8\u5173\u6539\u52a8 refactor\uff1a\u4ee3\u7801\u91cd\u6784 <scope>: \uff08\u53ef\u9009\uff09 core\uff1aLoggie\u6846\u67b6\u7684\u6838\u5fc3\u4ee3\u7801\u6539\u52a8 source\uff1aLoggie source\u90e8\u5206\u529f\u80fd\u65b0\u589e\u6216\u6539\u52a8 sink\uff1aLoggie sink\u90e8\u5206\u529f\u80fd\u65b0\u589e\u6216\u6539\u52a8 interceptor\uff1aLoggie interceptor\u90e8\u5206\u529f\u80fd\u65b0\u589e\u6216\u6539\u52a8 discovery\uff1a\u670d\u52a1\u53d1\u73b0\u548c\u914d\u7f6e\u4e2d\u5fc3\u90e8\u5206 monitor\uff1amonitor eventbus\u90e8\u5206 <subject>: \uff08\u5fc5\u987b\uff09\u5373commit\u7684\u5185\u5bb9\u63cf\u8ff0","title":"\u63d0\u4ea4\u4ee3\u7801"},{"location":"developer-guide/contributing/#3-pr","text":"","title":"3. \u521b\u5efaPR"},{"location":"developer-guide/contributing/#github","text":"\u8bbf\u95ee\u4f60\u7684\u4e2a\u4ebagithub\u8d26\u53f7\u91ccfork\u7684Loggie\u9879\u76ee\uff0c\u5e76 Open pull request \u3002 \u5c3d\u91cf\u63cf\u8ff0\u6e05\u695aPR\u7684\u80cc\u666f\u3001\u76ee\u7684\u548c\u6539\u52a8\u70b9\u3002 \u5982\u679c\u6709\u76f8\u5173Issues\uff0c\u9700\u5173\u8054\u3002 \u63d0\u4ea4\u524d\u8bf7\u68c0\u67e5\uff1a \u662f\u5426\u9700\u8981\u6dfb\u52a0/\u4fee\u6539\u76f8\u5173unit test/e2e/\u6027\u80fd\u6d4b\u8bd5 \u662f\u5426\u9700\u8981\u6dfb\u52a0/\u4fee\u6539\u76f8\u5173\u6587\u6863","title":"\u63d0\u4ea4\u81f3Github"},{"location":"developer-guide/contributing/#merge","text":"\u4f60\u53ef\u4ee5\u5728OWNERS\u627e\u4eba\uff0c\u6216\u8005\u9ed8\u8ba4\u6dfb\u52a0loggie-robot\u8d26\u53f7\u4f5c\u4e3a\u4f60PR\u7684Reviewers\u6216Assigneees\u3002","title":"\u5bfb\u6c42Merge"},{"location":"developer-guide/development/","text":"\u672c\u5730\u5f00\u53d1 \u00b6 \u672c\u6587\u4ecb\u7ecd\u5982\u4f55\u5728\u672c\u5730\u5f00\u53d1\u548c\u8c03\u8bd5Loggie\u5de5\u7a0b\u3002 \u672c\u5730\u5de5\u7a0b \u00b6 golang\u5f00\u53d1\u73af\u5883 \u00b6 Loggie\u4f7f\u7528Golang\u7f16\u5199\uff0c\u8bf7\u786e\u4fdd\u672c\u5730\u6709 Golang \u5f00\u53d1\u73af\u5883\u3002 go version \u4ee3\u7801\u5de5\u7a0b \u00b6 \u8bf7\u4f7f\u7528\u81ea\u5df1\u7684github\u8d26\u53f7fork Loggie\u5de5\u7a0b\u3002\u7136\u540egit clone\u5230\u672c\u5730\u3002 git clone git@github.com:<Account>/loggie.git \u672c\u5730\u73af\u5883 \u00b6 \u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u672c\u5730\u65e0\u7279\u6b8a\u4f9d\u8d56\u3002 \u9488\u5bf9\u4e0d\u540c\u7684\u529f\u80fd\u573a\u666f\uff0c\u9700\u8981\u6839\u636e\u5177\u4f53\u60c5\u51b5\u5b89\u88c5\u6216\u8005\u4f7f\u7528\u5916\u90e8\u7684\u4f9d\u8d56\u3002 \u5efa\u8bae\u672c\u5730\u8fd0\u884cKubernetes\u8fdb\u884c\u90e8\u7f72\u548c\u7ba1\u7406\u3002 Kubernetes \u00b6 \u642d\u5efaKubernetes \u63a8\u8350\u4f7f\u7528 Kind \u3002 \u90e8\u7f72\u4f9d\u8d56\u7ec4\u4ef6 \u63a8\u8350\u4f7f\u7528 Helm \u6765\u90e8\u7f72\u3002\u76f8\u5173\u7684\u7ec4\u4ef6\u53ef\u4f7f\u7528\u516c\u5f00\u7684Helm\u4ed3\u5e93\u6765\u6dfb\u52a0\u548c\u90e8\u7f72\u3002 \u672c\u5730Loggie\u8fde\u63a5Kubernetes \u5982\u679c\u9700\u8981\u4f7f\u7528LogConfig\u7b49CRD\uff0c\u6216\u8005\u8c03\u8bd5Kubernetes\u4e0b\u7684\u4f7f\u7528\u65b9\u5f0f\uff0c\u9700\u8981\u5728\u7cfb\u7edf\u914d\u7f6e\u4e2d\uff0cenable Kubernetes Discovery\u3002 loggie.yml discovery : enabled : true kubernetes : kubeconfig : ${home}/.kube/config \u6307\u5b9akubeconfig\u8fde\u63a5\u672c\u5730\u7684Kubernetes APIServer\u3002 \u53e6\u5916\uff0cAgent\u5f62\u6001\u7684Loggie\uff0c\u4f1a\u53ea\u76d1\u542c\u672c\u8282\u70b9\u7684Kubernetes Pod\u4e8b\u4ef6\uff0c\u9700\u8981\u5728Loggie\u542f\u52a8\u53c2\u6570\u4e2d\u6dfb\u52a0 -meta.nodeName \u6765\u6a21\u62df\u6240\u5728\u7684\u8282\u70b9\u3002 \u4f8b\u5982\uff0c\u53ef\u4ee5\u4f7f\u7528 kubectl get node \u67e5\u770b\u6240\u6709\u8282\u70b9\u540d\u79f0\uff1a NAME STATUS ROLES AGE VERSION kind-control-plane Ready master 2y50d v1.21.0 \u7136\u540e\u542f\u52a8\u53c2\u6570\u589e\u52a0 -meta.nodeName=kind-control-plane \uff0c\u53ef\u4ee5\u4f7fLoggie\u542f\u52a8\u540e\u88ab\u8ba4\u4e3a\u90e8\u7f72\u5728\u8be5\u8282\u70b9\u3002 \u9a8c\u8bc1\u4e0e\u8c03\u8bd5 \u00b6 Loggie\u9ed8\u8ba4\u542f\u52a8\u540e\uff0c\u8f93\u51fa\u7684\u65e5\u5fd7\u683c\u5f0f\u4e3aJSON\uff0c\u5982\u679c\u4f60\u4e0d\u4e60\u60ef\uff0c\u53ef\u5728\u542f\u52a8\u53c2\u6570\u4e2d\u6dfb\u52a0 -log.jsonFormat=false \u6765\u5173\u95ed\u3002 \u672c\u5730\u5c3d\u91cf\u4f7f\u7528\u6a21\u62df\u7684\u65b9\u5f0f\uff0c\u5408\u7406\u5229\u7528dev source\u548cdev sink\u3002\u6bd4\u5982\uff1a \u5f00\u53d1source\uff0c\u53ef\u914d\u7f6edev sink\u8f93\u51fa\u5230\u672c\u5730stdout\u9a8c\u8bc1 \u5f00\u53d1sink\uff0c\u53ef\u914d\u7f6edev source\u6a21\u62df\u8f93\u5165\u6216\u8005\u914d\u7f6efile source\u91c7\u96c6\u672c\u5730\u6587\u4ef6 \u5f00\u53d1interceptor\uff0c\u53ef\u540c\u65f6\u914d\u7f6edev source\u548cdev sink\u7528\u4e8e\u6a21\u62df \u793a\u4f8b\uff1a\u5728pipelines\u4e2d\uff0c\u4f7f\u7528dev sink\uff0c\u67e5\u770b\u6700\u7ec8\u8f93\u51fa\u53d1\u9001\u81f3\u4e0b\u6e38\u7684\u6570\u636e\u3002 pipelines.yml sink : type : \"dev\" printEvents : true codec : pretty : true","title":"\u672c\u5730\u5f00\u53d1"},{"location":"developer-guide/development/#_1","text":"\u672c\u6587\u4ecb\u7ecd\u5982\u4f55\u5728\u672c\u5730\u5f00\u53d1\u548c\u8c03\u8bd5Loggie\u5de5\u7a0b\u3002","title":"\u672c\u5730\u5f00\u53d1"},{"location":"developer-guide/development/#_2","text":"","title":"\u672c\u5730\u5de5\u7a0b"},{"location":"developer-guide/development/#golang","text":"Loggie\u4f7f\u7528Golang\u7f16\u5199\uff0c\u8bf7\u786e\u4fdd\u672c\u5730\u6709 Golang \u5f00\u53d1\u73af\u5883\u3002 go version","title":"golang\u5f00\u53d1\u73af\u5883"},{"location":"developer-guide/development/#_3","text":"\u8bf7\u4f7f\u7528\u81ea\u5df1\u7684github\u8d26\u53f7fork Loggie\u5de5\u7a0b\u3002\u7136\u540egit clone\u5230\u672c\u5730\u3002 git clone git@github.com:<Account>/loggie.git","title":"\u4ee3\u7801\u5de5\u7a0b"},{"location":"developer-guide/development/#_4","text":"\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u672c\u5730\u65e0\u7279\u6b8a\u4f9d\u8d56\u3002 \u9488\u5bf9\u4e0d\u540c\u7684\u529f\u80fd\u573a\u666f\uff0c\u9700\u8981\u6839\u636e\u5177\u4f53\u60c5\u51b5\u5b89\u88c5\u6216\u8005\u4f7f\u7528\u5916\u90e8\u7684\u4f9d\u8d56\u3002 \u5efa\u8bae\u672c\u5730\u8fd0\u884cKubernetes\u8fdb\u884c\u90e8\u7f72\u548c\u7ba1\u7406\u3002","title":"\u672c\u5730\u73af\u5883"},{"location":"developer-guide/development/#kubernetes","text":"\u642d\u5efaKubernetes \u63a8\u8350\u4f7f\u7528 Kind \u3002 \u90e8\u7f72\u4f9d\u8d56\u7ec4\u4ef6 \u63a8\u8350\u4f7f\u7528 Helm \u6765\u90e8\u7f72\u3002\u76f8\u5173\u7684\u7ec4\u4ef6\u53ef\u4f7f\u7528\u516c\u5f00\u7684Helm\u4ed3\u5e93\u6765\u6dfb\u52a0\u548c\u90e8\u7f72\u3002 \u672c\u5730Loggie\u8fde\u63a5Kubernetes \u5982\u679c\u9700\u8981\u4f7f\u7528LogConfig\u7b49CRD\uff0c\u6216\u8005\u8c03\u8bd5Kubernetes\u4e0b\u7684\u4f7f\u7528\u65b9\u5f0f\uff0c\u9700\u8981\u5728\u7cfb\u7edf\u914d\u7f6e\u4e2d\uff0cenable Kubernetes Discovery\u3002 loggie.yml discovery : enabled : true kubernetes : kubeconfig : ${home}/.kube/config \u6307\u5b9akubeconfig\u8fde\u63a5\u672c\u5730\u7684Kubernetes APIServer\u3002 \u53e6\u5916\uff0cAgent\u5f62\u6001\u7684Loggie\uff0c\u4f1a\u53ea\u76d1\u542c\u672c\u8282\u70b9\u7684Kubernetes Pod\u4e8b\u4ef6\uff0c\u9700\u8981\u5728Loggie\u542f\u52a8\u53c2\u6570\u4e2d\u6dfb\u52a0 -meta.nodeName \u6765\u6a21\u62df\u6240\u5728\u7684\u8282\u70b9\u3002 \u4f8b\u5982\uff0c\u53ef\u4ee5\u4f7f\u7528 kubectl get node \u67e5\u770b\u6240\u6709\u8282\u70b9\u540d\u79f0\uff1a NAME STATUS ROLES AGE VERSION kind-control-plane Ready master 2y50d v1.21.0 \u7136\u540e\u542f\u52a8\u53c2\u6570\u589e\u52a0 -meta.nodeName=kind-control-plane \uff0c\u53ef\u4ee5\u4f7fLoggie\u542f\u52a8\u540e\u88ab\u8ba4\u4e3a\u90e8\u7f72\u5728\u8be5\u8282\u70b9\u3002","title":"Kubernetes"},{"location":"developer-guide/development/#_5","text":"Loggie\u9ed8\u8ba4\u542f\u52a8\u540e\uff0c\u8f93\u51fa\u7684\u65e5\u5fd7\u683c\u5f0f\u4e3aJSON\uff0c\u5982\u679c\u4f60\u4e0d\u4e60\u60ef\uff0c\u53ef\u5728\u542f\u52a8\u53c2\u6570\u4e2d\u6dfb\u52a0 -log.jsonFormat=false \u6765\u5173\u95ed\u3002 \u672c\u5730\u5c3d\u91cf\u4f7f\u7528\u6a21\u62df\u7684\u65b9\u5f0f\uff0c\u5408\u7406\u5229\u7528dev source\u548cdev sink\u3002\u6bd4\u5982\uff1a \u5f00\u53d1source\uff0c\u53ef\u914d\u7f6edev sink\u8f93\u51fa\u5230\u672c\u5730stdout\u9a8c\u8bc1 \u5f00\u53d1sink\uff0c\u53ef\u914d\u7f6edev source\u6a21\u62df\u8f93\u5165\u6216\u8005\u914d\u7f6efile source\u91c7\u96c6\u672c\u5730\u6587\u4ef6 \u5f00\u53d1interceptor\uff0c\u53ef\u540c\u65f6\u914d\u7f6edev source\u548cdev sink\u7528\u4e8e\u6a21\u62df \u793a\u4f8b\uff1a\u5728pipelines\u4e2d\uff0c\u4f7f\u7528dev sink\uff0c\u67e5\u770b\u6700\u7ec8\u8f93\u51fa\u53d1\u9001\u81f3\u4e0b\u6e38\u7684\u6570\u636e\u3002 pipelines.yml sink : type : \"dev\" printEvents : true codec : pretty : true","title":"\u9a8c\u8bc1\u4e0e\u8c03\u8bd5"},{"location":"developer-guide/release/","text":"\u7248\u672c\u548cRelease\u53d1\u5e03\u6d41\u7a0b \u00b6 \u7248\u672c\u53d1\u5e03\u6d89\u53ca\u5de5\u7a0b \u00b6 Loggie \u4e3b\u5de5\u7a0b Loggie-installation \u90e8\u7f72\u811a\u672c\u5de5\u7a0b Loggie docs \u6587\u6863\u9879\u76ee\uff08\u6682\u65f6\u4e3a\u6700\u65b0\u7684\u7248\u672c\u6587\u6863\uff0c\u540e\u7eed\u4f1a\u652f\u6301\u591a\u7248\u672c\uff09 \u4ee3\u7801\u5206\u652f\u7b56\u7565 \u00b6 \u7248\u672c\u53c2\u8003 Semantic\u8bed\u4e49 \u4f7f\u7528main\u4e3b\u5206\u652f\u4e3a\u5f00\u53d1\u5206\u652f\uff0c\u65e5\u5e38\u6240\u6709\u4ee3\u7801PR\u5747\u5408\u5165main\u5206\u652f \u65b0\u7248\u672c\u4f7f\u7528release\u5206\u652f\uff0c\u683c\u5f0f\u4e3a release-vA.B \uff0c\u4f8b\u5982 release-v1.1 \uff0c\u8fd9\u91cc\u53ea\u4f7f\u7528\u7248\u672c\u524d\u4e24\u4f4d \u57fa\u4e8erelease\u5206\u652f\u6253\u4e0atag\u8868\u793a\u5177\u4f53\u7248\u672c\uff0c\u4f8b\u5982 v1.1.0 bugfix \u9664\u4e86\u80af\u5b9a\u4f1a\u5408\u5165main\u5206\u652f\u5916\uff0c\u6839\u636e\u4e25\u91cd\u60c5\u51b5cherry-pick\u81f3\u5177\u4f53\u7684release\u5206\u652f\uff0c\u540c\u65f6\u6253\u4e0atag\uff0c\u9700\u8981\u5347\u7ea7\u6700\u5c0f\u7248\u672c\uff0c\u4f8b\u5982 v1.1.1 \u53d1\u5e03\u65b0\u7248\u672c\u6b65\u9aa4 \u00b6 1. \u521b\u5efa\u65b0\u7684release\u5206\u652f \u00b6 \u786e\u8ba4\u7248\u672c\u9700\u8981\u7684\u6240\u6709\u529f\u80fd\u5df2\u7ecf\u5408\u5165\uff0cmain\u5206\u652f\u4e3a\u6700\u65b0\u63d0\u4ea4\uff1a git checkout main git pull upstream main -r \u57fa\u4e8emain\u5206\u652f\u521b\u5efa\u65b0\u7684release\u5206\u652f\uff0c\u4f8b\u5982 release-v1.1 \uff1a git checkout -b release-v ${ A .B } 2. \u586b\u5199CHANGELOG \u00b6 \u57fa\u4e8e\u8be5\u5206\u652f\u586b\u5199CHANGELOG\uff0c\u63d0\u4ea4\u81f3\u5de5\u7a0b\u4e2d\u5408\u5165 git add . git commit -m 'Release: add v${A.B.C} changelog' git push upstream release-v ${ A .B.C } 3. release Loggie-installation \u00b6 release Loggie-installationation\u90e8\u7f72\u811a\u672c\u5de5\u7a0b\uff0c\u548c\u4e0a\u8ff01\uff0c2\u6b65\u9aa4\u76f8\u540c \u8bf7\u6ce8\u610f\uff1a \u8bf7\u52ff\u5fd8\u8bb0\u4fee\u6539Chart.yaml\u4e2d\u7684\u7248\u672c\u53f7 4. \u56de\u5f52\u6d4b\u8bd5 \u00b6 \u57fa\u4e8erelease\u5206\u652f\u8fdb\u884c\u56de\u5f52\u6d4b\u8bd5\u3002 release\u5206\u652fpush\u81f3Github\u540e\uff0c\u4f1a\u89e6\u53d1action\u8fdb\u884c\u955c\u50cf\u6784\u5efa\uff0c\u4f7f\u7528\u8be5\u955c\u50cf\u8fdb\u884c\u56de\u5f52\u6d4b\u8bd5\u3002 \u8fd9\u91cc\u7684\u6d4b\u8bd5\u4f1a\u4f7f\u7528loggie-installationation\u90e8\u7f72\u811a\u672c\u91cc\u76f8\u5e94\u7684release\u5206\u652f\uff0c\u540c\u65f6\u56de\u5f52\u9a8c\u8bc1\u90e8\u7f72\u811a\u672c\u6b63\u786e\u6027\u3002 \u5982\u679c\u6d4b\u8bd5\u53d1\u73b0Bug\uff0c\u63d0\u4ea4PR\u5408\u5165release\u5206\u652f\uff0c\u91cd\u65b0\u8fdb\u884c\u56de\u5f52\u3002 5. \u6253\u4e0a\u7248\u672ctag \u00b6 \u6d4b\u8bd5\u901a\u8fc7\u540e\uff0c\u57fa\u4e8e\u8be5release\u5206\u652f\u6253\u4e0a\u76f8\u5e94\u7684\u7248\u672ctag\uff0c\u6bd4\u5982 v1.1.0 git pull upstream release-v ${ A .B.C } git tag v ${ A .B.C } git push v ${ A .B.C } \u6ce8\u610fLoggie\u5de5\u7a0b\u548cLoggie-installationation\u90e8\u7f72\u811a\u672c\u5747\u9700\u8981\u3002 6. \u5728Github\u4e0a\u53d1\u5e03release \u00b6 Loggie\u5de5\u7a0b\u590d\u5236\u9879\u76ee\u4e2d\u7684CHANGELOG\u5373\u53ef Loggie installation\u5de5\u7a0b\u9700\u8981\u63d0\u4f9b loggie-linux-amd64 \u4e8c\u8fdb\u5236\u548c loggie-v${A.B.C}.tgz helm chart\u5305\u3002 \u4e8c\u8fdb\u5236\u9700\u8981\u627e\u53f0linux amd64\u673a\u5668\u8fdb\u884c make build helm chart\u5305\u9700\u8981\u57fa\u4e8e\u5bf9\u5e94\u7248\u672c\u7684loggie installation\u9879\u76ee\uff0c\u6267\u884c helm package ./helm-chart \u5373\u53ef\u3002 7. \u66f4\u65b0Loggie docs\u6587\u6863 \u00b6 \u66f4\u65b0Loggie docs\u6587\u6863\uff0c\u5e76\u63d0PR\u5408\u5165 \u6ce8\u610f\u4fee\u6539Loggie\u955c\u50cf\u548c\u7248\u672c\u53f7\u7b49 8. \u5c06release\u5206\u652f\u5408\u5165main \u00b6 \u63d0PR\u5c06release\u5206\u652f\u5408\u5165main\uff0c\u53ef\u7b49\u7a33\u5b9a\u4e00\u6bb5\u65f6\u95f4\u540e\u518d\u5408\u5165\uff0c\u6ce8\u610fLoggie\u5de5\u7a0b\u548cLoggie-installation\u90e8\u7f72\u811a\u672c\u5747\u9700\u8981\u3002 \u6709BugFix\u65f6 \u00b6 \u5982\u679c\u662f\u4e0d\u91cd\u8981\u7684bug\uff0c\u57fa\u4e8emain\u5206\u652f\u63d0\u4ea4\u4fee\u6539\u5373\u53ef\uff0c\u53ef\u4ee5\u4e0d\u5408\u5165release\u5206\u652f \u5982\u679c\u4e3a\u91cd\u8981\u7684bug\uff0c\u9700\u8981\u4fee\u590d\uff0c\u786e\u5b9a\u9700\u8981\u4fee\u590d\u7684\u7248\u672crelease\u5206\u652f\uff08\u53ef\u4e3a\u6700\u8fd1\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\uff09\uff0c\u9664\u4e86\u63d0\u4ea4\u81f3main\u5206\u652f\u5916\uff0c\u8fd8\u9700\u8981cherry-pick\u81f3\u6307\u5b9arelease\u5206\u652f\uff0c\u540c\u65f6\u6253\u4e0atag\uff0c\u65b0\u589e\u6700\u5c0f\u7248\u672c\u53f7\uff0c\u540c\u65f6\u9700\u8981\u786e\u8ba4Loggie-installation\u548cdocs\u662f\u5426\u540c\u6b65\u4fee\u6539\u3002","title":"\u7248\u672c\u53d1\u5e03\u6d41\u7a0b"},{"location":"developer-guide/release/#release","text":"","title":"\u7248\u672c\u548cRelease\u53d1\u5e03\u6d41\u7a0b"},{"location":"developer-guide/release/#_1","text":"Loggie \u4e3b\u5de5\u7a0b Loggie-installation \u90e8\u7f72\u811a\u672c\u5de5\u7a0b Loggie docs \u6587\u6863\u9879\u76ee\uff08\u6682\u65f6\u4e3a\u6700\u65b0\u7684\u7248\u672c\u6587\u6863\uff0c\u540e\u7eed\u4f1a\u652f\u6301\u591a\u7248\u672c\uff09","title":"\u7248\u672c\u53d1\u5e03\u6d89\u53ca\u5de5\u7a0b"},{"location":"developer-guide/release/#_2","text":"\u7248\u672c\u53c2\u8003 Semantic\u8bed\u4e49 \u4f7f\u7528main\u4e3b\u5206\u652f\u4e3a\u5f00\u53d1\u5206\u652f\uff0c\u65e5\u5e38\u6240\u6709\u4ee3\u7801PR\u5747\u5408\u5165main\u5206\u652f \u65b0\u7248\u672c\u4f7f\u7528release\u5206\u652f\uff0c\u683c\u5f0f\u4e3a release-vA.B \uff0c\u4f8b\u5982 release-v1.1 \uff0c\u8fd9\u91cc\u53ea\u4f7f\u7528\u7248\u672c\u524d\u4e24\u4f4d \u57fa\u4e8erelease\u5206\u652f\u6253\u4e0atag\u8868\u793a\u5177\u4f53\u7248\u672c\uff0c\u4f8b\u5982 v1.1.0 bugfix \u9664\u4e86\u80af\u5b9a\u4f1a\u5408\u5165main\u5206\u652f\u5916\uff0c\u6839\u636e\u4e25\u91cd\u60c5\u51b5cherry-pick\u81f3\u5177\u4f53\u7684release\u5206\u652f\uff0c\u540c\u65f6\u6253\u4e0atag\uff0c\u9700\u8981\u5347\u7ea7\u6700\u5c0f\u7248\u672c\uff0c\u4f8b\u5982 v1.1.1","title":"\u4ee3\u7801\u5206\u652f\u7b56\u7565"},{"location":"developer-guide/release/#_3","text":"","title":"\u53d1\u5e03\u65b0\u7248\u672c\u6b65\u9aa4"},{"location":"developer-guide/release/#1-release","text":"\u786e\u8ba4\u7248\u672c\u9700\u8981\u7684\u6240\u6709\u529f\u80fd\u5df2\u7ecf\u5408\u5165\uff0cmain\u5206\u652f\u4e3a\u6700\u65b0\u63d0\u4ea4\uff1a git checkout main git pull upstream main -r \u57fa\u4e8emain\u5206\u652f\u521b\u5efa\u65b0\u7684release\u5206\u652f\uff0c\u4f8b\u5982 release-v1.1 \uff1a git checkout -b release-v ${ A .B }","title":"1. \u521b\u5efa\u65b0\u7684release\u5206\u652f"},{"location":"developer-guide/release/#2-changelog","text":"\u57fa\u4e8e\u8be5\u5206\u652f\u586b\u5199CHANGELOG\uff0c\u63d0\u4ea4\u81f3\u5de5\u7a0b\u4e2d\u5408\u5165 git add . git commit -m 'Release: add v${A.B.C} changelog' git push upstream release-v ${ A .B.C }","title":"2. \u586b\u5199CHANGELOG"},{"location":"developer-guide/release/#3-release-loggie-installation","text":"release Loggie-installationation\u90e8\u7f72\u811a\u672c\u5de5\u7a0b\uff0c\u548c\u4e0a\u8ff01\uff0c2\u6b65\u9aa4\u76f8\u540c \u8bf7\u6ce8\u610f\uff1a \u8bf7\u52ff\u5fd8\u8bb0\u4fee\u6539Chart.yaml\u4e2d\u7684\u7248\u672c\u53f7","title":"3. release Loggie-installation"},{"location":"developer-guide/release/#4","text":"\u57fa\u4e8erelease\u5206\u652f\u8fdb\u884c\u56de\u5f52\u6d4b\u8bd5\u3002 release\u5206\u652fpush\u81f3Github\u540e\uff0c\u4f1a\u89e6\u53d1action\u8fdb\u884c\u955c\u50cf\u6784\u5efa\uff0c\u4f7f\u7528\u8be5\u955c\u50cf\u8fdb\u884c\u56de\u5f52\u6d4b\u8bd5\u3002 \u8fd9\u91cc\u7684\u6d4b\u8bd5\u4f1a\u4f7f\u7528loggie-installationation\u90e8\u7f72\u811a\u672c\u91cc\u76f8\u5e94\u7684release\u5206\u652f\uff0c\u540c\u65f6\u56de\u5f52\u9a8c\u8bc1\u90e8\u7f72\u811a\u672c\u6b63\u786e\u6027\u3002 \u5982\u679c\u6d4b\u8bd5\u53d1\u73b0Bug\uff0c\u63d0\u4ea4PR\u5408\u5165release\u5206\u652f\uff0c\u91cd\u65b0\u8fdb\u884c\u56de\u5f52\u3002","title":"4. \u56de\u5f52\u6d4b\u8bd5"},{"location":"developer-guide/release/#5-tag","text":"\u6d4b\u8bd5\u901a\u8fc7\u540e\uff0c\u57fa\u4e8e\u8be5release\u5206\u652f\u6253\u4e0a\u76f8\u5e94\u7684\u7248\u672ctag\uff0c\u6bd4\u5982 v1.1.0 git pull upstream release-v ${ A .B.C } git tag v ${ A .B.C } git push v ${ A .B.C } \u6ce8\u610fLoggie\u5de5\u7a0b\u548cLoggie-installationation\u90e8\u7f72\u811a\u672c\u5747\u9700\u8981\u3002","title":"5. \u6253\u4e0a\u7248\u672ctag"},{"location":"developer-guide/release/#6-githubrelease","text":"Loggie\u5de5\u7a0b\u590d\u5236\u9879\u76ee\u4e2d\u7684CHANGELOG\u5373\u53ef Loggie installation\u5de5\u7a0b\u9700\u8981\u63d0\u4f9b loggie-linux-amd64 \u4e8c\u8fdb\u5236\u548c loggie-v${A.B.C}.tgz helm chart\u5305\u3002 \u4e8c\u8fdb\u5236\u9700\u8981\u627e\u53f0linux amd64\u673a\u5668\u8fdb\u884c make build helm chart\u5305\u9700\u8981\u57fa\u4e8e\u5bf9\u5e94\u7248\u672c\u7684loggie installation\u9879\u76ee\uff0c\u6267\u884c helm package ./helm-chart \u5373\u53ef\u3002","title":"6. \u5728Github\u4e0a\u53d1\u5e03release"},{"location":"developer-guide/release/#7-loggie-docs","text":"\u66f4\u65b0Loggie docs\u6587\u6863\uff0c\u5e76\u63d0PR\u5408\u5165 \u6ce8\u610f\u4fee\u6539Loggie\u955c\u50cf\u548c\u7248\u672c\u53f7\u7b49","title":"7. \u66f4\u65b0Loggie docs\u6587\u6863"},{"location":"developer-guide/release/#8-releasemain","text":"\u63d0PR\u5c06release\u5206\u652f\u5408\u5165main\uff0c\u53ef\u7b49\u7a33\u5b9a\u4e00\u6bb5\u65f6\u95f4\u540e\u518d\u5408\u5165\uff0c\u6ce8\u610fLoggie\u5de5\u7a0b\u548cLoggie-installation\u90e8\u7f72\u811a\u672c\u5747\u9700\u8981\u3002","title":"8. \u5c06release\u5206\u652f\u5408\u5165main"},{"location":"developer-guide/release/#bugfix","text":"\u5982\u679c\u662f\u4e0d\u91cd\u8981\u7684bug\uff0c\u57fa\u4e8emain\u5206\u652f\u63d0\u4ea4\u4fee\u6539\u5373\u53ef\uff0c\u53ef\u4ee5\u4e0d\u5408\u5165release\u5206\u652f \u5982\u679c\u4e3a\u91cd\u8981\u7684bug\uff0c\u9700\u8981\u4fee\u590d\uff0c\u786e\u5b9a\u9700\u8981\u4fee\u590d\u7684\u7248\u672crelease\u5206\u652f\uff08\u53ef\u4e3a\u6700\u8fd1\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\uff09\uff0c\u9664\u4e86\u63d0\u4ea4\u81f3main\u5206\u652f\u5916\uff0c\u8fd8\u9700\u8981cherry-pick\u81f3\u6307\u5b9arelease\u5206\u652f\uff0c\u540c\u65f6\u6253\u4e0atag\uff0c\u65b0\u589e\u6700\u5c0f\u7248\u672c\u53f7\uff0c\u540c\u65f6\u9700\u8981\u786e\u8ba4Loggie-installation\u548cdocs\u662f\u5426\u540c\u6b65\u4fee\u6539\u3002","title":"\u6709BugFix\u65f6"},{"location":"developer-guide/code/coding-guide/","text":"\u4ee3\u7801\u89c4\u8303 \u00b6 \u5f00\u53d1\u89c4\u5219 \u00b6 \u901a\u7528Golang\u89c4\u8303 \u00b6 \u53c2\u8003\uff1a Effective Go Go Code Review Comments Uber Go Style Guide Loggie\u7684\u89c4\u8303 \u00b6 \u804c\u8d23\u5355\u4e00\u539f\u5219\uff0c\u4e00\u4e2acomponent\u53ea\u505a\u4e00\u4ef6\u4e8b\uff0c\u4e14\u505a\u597d\u4e00\u4ef6\u4e8b \u542f\u52a8\u4efb\u4f55\u4e00\u4e2agoroutine\u90fd\u8981\u5148\u60f3\u597d\u5982\u4f55\u9000\u51fa\uff0c\u4ee5\u53ca\u7f16\u7801\u9000\u51fa\u903b\u8f91 return err\u7684\u65f6\u5019\u60f3\u60f3\u662f\u5426\u9700\u8981\u6e05\u7406\u672c\u65e0\u9700\u542f\u52a8\u7684goroutine \u6c38\u8fdc\u8bb0\u4f4fgo\u4e2d\u7684\u64cd\u4f5c\u90fd\u4e0d\u4fdd\u8bc1\u539f\u5b50\u6027\uff08\u4f8b\u5982\u5b57\u7b26\u4e32\u62fc\u63a5\uff09\uff0c\u9664\u4e86chan\u3001sync\u5305\u7b49 for\uff08for each\uff09\u5faa\u73af\u7684\u65f6\u5019\uff0c\u6ce8\u610f\u51fd\u6570\u53d8\u91cf\u662f\u5171\u4eab\u76f8\u540c\u7684\u5730\u5740 \u51cf\u5c11\u4f7f\u7528\u5168\u5c40\u7684done chan\uff08\u5927\u91cfgoroutine\u8f6e\u8be2\u540c\u4e00\u4e2adone chan\u6027\u80fd\u4f1a\u6025\u5267\u4e0b\u964d\uff09\u3002 \u66f4\u5efa\u8bae\u4f7f\u7528\u7ec4\u4ef6struct\u72ec\u7acb\u7684done chan\u548c\u63d0\u4f9bStop()\u65b9\u6cd5\u6765\u4f9b\u4e0a\u5c42\u8c03\u7528\u6765\u5173\u95ed\u4ee5\u907f\u514dgoroutine\u6cc4\u9732 Component\u60f3\u597d\u5982\u4f55\u5408\u7406\u4f18\u96c5Stop\uff08\u7279\u522b\u662f\u4e0d\u8981\u53d1\u751fpanic\u5bfc\u81f4\u6574\u4e2a\u8fdb\u7a0b\u6302\u6389\uff09 \u4e0d\u8981\u5173\u95ed(close)\u4e00\u4e2a\u7528\u4e8e\u8bfb\u5199\u7684chan\u6765\u8fbe\u5230\u9000\u51fagoroutine\u6216\u8005\u505c\u6b62Component\u7684\u76ee\u6807\uff0c\u53ef\u80fd\u5728close chan\u540e\u8fd8\u6709\u5199\u64cd\u4f5c\u4f1a\u9020\u6210panic\u3002 \u4f7f\u7528\u4e00\u4e2a\u5355\u72ec\u7684done chan\u6765\u6807\u793a\u662f\u5426\u9000\u51fa \u5173\u95ed(Stop)Component\u7684\u65f6\u5019\u6ce8\u610f\u5173\u95ed\u7684\u987a\u5e8f\u548c\u8d44\u6e90\u91ca\u653e\uff0c \u4e0d\u8981\u9020\u6210\u5176\u4ed6goroutine\u592f\u4f4f(\u4f8b\u5982\u4f9b\u5916\u90e8\u5199\u76840\u5bb9\u91cf\u7684chan\u6ca1\u6709\u5904\u7406\uff0c\u4f46\u662f\u8bfb\u7684goroutine\u9000\u51fa\u4e86\uff0c\u5bfc\u81f4\u5916\u90e8\u5199\u7684goroutine\u4e00\u76f4\u963b\u585e) \u5c06chan\u7684\u751f\u547d\u5468\u671f\u5c01\u88c5\u5728chan\u6240\u6709\u8005\u5185\u90e8 \u4f7f\u7528done chan\u9000\u51fagoroutine\u7684\u65f6\u5019\uff0c\u4e0d\u8981\u505a\u4efb\u4f55\u6e05\u7406\u8d44\u6e90\u7684\u64cd\u4f5c\u3002\u6e05\u7406\u8d44\u6e90\u4f18\u5148\u4f7f\u7528defer\uff0c\u56e0\u4e3a\u5f53goroutine panic\u7684\u65f6\u5019\uff0c defer\u8fd8\u80fd\u591f\u6e05\u7406\u8d44\u6e90\uff0c\u800cdone chan\u4e2d\u7684\u6e05\u7406\u903b\u8f91\u53ef\u80fd\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u6267\u884c \u4e0d\u5141\u8bb8\u4f7f\u7528 time.after() \u3002\u4f7f\u7528 time.NewTicker() \u4ee3\u66ff\uff0c\u5e76\u53ca\u65f6\u6e05\u7406ticker \u65e5\u5fd7 \u00b6 \u65e5\u5fd7\u5e94\u8be5\u88ab\u8ba4\u771f\u5bf9\u5f85\u3002\u5728\u8fdb\u884c\u4fee\u6539\u65f6\uff0c\u8bf7\u82b1\u65f6\u95f4\u8bb0\u5f55\u65e5\u5fd7\uff0c\u4ee5\u786e\u4fdd\u91cd\u8981\u7684\u4e8b\u60c5\u88ab\u8bb0\u5f55\u4e0b\u6765\u3002\u7279\u522b\u662fpipeline name\u3001source name\u7b49\u7ec4\u4ef6\u7684\u5173\u952e\u4fe1\u606f \u65e5\u5fd7\u8bed\u53e5\u5e94\u8be5\u662f\u5b8c\u6574\u7684\u53e5\u5b50\uff0c\u5927\u5c0f\u5199\u9002\u5f53\uff0c\u4f9b\u4e0d\u4e00\u5b9a\u719f\u6089\u6e90\u4ee3\u7801\u7684\u4eba\u9605\u8bfb \u6253\u5370\u65e5\u5fd7\u76f4\u63a5\u4f7f\u7528\u9879\u76ee\u9884\u8bbe\u7684\u51fd\u6570\uff0c\u4f8b\u5982 log.Info() \u3001 log.Error() \u3002\u4e0d\u5141\u8bb8\u4f7f\u7528 fmt.Printf() \u3001 fmt.Println() \u7b49go\u5185\u7f6efmt\u65b9\u6cd5\u3002\u9879\u76ee\u65e5\u5fd7\u7cfb\u7edf\u91c7\u7528 zerolog \u65e5\u5fd7\u7ea7\u522b \u00b6 DEBUG\uff1a\u6253\u5370\u4e00\u4e9b\u72b6\u6001\u3001\u63d0\u793a\u4fe1\u606f\uff0c\u7528\u4e8e\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u89c2\u5bdf\uff0c\u5f00\u53d1\u5b8c\u6210\u3001\u6b63\u5f0f\u4e0a\u7ebf\u540e\u9700\u8981\u5c4f\u853d\uff0c\u4f46\u5728\u53d1\u751f\u96be\u4ee5\u6392\u67e5\u7684\u5f02\u5e38\u65f6\uff0c\u53ef\u4ee5\u6253\u5f00\u4ee5\u63d0\u4f9b\u66f4\u591a\u7684\u8be6\u7ec6\u5185\u90e8\u4fe1\u606f\u3002 INFO\uff1a\u4e00\u4e9b\u63d0\u793a\u6027\u7684\u4fe1\u606f\uff0c\u5373\u4f7f\u5728\u5f00\u53d1\u5b8c\u6210\u3001\u6b63\u5f0f\u4e0a\u7ebf\u7684\u7cfb\u7edf\u4e2d\uff0c\u4e5f\u6709\u4fdd\u7559\u7684\u4ef7\u503c\u3002 WARN\uff1a\u5c5e\u4e8e\u8f7b\u5fae\u7684\u8b66\u544a\uff0c\u7a0b\u5e8f\u4e2d\u51fa\u73b0\u4e86\u4e00\u4e9b\u5f02\u5e38\u60c5\u51b5\uff0c\u4f46\u662f\u5f71\u54cd\u4e0d\u5927\uff0c\u8fd8\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528\u3002 ERROR\uff1a\u5c5e\u4e8e\u666e\u901a\u7684\u9519\u8bef\uff0c\u5728\u7a0b\u5e8f\u53ef\u4ee5\u63a7\u5236\u7684\u8303\u56f4\u5185\uff0c\u4e0d\u4f1a\u9020\u6210\u8fde\u9501\u5f71\u54cd\u6216\u5de8\u5927\u5f71\u54cd\u3002 PANIC/FATAL\uff1a\u5c5e\u4e8e\u81f4\u547d\u9519\u8bef\uff0c\u4f1a\u5bfc\u81f4\u7cfb\u7edf\u762b\u75ea\u3001\u5173\u95ed\uff0c\u5fc5\u987b\u9a6c\u4e0a\u8fdb\u884c\u5904\u7406\u3002\u4e00\u822c\u5728main\u51fd\u6570\u542f\u52a8\u6d41\u7a0b\u4e2d\u4f7f\u7528\uff0c\u6b63\u5e38\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u8c28\u614e\u4f7f\u7528\u3002\u5e76\u4e14\u8bf7\u6ce8\u610fLoggie\u7684\u591aPipeline\u8bbe\u8ba1\u4e0a\u4e92\u76f8\u9694\u79bb\uff0cFATAL\u4f1a\u5f71\u54cd\u6240\u6709Pipeline\u3002 PANIC\u548cFATAL\u533a\u522b PANIC\u6700\u7ec8\u8c03\u7528\u7684\u662fpanic(msg) FATAL\u6700\u7ec8\u8c03\u7528\u7684\u662fos.Exit(1) \u76d1\u63a7 \u00b6 \u4efb\u4f55\u65b0\u7ec4\u4ef6\u90fd\u5e94\u8be5\u5e26\u6709\u9002\u5f53\u7684\u6307\u6807\uff0c\u4ee5\u4fbf\u76d1\u63a7\u529f\u80fd\u6b63\u5e38\u5de5\u4f5c \u5e94\u8be5\u8ba4\u771f\u5bf9\u5f85\u8fd9\u4e9b\u6307\u6807\uff0c\u5e76\u4e14\u53ea\u4e0a\u62a5\u6709\u7528\u7684\u6307\u6807\uff0c\u8fd9\u4e9b\u6307\u6807\u5c06\u5728\u751f\u4ea7\u4e2d\u7528\u4e8e\u76d1\u6d4b/\u63d0\u9192\u7cfb\u7edf\u7684\u5065\u5eb7\u72b6\u51b5\uff0c\u6216\u6392\u67e5\u95ee\u9898 \u5355\u5143\u6d4b\u8bd5 \u00b6 \u65b0\u529f\u80fd\u9700\u8981\u5305\u542b\u5355\u5143\u6d4b\u8bd5 \u5355\u5143\u6d4b\u8bd5\u5e94\u8be5\u6d4b\u8bd5\u5c3d\u53ef\u80fd\u5c11\u7684\u4ee3\u7801\uff0c\u4e0d\u8981\u542f\u52a8\u6574\u4e2a\u670d\u52a1\uff0c\u6709\u5916\u90e8\u4f9d\u8d56\u8bf7\u8865\u5145e2e\u6216\u8005\u96c6\u6210\u6d4b\u8bd5 \u4ee3\u7801\u98ce\u683c \u00b6 go fmt \u914d\u7f6e\u9879\u547d\u540d\u4f7f\u7528\u9a7c\u5cf0\u3002\u4f8b\u5982 yaml:\"cleanDataTimeout,omitempty\" \uff0c\u4ee3\u66ff yaml:\"clean_data_timeout,omitempty\" \u5411\u540e\u517c\u5bb9 \u00b6 \u534f\u8bae\u5e94\u652f\u6301\u5411\u540e\u517c\u5bb9\u6027\u4ee5\u5b9e\u73b0\u65e0\u505c\u673a\u5347\u7ea7\u3002\u8fd9\u610f\u5473\u7740\u540c\u7c7bsource\u548csink\u5fc5\u987b\u80fd\u591f\u540c\u65f6\u652f\u6301\u6765\u81ea\u65b0\u7248\u548c\u65e7\u7248\u7684\u8bf7\u6c42 \u5143\u6570\u636e\u683c\u5f0f\u548c\u6570\u636e\u683c\u5f0f\u5e94\u652f\u6301\u5411\u540e\u517c\u5bb9\u3002\u4f8b\u5982grcp\u7684protobuf\u5b9a\u4e49 Copyright profile \u00b6 Copyright-text /* Copyright 2022 Loggie Authors Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. */","title":"\u4ee3\u7801\u89c4\u8303"},{"location":"developer-guide/code/coding-guide/#_1","text":"","title":"\u4ee3\u7801\u89c4\u8303"},{"location":"developer-guide/code/coding-guide/#_2","text":"","title":"\u5f00\u53d1\u89c4\u5219"},{"location":"developer-guide/code/coding-guide/#golang","text":"\u53c2\u8003\uff1a Effective Go Go Code Review Comments Uber Go Style Guide","title":"\u901a\u7528Golang\u89c4\u8303"},{"location":"developer-guide/code/coding-guide/#loggie","text":"\u804c\u8d23\u5355\u4e00\u539f\u5219\uff0c\u4e00\u4e2acomponent\u53ea\u505a\u4e00\u4ef6\u4e8b\uff0c\u4e14\u505a\u597d\u4e00\u4ef6\u4e8b \u542f\u52a8\u4efb\u4f55\u4e00\u4e2agoroutine\u90fd\u8981\u5148\u60f3\u597d\u5982\u4f55\u9000\u51fa\uff0c\u4ee5\u53ca\u7f16\u7801\u9000\u51fa\u903b\u8f91 return err\u7684\u65f6\u5019\u60f3\u60f3\u662f\u5426\u9700\u8981\u6e05\u7406\u672c\u65e0\u9700\u542f\u52a8\u7684goroutine \u6c38\u8fdc\u8bb0\u4f4fgo\u4e2d\u7684\u64cd\u4f5c\u90fd\u4e0d\u4fdd\u8bc1\u539f\u5b50\u6027\uff08\u4f8b\u5982\u5b57\u7b26\u4e32\u62fc\u63a5\uff09\uff0c\u9664\u4e86chan\u3001sync\u5305\u7b49 for\uff08for each\uff09\u5faa\u73af\u7684\u65f6\u5019\uff0c\u6ce8\u610f\u51fd\u6570\u53d8\u91cf\u662f\u5171\u4eab\u76f8\u540c\u7684\u5730\u5740 \u51cf\u5c11\u4f7f\u7528\u5168\u5c40\u7684done chan\uff08\u5927\u91cfgoroutine\u8f6e\u8be2\u540c\u4e00\u4e2adone chan\u6027\u80fd\u4f1a\u6025\u5267\u4e0b\u964d\uff09\u3002 \u66f4\u5efa\u8bae\u4f7f\u7528\u7ec4\u4ef6struct\u72ec\u7acb\u7684done chan\u548c\u63d0\u4f9bStop()\u65b9\u6cd5\u6765\u4f9b\u4e0a\u5c42\u8c03\u7528\u6765\u5173\u95ed\u4ee5\u907f\u514dgoroutine\u6cc4\u9732 Component\u60f3\u597d\u5982\u4f55\u5408\u7406\u4f18\u96c5Stop\uff08\u7279\u522b\u662f\u4e0d\u8981\u53d1\u751fpanic\u5bfc\u81f4\u6574\u4e2a\u8fdb\u7a0b\u6302\u6389\uff09 \u4e0d\u8981\u5173\u95ed(close)\u4e00\u4e2a\u7528\u4e8e\u8bfb\u5199\u7684chan\u6765\u8fbe\u5230\u9000\u51fagoroutine\u6216\u8005\u505c\u6b62Component\u7684\u76ee\u6807\uff0c\u53ef\u80fd\u5728close chan\u540e\u8fd8\u6709\u5199\u64cd\u4f5c\u4f1a\u9020\u6210panic\u3002 \u4f7f\u7528\u4e00\u4e2a\u5355\u72ec\u7684done chan\u6765\u6807\u793a\u662f\u5426\u9000\u51fa \u5173\u95ed(Stop)Component\u7684\u65f6\u5019\u6ce8\u610f\u5173\u95ed\u7684\u987a\u5e8f\u548c\u8d44\u6e90\u91ca\u653e\uff0c \u4e0d\u8981\u9020\u6210\u5176\u4ed6goroutine\u592f\u4f4f(\u4f8b\u5982\u4f9b\u5916\u90e8\u5199\u76840\u5bb9\u91cf\u7684chan\u6ca1\u6709\u5904\u7406\uff0c\u4f46\u662f\u8bfb\u7684goroutine\u9000\u51fa\u4e86\uff0c\u5bfc\u81f4\u5916\u90e8\u5199\u7684goroutine\u4e00\u76f4\u963b\u585e) \u5c06chan\u7684\u751f\u547d\u5468\u671f\u5c01\u88c5\u5728chan\u6240\u6709\u8005\u5185\u90e8 \u4f7f\u7528done chan\u9000\u51fagoroutine\u7684\u65f6\u5019\uff0c\u4e0d\u8981\u505a\u4efb\u4f55\u6e05\u7406\u8d44\u6e90\u7684\u64cd\u4f5c\u3002\u6e05\u7406\u8d44\u6e90\u4f18\u5148\u4f7f\u7528defer\uff0c\u56e0\u4e3a\u5f53goroutine panic\u7684\u65f6\u5019\uff0c defer\u8fd8\u80fd\u591f\u6e05\u7406\u8d44\u6e90\uff0c\u800cdone chan\u4e2d\u7684\u6e05\u7406\u903b\u8f91\u53ef\u80fd\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u6267\u884c \u4e0d\u5141\u8bb8\u4f7f\u7528 time.after() \u3002\u4f7f\u7528 time.NewTicker() \u4ee3\u66ff\uff0c\u5e76\u53ca\u65f6\u6e05\u7406ticker","title":"Loggie\u7684\u89c4\u8303"},{"location":"developer-guide/code/coding-guide/#_3","text":"\u65e5\u5fd7\u5e94\u8be5\u88ab\u8ba4\u771f\u5bf9\u5f85\u3002\u5728\u8fdb\u884c\u4fee\u6539\u65f6\uff0c\u8bf7\u82b1\u65f6\u95f4\u8bb0\u5f55\u65e5\u5fd7\uff0c\u4ee5\u786e\u4fdd\u91cd\u8981\u7684\u4e8b\u60c5\u88ab\u8bb0\u5f55\u4e0b\u6765\u3002\u7279\u522b\u662fpipeline name\u3001source name\u7b49\u7ec4\u4ef6\u7684\u5173\u952e\u4fe1\u606f \u65e5\u5fd7\u8bed\u53e5\u5e94\u8be5\u662f\u5b8c\u6574\u7684\u53e5\u5b50\uff0c\u5927\u5c0f\u5199\u9002\u5f53\uff0c\u4f9b\u4e0d\u4e00\u5b9a\u719f\u6089\u6e90\u4ee3\u7801\u7684\u4eba\u9605\u8bfb \u6253\u5370\u65e5\u5fd7\u76f4\u63a5\u4f7f\u7528\u9879\u76ee\u9884\u8bbe\u7684\u51fd\u6570\uff0c\u4f8b\u5982 log.Info() \u3001 log.Error() \u3002\u4e0d\u5141\u8bb8\u4f7f\u7528 fmt.Printf() \u3001 fmt.Println() \u7b49go\u5185\u7f6efmt\u65b9\u6cd5\u3002\u9879\u76ee\u65e5\u5fd7\u7cfb\u7edf\u91c7\u7528 zerolog","title":"\u65e5\u5fd7"},{"location":"developer-guide/code/coding-guide/#_4","text":"DEBUG\uff1a\u6253\u5370\u4e00\u4e9b\u72b6\u6001\u3001\u63d0\u793a\u4fe1\u606f\uff0c\u7528\u4e8e\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u89c2\u5bdf\uff0c\u5f00\u53d1\u5b8c\u6210\u3001\u6b63\u5f0f\u4e0a\u7ebf\u540e\u9700\u8981\u5c4f\u853d\uff0c\u4f46\u5728\u53d1\u751f\u96be\u4ee5\u6392\u67e5\u7684\u5f02\u5e38\u65f6\uff0c\u53ef\u4ee5\u6253\u5f00\u4ee5\u63d0\u4f9b\u66f4\u591a\u7684\u8be6\u7ec6\u5185\u90e8\u4fe1\u606f\u3002 INFO\uff1a\u4e00\u4e9b\u63d0\u793a\u6027\u7684\u4fe1\u606f\uff0c\u5373\u4f7f\u5728\u5f00\u53d1\u5b8c\u6210\u3001\u6b63\u5f0f\u4e0a\u7ebf\u7684\u7cfb\u7edf\u4e2d\uff0c\u4e5f\u6709\u4fdd\u7559\u7684\u4ef7\u503c\u3002 WARN\uff1a\u5c5e\u4e8e\u8f7b\u5fae\u7684\u8b66\u544a\uff0c\u7a0b\u5e8f\u4e2d\u51fa\u73b0\u4e86\u4e00\u4e9b\u5f02\u5e38\u60c5\u51b5\uff0c\u4f46\u662f\u5f71\u54cd\u4e0d\u5927\uff0c\u8fd8\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528\u3002 ERROR\uff1a\u5c5e\u4e8e\u666e\u901a\u7684\u9519\u8bef\uff0c\u5728\u7a0b\u5e8f\u53ef\u4ee5\u63a7\u5236\u7684\u8303\u56f4\u5185\uff0c\u4e0d\u4f1a\u9020\u6210\u8fde\u9501\u5f71\u54cd\u6216\u5de8\u5927\u5f71\u54cd\u3002 PANIC/FATAL\uff1a\u5c5e\u4e8e\u81f4\u547d\u9519\u8bef\uff0c\u4f1a\u5bfc\u81f4\u7cfb\u7edf\u762b\u75ea\u3001\u5173\u95ed\uff0c\u5fc5\u987b\u9a6c\u4e0a\u8fdb\u884c\u5904\u7406\u3002\u4e00\u822c\u5728main\u51fd\u6570\u542f\u52a8\u6d41\u7a0b\u4e2d\u4f7f\u7528\uff0c\u6b63\u5e38\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u8c28\u614e\u4f7f\u7528\u3002\u5e76\u4e14\u8bf7\u6ce8\u610fLoggie\u7684\u591aPipeline\u8bbe\u8ba1\u4e0a\u4e92\u76f8\u9694\u79bb\uff0cFATAL\u4f1a\u5f71\u54cd\u6240\u6709Pipeline\u3002 PANIC\u548cFATAL\u533a\u522b PANIC\u6700\u7ec8\u8c03\u7528\u7684\u662fpanic(msg) FATAL\u6700\u7ec8\u8c03\u7528\u7684\u662fos.Exit(1)","title":"\u65e5\u5fd7\u7ea7\u522b"},{"location":"developer-guide/code/coding-guide/#_5","text":"\u4efb\u4f55\u65b0\u7ec4\u4ef6\u90fd\u5e94\u8be5\u5e26\u6709\u9002\u5f53\u7684\u6307\u6807\uff0c\u4ee5\u4fbf\u76d1\u63a7\u529f\u80fd\u6b63\u5e38\u5de5\u4f5c \u5e94\u8be5\u8ba4\u771f\u5bf9\u5f85\u8fd9\u4e9b\u6307\u6807\uff0c\u5e76\u4e14\u53ea\u4e0a\u62a5\u6709\u7528\u7684\u6307\u6807\uff0c\u8fd9\u4e9b\u6307\u6807\u5c06\u5728\u751f\u4ea7\u4e2d\u7528\u4e8e\u76d1\u6d4b/\u63d0\u9192\u7cfb\u7edf\u7684\u5065\u5eb7\u72b6\u51b5\uff0c\u6216\u6392\u67e5\u95ee\u9898","title":"\u76d1\u63a7"},{"location":"developer-guide/code/coding-guide/#_6","text":"\u65b0\u529f\u80fd\u9700\u8981\u5305\u542b\u5355\u5143\u6d4b\u8bd5 \u5355\u5143\u6d4b\u8bd5\u5e94\u8be5\u6d4b\u8bd5\u5c3d\u53ef\u80fd\u5c11\u7684\u4ee3\u7801\uff0c\u4e0d\u8981\u542f\u52a8\u6574\u4e2a\u670d\u52a1\uff0c\u6709\u5916\u90e8\u4f9d\u8d56\u8bf7\u8865\u5145e2e\u6216\u8005\u96c6\u6210\u6d4b\u8bd5","title":"\u5355\u5143\u6d4b\u8bd5"},{"location":"developer-guide/code/coding-guide/#_7","text":"go fmt \u914d\u7f6e\u9879\u547d\u540d\u4f7f\u7528\u9a7c\u5cf0\u3002\u4f8b\u5982 yaml:\"cleanDataTimeout,omitempty\" \uff0c\u4ee3\u66ff yaml:\"clean_data_timeout,omitempty\"","title":"\u4ee3\u7801\u98ce\u683c"},{"location":"developer-guide/code/coding-guide/#_8","text":"\u534f\u8bae\u5e94\u652f\u6301\u5411\u540e\u517c\u5bb9\u6027\u4ee5\u5b9e\u73b0\u65e0\u505c\u673a\u5347\u7ea7\u3002\u8fd9\u610f\u5473\u7740\u540c\u7c7bsource\u548csink\u5fc5\u987b\u80fd\u591f\u540c\u65f6\u652f\u6301\u6765\u81ea\u65b0\u7248\u548c\u65e7\u7248\u7684\u8bf7\u6c42 \u5143\u6570\u636e\u683c\u5f0f\u548c\u6570\u636e\u683c\u5f0f\u5e94\u652f\u6301\u5411\u540e\u517c\u5bb9\u3002\u4f8b\u5982grcp\u7684protobuf\u5b9a\u4e49","title":"\u5411\u540e\u517c\u5bb9"},{"location":"developer-guide/code/coding-guide/#copyright-profile","text":"Copyright-text /* Copyright 2022 Loggie Authors Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. */","title":"Copyright profile"},{"location":"developer-guide/component/component-guide/","text":"\u63a8\u8350\u53c2\u8003\u5df2\u6709\u7684\u7ec4\u4ef6\u5f00\u53d1\u4e00\u4e2a\u65b0\u7684\u7ec4\u4ef6 \u516c\u5171\u63a5\u53e3 \u00b6 // \u751f\u547d\u5468\u671f\u63a5\u53e3 type Lifecycle interface { // \u521d\u59cb\u5316\uff0c\u4f8b\u5982\u521d\u59cb\u5316Kafka\u8fde\u63a5 Init ( context Context ) // \u542f\u52a8\u8fd0\u884c\uff0c\u4f8b\u5982\u5f00\u59cb\u6d88\u8d39Kafka Start () // \u505c\u6b62 Stop () } // \u63cf\u8ff0\u63a5\u53e3 type Describable interface { // \u7c7b\u522b\uff0c\u4f8b\u5982source Category () Category // \u7c7b\u578b\uff0c\u4f8b\u5982kafka Type () Type // \u81ea\u5b9a\u4e49\u63cf\u8ff0 String () string } // \u914d\u7f6e\u83b7\u53d6\u63a5\u53e3 type Config interface { // \u83b7\u53d6\u914d\u7f6e Config () interface {} } // \u7ec4\u4ef6\u63a5\u53e3 type Component interface { // \u751f\u547d\u5468\u671f\u7ba1\u7406 Lifecycle // \u63cf\u8ff0\u7ba1\u7406 Describable // \u914d\u7f6e\u7ba1\u7406 Config } source\u7ec4\u4ef6 \u00b6 source\u7ec4\u4ef6\u5bf9\u63a5\u6570\u636e\u6e90\u8f93\u5165\uff0c\u5f00\u53d1\u4e00\u4e2a\u65b0\u7684source\u63d2\u4ef6\u9700\u8981\u5b9e\u73b0\u5982\u4e0b\u63a5\u53e3 // source\u7ec4\u4ef6\u63a5\u53e3 type Source interface { Component Producer // \u63d0\u4ea4\u63a5\u53e3\uff0c\u786e\u8ba4sink\u7aef\u6210\u529f\u7136\u540e\u63d0\u4ea4 Commit ( events [] Event ) } // \u751f\u4ea7\u63a5\u53e3\uff0csource\u7ec4\u4ef6\u9700\u8981\u5b9e\u73b0 type Producer interface { // \u5bf9\u63a5\u6570\u636e\u6e90 ProductLoop ( productFunc ProductFunc ) } sink\u7ec4\u4ef6 \u00b6 sink\u7ec4\u4ef6\u5bf9\u63a5\u8f93\u51fa\u7aef\uff0c\u5f00\u53d1\u4e00\u4e2a\u65b0\u7684sink\u63d2\u4ef6\u9700\u8981\u5b9e\u73b0\u5982\u4e0b\u63a5\u53e3 // sink\u7ec4\u4ef6\u63a5\u53e3 type Sink interface { Component Consumer } // \u6d88\u8d39\u63a5\u53e3\uff0csink\u7ec4\u4ef6\u9700\u8981\u5b9e\u73b0 type Consumer interface { // \u5bf9\u63a5\u8f93\u51fa\u7aef Consume ( batch Batch ) Result } interceptor\u7ec4\u4ef6 \u00b6 interceptor\u7ec4\u4ef6\u5bf9\u4e8b\u4ef6\u8fdb\u884c\u62e6\u622a\u5904\u7406\uff0c\u5f00\u53d1\u4e00\u4e2a\u65b0\u7684interceptor\u63d2\u4ef6\u9700\u8981\u5b9e\u73b0\u5982\u4e0b\u63a5\u53e3 // interceptor\u7ec4\u4ef6\u63a5\u53e3 type Interceptor interface { Component // \u62e6\u622a\u5904\u7406 Intercept ( invoker Invoker , invocation Invocation ) api . Result } Note \u8bf7\u6ce8\u610f\u65b0\u589e\u7684\u7ec4\u4ef6\u9700\u8981\u653e\u5230pkg/include/include.go\u7684import\u5f53\u4e2d\u6ce8\u518c","title":"\u7ec4\u4ef6\u5f00\u53d1"},{"location":"developer-guide/component/component-guide/#_1","text":"// \u751f\u547d\u5468\u671f\u63a5\u53e3 type Lifecycle interface { // \u521d\u59cb\u5316\uff0c\u4f8b\u5982\u521d\u59cb\u5316Kafka\u8fde\u63a5 Init ( context Context ) // \u542f\u52a8\u8fd0\u884c\uff0c\u4f8b\u5982\u5f00\u59cb\u6d88\u8d39Kafka Start () // \u505c\u6b62 Stop () } // \u63cf\u8ff0\u63a5\u53e3 type Describable interface { // \u7c7b\u522b\uff0c\u4f8b\u5982source Category () Category // \u7c7b\u578b\uff0c\u4f8b\u5982kafka Type () Type // \u81ea\u5b9a\u4e49\u63cf\u8ff0 String () string } // \u914d\u7f6e\u83b7\u53d6\u63a5\u53e3 type Config interface { // \u83b7\u53d6\u914d\u7f6e Config () interface {} } // \u7ec4\u4ef6\u63a5\u53e3 type Component interface { // \u751f\u547d\u5468\u671f\u7ba1\u7406 Lifecycle // \u63cf\u8ff0\u7ba1\u7406 Describable // \u914d\u7f6e\u7ba1\u7406 Config }","title":"\u516c\u5171\u63a5\u53e3"},{"location":"developer-guide/component/component-guide/#source","text":"source\u7ec4\u4ef6\u5bf9\u63a5\u6570\u636e\u6e90\u8f93\u5165\uff0c\u5f00\u53d1\u4e00\u4e2a\u65b0\u7684source\u63d2\u4ef6\u9700\u8981\u5b9e\u73b0\u5982\u4e0b\u63a5\u53e3 // source\u7ec4\u4ef6\u63a5\u53e3 type Source interface { Component Producer // \u63d0\u4ea4\u63a5\u53e3\uff0c\u786e\u8ba4sink\u7aef\u6210\u529f\u7136\u540e\u63d0\u4ea4 Commit ( events [] Event ) } // \u751f\u4ea7\u63a5\u53e3\uff0csource\u7ec4\u4ef6\u9700\u8981\u5b9e\u73b0 type Producer interface { // \u5bf9\u63a5\u6570\u636e\u6e90 ProductLoop ( productFunc ProductFunc ) }","title":"source\u7ec4\u4ef6"},{"location":"developer-guide/component/component-guide/#sink","text":"sink\u7ec4\u4ef6\u5bf9\u63a5\u8f93\u51fa\u7aef\uff0c\u5f00\u53d1\u4e00\u4e2a\u65b0\u7684sink\u63d2\u4ef6\u9700\u8981\u5b9e\u73b0\u5982\u4e0b\u63a5\u53e3 // sink\u7ec4\u4ef6\u63a5\u53e3 type Sink interface { Component Consumer } // \u6d88\u8d39\u63a5\u53e3\uff0csink\u7ec4\u4ef6\u9700\u8981\u5b9e\u73b0 type Consumer interface { // \u5bf9\u63a5\u8f93\u51fa\u7aef Consume ( batch Batch ) Result }","title":"sink\u7ec4\u4ef6"},{"location":"developer-guide/component/component-guide/#interceptor","text":"interceptor\u7ec4\u4ef6\u5bf9\u4e8b\u4ef6\u8fdb\u884c\u62e6\u622a\u5904\u7406\uff0c\u5f00\u53d1\u4e00\u4e2a\u65b0\u7684interceptor\u63d2\u4ef6\u9700\u8981\u5b9e\u73b0\u5982\u4e0b\u63a5\u53e3 // interceptor\u7ec4\u4ef6\u63a5\u53e3 type Interceptor interface { Component // \u62e6\u622a\u5904\u7406 Intercept ( invoker Invoker , invocation Invocation ) api . Result } Note \u8bf7\u6ce8\u610f\u65b0\u589e\u7684\u7ec4\u4ef6\u9700\u8981\u653e\u5230pkg/include/include.go\u7684import\u5f53\u4e2d\u6ce8\u518c","title":"interceptor\u7ec4\u4ef6"},{"location":"getting-started/overview/","text":"Loggie\u6f2b\u6e38\u6307\u5357 \u00b6 \u6b22\u8fce\u6765\u5230Loggie\u7684\u4e16\u754c\u3002 \u4e86\u89e3 \u00b6 \u60f3\u77e5\u9053\u4ec0\u4e48\u662fLoggie\uff1f\u4e86\u89e3\u4e00\u4e0b\u300c \u6838\u5fc3\u6982\u5ff5 \u300d\u3002 \u5982\u679c\u4f60\u5e0c\u671b\u5feb\u901f\u4f53\u9a8cLoggie\uff0c\u8bf7\u53c2\u8003\u300c \u5feb\u901f\u4e0a\u624b \u300d\u3002 \u6709\u66f4\u591a\u5174\u8da3\uff1f\u60f3\u77e5\u9053\u6211\u4eec\u4e3a\u4ec0\u4e48\u7814\u53d1Loggie\u3001Loggie\u6709\u4ec0\u4e48\u4f18\u52bf\u3001\u548c\u540c\u7c7b\u9879\u76ee\u7684\u5bf9\u6bd4\uff1f\u8bf7\u6233 \u8fd9\u91cc \u3002 \u4f7f\u7528 \u00b6 \u5982\u679c\u4f60\u5e0c\u671b\u5c1d\u8bd5\u4e00\u4e0bLoggie\uff0c\u4f46\u4e0d\u77e5\u9053\u5982\u4f55\u5f00\u59cb\uff1f \u53ef\u4ee5\u5148\u4ece\u6574\u4f53\u601d\u8003\u4e00\u4e0b\uff1a\u5982\u4f55\u91c7\u96c6\u4e1a\u52a1\u7684\u65e5\u5fd7\uff0c\u5982\u4f55\u5f62\u6210\u4e00\u4e2a\u5b8c\u5584\u5e76\u9002\u5408\u5b9e\u9645\u9700\u6c42\u7684\u65e5\u5fd7\u67b6\u6784\uff1f \u8fd9\u91cc\u6709\u4e00\u4e2a \u53c2\u8003 \u3002 \u63a5\u7740\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u9002\u5408\u7684\u4e1a\u52a1\u300c \u573a\u666f \u300d\uff0c\u67e5\u770bLoggie\u5728Kubernetes\u4e0b\u7684\u6700\u4f73\u5b9e\u8df5\u3002 \u8fd9\u91cc\u8fd8\u6d89\u53ca\u5230\u5982\u4f55\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u300c \u90e8\u7f72 \u300dLoggie\u3002 \u53e6\u5916\uff0c\u60f3\u67e5\u770b\u5177\u4f53\u7ec4\u4ef6\u7684\u4f7f\u7528\u65b9\u5f0f\uff0c\u8bf7\u53c2\u8003\u300c \u914d\u7f6e \u300d\u3002 \u89e3\u7b54 \u00b6 \u5728\u4f7f\u7528Loggie\u7684\u65f6\u5019\u9047\u5230\u95ee\u9898\uff1f \u8bf7\u63d0 issues \u6216\u8005\u8054\u7cfb\u6211\u4eec\u3002 \u5fae\u4fe1\u626b\u7801\u52a0\u5165Loggie\u8ba8\u8bba\u7fa4\uff1a \u53c2\u4e0e \u00b6 \u5982\u679c\u4f60\u5bf9Loggie\u7684\u5177\u4f53\u5b9e\u73b0\u611f\u5174\u8da3\uff0c\u60f3\u53c2\u4e0eLoggie\u5f00\u6e90\u7684\u7814\u53d1\uff1f\u60f3\u81ea\u7814\u63d2\u4ef6\uff1f\u8bf7\u770b\u300c \u5f00\u53d1\u624b\u518c \u300d\u3002","title":"Overview"},{"location":"getting-started/overview/#loggie","text":"\u6b22\u8fce\u6765\u5230Loggie\u7684\u4e16\u754c\u3002","title":"Loggie\u6f2b\u6e38\u6307\u5357"},{"location":"getting-started/overview/#_1","text":"\u60f3\u77e5\u9053\u4ec0\u4e48\u662fLoggie\uff1f\u4e86\u89e3\u4e00\u4e0b\u300c \u6838\u5fc3\u6982\u5ff5 \u300d\u3002 \u5982\u679c\u4f60\u5e0c\u671b\u5feb\u901f\u4f53\u9a8cLoggie\uff0c\u8bf7\u53c2\u8003\u300c \u5feb\u901f\u4e0a\u624b \u300d\u3002 \u6709\u66f4\u591a\u5174\u8da3\uff1f\u60f3\u77e5\u9053\u6211\u4eec\u4e3a\u4ec0\u4e48\u7814\u53d1Loggie\u3001Loggie\u6709\u4ec0\u4e48\u4f18\u52bf\u3001\u548c\u540c\u7c7b\u9879\u76ee\u7684\u5bf9\u6bd4\uff1f\u8bf7\u6233 \u8fd9\u91cc \u3002","title":"\u4e86\u89e3"},{"location":"getting-started/overview/#_2","text":"\u5982\u679c\u4f60\u5e0c\u671b\u5c1d\u8bd5\u4e00\u4e0bLoggie\uff0c\u4f46\u4e0d\u77e5\u9053\u5982\u4f55\u5f00\u59cb\uff1f \u53ef\u4ee5\u5148\u4ece\u6574\u4f53\u601d\u8003\u4e00\u4e0b\uff1a\u5982\u4f55\u91c7\u96c6\u4e1a\u52a1\u7684\u65e5\u5fd7\uff0c\u5982\u4f55\u5f62\u6210\u4e00\u4e2a\u5b8c\u5584\u5e76\u9002\u5408\u5b9e\u9645\u9700\u6c42\u7684\u65e5\u5fd7\u67b6\u6784\uff1f \u8fd9\u91cc\u6709\u4e00\u4e2a \u53c2\u8003 \u3002 \u63a5\u7740\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u9002\u5408\u7684\u4e1a\u52a1\u300c \u573a\u666f \u300d\uff0c\u67e5\u770bLoggie\u5728Kubernetes\u4e0b\u7684\u6700\u4f73\u5b9e\u8df5\u3002 \u8fd9\u91cc\u8fd8\u6d89\u53ca\u5230\u5982\u4f55\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u300c \u90e8\u7f72 \u300dLoggie\u3002 \u53e6\u5916\uff0c\u60f3\u67e5\u770b\u5177\u4f53\u7ec4\u4ef6\u7684\u4f7f\u7528\u65b9\u5f0f\uff0c\u8bf7\u53c2\u8003\u300c \u914d\u7f6e \u300d\u3002","title":"\u4f7f\u7528"},{"location":"getting-started/overview/#_3","text":"\u5728\u4f7f\u7528Loggie\u7684\u65f6\u5019\u9047\u5230\u95ee\u9898\uff1f \u8bf7\u63d0 issues \u6216\u8005\u8054\u7cfb\u6211\u4eec\u3002 \u5fae\u4fe1\u626b\u7801\u52a0\u5165Loggie\u8ba8\u8bba\u7fa4\uff1a","title":"\u89e3\u7b54"},{"location":"getting-started/overview/#_4","text":"\u5982\u679c\u4f60\u5bf9Loggie\u7684\u5177\u4f53\u5b9e\u73b0\u611f\u5174\u8da3\uff0c\u60f3\u53c2\u4e0eLoggie\u5f00\u6e90\u7684\u7814\u53d1\uff1f\u60f3\u81ea\u7814\u63d2\u4ef6\uff1f\u8bf7\u770b\u300c \u5f00\u53d1\u624b\u518c \u300d\u3002","title":"\u53c2\u4e0e"},{"location":"getting-started/install/kubernetes/","text":"Kubernetes\u90e8\u7f72 \u00b6 \u90e8\u7f72Loggie DaemonSet \u00b6 \u8bf7\u786e\u4fdd\u672c\u5730\u6709kubectl\u548chelm\u53ef\u6267\u884c\u547d\u4ee4\u3002 kubectl\uff08 \u4e0b\u8f7d \uff09 helm\uff08 \u4e0b\u8f7d \uff09 \u4e0b\u8f7dhelm-chart\u5305 \u00b6 helm pull https://github.com/loggie-io/installation/releases/download/v1.2.0/loggie-v1.2.0.tgz && tar xvzf loggie-v1.2.0.tgz \u4fee\u6539\u914d\u7f6e \u00b6 \u8fdb\u5165chart\u76ee\u5f55\uff1a cd installation/helm-chart \u67e5\u770bvalues.yml\uff0c\u5e76\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u4fee\u6539\u3002 \u76ee\u524d\u53ef\u914d\u7f6e\u7684\u53c2\u6570\u5982\u4e0b\u6240\u793a\uff1a \u955c\u50cf \u00b6 image : hub.c.163.com/loggie/loggie:v1.2.0 loggie\u7684\u955c\u50cf\u3002 \u8d44\u6e90 \u00b6 resources : limits : cpu : 2 memory : 2Gi requests : cpu : 100m memory : 100Mi Loggie Agent\u7684limit/request\u8d44\u6e90\uff0c\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u4fee\u6539\u3002 \u989d\u5916\u542f\u52a8\u53c2\u6570 \u00b6 extraArgs : {} Loggie\u7684\u989d\u5916\u542f\u52a8\u53c2\u6570\uff0c\u6bd4\u5982\u5e0c\u671b\u4fee\u6539\u914d\u7f6e\u4f7f\u7528debug\u7684\u65e5\u5fd7\u7ea7\u522b\uff0c\u4e0d\u4f7f\u7528json\u683c\u5f0f\u7684\u65e5\u5fd7\u6253\u5370\u5f62\u5f0f\uff0c\u53ef\u4ee5\u4fee\u6539\u4e3a: extraArgs : log.level : debug log.jsonFormat : false \u989d\u5916\u6302\u8f7d \u00b6 extraVolumeMounts : - mountPath : /var/log/pods name : podlogs - mountPath : /var/lib/kubelet/pods name : kubelet - mountPath : /var/lib/docker name : docker extraVolumes : - hostPath : path : /var/log/pods type : DirectoryOrCreate name : podlogs - hostPath : path : /var/lib/kubelet/pods type : DirectoryOrCreate name : kubelet - hostPath : path : /var/lib/docker type : DirectoryOrCreate name : docker \u5efa\u8bae\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u9ed8\u8ba4\u6302\u8f7d\u4ee5\u4e0a\u76ee\u5f55\u3002 Loggie\u9700\u8981\u8bb0\u5f55\u91c7\u96c6\u7684\u6587\u4ef6\u72b6\u6001(offset\u7b49)\uff0c\u907f\u514d\u91cd\u542f\u540e\u4ece\u5934\u5f00\u59cb\u91c7\u96c6\u6587\u4ef6\uff0c\u9020\u6210\u65e5\u5fd7\u91c7\u96c6\u91cd\u590d\uff0c\u9ed8\u8ba4\u6302\u8f7d\u8def\u5f84\u4e3a/data/loggie.db\uff0c\u6240\u4ee5\u6302\u8f7d\u4e86 /data/loggie--{{ template \"loggie.name\" . }} \u76ee\u5f55\u3002 \u5982\u679c\u4e1a\u52a1Pod\u4f7f\u7528hostPath\u6302\u8f7d\u65e5\u5fd7\u5230\u8282\u70b9\uff0c\u9700\u8981Loggie\u6302\u8f7d\u76f8\u540c\u7684\u8def\u5f84\u3002 \u56e0\u4e3aLoggie\u9700\u8981\u91c7\u96c6\u5bb9\u5668\u6807\u51c6\u8f93\u51fa\u7684\u8def\u5f84\uff0c\u6240\u4ee5\u9700\u8981\u4ece\u8282\u70b9/var/lib/docker\u6216\u8005/var/log/pods\u4e0b\u91c7\u96c6\u65e5\u5fd7\uff0c\u5982\u679c\u73af\u5883\u4e2d\u90e8\u7f72\u7684docker\u4fee\u6539\u4e86\u8be5\u8def\u5f84\uff0c\u8bf7\u540c\u6b65\u4fee\u6539\u8be5\u6302\u8f7d\u8def\u5f84\u3002\u5982\u679c\u975edocker\u8fd0\u884c\u65f6\uff0c\u6bd4\u5982\u4f7f\u7528containerd\uff0c\u65e0\u9700\u6302\u8f7d/var/lib/docker\uff0cLoggie\u4f1a\u4ece/var/log/pods\u4e2d\u5bfb\u627e\u5b9e\u9645\u7684\u6807\u51c6\u8f93\u51fa\u8def\u5f84\u3002 \u5982\u679c\u4e1a\u52a1Pod\u4f7f\u7528emtpyDir\u6302\u8f7d\u65e5\u5fd7\u5230\u8282\u70b9\uff0c\u9ed8\u8ba4emtpyDir\u4f1a\u5728\u8282\u70b9\u7684/var/lib/kubelet/pods\u8def\u5f84\u4e0b\uff0c\u6240\u4ee5\u9700\u8981Loggie\u6302\u8f7d\u8be5\u8def\u5f84\u3002\u5982\u679c\u73af\u5883\u7684kubelet\u4fee\u6539\u4e86\u8be5\u8def\u5f84\u914d\u7f6e\uff0c\u8fd9\u91cc\u9700\u8981\u540c\u6b65\u4fee\u6539\u3002 \u8c03\u5ea6 \u00b6 nodeSelector : {} affinity : {} # podAntiAffinity: # requiredDuringSchedulingIgnoredDuringExecution: # - labelSelector: # matchExpressions: # - key: app # operator: In # values: # - loggie # topologyKey: \"kubernetes.io/hostname\" \u53ef\u4f7f\u7528nodeSelector\u548caffinity\u6765\u63a7\u5236Loggie Pod\u7684\u8c03\u5ea6\uff0c\u5177\u4f53\u8bf7\u53c2\u8003Kubernetes\u6587\u6863\u3002 tolerations : [] # - effect: NoExecute # operator: Exists # - effect: NoSchedule # operator: Exists \u5982\u679c\u8282\u70b9\u6709\u81ea\u5df1\u7684taints\uff0c\u4f1a\u5bfc\u81f4Loggie Pod\u65e0\u6cd5\u8c03\u5ea6\u5230\u8be5\u8282\u70b9\uff0c\u5982\u679c\u9700\u8981\u5ffd\u7565taints\uff0c\u53ef\u4ee5\u52a0\u4e0a\u5bf9\u5e94\u7684tolerations\u3002 \u66f4\u65b0\u7b56\u7565 \u00b6 updateStrategy : type : RollingUpdate \u53ef\u4e3a RollingUpdate \u6216\u8005 OnDelete \u3002 \u5168\u5c40\u914d\u7f6e \u00b6 config : loggie : reload : enabled : true period : 10s monitor : logger : period : 30s enabled : true listeners : filesource : ~ filewatcher : ~ reload : ~ sink : ~ discovery : enabled : true kubernetes : containerRuntime : containerd fields : container.name : containername logConfig : logconfig namespace : namespace node.name : nodename pod.name : podname http : enabled : true port : 9196 \u5177\u4f53\u53c2\u6570\u8bf4\u660e\u53ef\u53c2\u8003 \u7ec4\u4ef6\u914d\u7f6e \u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u4f60\u5728\u672c\u5730\u4f7f\u7528Kind\u7b49\u5de5\u5177\u90e8\u7f72Kubernetes\uff0cKind\u9ed8\u8ba4\u4f1a\u4f7f\u7528containerd runtime\uff0c\u6b64\u65f6\u9700\u8981\u5728discovery.kubernetes\u4e2d\u589e\u52a0 containerRuntime: containerd \uff0c\u6307\u5b9a\u5bb9\u5668\u8fd0\u884c\u65f6\u3002 service \u00b6 \u5982\u679cLoggie\u5e0c\u671b\u63a5\u6536\u5176\u4ed6\u670d\u52a1\u53d1\u9001\u7684\u6570\u636e\uff0c\u9700\u8981\u5c06\u81ea\u8eab\u7684\u670d\u52a1\u901a\u8fc7service\u66b4\u9732\u51fa\u6765\u3002 \u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528Agent\u6a21\u5f0f\u7684Loggie\u53ea\u9700\u8981\u66b4\u9732\u81ea\u8eab\u7ba1\u7406\u7aef\u53e3\u3002 servicePorts : - name : monitor port : 9196 targetPort : 9196 \u90e8\u7f72 \u00b6 \u521d\u6b21\u90e8\u7f72\uff0c\u6211\u4eec\u6307\u5b9a\u90e8\u7f72\u5728 loggie namespace\u4e0b\uff0c\u5e76\u8ba9helm\u81ea\u52a8\u521b\u5efa\u8be5namespace\u3002 helm install loggie ./ -nloggie --create-namespace \u5982\u679c\u4f60\u7684\u73af\u5883\u4e2d\u5df2\u7ecf\u521b\u5efa\u4e86 loggie namespace\uff0c\u53ef\u4ee5\u5ffd\u7565\u5176\u4e2d\u7684 -nloggie \u548c --create-namespace \u53c2\u6570\u3002\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u81ea\u5df1\u7684namespace\uff0c\u5c06\u5176\u4e2d loggie \u66ff\u6362\u5373\u53ef\u3002 Kubernetes\u7248\u672c\u95ee\u9898 failed to install CRD crds/crds.yaml: unable to recognize \"\": no matches for kind \"CustomResourceDefinition\" in version \"apiextensions.k8s.io/v1\" \u5982\u679c\u4f60\u5728helm install\u7684\u65f6\u5019\u51fa\u73b0\u7c7b\u4f3c\u7684\u95ee\u9898\uff0c\u8bf4\u660e\u4f60\u7684Kubernetes\u7248\u672c\u8f83\u4f4e\uff0c\u4e0d\u652f\u6301apiextensions.k8s.io/v1\u7248\u672cCRD\u3002Loggie\u6682\u65f6\u4fdd\u7559\u4e86v1beta1\u7248\u672c\u7684CRD\uff0c\u8bf7\u5220\u9664charts\u4e2dv1beta1\u7248\u672c\uff0c rm loggie/crds/crds.yaml \uff0c\u91cd\u65b0install\u3002 \u67e5\u770b\u90e8\u7f72\u72b6\u6001 \u00b6 \u6267\u884c\u5b8c\u540e\uff0c\u901a\u8fc7\u4f7f\u7528helm\u547d\u4ee4\u6765\u67e5\u770b\u90e8\u7f72\u72b6\u6001\uff1a helm list -nloggie \u7c7b\u4f3c\u5982\u4e0b\u6240\u793a\uff1a NAME NAMESPACE REVISION UPDATED STATUS CHART APP VERSION loggie loggie 1 2021-11-30 18:06:16.976334232 +0800 CST deployed loggie-v0.1.0 v0.1.0 \u540c\u65f6\u4e5f\u53ef\u4ee5\u901a\u8fc7kubectl\u547d\u4ee4\u67e5\u770bPod\u662f\u5426\u5df2\u7ecf\u88ab\u521b\u5efa\u3002 kubectl -nloggie get po \u7c7b\u4f3c\u5982\u4e0b\u6240\u793a\uff1a loggie-sxxwh 1/1 Running 0 5m21s 10.244.0.5 kind-control-plane <none> <none> \u90e8\u7f72Loggie Aggregator \u00b6 \u90e8\u7f72Aggregator\u57fa\u672c\u548cAgent\u4e00\u81f4\uff0c\u5728helm chart\u4e2d\u6211\u4eec\u63d0\u4f9b\u4e86\u9ed8\u8ba4\u6ce8\u91ca\u6389\u7684 Aggregator global config \u90e8\u5206\uff0c\u53ea\u9700\u4f7f\u7528\u8be5\u914d\u7f6e\u540c\u65f6\u53bb\u6389Agent\u7684\u914d\u7f6e\u5373\u53ef\u3002 \u540c\u65f6\uff0c\u8bf7\u6ce8\u610f\u5728values.yaml\u4e2d\u6839\u636e\u60c5\u51b5\u589e\u52a0\uff1a nodeSelector\u6216\u8005affinity\uff0c\u6839\u636enode\u662f\u5426\u6709\u6c61\u70b9\u589e\u52a0tolerations\u3002\u4f7f\u5f97Aggregator DaemonSet\u53ea\u8c03\u5ea6\u5728\u67d0\u51e0\u4e2a\u8282\u70b9\u4e0a service\u589e\u52a0\u63a5\u6536\u7684\u7aef\u53e3\uff0c\u6bd4\u5982\u4f7f\u7528Grpc source\uff0c\u9700\u8981\u586b\u5199\u9ed8\u8ba4\u76846066\u7aef\u53e3\uff1a servicePorts : - name : grpc port : 6066 targetPort : 6066 discovery.kubernetes\u4e2d\u589e\u52a0cluster\u5b57\u6bb5\uff0c\u8868\u793a\u4e2d\u8f6c\u673a\u96c6\u7fa4\u540d\u79f0\uff0c\u7528\u4e8e\u533a\u522bAgent\u6216\u8005\u5176\u4ed6\u7684Loggie\u96c6\u7fa4\uff0c\u5982\u4e0b\u6240\u793a\uff1a config : loggie : discovery : enabled : true kubernetes : cluster : aggregator \u6267\u884c\u90e8\u7f72\u547d\u4ee4\u53c2\u8003\uff1a helm install loggie-aggregator ./ -nloggie-aggregator --create-namespace Note Loggie\u4e2d\u8f6c\u673a\u540c\u6837\u53ef\u4ee5\u4f7f\u7528Deployment\u6216\u8005StatefulSet\u6765\u90e8\u7f72\uff0c\u8bf7\u53c2\u8003DaemonSet\u81ea\u884c\u4fee\u6539helm chart\u3002","title":"Kubernetes\u90e8\u7f72"},{"location":"getting-started/install/kubernetes/#kubernetes","text":"","title":"Kubernetes\u90e8\u7f72"},{"location":"getting-started/install/kubernetes/#loggie-daemonset","text":"\u8bf7\u786e\u4fdd\u672c\u5730\u6709kubectl\u548chelm\u53ef\u6267\u884c\u547d\u4ee4\u3002 kubectl\uff08 \u4e0b\u8f7d \uff09 helm\uff08 \u4e0b\u8f7d \uff09","title":"\u90e8\u7f72Loggie DaemonSet"},{"location":"getting-started/install/kubernetes/#helm-chart","text":"helm pull https://github.com/loggie-io/installation/releases/download/v1.2.0/loggie-v1.2.0.tgz && tar xvzf loggie-v1.2.0.tgz","title":"\u4e0b\u8f7dhelm-chart\u5305"},{"location":"getting-started/install/kubernetes/#_1","text":"\u8fdb\u5165chart\u76ee\u5f55\uff1a cd installation/helm-chart \u67e5\u770bvalues.yml\uff0c\u5e76\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u4fee\u6539\u3002 \u76ee\u524d\u53ef\u914d\u7f6e\u7684\u53c2\u6570\u5982\u4e0b\u6240\u793a\uff1a","title":"\u4fee\u6539\u914d\u7f6e"},{"location":"getting-started/install/kubernetes/#_2","text":"image : hub.c.163.com/loggie/loggie:v1.2.0 loggie\u7684\u955c\u50cf\u3002","title":"\u955c\u50cf"},{"location":"getting-started/install/kubernetes/#_3","text":"resources : limits : cpu : 2 memory : 2Gi requests : cpu : 100m memory : 100Mi Loggie Agent\u7684limit/request\u8d44\u6e90\uff0c\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u4fee\u6539\u3002","title":"\u8d44\u6e90"},{"location":"getting-started/install/kubernetes/#_4","text":"extraArgs : {} Loggie\u7684\u989d\u5916\u542f\u52a8\u53c2\u6570\uff0c\u6bd4\u5982\u5e0c\u671b\u4fee\u6539\u914d\u7f6e\u4f7f\u7528debug\u7684\u65e5\u5fd7\u7ea7\u522b\uff0c\u4e0d\u4f7f\u7528json\u683c\u5f0f\u7684\u65e5\u5fd7\u6253\u5370\u5f62\u5f0f\uff0c\u53ef\u4ee5\u4fee\u6539\u4e3a: extraArgs : log.level : debug log.jsonFormat : false","title":"\u989d\u5916\u542f\u52a8\u53c2\u6570"},{"location":"getting-started/install/kubernetes/#_5","text":"extraVolumeMounts : - mountPath : /var/log/pods name : podlogs - mountPath : /var/lib/kubelet/pods name : kubelet - mountPath : /var/lib/docker name : docker extraVolumes : - hostPath : path : /var/log/pods type : DirectoryOrCreate name : podlogs - hostPath : path : /var/lib/kubelet/pods type : DirectoryOrCreate name : kubelet - hostPath : path : /var/lib/docker type : DirectoryOrCreate name : docker \u5efa\u8bae\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u9ed8\u8ba4\u6302\u8f7d\u4ee5\u4e0a\u76ee\u5f55\u3002 Loggie\u9700\u8981\u8bb0\u5f55\u91c7\u96c6\u7684\u6587\u4ef6\u72b6\u6001(offset\u7b49)\uff0c\u907f\u514d\u91cd\u542f\u540e\u4ece\u5934\u5f00\u59cb\u91c7\u96c6\u6587\u4ef6\uff0c\u9020\u6210\u65e5\u5fd7\u91c7\u96c6\u91cd\u590d\uff0c\u9ed8\u8ba4\u6302\u8f7d\u8def\u5f84\u4e3a/data/loggie.db\uff0c\u6240\u4ee5\u6302\u8f7d\u4e86 /data/loggie--{{ template \"loggie.name\" . }} \u76ee\u5f55\u3002 \u5982\u679c\u4e1a\u52a1Pod\u4f7f\u7528hostPath\u6302\u8f7d\u65e5\u5fd7\u5230\u8282\u70b9\uff0c\u9700\u8981Loggie\u6302\u8f7d\u76f8\u540c\u7684\u8def\u5f84\u3002 \u56e0\u4e3aLoggie\u9700\u8981\u91c7\u96c6\u5bb9\u5668\u6807\u51c6\u8f93\u51fa\u7684\u8def\u5f84\uff0c\u6240\u4ee5\u9700\u8981\u4ece\u8282\u70b9/var/lib/docker\u6216\u8005/var/log/pods\u4e0b\u91c7\u96c6\u65e5\u5fd7\uff0c\u5982\u679c\u73af\u5883\u4e2d\u90e8\u7f72\u7684docker\u4fee\u6539\u4e86\u8be5\u8def\u5f84\uff0c\u8bf7\u540c\u6b65\u4fee\u6539\u8be5\u6302\u8f7d\u8def\u5f84\u3002\u5982\u679c\u975edocker\u8fd0\u884c\u65f6\uff0c\u6bd4\u5982\u4f7f\u7528containerd\uff0c\u65e0\u9700\u6302\u8f7d/var/lib/docker\uff0cLoggie\u4f1a\u4ece/var/log/pods\u4e2d\u5bfb\u627e\u5b9e\u9645\u7684\u6807\u51c6\u8f93\u51fa\u8def\u5f84\u3002 \u5982\u679c\u4e1a\u52a1Pod\u4f7f\u7528emtpyDir\u6302\u8f7d\u65e5\u5fd7\u5230\u8282\u70b9\uff0c\u9ed8\u8ba4emtpyDir\u4f1a\u5728\u8282\u70b9\u7684/var/lib/kubelet/pods\u8def\u5f84\u4e0b\uff0c\u6240\u4ee5\u9700\u8981Loggie\u6302\u8f7d\u8be5\u8def\u5f84\u3002\u5982\u679c\u73af\u5883\u7684kubelet\u4fee\u6539\u4e86\u8be5\u8def\u5f84\u914d\u7f6e\uff0c\u8fd9\u91cc\u9700\u8981\u540c\u6b65\u4fee\u6539\u3002","title":"\u989d\u5916\u6302\u8f7d"},{"location":"getting-started/install/kubernetes/#_6","text":"nodeSelector : {} affinity : {} # podAntiAffinity: # requiredDuringSchedulingIgnoredDuringExecution: # - labelSelector: # matchExpressions: # - key: app # operator: In # values: # - loggie # topologyKey: \"kubernetes.io/hostname\" \u53ef\u4f7f\u7528nodeSelector\u548caffinity\u6765\u63a7\u5236Loggie Pod\u7684\u8c03\u5ea6\uff0c\u5177\u4f53\u8bf7\u53c2\u8003Kubernetes\u6587\u6863\u3002 tolerations : [] # - effect: NoExecute # operator: Exists # - effect: NoSchedule # operator: Exists \u5982\u679c\u8282\u70b9\u6709\u81ea\u5df1\u7684taints\uff0c\u4f1a\u5bfc\u81f4Loggie Pod\u65e0\u6cd5\u8c03\u5ea6\u5230\u8be5\u8282\u70b9\uff0c\u5982\u679c\u9700\u8981\u5ffd\u7565taints\uff0c\u53ef\u4ee5\u52a0\u4e0a\u5bf9\u5e94\u7684tolerations\u3002","title":"\u8c03\u5ea6"},{"location":"getting-started/install/kubernetes/#_7","text":"updateStrategy : type : RollingUpdate \u53ef\u4e3a RollingUpdate \u6216\u8005 OnDelete \u3002","title":"\u66f4\u65b0\u7b56\u7565"},{"location":"getting-started/install/kubernetes/#_8","text":"config : loggie : reload : enabled : true period : 10s monitor : logger : period : 30s enabled : true listeners : filesource : ~ filewatcher : ~ reload : ~ sink : ~ discovery : enabled : true kubernetes : containerRuntime : containerd fields : container.name : containername logConfig : logconfig namespace : namespace node.name : nodename pod.name : podname http : enabled : true port : 9196 \u5177\u4f53\u53c2\u6570\u8bf4\u660e\u53ef\u53c2\u8003 \u7ec4\u4ef6\u914d\u7f6e \u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u4f60\u5728\u672c\u5730\u4f7f\u7528Kind\u7b49\u5de5\u5177\u90e8\u7f72Kubernetes\uff0cKind\u9ed8\u8ba4\u4f1a\u4f7f\u7528containerd runtime\uff0c\u6b64\u65f6\u9700\u8981\u5728discovery.kubernetes\u4e2d\u589e\u52a0 containerRuntime: containerd \uff0c\u6307\u5b9a\u5bb9\u5668\u8fd0\u884c\u65f6\u3002","title":"\u5168\u5c40\u914d\u7f6e"},{"location":"getting-started/install/kubernetes/#service","text":"\u5982\u679cLoggie\u5e0c\u671b\u63a5\u6536\u5176\u4ed6\u670d\u52a1\u53d1\u9001\u7684\u6570\u636e\uff0c\u9700\u8981\u5c06\u81ea\u8eab\u7684\u670d\u52a1\u901a\u8fc7service\u66b4\u9732\u51fa\u6765\u3002 \u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528Agent\u6a21\u5f0f\u7684Loggie\u53ea\u9700\u8981\u66b4\u9732\u81ea\u8eab\u7ba1\u7406\u7aef\u53e3\u3002 servicePorts : - name : monitor port : 9196 targetPort : 9196","title":"service"},{"location":"getting-started/install/kubernetes/#_9","text":"\u521d\u6b21\u90e8\u7f72\uff0c\u6211\u4eec\u6307\u5b9a\u90e8\u7f72\u5728 loggie namespace\u4e0b\uff0c\u5e76\u8ba9helm\u81ea\u52a8\u521b\u5efa\u8be5namespace\u3002 helm install loggie ./ -nloggie --create-namespace \u5982\u679c\u4f60\u7684\u73af\u5883\u4e2d\u5df2\u7ecf\u521b\u5efa\u4e86 loggie namespace\uff0c\u53ef\u4ee5\u5ffd\u7565\u5176\u4e2d\u7684 -nloggie \u548c --create-namespace \u53c2\u6570\u3002\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u81ea\u5df1\u7684namespace\uff0c\u5c06\u5176\u4e2d loggie \u66ff\u6362\u5373\u53ef\u3002 Kubernetes\u7248\u672c\u95ee\u9898 failed to install CRD crds/crds.yaml: unable to recognize \"\": no matches for kind \"CustomResourceDefinition\" in version \"apiextensions.k8s.io/v1\" \u5982\u679c\u4f60\u5728helm install\u7684\u65f6\u5019\u51fa\u73b0\u7c7b\u4f3c\u7684\u95ee\u9898\uff0c\u8bf4\u660e\u4f60\u7684Kubernetes\u7248\u672c\u8f83\u4f4e\uff0c\u4e0d\u652f\u6301apiextensions.k8s.io/v1\u7248\u672cCRD\u3002Loggie\u6682\u65f6\u4fdd\u7559\u4e86v1beta1\u7248\u672c\u7684CRD\uff0c\u8bf7\u5220\u9664charts\u4e2dv1beta1\u7248\u672c\uff0c rm loggie/crds/crds.yaml \uff0c\u91cd\u65b0install\u3002","title":"\u90e8\u7f72"},{"location":"getting-started/install/kubernetes/#_10","text":"\u6267\u884c\u5b8c\u540e\uff0c\u901a\u8fc7\u4f7f\u7528helm\u547d\u4ee4\u6765\u67e5\u770b\u90e8\u7f72\u72b6\u6001\uff1a helm list -nloggie \u7c7b\u4f3c\u5982\u4e0b\u6240\u793a\uff1a NAME NAMESPACE REVISION UPDATED STATUS CHART APP VERSION loggie loggie 1 2021-11-30 18:06:16.976334232 +0800 CST deployed loggie-v0.1.0 v0.1.0 \u540c\u65f6\u4e5f\u53ef\u4ee5\u901a\u8fc7kubectl\u547d\u4ee4\u67e5\u770bPod\u662f\u5426\u5df2\u7ecf\u88ab\u521b\u5efa\u3002 kubectl -nloggie get po \u7c7b\u4f3c\u5982\u4e0b\u6240\u793a\uff1a loggie-sxxwh 1/1 Running 0 5m21s 10.244.0.5 kind-control-plane <none> <none>","title":"\u67e5\u770b\u90e8\u7f72\u72b6\u6001"},{"location":"getting-started/install/kubernetes/#loggie-aggregator","text":"\u90e8\u7f72Aggregator\u57fa\u672c\u548cAgent\u4e00\u81f4\uff0c\u5728helm chart\u4e2d\u6211\u4eec\u63d0\u4f9b\u4e86\u9ed8\u8ba4\u6ce8\u91ca\u6389\u7684 Aggregator global config \u90e8\u5206\uff0c\u53ea\u9700\u4f7f\u7528\u8be5\u914d\u7f6e\u540c\u65f6\u53bb\u6389Agent\u7684\u914d\u7f6e\u5373\u53ef\u3002 \u540c\u65f6\uff0c\u8bf7\u6ce8\u610f\u5728values.yaml\u4e2d\u6839\u636e\u60c5\u51b5\u589e\u52a0\uff1a nodeSelector\u6216\u8005affinity\uff0c\u6839\u636enode\u662f\u5426\u6709\u6c61\u70b9\u589e\u52a0tolerations\u3002\u4f7f\u5f97Aggregator DaemonSet\u53ea\u8c03\u5ea6\u5728\u67d0\u51e0\u4e2a\u8282\u70b9\u4e0a service\u589e\u52a0\u63a5\u6536\u7684\u7aef\u53e3\uff0c\u6bd4\u5982\u4f7f\u7528Grpc source\uff0c\u9700\u8981\u586b\u5199\u9ed8\u8ba4\u76846066\u7aef\u53e3\uff1a servicePorts : - name : grpc port : 6066 targetPort : 6066 discovery.kubernetes\u4e2d\u589e\u52a0cluster\u5b57\u6bb5\uff0c\u8868\u793a\u4e2d\u8f6c\u673a\u96c6\u7fa4\u540d\u79f0\uff0c\u7528\u4e8e\u533a\u522bAgent\u6216\u8005\u5176\u4ed6\u7684Loggie\u96c6\u7fa4\uff0c\u5982\u4e0b\u6240\u793a\uff1a config : loggie : discovery : enabled : true kubernetes : cluster : aggregator \u6267\u884c\u90e8\u7f72\u547d\u4ee4\u53c2\u8003\uff1a helm install loggie-aggregator ./ -nloggie-aggregator --create-namespace Note Loggie\u4e2d\u8f6c\u673a\u540c\u6837\u53ef\u4ee5\u4f7f\u7528Deployment\u6216\u8005StatefulSet\u6765\u90e8\u7f72\uff0c\u8bf7\u53c2\u8003DaemonSet\u81ea\u884c\u4fee\u6539helm chart\u3002","title":"\u90e8\u7f72Loggie Aggregator"},{"location":"getting-started/install/node/","text":"\u4e3b\u673a\u90e8\u7f72 \u00b6 Loggie\u4f7f\u7528Golang\u7f16\u8bd1\u6210\u4e8c\u8fdb\u5236\uff0c\u53ef\u6839\u636e\u81ea\u8eab\u9700\u6c42\u5bf9\u63a5\u5404\u7c7b\u90e8\u7f72\u7cfb\u7edf\u3002 \u8fd9\u91cc\u6211\u4eec\u63d0\u4f9b\u4e00\u4e2a\u4f7f\u7528systemd\u90e8\u7f72Loggie\u7684\u53c2\u8003\u3002 \u524d\u7f6e\u68c0\u67e5 \u00b6 \u64cd\u4f5c\u7cfb\u7edf\uff1aLinux \u7cfb\u7edf\u67b6\u6784\uff1aamd64 \u53d1\u884c\u7248\u652f\u6301systemd \u76ee\u524drelease\u4ec5\u5305\u542bGOOS=linux GOARCH=amd64\u751f\u6210\u7684\u4e8c\u8fdb\u5236\u53ef\u6267\u884c\u6587\u4ef6\u3002\u5176\u4ed6\u7cfb\u7edf\u548c\u67b6\u6784\uff0c\u8bf7\u81ea\u884c\u57fa\u4e8e\u6e90\u7801\u4ea4\u53c9\u7f16\u8bd1\u3002 \u4e0b\u8f7d\u4e8c\u8fdb\u5236 \u00b6 mkdir /opt/loggie && curl https://github.com/loggie-io/installation/releases/download/v1.2.0/loggie-linux-amd64 -o /opt/loggie/loggie && chmod +x /opt/loggie/loggie \u6dfb\u52a0\u914d\u7f6e\u6587\u4ef6 \u00b6 \u8bf7\u6839\u636e\u5b9e\u9645\u9700\u6c42\u521b\u5efa\u914d\u7f6e\uff0c\u4ee5\u4e0b\u4e3a\u53c2\u8003\uff1a \u521b\u5efaloggie.yml \u00b6 loggie.yml cat << EOF > /opt/loggie/loggie.yml loggie : monitor : logger : period : 30s enabled : true listeners : filesource : ~ filewatcher : ~ reload : ~ sink : ~ reload : enabled : true period : 10s http : enabled : true port : 9196 EOF \u521b\u5efapipelines.yml \u00b6 pipelines.yml cat << EOF > /opt/loggie/pipelines.yml pipelines : - name : local sources : - type : file name : demo paths : - /tmp/log/*.log sink : type : dev printEvents : true codec : pretty : true EOF \u6dfb\u52a0systemd\u914d\u7f6e \u00b6 cat << EOF > /lib/systemd/system/loggie.service [Unit] Description=Loggie Documentation=https://loggie-io.github.io/docs/getting-started/install/node/ [Service] MemoryMax=200M ExecStart=/opt/loggie/loggie -config.system=/opt/loggie/loggie.yml -config.pipeline=/opt/loggie/pipelines.yml Restart=always [Install] WantedBy=multi-user.target EOF \u542f\u52a8 \u00b6 \u9996\u5148\u751f\u6548\u914d\u7f6e\uff1a systemctl daemon-reload \u7136\u540e\u8bbe\u7f6e\u4e3a\u5f00\u673a\u542f\u52a8\uff1a systemctl enable loggie \u63a5\u7740\u5c31\u53ef\u4ee5\u6b63\u5f0f\u542f\u52a8Loggie\u4e86\uff1a systemctl start loggie \u542f\u52a8\u540e\uff0c\u4f60\u53ef\u4ee5\u968f\u65f6\u67e5\u770b\u8fdb\u7a0b\u72b6\u6001\uff1a systemctl status loggie","title":"\u4e3b\u673a\u90e8\u7f72"},{"location":"getting-started/install/node/#_1","text":"Loggie\u4f7f\u7528Golang\u7f16\u8bd1\u6210\u4e8c\u8fdb\u5236\uff0c\u53ef\u6839\u636e\u81ea\u8eab\u9700\u6c42\u5bf9\u63a5\u5404\u7c7b\u90e8\u7f72\u7cfb\u7edf\u3002 \u8fd9\u91cc\u6211\u4eec\u63d0\u4f9b\u4e00\u4e2a\u4f7f\u7528systemd\u90e8\u7f72Loggie\u7684\u53c2\u8003\u3002","title":"\u4e3b\u673a\u90e8\u7f72"},{"location":"getting-started/install/node/#_2","text":"\u64cd\u4f5c\u7cfb\u7edf\uff1aLinux \u7cfb\u7edf\u67b6\u6784\uff1aamd64 \u53d1\u884c\u7248\u652f\u6301systemd \u76ee\u524drelease\u4ec5\u5305\u542bGOOS=linux GOARCH=amd64\u751f\u6210\u7684\u4e8c\u8fdb\u5236\u53ef\u6267\u884c\u6587\u4ef6\u3002\u5176\u4ed6\u7cfb\u7edf\u548c\u67b6\u6784\uff0c\u8bf7\u81ea\u884c\u57fa\u4e8e\u6e90\u7801\u4ea4\u53c9\u7f16\u8bd1\u3002","title":"\u524d\u7f6e\u68c0\u67e5"},{"location":"getting-started/install/node/#_3","text":"mkdir /opt/loggie && curl https://github.com/loggie-io/installation/releases/download/v1.2.0/loggie-linux-amd64 -o /opt/loggie/loggie && chmod +x /opt/loggie/loggie","title":"\u4e0b\u8f7d\u4e8c\u8fdb\u5236"},{"location":"getting-started/install/node/#_4","text":"\u8bf7\u6839\u636e\u5b9e\u9645\u9700\u6c42\u521b\u5efa\u914d\u7f6e\uff0c\u4ee5\u4e0b\u4e3a\u53c2\u8003\uff1a","title":"\u6dfb\u52a0\u914d\u7f6e\u6587\u4ef6"},{"location":"getting-started/install/node/#loggieyml","text":"loggie.yml cat << EOF > /opt/loggie/loggie.yml loggie : monitor : logger : period : 30s enabled : true listeners : filesource : ~ filewatcher : ~ reload : ~ sink : ~ reload : enabled : true period : 10s http : enabled : true port : 9196 EOF","title":"\u521b\u5efaloggie.yml"},{"location":"getting-started/install/node/#pipelinesyml","text":"pipelines.yml cat << EOF > /opt/loggie/pipelines.yml pipelines : - name : local sources : - type : file name : demo paths : - /tmp/log/*.log sink : type : dev printEvents : true codec : pretty : true EOF","title":"\u521b\u5efapipelines.yml"},{"location":"getting-started/install/node/#systemd","text":"cat << EOF > /lib/systemd/system/loggie.service [Unit] Description=Loggie Documentation=https://loggie-io.github.io/docs/getting-started/install/node/ [Service] MemoryMax=200M ExecStart=/opt/loggie/loggie -config.system=/opt/loggie/loggie.yml -config.pipeline=/opt/loggie/pipelines.yml Restart=always [Install] WantedBy=multi-user.target EOF","title":"\u6dfb\u52a0systemd\u914d\u7f6e"},{"location":"getting-started/install/node/#_5","text":"\u9996\u5148\u751f\u6548\u914d\u7f6e\uff1a systemctl daemon-reload \u7136\u540e\u8bbe\u7f6e\u4e3a\u5f00\u673a\u542f\u52a8\uff1a systemctl enable loggie \u63a5\u7740\u5c31\u53ef\u4ee5\u6b63\u5f0f\u542f\u52a8Loggie\u4e86\uff1a systemctl start loggie \u542f\u52a8\u540e\uff0c\u4f60\u53ef\u4ee5\u968f\u65f6\u67e5\u770b\u8fdb\u7a0b\u72b6\u6001\uff1a systemctl status loggie","title":"\u542f\u52a8"},{"location":"getting-started/intro/core-concept/","text":"\u6838\u5fc3\u6982\u5ff5 \u00b6 Loggie\u662f\u4e00\u4e2a\u57fa\u4e8eGolang\u7684\u8f7b\u91cf\u7ea7\u3001\u9ad8\u6027\u80fd\u3001\u4e91\u539f\u751f\u65e5\u5fd7\u91c7\u96c6Agent\u548c\u4e2d\u8f6c\u5904\u7406Aggregator\uff0c\u652f\u6301\u591aPipeline\u548c\u7ec4\u4ef6\u70ed\u63d2\u62d4\uff0c\u63d0\u4f9b\u4e86\uff1a \u4e00\u6808\u5f0f\u65e5\u5fd7\u89e3\u51b3\u65b9\u6848 \uff1a\u540c\u65f6\u652f\u6301\u65e5\u5fd7\u4e2d\u8f6c\u3001\u8fc7\u6ee4\u3001\u89e3\u6790\u3001\u5207\u5206\u3001\u65e5\u5fd7\u62a5\u8b66\u7b49 \u4e91\u539f\u751f\u7684\u65e5\u5fd7\u5f62\u6001 \uff1a\u5feb\u901f\u4fbf\u6377\u7684\u5bb9\u5668\u65e5\u5fd7\u91c7\u96c6\u65b9\u5f0f\uff0c\u539f\u751f\u7684Kubernetes\u52a8\u6001\u914d\u7f6e\u4e0b\u53d1 \u751f\u4ea7\u7ea7\u7684\u7279\u6027 \uff1aLoggie\u5438\u6536\u4e86\u6211\u4eec\u957f\u671f\u7684\u5927\u89c4\u6a21\u8fd0\u7ef4\u7ecf\u9a8c\uff0c\u5f62\u6210\u4e86\u5168\u65b9\u4f4d\u7684\u53ef\u89c2\u6d4b\u6027\u3001\u5feb\u901f\u6392\u969c\u3001\u5f02\u5e38\u9884\u8b66\u3001\u81ea\u52a8\u5316\u8fd0\u7ef4\u80fd\u529b \u67b6\u6784 \u00b6 \u6982\u5ff5 \u00b6 \u6838\u5fc3\u6570\u636e\u6d41 \u00b6 Source \uff1a\u8f93\u5165\u6e90\uff0c\u8868\u793a\u4e00\u4e2a\u5177\u4f53\u7684\u8f93\u5165\u6e90\uff0c\u4e00\u4e2aPipeline\u53ef\u4ee5\u6709\u591a\u4e2a\u4e0d\u540c\u7684\u8f93\u5165\u6e90\u3002\u6bd4\u5982file source\u8868\u793a\u65e5\u5fd7\u6587\u4ef6\u91c7\u96c6\u6e90\uff0cKafka source\u4e3a\u8bfb\u53d6Kafka\u7684\u8f93\u5165\u6e90\u3002 Sink \uff1a\u8f93\u51fa\u6e90\uff0c\u8868\u793a\u4e00\u4e2a\u5177\u4f53\u7684\u8f93\u51fa\u6e90\uff0c\u4e00\u4e2aPipeline\u4ec5\u80fd\u914d\u7f6e\u4e00\u79cd\u7c7b\u578b\u7684\u8f93\u5165\u6e90\uff0c\u4f46\u662f\u53ef\u4ee5\u6709\u591a\u4e2a\u5e76\u884c\u5b9e\u4f8b\u3002\u6bd4\u5982Elasticsearch sink\u8868\u793a\u65e5\u5fd7\u6570\u636e\u5c06\u53d1\u9001\u81f3\u8fdc\u7aef\u7684Elasticsearch\u3002 Interceptor \uff1a\u62e6\u622a\u5668\uff0c\u8868\u793a\u4e00\u4e2a\u65e5\u5fd7\u6570\u636e\u5904\u7406\u7ec4\u4ef6\uff0c\u4e0d\u540c\u7684\u62e6\u622a\u5668\u6839\u636e\u5b9e\u73b0\u53ef\u4ee5\u8fdb\u884c\u65e5\u5fd7\u7684\u89e3\u6790\u3001\u5207\u5206\u3001\u8f6c\u6362\u3001\u9650\u6d41\u7b49\u3002\u4e00\u4e2aPipeline\u53ef\u4ee5\u6709\u591a\u4e2aInterceptor\uff0c\u6570\u636e\u6d41\u7ecf\u8fc7\u591a\u4e2aInterceptor\u88ab\u94fe\u5f0f\u5904\u7406\u3002 Queue \uff1a\u961f\u5217\uff0c\u76ee\u524d\u6709\u5185\u5b58\u961f\u5217\u3002 Pipeline \uff1a\u7ba1\u9053\uff0csource/interceptor/queue/sink\u5171\u540c\u7ec4\u6210\u4e86\u4e00\u4e2aPipeline\uff0c\u4e0d\u540c\u7684Pipeline\u6570\u636e\u9694\u79bb\u3002 \u7ba1\u7406\u4e0e\u63a7\u5236 \u00b6 Discovery \uff1a\u52a8\u6001\u914d\u7f6e\u7684\u4e0b\u53d1\uff0c\u76ee\u524d\u4e3b\u8981\u4e3aKubernetes\u4e0b\u7684\u65e5\u5fd7\u914d\u7f6e\uff0c\u53ef\u4ee5\u901a\u8fc7\u521b\u5efaLogConfig\u7b49CRD\u5b9e\u4f8b\u7684\u65b9\u5f0f\u6765\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\u3002\u540e\u7eed\u5c06\u9646\u7eed\u652f\u6301\u4e3b\u673a\u5f62\u6001\u4e0b\u7684\u5404\u79cd\u914d\u7f6e\u4e2d\u5fc3\u5bf9\u63a5\u3002 Monitor EventBus \uff1a\u5404\u7ec4\u4ef6\u5747\u53ef\u4ee5\u901a\u8fc7publish\u6570\u636e\u5230EventBus Topic\u4e2d\uff0c\u7531\u7279\u5b9a\u7684Listener\u76d1\u542cTopic\u5e76\u8fdb\u884c\u6d88\u8d39\u5904\u7406\u3002\u4e3b\u8981\u7528\u4e8e\u76d1\u63a7\u6570\u636e\u7684\u66b4\u9732\u6216\u53d1\u9001\u3002 Reloader \uff1a\u7528\u4e8e\u914d\u7f6e\u7684\u52a8\u6001\u66f4\u65b0\u3002","title":"\u6838\u5fc3\u6982\u5ff5"},{"location":"getting-started/intro/core-concept/#_1","text":"Loggie\u662f\u4e00\u4e2a\u57fa\u4e8eGolang\u7684\u8f7b\u91cf\u7ea7\u3001\u9ad8\u6027\u80fd\u3001\u4e91\u539f\u751f\u65e5\u5fd7\u91c7\u96c6Agent\u548c\u4e2d\u8f6c\u5904\u7406Aggregator\uff0c\u652f\u6301\u591aPipeline\u548c\u7ec4\u4ef6\u70ed\u63d2\u62d4\uff0c\u63d0\u4f9b\u4e86\uff1a \u4e00\u6808\u5f0f\u65e5\u5fd7\u89e3\u51b3\u65b9\u6848 \uff1a\u540c\u65f6\u652f\u6301\u65e5\u5fd7\u4e2d\u8f6c\u3001\u8fc7\u6ee4\u3001\u89e3\u6790\u3001\u5207\u5206\u3001\u65e5\u5fd7\u62a5\u8b66\u7b49 \u4e91\u539f\u751f\u7684\u65e5\u5fd7\u5f62\u6001 \uff1a\u5feb\u901f\u4fbf\u6377\u7684\u5bb9\u5668\u65e5\u5fd7\u91c7\u96c6\u65b9\u5f0f\uff0c\u539f\u751f\u7684Kubernetes\u52a8\u6001\u914d\u7f6e\u4e0b\u53d1 \u751f\u4ea7\u7ea7\u7684\u7279\u6027 \uff1aLoggie\u5438\u6536\u4e86\u6211\u4eec\u957f\u671f\u7684\u5927\u89c4\u6a21\u8fd0\u7ef4\u7ecf\u9a8c\uff0c\u5f62\u6210\u4e86\u5168\u65b9\u4f4d\u7684\u53ef\u89c2\u6d4b\u6027\u3001\u5feb\u901f\u6392\u969c\u3001\u5f02\u5e38\u9884\u8b66\u3001\u81ea\u52a8\u5316\u8fd0\u7ef4\u80fd\u529b","title":"\u6838\u5fc3\u6982\u5ff5"},{"location":"getting-started/intro/core-concept/#_2","text":"","title":"\u67b6\u6784"},{"location":"getting-started/intro/core-concept/#_3","text":"","title":"\u6982\u5ff5"},{"location":"getting-started/intro/core-concept/#_4","text":"Source \uff1a\u8f93\u5165\u6e90\uff0c\u8868\u793a\u4e00\u4e2a\u5177\u4f53\u7684\u8f93\u5165\u6e90\uff0c\u4e00\u4e2aPipeline\u53ef\u4ee5\u6709\u591a\u4e2a\u4e0d\u540c\u7684\u8f93\u5165\u6e90\u3002\u6bd4\u5982file source\u8868\u793a\u65e5\u5fd7\u6587\u4ef6\u91c7\u96c6\u6e90\uff0cKafka source\u4e3a\u8bfb\u53d6Kafka\u7684\u8f93\u5165\u6e90\u3002 Sink \uff1a\u8f93\u51fa\u6e90\uff0c\u8868\u793a\u4e00\u4e2a\u5177\u4f53\u7684\u8f93\u51fa\u6e90\uff0c\u4e00\u4e2aPipeline\u4ec5\u80fd\u914d\u7f6e\u4e00\u79cd\u7c7b\u578b\u7684\u8f93\u5165\u6e90\uff0c\u4f46\u662f\u53ef\u4ee5\u6709\u591a\u4e2a\u5e76\u884c\u5b9e\u4f8b\u3002\u6bd4\u5982Elasticsearch sink\u8868\u793a\u65e5\u5fd7\u6570\u636e\u5c06\u53d1\u9001\u81f3\u8fdc\u7aef\u7684Elasticsearch\u3002 Interceptor \uff1a\u62e6\u622a\u5668\uff0c\u8868\u793a\u4e00\u4e2a\u65e5\u5fd7\u6570\u636e\u5904\u7406\u7ec4\u4ef6\uff0c\u4e0d\u540c\u7684\u62e6\u622a\u5668\u6839\u636e\u5b9e\u73b0\u53ef\u4ee5\u8fdb\u884c\u65e5\u5fd7\u7684\u89e3\u6790\u3001\u5207\u5206\u3001\u8f6c\u6362\u3001\u9650\u6d41\u7b49\u3002\u4e00\u4e2aPipeline\u53ef\u4ee5\u6709\u591a\u4e2aInterceptor\uff0c\u6570\u636e\u6d41\u7ecf\u8fc7\u591a\u4e2aInterceptor\u88ab\u94fe\u5f0f\u5904\u7406\u3002 Queue \uff1a\u961f\u5217\uff0c\u76ee\u524d\u6709\u5185\u5b58\u961f\u5217\u3002 Pipeline \uff1a\u7ba1\u9053\uff0csource/interceptor/queue/sink\u5171\u540c\u7ec4\u6210\u4e86\u4e00\u4e2aPipeline\uff0c\u4e0d\u540c\u7684Pipeline\u6570\u636e\u9694\u79bb\u3002","title":"\u6838\u5fc3\u6570\u636e\u6d41"},{"location":"getting-started/intro/core-concept/#_5","text":"Discovery \uff1a\u52a8\u6001\u914d\u7f6e\u7684\u4e0b\u53d1\uff0c\u76ee\u524d\u4e3b\u8981\u4e3aKubernetes\u4e0b\u7684\u65e5\u5fd7\u914d\u7f6e\uff0c\u53ef\u4ee5\u901a\u8fc7\u521b\u5efaLogConfig\u7b49CRD\u5b9e\u4f8b\u7684\u65b9\u5f0f\u6765\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\u3002\u540e\u7eed\u5c06\u9646\u7eed\u652f\u6301\u4e3b\u673a\u5f62\u6001\u4e0b\u7684\u5404\u79cd\u914d\u7f6e\u4e2d\u5fc3\u5bf9\u63a5\u3002 Monitor EventBus \uff1a\u5404\u7ec4\u4ef6\u5747\u53ef\u4ee5\u901a\u8fc7publish\u6570\u636e\u5230EventBus Topic\u4e2d\uff0c\u7531\u7279\u5b9a\u7684Listener\u76d1\u542cTopic\u5e76\u8fdb\u884c\u6d88\u8d39\u5904\u7406\u3002\u4e3b\u8981\u7528\u4e8e\u76d1\u63a7\u6570\u636e\u7684\u66b4\u9732\u6216\u53d1\u9001\u3002 Reloader \uff1a\u7528\u4e8e\u914d\u7f6e\u7684\u52a8\u6001\u66f4\u65b0\u3002","title":"\u7ba1\u7406\u4e0e\u63a7\u5236"},{"location":"getting-started/quick-start/kubernetes/","text":"\u5feb\u901f\u4e0a\u624b\uff1a\u91c7\u96c6Kubernetes Pod\u65e5\u5fd7 \u00b6 \u4e0b\u9762\u5c06\u5e26\u4f60\u6f14\u793a\u5728\u4e00\u4e2aKubernetes\u96c6\u7fa4\u4e2d\uff0c\u901a\u8fc7\u521b\u5efaLogConfig CRD\u5feb\u901f\u91c7\u96c6Pod\u7684\u65e5\u5fd7\u3002 1. \u51c6\u5907Kubernetes\u73af\u5883 \u00b6 \u53ef\u4ee5\u4f7f\u7528\u73b0\u6709Kubernetes\u96c6\u7fa4\uff0c\u6216\u8005 \u90e8\u7f72Kubernetes \u3002\u672c\u5730\u63a8\u8350\u4f7f\u7528 Kind \u642d\u5efaKubernetes\u96c6\u7fa4\u3002 \u672c\u6587\u7684\u64cd\u4f5c\u9700\u8981\u5728\u672c\u5730\u4f7f\u7528: kubectl\uff08 \u4e0b\u8f7d \uff09 helm\uff08 \u4e0b\u8f7d \uff09 \u8bf7\u786e\u4fdd\u672c\u5730\u6709kubectl\u548chelm\u53ef\u6267\u884c\u547d\u4ee4\u3002 2. \u90e8\u7f72Loggie DaemonSet \u00b6 \u4f60\u53ef\u4ee5\u5728 installation \u9875\u9762\u67e5\u770b\u6240\u6709\u53d1\u5e03\u7684\u90e8\u7f72chart\u3002 \u53ef\u4ee5\u9009\u62e9\uff1a \u4e0b\u8f7dchart\u518d\u90e8\u7f72 \u00b6 helm pull https://github.com/loggie-io/installation/releases/download/v1.2.0/loggie-v1.2.0.tgz && tar xvzf loggie-v1.2.0.tgz \u5c1d\u8bd5\u4fee\u6539\u4e00\u4e0b\u5176\u4e2d\u7684values.yaml\u3002 \u60f3\u4f7f\u7528\u5176\u4ed6\u7248\u672c\u955c\u50cf\uff1f \u4e3a\u4e86\u65b9\u4fbf\u4f53\u9a8c\u6700\u65b0\u7684Fix\u548c\u7279\u6027\uff0c\u6211\u4eec\u63d0\u4f9b\u4e86main\u5206\u652f\u6bcf\u6b21\u5408\u5e76\u540e\u7684\u955c\u50cf\u7248\u672c\uff0c\u53ef\u901a\u8fc7 \u8fd9\u91cc \u8fdb\u884c\u9009\u62e9\u3002 \u7136\u540e\u90e8\u7f72\u5b89\u88c5\uff1a helm install loggie ./loggie -nloggie --create-namespace \u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\uff1a \u76f4\u63a5\u90e8\u7f72\uff1a \u00b6 helm install loggie -nloggie --create-namespace https://github.com/loggie-io/installation/releases/download/v1.2.0/loggie-v1.2.0.tgz \u90e8\u7f72\u6709\u95ee\u9898\uff1f \u5982\u679c\u5c1d\u8bd5\u90e8\u7f72\u540e\u51fa\u73b0\u95ee\u9898\uff0c\u6216\u8005\u5728\u4f60\u7684\u73af\u5883\u4e2d\u4ee5\u4e0b\u6f14\u793a\u64cd\u4f5c\u672a\u6210\u529f\uff0c\u8bf7\u53c2\u8003 Kubernetes\u4e0b\u90e8\u7f72Loggie \uff0c\u4fee\u6539\u76f8\u5173\u914d\u7f6e\u3002 3. \u91c7\u96c6\u65e5\u5fd7 \u00b6 Loggie\u5b9a\u4e49\u4e86Kubernetes CRD LogConfig\uff0c\u4e00\u4e2aLogConfig\u8868\u793a\u91c7\u96c6\u4e00\u7c7bPods\u7684\u65e5\u5fd7\u91c7\u96c6\u4efb\u52a1\u3002 3.1 \u521b\u5efa\u88ab\u91c7\u96c6\u7684Pods \u00b6 \u6211\u4eec\u5148\u521b\u5efa\u4e00\u4e2aPod\u7528\u4e8e\u88ab\u91c7\u96c6\u65e5\u5fd7\u7684\u5bf9\u8c61\u3002 kubectl create deploy nginx --image = nginx \u63a5\u4e0b\u6765\u5c06\u91c7\u96c6\u8fd9\u4e2aNginx Pod\u7684\u6807\u51c6\u8f93\u51fastdout\u65e5\u5fd7\u3002 3.2 \u5b9a\u4e49\u8f93\u51fa\u6e90Sink \u00b6 \u63a5\u7740\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2aLoggie\u5b9a\u4e49\u7684CRD Sink\u5b9e\u4f8b\uff0c\u8868\u660e\u65e5\u5fd7\u53d1\u9001\u7684\u540e\u7aef\u3002 \u4e3a\u4e86\u65b9\u4fbf\u6f14\u793a\uff0c\u8fd9\u91cc\u6211\u4eec\u5c06\u65e5\u5fd7\u53d1\u9001\u81f3Loggie Agent\u81ea\u8eab\u7684\u65e5\u5fd7\u4e2d\u5e76\u6253\u5370\u3002 cat << EOF | kubectl apply -f - apiVersion : loggie.io/v1beta1 kind : Sink metadata : name : default spec : sink : | type: dev printEvents: true EOF \u53ef\u4ee5\u901a\u8fc7 kubectl get sink \u67e5\u770b\u5230\u5df2\u521b\u5efa\u7684Sink\u3002 3.3 \u5b9a\u4e49\u91c7\u96c6\u4efb\u52a1 \u00b6 Loggie\u5b9a\u4e49CRD LogConfig\uff0c\u8868\u793a\u4e00\u4e2a\u65e5\u5fd7\u91c7\u96c6\u4efb\u52a1\u3002\u6211\u4eec\u521b\u5efa\u4e00\u4e2aLogConfig\u793a\u4f8b\u5982\u4e0b\u6240\u793a\uff1a cat << EOF | kubectl apply -f - apiVersion : loggie.io/v1beta1 kind : LogConfig metadata : name : nginx namespace : default spec : selector : type : pod labelSelector : app : nginx pipeline : sources : | - type: file name: mylog paths: - stdout sinkRef : default EOF \u53ef\u4ee5\u770b\u5230\uff0c\u4e0a\u9762\u4f7f\u7528\u4e86sinkRef\u5f15\u7528\u4e86\u521a\u624d\u521b\u5efa\u7684 sink default CR \u3002\u5f53\u7136\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u76f4\u63a5\u5728Logconfig\u4e2d\u4f7f\u7528sink\u5b57\u6bb5\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a cat << EOF | kubectl apply -f - apiVersion : loggie.io/v1beta1 kind : LogConfig metadata : name : nginx namespace : default spec : selector : type : pod labelSelector : app : nginx pipeline : sources : | - type: file name: mylog paths: - stdout sink : | type: dev printEvents: true codec: type: json pretty: true EOF \u521b\u5efa\u5b8c\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 kubectl get lgc \u67e5\u770b\u5230\u521b\u5efa\u7684CRD\u5b9e\u4f8b\u3002 \u540c\u65f6\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7 kubectl describe lgc nginx \u67e5\u770bLogConfig\u7684\u4e8b\u4ef6\uff0c\u4ee5\u83b7\u53d6\u6700\u65b0\u7684\u72b6\u6001\u3002 Events: Type Reason Age From Message ---- ------ ---- ---- ------- Normal syncSuccess 52s loggie/kind-control-plane Sync type pod [nginx-6799fc88d8-5cb67] success \u4e0a\u9762\u7684nginx LogConfig\u901a\u8fc7\u5176\u4e2d\u7684spec.selector\u6765\u5339\u914d\u91c7\u96c6\u54ea\u4e9bPod\u7684\u65e5\u5fd7\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528 app: nginx \u9009\u62e9\u4e86\u521a\u624d\u521b\u5efa\u7684nginx Pod\u3002 spec.pipeline\u5219\u8868\u793aLoggie\u7684Pipeline\u914d\u7f6e\uff0c\u6211\u4eec\u53ea\u91c7\u96c6\u5bb9\u5668\u6807\u51c6\u8f93\u51fa\u7684\u65e5\u5fd7\uff0c\u6240\u4ee5\u5728paths\u4e2d\u586b\u5199 stdout \u5373\u53ef\u3002 4. \u67e5\u770b\u65e5\u5fd7 \u00b6 \u9996\u5148\u627e\u5230\u6240\u5728\u7684nginx pod\u8282\u70b9\uff1a kubectl get po -owide -l app = nginx \u7136\u540e\u6211\u4eec\u627e\u5230\u8be5\u8282\u70b9\u7684Loggie\uff1a kubectl -nloggie get po -owide | grep ${ node } \u53ef\u4ee5\u901a\u8fc7\uff1a kubectl -nloggie logs -f ${ logge -pod } \u67e5\u770bLoggie\u6253\u5370\u51fa\u7684\u65e5\u5fd7\uff0c\u91cc\u9762\u5c55\u793a\u4e86\u91c7\u96c6\u5230\u7684nginx\u6807\u51c6\u8f93\u51fa\u65e5\u5fd7\u3002 \u66f4\u591a \u00b6 \u4e0a\u6587\u53ea\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u5feb\u901f\u6f14\u793a\uff0c\u90e8\u7f72\u51fa\u73b0\u95ee\u9898\u6216\u8005\u60f3\u4e86\u89e3\u66f4\u591aKubernetes\u4e0bLoggie\u5982\u4f55\u4f7f\u7528\uff1f \u66f4\u5168\u9762\u7684\u90e8\u7f72\u4ecb\u7ecd\uff1a Kubernetes\u4e0b\u90e8\u7f72Loggie Kubernetes\u4e0b\u65e5\u5fd7\u91c7\u96c6\u6700\u4f73\u5b9e\u8df5\uff1a Kubernetes\u4e0b\u7684\u65e5\u5fd7\u91c7\u96c6","title":"Kubernetes\u73af\u5883"},{"location":"getting-started/quick-start/kubernetes/#kubernetes-pod","text":"\u4e0b\u9762\u5c06\u5e26\u4f60\u6f14\u793a\u5728\u4e00\u4e2aKubernetes\u96c6\u7fa4\u4e2d\uff0c\u901a\u8fc7\u521b\u5efaLogConfig CRD\u5feb\u901f\u91c7\u96c6Pod\u7684\u65e5\u5fd7\u3002","title":"\u5feb\u901f\u4e0a\u624b\uff1a\u91c7\u96c6Kubernetes Pod\u65e5\u5fd7"},{"location":"getting-started/quick-start/kubernetes/#1-kubernetes","text":"\u53ef\u4ee5\u4f7f\u7528\u73b0\u6709Kubernetes\u96c6\u7fa4\uff0c\u6216\u8005 \u90e8\u7f72Kubernetes \u3002\u672c\u5730\u63a8\u8350\u4f7f\u7528 Kind \u642d\u5efaKubernetes\u96c6\u7fa4\u3002 \u672c\u6587\u7684\u64cd\u4f5c\u9700\u8981\u5728\u672c\u5730\u4f7f\u7528: kubectl\uff08 \u4e0b\u8f7d \uff09 helm\uff08 \u4e0b\u8f7d \uff09 \u8bf7\u786e\u4fdd\u672c\u5730\u6709kubectl\u548chelm\u53ef\u6267\u884c\u547d\u4ee4\u3002","title":"1. \u51c6\u5907Kubernetes\u73af\u5883"},{"location":"getting-started/quick-start/kubernetes/#2-loggie-daemonset","text":"\u4f60\u53ef\u4ee5\u5728 installation \u9875\u9762\u67e5\u770b\u6240\u6709\u53d1\u5e03\u7684\u90e8\u7f72chart\u3002 \u53ef\u4ee5\u9009\u62e9\uff1a","title":"2. \u90e8\u7f72Loggie DaemonSet"},{"location":"getting-started/quick-start/kubernetes/#chart","text":"helm pull https://github.com/loggie-io/installation/releases/download/v1.2.0/loggie-v1.2.0.tgz && tar xvzf loggie-v1.2.0.tgz \u5c1d\u8bd5\u4fee\u6539\u4e00\u4e0b\u5176\u4e2d\u7684values.yaml\u3002 \u60f3\u4f7f\u7528\u5176\u4ed6\u7248\u672c\u955c\u50cf\uff1f \u4e3a\u4e86\u65b9\u4fbf\u4f53\u9a8c\u6700\u65b0\u7684Fix\u548c\u7279\u6027\uff0c\u6211\u4eec\u63d0\u4f9b\u4e86main\u5206\u652f\u6bcf\u6b21\u5408\u5e76\u540e\u7684\u955c\u50cf\u7248\u672c\uff0c\u53ef\u901a\u8fc7 \u8fd9\u91cc \u8fdb\u884c\u9009\u62e9\u3002 \u7136\u540e\u90e8\u7f72\u5b89\u88c5\uff1a helm install loggie ./loggie -nloggie --create-namespace \u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\uff1a","title":"\u4e0b\u8f7dchart\u518d\u90e8\u7f72"},{"location":"getting-started/quick-start/kubernetes/#_1","text":"helm install loggie -nloggie --create-namespace https://github.com/loggie-io/installation/releases/download/v1.2.0/loggie-v1.2.0.tgz \u90e8\u7f72\u6709\u95ee\u9898\uff1f \u5982\u679c\u5c1d\u8bd5\u90e8\u7f72\u540e\u51fa\u73b0\u95ee\u9898\uff0c\u6216\u8005\u5728\u4f60\u7684\u73af\u5883\u4e2d\u4ee5\u4e0b\u6f14\u793a\u64cd\u4f5c\u672a\u6210\u529f\uff0c\u8bf7\u53c2\u8003 Kubernetes\u4e0b\u90e8\u7f72Loggie \uff0c\u4fee\u6539\u76f8\u5173\u914d\u7f6e\u3002","title":"\u76f4\u63a5\u90e8\u7f72\uff1a"},{"location":"getting-started/quick-start/kubernetes/#3","text":"Loggie\u5b9a\u4e49\u4e86Kubernetes CRD LogConfig\uff0c\u4e00\u4e2aLogConfig\u8868\u793a\u91c7\u96c6\u4e00\u7c7bPods\u7684\u65e5\u5fd7\u91c7\u96c6\u4efb\u52a1\u3002","title":"3. \u91c7\u96c6\u65e5\u5fd7"},{"location":"getting-started/quick-start/kubernetes/#31-pods","text":"\u6211\u4eec\u5148\u521b\u5efa\u4e00\u4e2aPod\u7528\u4e8e\u88ab\u91c7\u96c6\u65e5\u5fd7\u7684\u5bf9\u8c61\u3002 kubectl create deploy nginx --image = nginx \u63a5\u4e0b\u6765\u5c06\u91c7\u96c6\u8fd9\u4e2aNginx Pod\u7684\u6807\u51c6\u8f93\u51fastdout\u65e5\u5fd7\u3002","title":"3.1 \u521b\u5efa\u88ab\u91c7\u96c6\u7684Pods"},{"location":"getting-started/quick-start/kubernetes/#32-sink","text":"\u63a5\u7740\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2aLoggie\u5b9a\u4e49\u7684CRD Sink\u5b9e\u4f8b\uff0c\u8868\u660e\u65e5\u5fd7\u53d1\u9001\u7684\u540e\u7aef\u3002 \u4e3a\u4e86\u65b9\u4fbf\u6f14\u793a\uff0c\u8fd9\u91cc\u6211\u4eec\u5c06\u65e5\u5fd7\u53d1\u9001\u81f3Loggie Agent\u81ea\u8eab\u7684\u65e5\u5fd7\u4e2d\u5e76\u6253\u5370\u3002 cat << EOF | kubectl apply -f - apiVersion : loggie.io/v1beta1 kind : Sink metadata : name : default spec : sink : | type: dev printEvents: true EOF \u53ef\u4ee5\u901a\u8fc7 kubectl get sink \u67e5\u770b\u5230\u5df2\u521b\u5efa\u7684Sink\u3002","title":"3.2 \u5b9a\u4e49\u8f93\u51fa\u6e90Sink"},{"location":"getting-started/quick-start/kubernetes/#33","text":"Loggie\u5b9a\u4e49CRD LogConfig\uff0c\u8868\u793a\u4e00\u4e2a\u65e5\u5fd7\u91c7\u96c6\u4efb\u52a1\u3002\u6211\u4eec\u521b\u5efa\u4e00\u4e2aLogConfig\u793a\u4f8b\u5982\u4e0b\u6240\u793a\uff1a cat << EOF | kubectl apply -f - apiVersion : loggie.io/v1beta1 kind : LogConfig metadata : name : nginx namespace : default spec : selector : type : pod labelSelector : app : nginx pipeline : sources : | - type: file name: mylog paths: - stdout sinkRef : default EOF \u53ef\u4ee5\u770b\u5230\uff0c\u4e0a\u9762\u4f7f\u7528\u4e86sinkRef\u5f15\u7528\u4e86\u521a\u624d\u521b\u5efa\u7684 sink default CR \u3002\u5f53\u7136\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u76f4\u63a5\u5728Logconfig\u4e2d\u4f7f\u7528sink\u5b57\u6bb5\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a cat << EOF | kubectl apply -f - apiVersion : loggie.io/v1beta1 kind : LogConfig metadata : name : nginx namespace : default spec : selector : type : pod labelSelector : app : nginx pipeline : sources : | - type: file name: mylog paths: - stdout sink : | type: dev printEvents: true codec: type: json pretty: true EOF \u521b\u5efa\u5b8c\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 kubectl get lgc \u67e5\u770b\u5230\u521b\u5efa\u7684CRD\u5b9e\u4f8b\u3002 \u540c\u65f6\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7 kubectl describe lgc nginx \u67e5\u770bLogConfig\u7684\u4e8b\u4ef6\uff0c\u4ee5\u83b7\u53d6\u6700\u65b0\u7684\u72b6\u6001\u3002 Events: Type Reason Age From Message ---- ------ ---- ---- ------- Normal syncSuccess 52s loggie/kind-control-plane Sync type pod [nginx-6799fc88d8-5cb67] success \u4e0a\u9762\u7684nginx LogConfig\u901a\u8fc7\u5176\u4e2d\u7684spec.selector\u6765\u5339\u914d\u91c7\u96c6\u54ea\u4e9bPod\u7684\u65e5\u5fd7\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528 app: nginx \u9009\u62e9\u4e86\u521a\u624d\u521b\u5efa\u7684nginx Pod\u3002 spec.pipeline\u5219\u8868\u793aLoggie\u7684Pipeline\u914d\u7f6e\uff0c\u6211\u4eec\u53ea\u91c7\u96c6\u5bb9\u5668\u6807\u51c6\u8f93\u51fa\u7684\u65e5\u5fd7\uff0c\u6240\u4ee5\u5728paths\u4e2d\u586b\u5199 stdout \u5373\u53ef\u3002","title":"3.3 \u5b9a\u4e49\u91c7\u96c6\u4efb\u52a1"},{"location":"getting-started/quick-start/kubernetes/#4","text":"\u9996\u5148\u627e\u5230\u6240\u5728\u7684nginx pod\u8282\u70b9\uff1a kubectl get po -owide -l app = nginx \u7136\u540e\u6211\u4eec\u627e\u5230\u8be5\u8282\u70b9\u7684Loggie\uff1a kubectl -nloggie get po -owide | grep ${ node } \u53ef\u4ee5\u901a\u8fc7\uff1a kubectl -nloggie logs -f ${ logge -pod } \u67e5\u770bLoggie\u6253\u5370\u51fa\u7684\u65e5\u5fd7\uff0c\u91cc\u9762\u5c55\u793a\u4e86\u91c7\u96c6\u5230\u7684nginx\u6807\u51c6\u8f93\u51fa\u65e5\u5fd7\u3002","title":"4. \u67e5\u770b\u65e5\u5fd7"},{"location":"getting-started/quick-start/kubernetes/#_2","text":"\u4e0a\u6587\u53ea\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u5feb\u901f\u6f14\u793a\uff0c\u90e8\u7f72\u51fa\u73b0\u95ee\u9898\u6216\u8005\u60f3\u4e86\u89e3\u66f4\u591aKubernetes\u4e0bLoggie\u5982\u4f55\u4f7f\u7528\uff1f \u66f4\u5168\u9762\u7684\u90e8\u7f72\u4ecb\u7ecd\uff1a Kubernetes\u4e0b\u90e8\u7f72Loggie Kubernetes\u4e0b\u65e5\u5fd7\u91c7\u96c6\u6700\u4f73\u5b9e\u8df5\uff1a Kubernetes\u4e0b\u7684\u65e5\u5fd7\u91c7\u96c6","title":"\u66f4\u591a"},{"location":"getting-started/quick-start/node/","text":"\u5feb\u901f\u4e0a\u624b\uff1a\u8282\u70b9\u65e5\u5fd7\u91c7\u96c6 \u00b6 \u4e0b\u9762\u6211\u4eec\u5c06\u6f14\u793a\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u91c7\u96c6\u8282\u70b9\u65e5\u5fd7\u6587\u4ef6\u7684\u573a\u666f\u3002 1. \u4e0b\u8f7d\u53ef\u6267\u884c\u6587\u4ef6 \u00b6 \u8bf7\u627e\u4e00\u53f0Linux\u670d\u52a1\u5668\u8282\u70b9\uff0c\u4e0b\u8f7dLoggie\u4e8c\u8fdb\u5236\u53ef\u6267\u884c\u6587\u4ef6 curl -LJ https://github.com/loggie-io/installation/releases/download/v1.2.0/loggie-linux-amd64 -o loggie 2. \u6dfb\u52a0\u914d\u7f6e\u6587\u4ef6 \u00b6 \u6211\u4eec\u5148\u4f7f\u7528dev sink\u5c06file source\u91c7\u96c6\u7684\u65e5\u5fd7\u6587\u4ef6\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u590d\u5236\u4ee5\u4e0b\u5185\u5bb9\u4e3apipelines.yml\u6587\u4ef6\uff1a pipelines.yml cat << EOF > pipelines.yml pipelines : - name : demo sources : - type : file name : mylog paths : - \"/var/log/*.log\" sink : type : dev printEvents : true EOF \u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u79f0\u4e3ademo\u7684pipeline\uff0c\u7136\u540e\u5b9a\u4e49\u4e86\u4e00\u4e2a\u7c7b\u578b\u4e3afile\u7684source\u8f93\u5165\u6e90\u7ec4\u4ef6\uff0c\u8868\u793a\u9700\u8981\u91c7\u96c6\u5728 /var/log \u76ee\u5f55\u4e0b\u6ee1\u8db3 *.log \u5339\u914d\u89c4\u5219\u7684\u65e5\u5fd7\u6587\u4ef6\u3002\u6587\u4ef6\u91c7\u96c6\u540e\uff0c\u6587\u4ef6\u4f1a\u88ab\u53d1\u9001\u81f3dev sink\u8f93\u51fa\u6e90\uff0c\u8be5sink\u4ec5\u4ec5\u5c06\u91c7\u96c6\u7684\u6587\u4ef6\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa\u3002 pipeline\u6587\u4ef6\u8868\u793a\u6211\u4eec\u60f3\u8981\u7684\u8f93\u5165\u3001\u8f93\u51fa\u7b49\u4e1a\u52a1\u76f8\u5173\u7684\u914d\u7f6e\uff0c\u9664\u4e86pipeline\u914d\u7f6e\u6587\u4ef6\u5916\uff0cLoggie\u8fd8\u9700\u8981\u6709\u4e00\u4e2a\u5168\u5c40\u7684\u914d\u7f6e\u6587\u4ef6\u3002 // loggie.yml cat << EOF > loggie.yml loggie : reload : enabled : true period : 10s EOF \u8fd9\u91cc\u6211\u4eec\u53ea\u5c55\u793a\u4e86\u4e00\u4e2a\u6bd4\u8f83\u7b80\u5355\u7684\u914d\u7f6e\uff0c\u8868\u793a\u6253\u5f00loggie\u7684\u52a8\u6001\u914d\u7f6ereload\u529f\u80fd\uff0c\u540c\u65f6\u95f4\u9694\u68c0\u67e5\u65f6\u95f4\u4e3a10s\u3002 \u5728\u8282\u70b9\u4e0a\u589e\u52a0\u4ee5\u4e0a\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f00\u59cb\u542f\u52a8Loggie\u4e86\u3002 3. \u8fd0\u884c \u00b6 ./loggie -config.system = ./loggie.yml -config.pipeline = ./pipelines.yml -log.jsonFormat = false \u542f\u52a8\u53c2\u6570\u91cc\uff0c\u586b\u5165\u4e0a\u9762\u7684loggie.yml\u548cpipelines.yml\u7684\u6587\u4ef6\u8def\u5f84\u3002 \u770b\u5230\u6b63\u5e38\u7684\u542f\u52a8\u65e5\u5fd7\u540e\uff0c\u8868\u660eLoggie\u5c31\u5f00\u59cb\u6b63\u5e38\u7684\u5de5\u4f5c\u4e86\u3002\u540c\u65f6\u8282\u70b9/var/log/*.log\u4e0b\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u90fd\u4f1a\u88ab\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa\u3002","title":"\u4e3b\u673a\u73af\u5883"},{"location":"getting-started/quick-start/node/#_1","text":"\u4e0b\u9762\u6211\u4eec\u5c06\u6f14\u793a\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u91c7\u96c6\u8282\u70b9\u65e5\u5fd7\u6587\u4ef6\u7684\u573a\u666f\u3002","title":"\u5feb\u901f\u4e0a\u624b\uff1a\u8282\u70b9\u65e5\u5fd7\u91c7\u96c6"},{"location":"getting-started/quick-start/node/#1","text":"\u8bf7\u627e\u4e00\u53f0Linux\u670d\u52a1\u5668\u8282\u70b9\uff0c\u4e0b\u8f7dLoggie\u4e8c\u8fdb\u5236\u53ef\u6267\u884c\u6587\u4ef6 curl -LJ https://github.com/loggie-io/installation/releases/download/v1.2.0/loggie-linux-amd64 -o loggie","title":"1. \u4e0b\u8f7d\u53ef\u6267\u884c\u6587\u4ef6"},{"location":"getting-started/quick-start/node/#2","text":"\u6211\u4eec\u5148\u4f7f\u7528dev sink\u5c06file source\u91c7\u96c6\u7684\u65e5\u5fd7\u6587\u4ef6\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u590d\u5236\u4ee5\u4e0b\u5185\u5bb9\u4e3apipelines.yml\u6587\u4ef6\uff1a pipelines.yml cat << EOF > pipelines.yml pipelines : - name : demo sources : - type : file name : mylog paths : - \"/var/log/*.log\" sink : type : dev printEvents : true EOF \u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u79f0\u4e3ademo\u7684pipeline\uff0c\u7136\u540e\u5b9a\u4e49\u4e86\u4e00\u4e2a\u7c7b\u578b\u4e3afile\u7684source\u8f93\u5165\u6e90\u7ec4\u4ef6\uff0c\u8868\u793a\u9700\u8981\u91c7\u96c6\u5728 /var/log \u76ee\u5f55\u4e0b\u6ee1\u8db3 *.log \u5339\u914d\u89c4\u5219\u7684\u65e5\u5fd7\u6587\u4ef6\u3002\u6587\u4ef6\u91c7\u96c6\u540e\uff0c\u6587\u4ef6\u4f1a\u88ab\u53d1\u9001\u81f3dev sink\u8f93\u51fa\u6e90\uff0c\u8be5sink\u4ec5\u4ec5\u5c06\u91c7\u96c6\u7684\u6587\u4ef6\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa\u3002 pipeline\u6587\u4ef6\u8868\u793a\u6211\u4eec\u60f3\u8981\u7684\u8f93\u5165\u3001\u8f93\u51fa\u7b49\u4e1a\u52a1\u76f8\u5173\u7684\u914d\u7f6e\uff0c\u9664\u4e86pipeline\u914d\u7f6e\u6587\u4ef6\u5916\uff0cLoggie\u8fd8\u9700\u8981\u6709\u4e00\u4e2a\u5168\u5c40\u7684\u914d\u7f6e\u6587\u4ef6\u3002 // loggie.yml cat << EOF > loggie.yml loggie : reload : enabled : true period : 10s EOF \u8fd9\u91cc\u6211\u4eec\u53ea\u5c55\u793a\u4e86\u4e00\u4e2a\u6bd4\u8f83\u7b80\u5355\u7684\u914d\u7f6e\uff0c\u8868\u793a\u6253\u5f00loggie\u7684\u52a8\u6001\u914d\u7f6ereload\u529f\u80fd\uff0c\u540c\u65f6\u95f4\u9694\u68c0\u67e5\u65f6\u95f4\u4e3a10s\u3002 \u5728\u8282\u70b9\u4e0a\u589e\u52a0\u4ee5\u4e0a\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f00\u59cb\u542f\u52a8Loggie\u4e86\u3002","title":"2. \u6dfb\u52a0\u914d\u7f6e\u6587\u4ef6"},{"location":"getting-started/quick-start/node/#3","text":"./loggie -config.system = ./loggie.yml -config.pipeline = ./pipelines.yml -log.jsonFormat = false \u542f\u52a8\u53c2\u6570\u91cc\uff0c\u586b\u5165\u4e0a\u9762\u7684loggie.yml\u548cpipelines.yml\u7684\u6587\u4ef6\u8def\u5f84\u3002 \u770b\u5230\u6b63\u5e38\u7684\u542f\u52a8\u65e5\u5fd7\u540e\uff0c\u8868\u660eLoggie\u5c31\u5f00\u59cb\u6b63\u5e38\u7684\u5de5\u4f5c\u4e86\u3002\u540c\u65f6\u8282\u70b9/var/log/*.log\u4e0b\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u90fd\u4f1a\u88ab\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa\u3002","title":"3. \u8fd0\u884c"},{"location":"getting-started/quick-start/quick-start/","text":"\u5feb\u901f\u4e0a\u624b \u00b6 Loggie\u662f\u4e00\u4e2a\u65e5\u5fd7\u91c7\u96c6Agent\u548c\u4e2d\u8f6c\u5904\u7406\u7684Aggregator\uff0c\u5305\u542b\u591a\u4e2aPipeline\u7ba1\u9053\uff0c\u6bcf\u4e2aPipeline\u53c8\u7531Source\u8f93\u5165\u3001Interceptor\u62e6\u622a\u5904\u7406\u548cSink\u8f93\u51fa\u7ec4\u6210\u3002 \u57fa\u4e8e\u8fd9\u79cd\u63d2\u4ef6\u5f0f\u8bbe\u8ba1\uff0cLoggie\u5e76\u4e0d\u5c40\u9650\u5728\u65e5\u5fd7\u91c7\u96c6\uff0c\u901a\u8fc7\u914d\u7f6e\u4e0d\u540c\u7684Source/Interceptor/Sink\uff0cLoggie\u53ef\u4ee5\u7ec4\u5408\u5b9e\u73b0\u5404\u79cd\u4e0d\u540c\u7684\u529f\u80fd\u3002 \u7b80\u5355\u8d77\u89c1\uff0c\u8fd9\u91cc\u6211\u4eec\u4ece\u91c7\u96c6\u65e5\u5fd7\u5f00\u59cb\u3002 \u9009\u62e9\u4f60\u7684\u90e8\u7f72\u73af\u5883 \uff1a Kubernetes \u00b6 \u4e3b\u673a \u00b6","title":"Overview"},{"location":"getting-started/quick-start/quick-start/#_1","text":"Loggie\u662f\u4e00\u4e2a\u65e5\u5fd7\u91c7\u96c6Agent\u548c\u4e2d\u8f6c\u5904\u7406\u7684Aggregator\uff0c\u5305\u542b\u591a\u4e2aPipeline\u7ba1\u9053\uff0c\u6bcf\u4e2aPipeline\u53c8\u7531Source\u8f93\u5165\u3001Interceptor\u62e6\u622a\u5904\u7406\u548cSink\u8f93\u51fa\u7ec4\u6210\u3002 \u57fa\u4e8e\u8fd9\u79cd\u63d2\u4ef6\u5f0f\u8bbe\u8ba1\uff0cLoggie\u5e76\u4e0d\u5c40\u9650\u5728\u65e5\u5fd7\u91c7\u96c6\uff0c\u901a\u8fc7\u914d\u7f6e\u4e0d\u540c\u7684Source/Interceptor/Sink\uff0cLoggie\u53ef\u4ee5\u7ec4\u5408\u5b9e\u73b0\u5404\u79cd\u4e0d\u540c\u7684\u529f\u80fd\u3002 \u7b80\u5355\u8d77\u89c1\uff0c\u8fd9\u91cc\u6211\u4eec\u4ece\u91c7\u96c6\u65e5\u5fd7\u5f00\u59cb\u3002 \u9009\u62e9\u4f60\u7684\u90e8\u7f72\u73af\u5883 \uff1a","title":"\u5feb\u901f\u4e0a\u624b"},{"location":"getting-started/quick-start/quick-start/#kubernetes","text":"","title":"  Kubernetes"},{"location":"getting-started/quick-start/quick-start/#_2","text":"","title":"  \u4e3b\u673a"},{"location":"getting-started/roadmap/roadmap-2022/","text":"2022 Loggie RoadMap \u00b6 \u66f4\u591a\u7ec4\u4ef6\u4e0e\u529f\u80fd\u6269\u5c55 \u00b6 \u6301\u4e45\u5316queue \u6d41\u5904\u7406\u80fd\u529b\uff1a\u805a\u5408\u3001\u8ba1\u7b97\u7b49\uff08\u7c7b\u4f3cpulsar\u7684funtion\uff0c\u6216\u8005\u7406\u89e3\u4e3a\u8f7b\u91cf\u7ea7flink\uff09 source: elasticsearch\u3001http sink: file, clickhouse, pulsar, influxdb\u7b49 WASM\u5f62\u6001\u652f\u6301\u81ea\u5b9a\u4e49\u65e5\u5fd7\u89e3\u6790\u5904\u7406 \u652f\u6301Knative/KEDA\u7b49Serverless\u5f62\u6001\u6269\u7f29\u5bb9\u6307\u6807\uff0c\u5b9e\u73b0\u4e2d\u8f6c\u673a\u89e3\u6790\u5904\u7406\u7684\u81ea\u52a8\u4f38\u7f29 \u670d\u52a1\u53d1\u73b0\u4e0e\u914d\u7f6e\u4e2d\u5fc3 \u00b6 \u4e3b\u673a\u6a21\u5f0f\u7684\u914d\u7f6e\u4e0b\u53d1\uff1a\u652f\u6301Consul, Apollo\u7b49 \u4e91\u539f\u751f\u4e0eKubernetes \u00b6 \u81ea\u52a8\u6ce8\u5165Loggie sidecar\u5f62\u6001\u652f\u6301 opentelemetry\u517c\u5bb9\u4e0e\u652f\u6301","title":2022},{"location":"getting-started/roadmap/roadmap-2022/#2022-loggie-roadmap","text":"","title":"2022 Loggie RoadMap"},{"location":"getting-started/roadmap/roadmap-2022/#_1","text":"\u6301\u4e45\u5316queue \u6d41\u5904\u7406\u80fd\u529b\uff1a\u805a\u5408\u3001\u8ba1\u7b97\u7b49\uff08\u7c7b\u4f3cpulsar\u7684funtion\uff0c\u6216\u8005\u7406\u89e3\u4e3a\u8f7b\u91cf\u7ea7flink\uff09 source: elasticsearch\u3001http sink: file, clickhouse, pulsar, influxdb\u7b49 WASM\u5f62\u6001\u652f\u6301\u81ea\u5b9a\u4e49\u65e5\u5fd7\u89e3\u6790\u5904\u7406 \u652f\u6301Knative/KEDA\u7b49Serverless\u5f62\u6001\u6269\u7f29\u5bb9\u6307\u6807\uff0c\u5b9e\u73b0\u4e2d\u8f6c\u673a\u89e3\u6790\u5904\u7406\u7684\u81ea\u52a8\u4f38\u7f29","title":"\u66f4\u591a\u7ec4\u4ef6\u4e0e\u529f\u80fd\u6269\u5c55"},{"location":"getting-started/roadmap/roadmap-2022/#_2","text":"\u4e3b\u673a\u6a21\u5f0f\u7684\u914d\u7f6e\u4e0b\u53d1\uff1a\u652f\u6301Consul, Apollo\u7b49","title":"\u670d\u52a1\u53d1\u73b0\u4e0e\u914d\u7f6e\u4e2d\u5fc3"},{"location":"getting-started/roadmap/roadmap-2022/#kubernetes","text":"\u81ea\u52a8\u6ce8\u5165Loggie sidecar\u5f62\u6001\u652f\u6301 opentelemetry\u517c\u5bb9\u4e0e\u652f\u6301","title":"\u4e91\u539f\u751f\u4e0eKubernetes"},{"location":"reference/","text":"\u914d\u7f6e \u00b6 Loggie\u7684\u914d\u7f6e\u4e3b\u8981\u5206\u4e3a\u4e24\u7c7b\uff1a \u7cfb\u7edf\u914d\u7f6e \u00b6 \u5168\u5c40\u7684\u7cfb\u7edf\u914d\u7f6e\uff0c\u542f\u52a8\u53c2\u6570\u4e2d\u4f7f\u7528 -config.system \u6307\u5b9a\uff0c\u5305\u542b\u5982\u4e0b\uff1a monitor : \u76d1\u63a7\u76f8\u5173\u7684\u914d\u7f6e discovery : \u670d\u52a1\u53d1\u73b0\u4e0e\u914d\u7f6e\u4e0b\u53d1 reload : \u52a8\u6001\u914d\u7f6e\u70ed\u52a0\u8f7d defaults : \u5168\u5c40\u9ed8\u8ba4\u914d\u7f6e http : \u7ba1\u7406\u548c\u76d1\u63a7\u4f7f\u7528\u7684http\u7aef\u53e3 loggie.yml # loggie.yml loggie : monitor : logger : period : 30s enabled : true listeners : filesource : ~ filewatcher : ~ reload : ~ sink : ~ discovery : enabled : true kubernetes : fields : container.name : containername logConfig : logconfig namespace : namespace node.name : nodename pod.name : podname reload : enabled : true period : 10s defaults : sink : type : dev sources : - type : file watcher : cleanFiles : maxHistory : 1 http : enabled : true port : 9196 Pipeline\u914d\u7f6e \u00b6 Pipeline\u7684\u914d\u7f6e\uff0c\u901a\u8fc7\u542f\u52a8\u53c2\u6570 -config.pipeline \u6307\u5b9a\u3002\u8868\u793a\u961f\u5217\u4f7f\u7528\u7684Source\u3001Sink\u3001Queue\u548cInterceptor\u3002 Source : \u6bcf\u4e2aPipeline\u53ef\u914d\u7f6e\u591a\u4e2aSource Interceptor : \u6bcf\u4e2aPipeline\u53ef\u914d\u7f6e\u591a\u4e2aInterceptor Sink : \u6bcf\u4e2aPipeline\u53ef\u914d\u7f6e\u4e00\u4e2aSink Queue : \u9ed8\u8ba4\u4e3achannel\u961f\u5217\uff0c\u4e00\u822c\u65e0\u9700\u914d\u7f6e pipeline.yml pipelines : - name : demo # pipeline name\u5fc5\u586b sources : - type : ${sourceType} name : access # source\u4e2dname\u5fc5\u586b ... interceptors : - type : ${interceptorType} ... sink : type : ${sinkType} ... Kubernetes CRD \u00b6 Loggie\u5b9a\u4e49\u4e86\u4ee5\u4e0b\u51e0\u4e2aCRD\u7528\u4e8e\u5728Kubernetes\u96c6\u7fa4\u73af\u5883\u91cc\u4e0b\u53d1\u914d\u7f6e\uff1a LogConfig \uff1anamespace\u7ea7\u522b\uff0c\u8868\u793a\u4e00\u4e2aPipeline\u914d\u7f6e\uff0c\u53ef\u7528\u4e8e\u91c7\u96c6Pods\u7684\u5bb9\u5668\u65e5\u5fd7\u3002 ClusterLogConfig \uff1acluster\u7ea7\u522b\uff0c\u8868\u793a\u4e00\u4e2aPipeline\u914d\u7f6e\uff0c\u5305\u62ec\u96c6\u7fa4\u7ea7\u522b\u7684\u8de8Namespace\u91c7\u96c6Pod\u5bb9\u5668\u65e5\u5fd7\uff0c\u91c7\u96c6Node\u8282\u70b9\u4e0a\u7684\u65e5\u5fd7\uff0c\u4ee5\u53ca\u4e3a\u67d0\u4e2aLoggie\u96c6\u7fa4\u4e0b\u53d1\u901a\u7528\u7684pipeline\u914d\u7f6e\u3002 Sink \uff1acluster\u7ea7\u522b\uff0c\u8868\u793a\u4e00\u4e2asink\u914d\u7f6e\uff0c\u53ef\u4ee5\u5728LogConfig/ClusterLogConfig\u4e2d\u5f15\u7528\u8be5Sink\u3002 Interceptors \uff1acluster\u7ea7\u522b\uff0c\u8868\u793a\u4e00\u4e2ainterceptors\u7ec4\uff0c\u53ef\u4ee5\u5728LogConfig\u4e2d\u5f15\u7528\u8be5interceptors\u7ec4\u3002 Note ClusterLogConfig/LogConfig\u4e2d\u7684pipeline\u53ef\u4ee5\u5b9a\u4e49sink\u548cinterceptor\uff0c\u7528\u4e8e\u8be5pipeline\u7684sink/interceptor\u3002 \u5982\u679c\u4f60\u5e0c\u671b\u5728\u591a\u4e2aClusterLogConfig/LogConfig\u4e2d\u590d\u7528sink\u6216\u8005interceptor\uff0c\u53ef\u4ee5\u521b\u5efaSink/Interceptor CR\uff0c\u5728ClusterLogConfig/LogConfig\u4e2d\u4f7f\u7528sinkRef/interceptorRef\u8fdb\u884c\u5f15\u7528\u3002","title":"Overview"},{"location":"reference/#_1","text":"Loggie\u7684\u914d\u7f6e\u4e3b\u8981\u5206\u4e3a\u4e24\u7c7b\uff1a","title":"\u914d\u7f6e"},{"location":"reference/#_2","text":"\u5168\u5c40\u7684\u7cfb\u7edf\u914d\u7f6e\uff0c\u542f\u52a8\u53c2\u6570\u4e2d\u4f7f\u7528 -config.system \u6307\u5b9a\uff0c\u5305\u542b\u5982\u4e0b\uff1a monitor : \u76d1\u63a7\u76f8\u5173\u7684\u914d\u7f6e discovery : \u670d\u52a1\u53d1\u73b0\u4e0e\u914d\u7f6e\u4e0b\u53d1 reload : \u52a8\u6001\u914d\u7f6e\u70ed\u52a0\u8f7d defaults : \u5168\u5c40\u9ed8\u8ba4\u914d\u7f6e http : \u7ba1\u7406\u548c\u76d1\u63a7\u4f7f\u7528\u7684http\u7aef\u53e3 loggie.yml # loggie.yml loggie : monitor : logger : period : 30s enabled : true listeners : filesource : ~ filewatcher : ~ reload : ~ sink : ~ discovery : enabled : true kubernetes : fields : container.name : containername logConfig : logconfig namespace : namespace node.name : nodename pod.name : podname reload : enabled : true period : 10s defaults : sink : type : dev sources : - type : file watcher : cleanFiles : maxHistory : 1 http : enabled : true port : 9196","title":"\u7cfb\u7edf\u914d\u7f6e"},{"location":"reference/#pipeline","text":"Pipeline\u7684\u914d\u7f6e\uff0c\u901a\u8fc7\u542f\u52a8\u53c2\u6570 -config.pipeline \u6307\u5b9a\u3002\u8868\u793a\u961f\u5217\u4f7f\u7528\u7684Source\u3001Sink\u3001Queue\u548cInterceptor\u3002 Source : \u6bcf\u4e2aPipeline\u53ef\u914d\u7f6e\u591a\u4e2aSource Interceptor : \u6bcf\u4e2aPipeline\u53ef\u914d\u7f6e\u591a\u4e2aInterceptor Sink : \u6bcf\u4e2aPipeline\u53ef\u914d\u7f6e\u4e00\u4e2aSink Queue : \u9ed8\u8ba4\u4e3achannel\u961f\u5217\uff0c\u4e00\u822c\u65e0\u9700\u914d\u7f6e pipeline.yml pipelines : - name : demo # pipeline name\u5fc5\u586b sources : - type : ${sourceType} name : access # source\u4e2dname\u5fc5\u586b ... interceptors : - type : ${interceptorType} ... sink : type : ${sinkType} ...","title":"Pipeline\u914d\u7f6e"},{"location":"reference/#kubernetes-crd","text":"Loggie\u5b9a\u4e49\u4e86\u4ee5\u4e0b\u51e0\u4e2aCRD\u7528\u4e8e\u5728Kubernetes\u96c6\u7fa4\u73af\u5883\u91cc\u4e0b\u53d1\u914d\u7f6e\uff1a LogConfig \uff1anamespace\u7ea7\u522b\uff0c\u8868\u793a\u4e00\u4e2aPipeline\u914d\u7f6e\uff0c\u53ef\u7528\u4e8e\u91c7\u96c6Pods\u7684\u5bb9\u5668\u65e5\u5fd7\u3002 ClusterLogConfig \uff1acluster\u7ea7\u522b\uff0c\u8868\u793a\u4e00\u4e2aPipeline\u914d\u7f6e\uff0c\u5305\u62ec\u96c6\u7fa4\u7ea7\u522b\u7684\u8de8Namespace\u91c7\u96c6Pod\u5bb9\u5668\u65e5\u5fd7\uff0c\u91c7\u96c6Node\u8282\u70b9\u4e0a\u7684\u65e5\u5fd7\uff0c\u4ee5\u53ca\u4e3a\u67d0\u4e2aLoggie\u96c6\u7fa4\u4e0b\u53d1\u901a\u7528\u7684pipeline\u914d\u7f6e\u3002 Sink \uff1acluster\u7ea7\u522b\uff0c\u8868\u793a\u4e00\u4e2asink\u914d\u7f6e\uff0c\u53ef\u4ee5\u5728LogConfig/ClusterLogConfig\u4e2d\u5f15\u7528\u8be5Sink\u3002 Interceptors \uff1acluster\u7ea7\u522b\uff0c\u8868\u793a\u4e00\u4e2ainterceptors\u7ec4\uff0c\u53ef\u4ee5\u5728LogConfig\u4e2d\u5f15\u7528\u8be5interceptors\u7ec4\u3002 Note ClusterLogConfig/LogConfig\u4e2d\u7684pipeline\u53ef\u4ee5\u5b9a\u4e49sink\u548cinterceptor\uff0c\u7528\u4e8e\u8be5pipeline\u7684sink/interceptor\u3002 \u5982\u679c\u4f60\u5e0c\u671b\u5728\u591a\u4e2aClusterLogConfig/LogConfig\u4e2d\u590d\u7528sink\u6216\u8005interceptor\uff0c\u53ef\u4ee5\u521b\u5efaSink/Interceptor CR\uff0c\u5728ClusterLogConfig/LogConfig\u4e2d\u4f7f\u7528sinkRef/interceptorRef\u8fdb\u884c\u5f15\u7528\u3002","title":"Kubernetes CRD"},{"location":"reference/discovery/kubernetes/clusterlogconfig/","text":"ClusterLogConfig \u00b6 Cluster\u7ea7\u522bCRD\uff0c\u53ef\u7528\u4e8e\uff1a \u91c7\u96c6\u4efb\u610fNamespace\u7684Pod\u65e5\u5fd7 \u91c7\u96c6Node\u8282\u70b9\u4e0a\u7684\u65e5\u5fd7 \u5c06Pipeline\u914d\u7f6e\u4e0b\u53d1\u81f3\u6307\u5b9aLoggie\u96c6\u7fa4 Example apiVersion : loggie.io/v1beta1 kind : ClusterLogConfig metadata : name : test spec : selector : type : node nodeSelector : nodepool : test pipeline : sources : | - type: file name: messages paths: - /var/log/messages sinkRef : default spec.selector \u00b6 \u8868\u793aPipeline\u914d\u7f6e\u9002\u7528\u7684\u8303\u56f4 type: pod \u00b6 \u901a\u8fc7Pipeline\u914d\u7f6e\u9009\u62e9\u4e00\u6279Pod\u8fdb\u884c\u65e5\u5fd7\u91c7\u96c6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 labelSelector map \u5fc5\u586b \u901a\u8fc7\u8be5label\u6765\u5339\u914dPods Example spec : selector : type : pod labelSelector : app : nginx \u8868\u793a\u91c7\u96c6\u5e26\u6709\u6807\u7b7e app: nginx \u7684\u6240\u6709Pod\u7684\u65e5\u5fd7\u3002 Warning \u5728 type: pod \u65f6\uff0c\u4e0b\u9762\u7684Pipeline\u53ea\u80fd\u4f7f\u7528file source\uff0c\u6b64\u65f6\u7684\u573a\u666f\u53ea\u80fd\u662f\u91c7\u96c6\u65e5\u5fd7\u3002 type: node \u00b6 \u4e0b\u53d1Pipeline\u914d\u7f6e\u81f3\u8be5\u6279\u8282\u70b9\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 nodeSelector map \u5fc5\u586b \u901a\u8fc7label\u9009\u62e9\u4e0b\u53d1\u914d\u7f6e\u7684node Example spec : selector : type : node nodeSelector : nodepool : test \u8868\u793a\u5c06\u914d\u7f6e\u7684Pipelines\u4e0b\u53d1\u81f3\u5e26\u6709 nodepool: test \u7684\u6240\u6709node\u4e0a\u3002 type: cluster \u00b6 \u4e0b\u53d1Pipeline\u914d\u7f6e\u81f3\u67d0\u4e2aLoggie\u96c6\u7fa4\uff0c\u901a\u5e38\u9700\u8981\u914d\u5408 cluster \u5b57\u6bb5\u6307\u5b9a\u96c6\u7fa4\u540d\u4f7f\u7528\u3002 Example spec : selector : cluster : aggregator type : cluster \u8868\u793a\u5c06\u914d\u7f6e\u7684Pipelines\u4e0b\u53d1\u81f3 cluster \u4e3aaggregator\u7684Loggie\u96c6\u7fa4\u3002 cluster \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 cluster string \u975e\u5fc5\u586b \"\" \u8868\u793a\u914d\u7f6e\u6307\u5b9a\u4e0b\u53d1\u7684Loggie\u96c6\u7fa4\u3002\u5f53\u90e8\u7f72\u591a\u5957Loggie\u65f6\uff0c\u548c\u5168\u5c40\u7cfb\u7edf\u914d\u7f6e discovery.kubernetes.cluster \u914d\u5957\u4f7f\u7528 spec.pipelines \u00b6 \u914d\u7f6e\u548cLogConfig\u4e00\u81f4\u3002","title":"ClusterLogConfig"},{"location":"reference/discovery/kubernetes/clusterlogconfig/#clusterlogconfig","text":"Cluster\u7ea7\u522bCRD\uff0c\u53ef\u7528\u4e8e\uff1a \u91c7\u96c6\u4efb\u610fNamespace\u7684Pod\u65e5\u5fd7 \u91c7\u96c6Node\u8282\u70b9\u4e0a\u7684\u65e5\u5fd7 \u5c06Pipeline\u914d\u7f6e\u4e0b\u53d1\u81f3\u6307\u5b9aLoggie\u96c6\u7fa4 Example apiVersion : loggie.io/v1beta1 kind : ClusterLogConfig metadata : name : test spec : selector : type : node nodeSelector : nodepool : test pipeline : sources : | - type: file name: messages paths: - /var/log/messages sinkRef : default","title":"ClusterLogConfig"},{"location":"reference/discovery/kubernetes/clusterlogconfig/#specselector","text":"\u8868\u793aPipeline\u914d\u7f6e\u9002\u7528\u7684\u8303\u56f4","title":"spec.selector"},{"location":"reference/discovery/kubernetes/clusterlogconfig/#type-pod","text":"\u901a\u8fc7Pipeline\u914d\u7f6e\u9009\u62e9\u4e00\u6279Pod\u8fdb\u884c\u65e5\u5fd7\u91c7\u96c6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 labelSelector map \u5fc5\u586b \u901a\u8fc7\u8be5label\u6765\u5339\u914dPods Example spec : selector : type : pod labelSelector : app : nginx \u8868\u793a\u91c7\u96c6\u5e26\u6709\u6807\u7b7e app: nginx \u7684\u6240\u6709Pod\u7684\u65e5\u5fd7\u3002 Warning \u5728 type: pod \u65f6\uff0c\u4e0b\u9762\u7684Pipeline\u53ea\u80fd\u4f7f\u7528file source\uff0c\u6b64\u65f6\u7684\u573a\u666f\u53ea\u80fd\u662f\u91c7\u96c6\u65e5\u5fd7\u3002","title":"type: pod"},{"location":"reference/discovery/kubernetes/clusterlogconfig/#type-node","text":"\u4e0b\u53d1Pipeline\u914d\u7f6e\u81f3\u8be5\u6279\u8282\u70b9\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 nodeSelector map \u5fc5\u586b \u901a\u8fc7label\u9009\u62e9\u4e0b\u53d1\u914d\u7f6e\u7684node Example spec : selector : type : node nodeSelector : nodepool : test \u8868\u793a\u5c06\u914d\u7f6e\u7684Pipelines\u4e0b\u53d1\u81f3\u5e26\u6709 nodepool: test \u7684\u6240\u6709node\u4e0a\u3002","title":"type: node"},{"location":"reference/discovery/kubernetes/clusterlogconfig/#type-cluster","text":"\u4e0b\u53d1Pipeline\u914d\u7f6e\u81f3\u67d0\u4e2aLoggie\u96c6\u7fa4\uff0c\u901a\u5e38\u9700\u8981\u914d\u5408 cluster \u5b57\u6bb5\u6307\u5b9a\u96c6\u7fa4\u540d\u4f7f\u7528\u3002 Example spec : selector : cluster : aggregator type : cluster \u8868\u793a\u5c06\u914d\u7f6e\u7684Pipelines\u4e0b\u53d1\u81f3 cluster \u4e3aaggregator\u7684Loggie\u96c6\u7fa4\u3002","title":"type: cluster"},{"location":"reference/discovery/kubernetes/clusterlogconfig/#cluster","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 cluster string \u975e\u5fc5\u586b \"\" \u8868\u793a\u914d\u7f6e\u6307\u5b9a\u4e0b\u53d1\u7684Loggie\u96c6\u7fa4\u3002\u5f53\u90e8\u7f72\u591a\u5957Loggie\u65f6\uff0c\u548c\u5168\u5c40\u7cfb\u7edf\u914d\u7f6e discovery.kubernetes.cluster \u914d\u5957\u4f7f\u7528","title":"cluster"},{"location":"reference/discovery/kubernetes/clusterlogconfig/#specpipelines","text":"\u914d\u7f6e\u548cLogConfig\u4e00\u81f4\u3002","title":"spec.pipelines"},{"location":"reference/discovery/kubernetes/interceptors/","text":"Interceptor \u00b6 \u8868\u793a\u4e00\u4e2ainterceptor\u7ec4\u3002\u7528\u4e8e\u5728LogConfig/ClusterLogConfig\u4e2d\u88ab\u5f15\u7528\u3002 Example apiVersion : loggie.io/v1beta1 kind : Interceptor metadata : name : default spec : interceptors : | - type: rateLimit qps: 90000 spec.interceptors \u00b6 \u4f7f\u7528\"|\"\u7b26\u53f7\u8868\u793a\u4e00\u6574\u6bb5interceptors\u914d\u7f6e\u5217\u8868\uff0c\u548cPipelines\u91cc\u7684\u914d\u7f6e\u4e00\u81f4\u3002","title":"Interceptor"},{"location":"reference/discovery/kubernetes/interceptors/#interceptor","text":"\u8868\u793a\u4e00\u4e2ainterceptor\u7ec4\u3002\u7528\u4e8e\u5728LogConfig/ClusterLogConfig\u4e2d\u88ab\u5f15\u7528\u3002 Example apiVersion : loggie.io/v1beta1 kind : Interceptor metadata : name : default spec : interceptors : | - type: rateLimit qps: 90000","title":"Interceptor"},{"location":"reference/discovery/kubernetes/interceptors/#specinterceptors","text":"\u4f7f\u7528\"|\"\u7b26\u53f7\u8868\u793a\u4e00\u6574\u6bb5interceptors\u914d\u7f6e\u5217\u8868\uff0c\u548cPipelines\u91cc\u7684\u914d\u7f6e\u4e00\u81f4\u3002","title":"spec.interceptors"},{"location":"reference/discovery/kubernetes/logconfig/","text":"Logconfig \u00b6 namespace\u7ea7\u522bCRD\uff0c\u8868\u793a\u4e00\u4e2a\u65e5\u5fd7\u91c7\u96c6\u4efb\u52a1\uff0c\u7528\u4e8e\u91c7\u96c6Pod\u5bb9\u5668\u65e5\u5fd7\u3002 Example \u76f4\u63a5\u5b9a\u4e49sink/interceptor\u65b9\u5f0f apiVersion : loggie.io/v1beta1 kind : LogConfig metadata : name : tomcat namespace : default spec : selector : type : pod labelSelector : app : tomcat pipeline : sources : | - type: file name: common paths: - stdout sink : | type: dev printEvents: false interceptors : | - type: rateLimit qps: 90000 \u5f15\u7528sink\u548cinterceptor\u65b9\u5f0f apiVersion : loggie.io/v1beta1 kind : LogConfig metadata : name : nginx namespace : default spec : selector : type : pod labelSelector : app : nginx pipeline : sources : | - type: file name: mylog paths: - stdout sinkRef : default interceptorRef : default spec.selector \u00b6 \u8868\u793aPipeline\u914d\u7f6e\u9002\u7528\u7684\u8303\u56f4\uff0c\u53ef\u4ee5\u9009\u62e9\u91c7\u96c6\u4e00\u6279Pods\u7684\u65e5\u5fd7 type: pod \u00b6 \u91c7\u96c6Pods\u65e5\u5fd7 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 labelSelector map \u5fc5\u586b \u901a\u8fc7\u8be5label\u6765\u5339\u914dPods Example spec : selector : type : pod labelSelector : app : nginx \u8868\u793a\u91c7\u96c6\u8be5namespace\u4e0b\u7684\u5e26\u6709label app: nginx \u7684\u6240\u6709Pods\u65e5\u5fd7\u3002 Warning \u5728 type: pod \u65f6\uff0c\u4e0b\u9762\u7684Pipeline\u53ea\u652f\u6301\u4f7f\u7528file source\uff0c\u6b64\u65f6\u7684\u573a\u666f\u53ea\u80fd\u662f\u91c7\u96c6\u65e5\u5fd7\u3002 cluster \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 cluster string \u975e\u5fc5\u586b \"\" \u8868\u793a\u914d\u7f6e\u6307\u5b9a\u4e0b\u53d1\u7684Loggie\u96c6\u7fa4\u3002\u5f53\u90e8\u7f72\u591a\u5957Loggie\u65f6\uff0c\u548c\u5168\u5c40\u7cfb\u7edf\u914d\u7f6e discovery.kubernetes.cluster \u914d\u5957\u4f7f\u7528 spec.pipeline \u00b6 \u8868\u793a\u4e00\u4e2aPipeline\uff0c\u4e0d\u652f\u6301\u586b\u5199\u591a\u4e2aPipeline\u3002 \u548c\u5728\u914d\u7f6e\u6587\u4ef6\u4e2dPipelines\u7684\u533a\u522b\u5728\uff1a sources\u4e3a\u5b9e\u9645\u4e3astring\uff0c\u5728yaml\u4e2d\u4f7f\u7528 \uff5c \u8868\u793a\u4fdd\u7559\u6362\u884c\u7b26 \u6ca1\u6709sink\uff0c\u53ea\u6709sinkRef\uff0c\u8868\u793a\u5f15\u7528\u7684Sink CRD\u5b9e\u4f8b \u6ca1\u6709interceptors\uff0c\u53ea\u6709interceptorRef\uff0c\u8868\u793a\u5f15\u7528\u7684Interceptor CRD\u5b9e\u4f8b sources \u00b6 \u5728LogConfig\u4e2d\uff0c\u5982\u679c type: pod \uff0c file source \u65b0\u589e\u51e0\u4e2a\u4e13\u95e8\u9488\u5bf9\u5bb9\u5668\u5316\u7684\u53c2\u6570\uff1a \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 containerName string \u975e\u5fc5\u586b \u8868\u793a\u6307\u5b9a\u91c7\u96c6\u7684\u5bb9\u5668\u540d\u79f0\uff0c\u5efa\u8bae\u5728Pod\u91cc\u5305\u542b\u591a\u4e2a\u5bb9\u5668\u65f6\u586b\u5199 excludeContainerPatterns string\u6570\u7ec4 \u975e\u5fc5\u586b \u6392\u9664\u7684\u5bb9\u5668\u540d\u79f0\uff0c\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u5f62\u5f0f matchFields \u975e\u5fc5\u586b \u5c06Pod\u4e2d\u7684\u4fe1\u606f\u52a0\u5165\u5230Fields\u4e2d matchFields.labelKey string\u6570\u7ec4 \u975e\u5fc5\u586b \u6307\u5b9a\u589e\u52a0\u7684Pod\u4e0a\u7684Label Key\u503c\uff0c\u6bd4\u5982Pod\u4e0a\u5305\u542bLabel: app: demo \uff0c\u6b64\u5904\u586b\u5199 labelKey: app \uff0c\u6b64\u65f6\u4f1a\u5c06Pod\u4e0a\u7684 app: demo label\u589e\u52a0\u5230file source fields\u4e2d\uff0c\u91c7\u96c6\u5230\u7684\u65e5\u5fd7\u4f1a\u88ab\u52a0\u4e0a\u8be5label\u4fe1\u606f\u3002\u9002\u7528\u4e8e\u5339\u914d\u7684Pod\u7684label\u5b58\u5728\u4e0d\u4e00\u81f4\u7684\u573a\u666f\u3002\u652f\u6301\u914d\u7f6e\u4e3a\"*\"\u7684\u65b9\u5f0f\u83b7\u53d6\u6240\u6709\u7684label matchFields.annotationKey string\u6570\u7ec4 \u975e\u5fc5\u586b \u548c\u4e0a\u9762labelKey\u7c7b\u4f3c\uff0c\u6ce8\u5165\u7684\u4e3aPod Annoatation\u7684\u503c\uff0c\u652f\u6301\u914d\u7f6e\u4e3a\"*\"\u7684\u65b9\u5f0f\u83b7\u53d6\u6240\u6709\u7684annotation matchFields.env string\u6570\u7ec4 \u975e\u5fc5\u586b \u548c\u4e0a\u9762labelKey\u7c7b\u4f3c\uff0c\u6ce8\u5165\u7684\u4e3aPod Env\u73af\u5883\u53d8\u91cf\u7684\u503c\uff0c\u652f\u6301\u914d\u7f6e\u4e3a\"*\"\u7684\u65b9\u5f0f\u83b7\u53d6\u6240\u6709\u7684env Example apiVersion : loggie.io/v1beta1 kind : LogConfig metadata : name : nginx namespace : default spec : selector : type : pod labelSelector : app : nginx pipeline : sources : | - type: file name: mylog containerName: nginx matchFields: labelKey: [\"app\"] paths: - stdout interceptors \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 interceptors string \u975e\u5fc5\u586b \u8868\u793a\u8be5Pipeline\u7684interceptor\uff0c\u4f7f\u7528\u65b9\u5f0f\u548c\u4ee5\u4e0asources\u7c7b\u4f3c sink \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 sink string \u975e\u5fc5\u586b \u8868\u793a\u8be5Pipeline\u7684sink\uff0c\u4f7f\u7528\u65b9\u5f0f\u548c\u4ee5\u4e0a\u7684sources\u7c7b\u4f3c \u5982\u679c\u4f60\u5e0c\u671bsink\u548cinterceptor\u53ef\u4ee5\u5728\u4e0d\u540c\u7684ClusterLogConfig/LogConfig\u95f4\u590d\u7528\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0bref\u7684\u65b9\u5f0f\uff1a sinkRef \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 sinkRef string \u975e\u5fc5\u586b \u8868\u793a\u8be5Pipeline\u5f15\u7528\u7684Sink CR interceptorRef \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 interceptorRef string \u975e\u5fc5\u586b \u8868\u793a\u8be5Pipeline\u5f15\u7528\u7684Interceptor CR","title":"LogConfig"},{"location":"reference/discovery/kubernetes/logconfig/#logconfig","text":"namespace\u7ea7\u522bCRD\uff0c\u8868\u793a\u4e00\u4e2a\u65e5\u5fd7\u91c7\u96c6\u4efb\u52a1\uff0c\u7528\u4e8e\u91c7\u96c6Pod\u5bb9\u5668\u65e5\u5fd7\u3002 Example \u76f4\u63a5\u5b9a\u4e49sink/interceptor\u65b9\u5f0f apiVersion : loggie.io/v1beta1 kind : LogConfig metadata : name : tomcat namespace : default spec : selector : type : pod labelSelector : app : tomcat pipeline : sources : | - type: file name: common paths: - stdout sink : | type: dev printEvents: false interceptors : | - type: rateLimit qps: 90000 \u5f15\u7528sink\u548cinterceptor\u65b9\u5f0f apiVersion : loggie.io/v1beta1 kind : LogConfig metadata : name : nginx namespace : default spec : selector : type : pod labelSelector : app : nginx pipeline : sources : | - type: file name: mylog paths: - stdout sinkRef : default interceptorRef : default","title":"Logconfig"},{"location":"reference/discovery/kubernetes/logconfig/#specselector","text":"\u8868\u793aPipeline\u914d\u7f6e\u9002\u7528\u7684\u8303\u56f4\uff0c\u53ef\u4ee5\u9009\u62e9\u91c7\u96c6\u4e00\u6279Pods\u7684\u65e5\u5fd7","title":"spec.selector"},{"location":"reference/discovery/kubernetes/logconfig/#type-pod","text":"\u91c7\u96c6Pods\u65e5\u5fd7 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 labelSelector map \u5fc5\u586b \u901a\u8fc7\u8be5label\u6765\u5339\u914dPods Example spec : selector : type : pod labelSelector : app : nginx \u8868\u793a\u91c7\u96c6\u8be5namespace\u4e0b\u7684\u5e26\u6709label app: nginx \u7684\u6240\u6709Pods\u65e5\u5fd7\u3002 Warning \u5728 type: pod \u65f6\uff0c\u4e0b\u9762\u7684Pipeline\u53ea\u652f\u6301\u4f7f\u7528file source\uff0c\u6b64\u65f6\u7684\u573a\u666f\u53ea\u80fd\u662f\u91c7\u96c6\u65e5\u5fd7\u3002","title":"type: pod"},{"location":"reference/discovery/kubernetes/logconfig/#cluster","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 cluster string \u975e\u5fc5\u586b \"\" \u8868\u793a\u914d\u7f6e\u6307\u5b9a\u4e0b\u53d1\u7684Loggie\u96c6\u7fa4\u3002\u5f53\u90e8\u7f72\u591a\u5957Loggie\u65f6\uff0c\u548c\u5168\u5c40\u7cfb\u7edf\u914d\u7f6e discovery.kubernetes.cluster \u914d\u5957\u4f7f\u7528","title":"cluster"},{"location":"reference/discovery/kubernetes/logconfig/#specpipeline","text":"\u8868\u793a\u4e00\u4e2aPipeline\uff0c\u4e0d\u652f\u6301\u586b\u5199\u591a\u4e2aPipeline\u3002 \u548c\u5728\u914d\u7f6e\u6587\u4ef6\u4e2dPipelines\u7684\u533a\u522b\u5728\uff1a sources\u4e3a\u5b9e\u9645\u4e3astring\uff0c\u5728yaml\u4e2d\u4f7f\u7528 \uff5c \u8868\u793a\u4fdd\u7559\u6362\u884c\u7b26 \u6ca1\u6709sink\uff0c\u53ea\u6709sinkRef\uff0c\u8868\u793a\u5f15\u7528\u7684Sink CRD\u5b9e\u4f8b \u6ca1\u6709interceptors\uff0c\u53ea\u6709interceptorRef\uff0c\u8868\u793a\u5f15\u7528\u7684Interceptor CRD\u5b9e\u4f8b","title":"spec.pipeline"},{"location":"reference/discovery/kubernetes/logconfig/#sources","text":"\u5728LogConfig\u4e2d\uff0c\u5982\u679c type: pod \uff0c file source \u65b0\u589e\u51e0\u4e2a\u4e13\u95e8\u9488\u5bf9\u5bb9\u5668\u5316\u7684\u53c2\u6570\uff1a \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 containerName string \u975e\u5fc5\u586b \u8868\u793a\u6307\u5b9a\u91c7\u96c6\u7684\u5bb9\u5668\u540d\u79f0\uff0c\u5efa\u8bae\u5728Pod\u91cc\u5305\u542b\u591a\u4e2a\u5bb9\u5668\u65f6\u586b\u5199 excludeContainerPatterns string\u6570\u7ec4 \u975e\u5fc5\u586b \u6392\u9664\u7684\u5bb9\u5668\u540d\u79f0\uff0c\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u5f62\u5f0f matchFields \u975e\u5fc5\u586b \u5c06Pod\u4e2d\u7684\u4fe1\u606f\u52a0\u5165\u5230Fields\u4e2d matchFields.labelKey string\u6570\u7ec4 \u975e\u5fc5\u586b \u6307\u5b9a\u589e\u52a0\u7684Pod\u4e0a\u7684Label Key\u503c\uff0c\u6bd4\u5982Pod\u4e0a\u5305\u542bLabel: app: demo \uff0c\u6b64\u5904\u586b\u5199 labelKey: app \uff0c\u6b64\u65f6\u4f1a\u5c06Pod\u4e0a\u7684 app: demo label\u589e\u52a0\u5230file source fields\u4e2d\uff0c\u91c7\u96c6\u5230\u7684\u65e5\u5fd7\u4f1a\u88ab\u52a0\u4e0a\u8be5label\u4fe1\u606f\u3002\u9002\u7528\u4e8e\u5339\u914d\u7684Pod\u7684label\u5b58\u5728\u4e0d\u4e00\u81f4\u7684\u573a\u666f\u3002\u652f\u6301\u914d\u7f6e\u4e3a\"*\"\u7684\u65b9\u5f0f\u83b7\u53d6\u6240\u6709\u7684label matchFields.annotationKey string\u6570\u7ec4 \u975e\u5fc5\u586b \u548c\u4e0a\u9762labelKey\u7c7b\u4f3c\uff0c\u6ce8\u5165\u7684\u4e3aPod Annoatation\u7684\u503c\uff0c\u652f\u6301\u914d\u7f6e\u4e3a\"*\"\u7684\u65b9\u5f0f\u83b7\u53d6\u6240\u6709\u7684annotation matchFields.env string\u6570\u7ec4 \u975e\u5fc5\u586b \u548c\u4e0a\u9762labelKey\u7c7b\u4f3c\uff0c\u6ce8\u5165\u7684\u4e3aPod Env\u73af\u5883\u53d8\u91cf\u7684\u503c\uff0c\u652f\u6301\u914d\u7f6e\u4e3a\"*\"\u7684\u65b9\u5f0f\u83b7\u53d6\u6240\u6709\u7684env Example apiVersion : loggie.io/v1beta1 kind : LogConfig metadata : name : nginx namespace : default spec : selector : type : pod labelSelector : app : nginx pipeline : sources : | - type: file name: mylog containerName: nginx matchFields: labelKey: [\"app\"] paths: - stdout","title":"sources"},{"location":"reference/discovery/kubernetes/logconfig/#interceptors","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 interceptors string \u975e\u5fc5\u586b \u8868\u793a\u8be5Pipeline\u7684interceptor\uff0c\u4f7f\u7528\u65b9\u5f0f\u548c\u4ee5\u4e0asources\u7c7b\u4f3c","title":"interceptors"},{"location":"reference/discovery/kubernetes/logconfig/#sink","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 sink string \u975e\u5fc5\u586b \u8868\u793a\u8be5Pipeline\u7684sink\uff0c\u4f7f\u7528\u65b9\u5f0f\u548c\u4ee5\u4e0a\u7684sources\u7c7b\u4f3c \u5982\u679c\u4f60\u5e0c\u671bsink\u548cinterceptor\u53ef\u4ee5\u5728\u4e0d\u540c\u7684ClusterLogConfig/LogConfig\u95f4\u590d\u7528\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0bref\u7684\u65b9\u5f0f\uff1a","title":"sink"},{"location":"reference/discovery/kubernetes/logconfig/#sinkref","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 sinkRef string \u975e\u5fc5\u586b \u8868\u793a\u8be5Pipeline\u5f15\u7528\u7684Sink CR","title":"sinkRef"},{"location":"reference/discovery/kubernetes/logconfig/#interceptorref","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 interceptorRef string \u975e\u5fc5\u586b \u8868\u793a\u8be5Pipeline\u5f15\u7528\u7684Interceptor CR","title":"interceptorRef"},{"location":"reference/discovery/kubernetes/sink/","text":"Sink \u00b6 \u8868\u793a\u4e00\u4e2asink\u914d\u7f6e\u3002\u7528\u4e8e\u5728LogConfig/ClusterLogConfig\u4e2d\u88ab\u5f15\u7528\u3002 Example kind : Sink metadata : name : default spec : sink : | type: elasticsearch index: \"loggie\" hosts: [\"elasticsearch-master.default.svc:9200\"] spec.sink \u00b6 \u4f7f\u7528\"|\"\u7b26\u53f7\u8868\u793a\u4e00\u4e2asink\u914d\u7f6e\uff0c\u548cPipelines\u91cc\u7684\u914d\u7f6e\u4e00\u81f4\u3002","title":"Sink"},{"location":"reference/discovery/kubernetes/sink/#sink","text":"\u8868\u793a\u4e00\u4e2asink\u914d\u7f6e\u3002\u7528\u4e8e\u5728LogConfig/ClusterLogConfig\u4e2d\u88ab\u5f15\u7528\u3002 Example kind : Sink metadata : name : default spec : sink : | type: elasticsearch index: \"loggie\" hosts: [\"elasticsearch-master.default.svc:9200\"]","title":"Sink"},{"location":"reference/discovery/kubernetes/sink/#specsink","text":"\u4f7f\u7528\"|\"\u7b26\u53f7\u8868\u793a\u4e00\u4e2asink\u914d\u7f6e\uff0c\u548cPipelines\u91cc\u7684\u914d\u7f6e\u4e00\u81f4\u3002","title":"spec.sink"},{"location":"reference/global/args/","text":"\u7cfb\u7edf\u53c2\u6570 \u00b6 -config.from : \u9ed8\u8ba4\u4e3afile\uff0c\u5373\u9ed8\u8ba4\u4f7f\u7528\u6587\u4ef6\u7684\u914d\u7f6e\u65b9\u5f0f\u3002\u53ef\u9009\uff1aenv\uff0c\u6b64\u65f6\u4f1a\u4ece\u73af\u5883\u53d8\u91cf\u4e2d\u8bfb\u53d6\u914d\u7f6e\uff08\u6b64\u65f6\u4e0d\u652f\u6301reload\uff09\u3002 -config.system : \u9ed8\u8ba4\u4e3aloggie.yml\uff0c\u8868\u793a\u6307\u5b9aLoggie\u7cfb\u7edf\u914d\u7f6e\u7684\u8def\u5f84\u548c\u6587\u4ef6\u540d\u79f0\u3002 \uff08\u5982\u679c -config.from=env \uff0c\u5219\u4e3asystem\u914d\u7f6e\u7684\u73af\u5883\u53d8\u91cf\u540d\u79f0\uff09 -config.pipeline : \u9ed8\u8ba4\u4e3apipelines.yml\uff0c\u8868\u793aPipeline\u914d\u7f6e\u6587\u4ef6\u6240\u5728\u7684\u8def\u5f84\uff0c\u9700\u8981\u586b\u5199\u7b26\u5408glob\u5339\u914d\u7684\u8def\u5f84\uff0c\u6bd4\u5982\u5177\u4f53\u7684\u8def\u5f84\u548c\u6587\u4ef6\u540d /etc/loggie/pipelines.yml \uff0c\u6216\u8005glob\u5339\u914d\u7684\u65b9\u5f0f\uff0c\u6bd4\u5982 /etc/loggie/*.yml \u3002 \uff08\u5982\u679c -config.from=env \uff0c\u5219\u4e3apipeline\u914d\u7f6e\u7684\u73af\u5883\u53d8\u91cf\u540d\u79f0\uff09 Warning \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c config.pipeline=/etc/loggie \uff0cglob\u5339\u914d\u4f1a\u8ba4\u4e3a /etc/loggie \u4e3a /etc \u76ee\u5f55\u4e0b\u7684 loggie \u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u5339\u914d /etc/loggie \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff0c\u8bf7\u907f\u514d\u7c7b\u4f3c\u7684\u8bbe\u7f6e\u65b9\u5f0f -meta.nodeName \uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f1a\u4f7f\u7528\u7cfb\u7edf\u7684hostname\uff0c\u5728Kubernetes\u90e8\u7f72\u4e2d\u4f1a\u4f7f\u7528Downward API\u6765\u6ce8\u5165nodeName\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u9700\u8981\u5355\u72ec\u914d\u7f6e \u65e5\u5fd7\u53c2\u6570: \u00b6 -log.level : \u65e5\u5fd7\u7ea7\u522b\uff0c\u9ed8\u8ba4\u4e3ainfo\uff0c\u53ef\u914d\u7f6e\u4e3adebug\u3001info\u3001warn\u548cerror -log.jsonFormat : \u662f\u5426\u5c06\u65e5\u5fd7\u8f93\u51fa\u4e3ajson\u683c\u5f0f\uff0c\u9ed8\u8ba4\u4e3afalse -log.enableStdout : \u662f\u5426\u8f93\u51fa\u6807\u51c6\u8f93\u51fa\u65e5\u5fd7\uff0c\u9ed8\u8ba4\u4e3atrue -log.enableFile : \u662f\u5426\u8f93\u51fa\u65e5\u5fd7\u6587\u4ef6\uff0c\u9ed8\u8ba4\u4e3afalse\uff0c\u5373\u4e0d\u8f93\u51fa\u65e5\u5fd7\u6587\u4ef6\uff0c\u9ed8\u8ba4\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa -log.directory : \u65e5\u5fd7\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u9ed8\u8ba4\u4e3a/var/log\uff0c\u5f53log.enableFile=true\u65f6\u751f\u6548 -log.filename : \u65e5\u5fd7\u6587\u4ef6\u7684\u540d\u79f0\uff0c\u9ed8\u8ba4\u4e3aloggie.log\uff0c\u4e00\u822c\u540clog.directory\u642d\u914d\u4f7f\u7528 -log.maxSize : \u65e5\u5fd7\u8f6e\u8f6c\u7684\u65f6\u5019\uff0c\u6700\u5927\u7684\u6587\u4ef6\u5927\u5c0f\uff0c\u9ed8\u8ba4\u4e3a1024MB -log.maxBackups : \u65e5\u5fd7\u8f6e\u8f6c\u6700\u591a\u4fdd\u7559\u7684\u6587\u4ef6\u4e2a\u6570\uff0c\u9ed8\u8ba4\u4e3a3 -log.maxAge : \u65e5\u5fd7\u8f6e\u8f6c\u6700\u5927\u4fdd\u7559\u7684\u5929\u6570\uff0c\u9ed8\u8ba4\u4e3a7 -log.timeFormat : \u6bcf\u884c\u65e5\u5fd7\u8f93\u51fa\u7684\u65f6\u95f4\u683c\u5f0f\uff0c\u9ed8\u8ba4\u683c\u5f0f\u4e3a 2006-01-02 15:04:05 -log.noColor : \u8f93\u51fa\u662f\u5426\u6709\u989c\u8272\u7f8e\u5316\uff0c\u9ed8\u8ba4\u4e3afalse\uff0c\u5373\u6709\u989c\u8272\u7f8e\u5316\uff0c\u5bf9\u4e8e\u4ece\u6807\u51c6\u8f93\u51fa\u67e5\u770b\u65e5\u5fd7\u6bd4\u8f83\u65b9\u4fbf\u3002\u5982\u679c\u8f93\u51fa\u5230\u65e5\u5fd7\u6587\u4ef6\u4e2d\uff0c\u5efa\u8bae\u8bbe\u7f6e\u4e3atrue\uff0c\u907f\u514d\u5f15\u5165\u989d\u5916\u7684\u683c\u5f0f\u3002 Info Loggie\u7684\u65e5\u5fd7\u8f6e\u8f6c\u4f7f\u7528 lumberjack \u5e93","title":"\u542f\u52a8\u53c2\u6570"},{"location":"reference/global/args/#_1","text":"-config.from : \u9ed8\u8ba4\u4e3afile\uff0c\u5373\u9ed8\u8ba4\u4f7f\u7528\u6587\u4ef6\u7684\u914d\u7f6e\u65b9\u5f0f\u3002\u53ef\u9009\uff1aenv\uff0c\u6b64\u65f6\u4f1a\u4ece\u73af\u5883\u53d8\u91cf\u4e2d\u8bfb\u53d6\u914d\u7f6e\uff08\u6b64\u65f6\u4e0d\u652f\u6301reload\uff09\u3002 -config.system : \u9ed8\u8ba4\u4e3aloggie.yml\uff0c\u8868\u793a\u6307\u5b9aLoggie\u7cfb\u7edf\u914d\u7f6e\u7684\u8def\u5f84\u548c\u6587\u4ef6\u540d\u79f0\u3002 \uff08\u5982\u679c -config.from=env \uff0c\u5219\u4e3asystem\u914d\u7f6e\u7684\u73af\u5883\u53d8\u91cf\u540d\u79f0\uff09 -config.pipeline : \u9ed8\u8ba4\u4e3apipelines.yml\uff0c\u8868\u793aPipeline\u914d\u7f6e\u6587\u4ef6\u6240\u5728\u7684\u8def\u5f84\uff0c\u9700\u8981\u586b\u5199\u7b26\u5408glob\u5339\u914d\u7684\u8def\u5f84\uff0c\u6bd4\u5982\u5177\u4f53\u7684\u8def\u5f84\u548c\u6587\u4ef6\u540d /etc/loggie/pipelines.yml \uff0c\u6216\u8005glob\u5339\u914d\u7684\u65b9\u5f0f\uff0c\u6bd4\u5982 /etc/loggie/*.yml \u3002 \uff08\u5982\u679c -config.from=env \uff0c\u5219\u4e3apipeline\u914d\u7f6e\u7684\u73af\u5883\u53d8\u91cf\u540d\u79f0\uff09 Warning \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c config.pipeline=/etc/loggie \uff0cglob\u5339\u914d\u4f1a\u8ba4\u4e3a /etc/loggie \u4e3a /etc \u76ee\u5f55\u4e0b\u7684 loggie \u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u5339\u914d /etc/loggie \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff0c\u8bf7\u907f\u514d\u7c7b\u4f3c\u7684\u8bbe\u7f6e\u65b9\u5f0f -meta.nodeName \uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f1a\u4f7f\u7528\u7cfb\u7edf\u7684hostname\uff0c\u5728Kubernetes\u90e8\u7f72\u4e2d\u4f1a\u4f7f\u7528Downward API\u6765\u6ce8\u5165nodeName\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u9700\u8981\u5355\u72ec\u914d\u7f6e","title":"\u7cfb\u7edf\u53c2\u6570"},{"location":"reference/global/args/#_2","text":"-log.level : \u65e5\u5fd7\u7ea7\u522b\uff0c\u9ed8\u8ba4\u4e3ainfo\uff0c\u53ef\u914d\u7f6e\u4e3adebug\u3001info\u3001warn\u548cerror -log.jsonFormat : \u662f\u5426\u5c06\u65e5\u5fd7\u8f93\u51fa\u4e3ajson\u683c\u5f0f\uff0c\u9ed8\u8ba4\u4e3afalse -log.enableStdout : \u662f\u5426\u8f93\u51fa\u6807\u51c6\u8f93\u51fa\u65e5\u5fd7\uff0c\u9ed8\u8ba4\u4e3atrue -log.enableFile : \u662f\u5426\u8f93\u51fa\u65e5\u5fd7\u6587\u4ef6\uff0c\u9ed8\u8ba4\u4e3afalse\uff0c\u5373\u4e0d\u8f93\u51fa\u65e5\u5fd7\u6587\u4ef6\uff0c\u9ed8\u8ba4\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa -log.directory : \u65e5\u5fd7\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u9ed8\u8ba4\u4e3a/var/log\uff0c\u5f53log.enableFile=true\u65f6\u751f\u6548 -log.filename : \u65e5\u5fd7\u6587\u4ef6\u7684\u540d\u79f0\uff0c\u9ed8\u8ba4\u4e3aloggie.log\uff0c\u4e00\u822c\u540clog.directory\u642d\u914d\u4f7f\u7528 -log.maxSize : \u65e5\u5fd7\u8f6e\u8f6c\u7684\u65f6\u5019\uff0c\u6700\u5927\u7684\u6587\u4ef6\u5927\u5c0f\uff0c\u9ed8\u8ba4\u4e3a1024MB -log.maxBackups : \u65e5\u5fd7\u8f6e\u8f6c\u6700\u591a\u4fdd\u7559\u7684\u6587\u4ef6\u4e2a\u6570\uff0c\u9ed8\u8ba4\u4e3a3 -log.maxAge : \u65e5\u5fd7\u8f6e\u8f6c\u6700\u5927\u4fdd\u7559\u7684\u5929\u6570\uff0c\u9ed8\u8ba4\u4e3a7 -log.timeFormat : \u6bcf\u884c\u65e5\u5fd7\u8f93\u51fa\u7684\u65f6\u95f4\u683c\u5f0f\uff0c\u9ed8\u8ba4\u683c\u5f0f\u4e3a 2006-01-02 15:04:05 -log.noColor : \u8f93\u51fa\u662f\u5426\u6709\u989c\u8272\u7f8e\u5316\uff0c\u9ed8\u8ba4\u4e3afalse\uff0c\u5373\u6709\u989c\u8272\u7f8e\u5316\uff0c\u5bf9\u4e8e\u4ece\u6807\u51c6\u8f93\u51fa\u67e5\u770b\u65e5\u5fd7\u6bd4\u8f83\u65b9\u4fbf\u3002\u5982\u679c\u8f93\u51fa\u5230\u65e5\u5fd7\u6587\u4ef6\u4e2d\uff0c\u5efa\u8bae\u8bbe\u7f6e\u4e3atrue\uff0c\u907f\u514d\u5f15\u5165\u989d\u5916\u7684\u683c\u5f0f\u3002 Info Loggie\u7684\u65e5\u5fd7\u8f6e\u8f6c\u4f7f\u7528 lumberjack \u5e93","title":"\u65e5\u5fd7\u53c2\u6570:"},{"location":"reference/global/defaults/","text":"Defaults \u00b6 defaults\u7528\u4e8e\u8bbe\u7f6ePipelines\u914d\u7f6e\u4e2d\u7684\u9ed8\u8ba4\u503c\u3002\u5f53Pipeline\u4e2d\u6ca1\u6709\u8bbe\u7f6e\u503c\u65f6\u751f\u6548\uff0c\u6216\u8005\u7528\u4e8e\u8986\u76d6\u9ed8\u8ba4\u7684\u53c2\u6570\u3002 Example defaults : sources : - type : file watcher : cleanFiles : maxHistory : 10 sink : type : dev printEvents : true sources \u00b6 \u548cPipeline\u4e2d\u7684source\u4e00\u81f4\u3002\u5f53Pipelines\u914d\u7f6e\u4e86\u76f8\u540ctype\u7684source\u65f6\uff0c\u4f1a\u8986\u76d6\u5176\u4e2d\u672a\u586b\u5199\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u3002 \u6bd4\u5982: sources : - type : file watcher : cleanFiles : maxHistory : 10 \u5982\u679cPipeline\u914d\u7f6e\u4e86file source\uff0c\u6b64\u65f6\u53ef\u4ee5\u8bbe\u7f6e\u5168\u5c40\u7684\u6587\u4ef6\u6e05\u7406\u4fdd\u7559\u5929\u6570\u4e3a10\u5929\uff0c\u800c\u4e0d\u9700\u8981\u5728\u6bcf\u4e2aPipeline\u7684file source\u4e2d\u90fd\u8bbe\u7f6e\u4e00\u904d\u3002 sink \u00b6 \u548cPipeline\u4e2d\u7684sink\u4e00\u81f4\uff0c\u5982\u679c\u96c6\u7fa4\u53ea\u9700\u8981\u8bbe\u7f6e\u4e00\u4e2a\u5168\u5c40\u7684sink\u8f93\u51fa\u6e90\uff0c\u5219\u53ea\u9700\u8981\u5728\u8fd9\u91cc\u914d\u7f6e\u4e00\u6b21\uff0c\u907f\u514d\u5728\u6bcf\u4e2aPipeline\u4e2d\u586b\u5199\u3002 interceptors \u00b6 defaults\u4e2d\u914d\u7f6e\u7684interceptors\u4f1a\u6dfb\u52a0\u5230pipeline\u4e2d\u5b9a\u4e49\u7684interceptors\u4e2d\uff0c\u4f46pipeline\u4e2d\u7684interceptor\u4f1a\u8986\u76d6defaults\u4e2d\u7684\u540c\u4e00\u4e2atype\u7684interceptor\u3002 \u5982\u679c\u4e0d\u5e0c\u671b\u8986\u76d6\u76f8\u540c\u7c7b\u578b\u7684interceptor\uff0c\u800c\u662f\u6dfb\u52a0\u76f8\u540ctype\u7684interceptor\uff0c\u4f9d\u6b21\u8fdb\u884c\u5904\u7406\uff0c\u9700\u8981\u989d\u5916\u586b\u5199name\u5b57\u6bb5\uff0c\u8fdb\u884c\u552f\u4e00\u6027\u6807\u8bc6\u3002 \u5728defaults\u4e2d\u5df2\u7ecf\u5b9a\u4e49normalize interceptor\u5982\u4e0b: defaults : interceptors : - type : normalize processor : - addMeta : ~ \u5982\u679c\u5728pipelines\u4e2d\u5b9a\u4e49\u5982\u4e0bnormalize interceptor\uff1a pipelines : interceptors : - type : normalize processor : - drop : ... \u6b64\u65f6defaults\u4e2d\u7684normalize interceptor\u4f1a\u88ab\u8986\u76d6\uff0c\u4e0d\u4f1a\u751f\u6548\u3002 \u5982\u679c\u6211\u4eec\u5e0c\u671b\u5148\u6267\u884cdefaults\u4e2d\u7684normalize interceptor\uff0c\u63a5\u7740\u518d\u6267\u884cpipeline\u4e2d\u7684normalize interceptor\uff0c\u53ef\u4ee5\u5728defaults\u4e2d\u6539\u4e3a\uff1a defaults : interceptors : - type : normalize name : global # \u7528\u4e8e\u533a\u5206pipelines\u4e2d\u7684normalize order : 500 # \u9ed8\u8ba4normalize\u7684order\u503c\u4e3a900\uff0c\u8fd9\u91cc\u5b9a\u4e49\u4e00\u4e2a\u76f8\u5bf9\u8f83\u5c0f\u503c\uff0c\u53ef\u63a7\u5236\u5148\u6267\u884cdefaults\u4e2d\u7684normalize processor : - addMeta : ~ Loggie\u4f1a\u9ed8\u8ba4\u8bbe\u7f6e metric \u3001 maxbytes \u3001 retry 3\u4e2a\u7cfb\u7edf\u5185\u7f6einterceptors\u3002 \u5982\u679c\u9700\u8981\u6dfb\u52a0\u5176\u4ed6\u7684\u9ed8\u8ba4interceptors\uff0c\u4f1a\u8986\u76d6\u6389\u4ee5\u4e0a\u7684\u5185\u7f6einterceptors\uff0c\u6240\u4ee5\u5f3a\u70c8\u5efa\u8bae\u6b64\u65f6\u5c06\u5185\u7f6einterceptors\u52a0\u4e0a\uff0c\u9664\u975e\u4f60\u786e\u8ba4\u4e0d\u9700\u8981\u4ee5\u4e0a\u7cfb\u7edf\u5185\u7f6e\u7684interceptors\u3002 queue \u00b6 \u9ed8\u8ba4\u4e3achannel queue\u3002","title":"defaults"},{"location":"reference/global/defaults/#defaults","text":"defaults\u7528\u4e8e\u8bbe\u7f6ePipelines\u914d\u7f6e\u4e2d\u7684\u9ed8\u8ba4\u503c\u3002\u5f53Pipeline\u4e2d\u6ca1\u6709\u8bbe\u7f6e\u503c\u65f6\u751f\u6548\uff0c\u6216\u8005\u7528\u4e8e\u8986\u76d6\u9ed8\u8ba4\u7684\u53c2\u6570\u3002 Example defaults : sources : - type : file watcher : cleanFiles : maxHistory : 10 sink : type : dev printEvents : true","title":"Defaults"},{"location":"reference/global/defaults/#sources","text":"\u548cPipeline\u4e2d\u7684source\u4e00\u81f4\u3002\u5f53Pipelines\u914d\u7f6e\u4e86\u76f8\u540ctype\u7684source\u65f6\uff0c\u4f1a\u8986\u76d6\u5176\u4e2d\u672a\u586b\u5199\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u3002 \u6bd4\u5982: sources : - type : file watcher : cleanFiles : maxHistory : 10 \u5982\u679cPipeline\u914d\u7f6e\u4e86file source\uff0c\u6b64\u65f6\u53ef\u4ee5\u8bbe\u7f6e\u5168\u5c40\u7684\u6587\u4ef6\u6e05\u7406\u4fdd\u7559\u5929\u6570\u4e3a10\u5929\uff0c\u800c\u4e0d\u9700\u8981\u5728\u6bcf\u4e2aPipeline\u7684file source\u4e2d\u90fd\u8bbe\u7f6e\u4e00\u904d\u3002","title":"sources"},{"location":"reference/global/defaults/#sink","text":"\u548cPipeline\u4e2d\u7684sink\u4e00\u81f4\uff0c\u5982\u679c\u96c6\u7fa4\u53ea\u9700\u8981\u8bbe\u7f6e\u4e00\u4e2a\u5168\u5c40\u7684sink\u8f93\u51fa\u6e90\uff0c\u5219\u53ea\u9700\u8981\u5728\u8fd9\u91cc\u914d\u7f6e\u4e00\u6b21\uff0c\u907f\u514d\u5728\u6bcf\u4e2aPipeline\u4e2d\u586b\u5199\u3002","title":"sink"},{"location":"reference/global/defaults/#interceptors","text":"defaults\u4e2d\u914d\u7f6e\u7684interceptors\u4f1a\u6dfb\u52a0\u5230pipeline\u4e2d\u5b9a\u4e49\u7684interceptors\u4e2d\uff0c\u4f46pipeline\u4e2d\u7684interceptor\u4f1a\u8986\u76d6defaults\u4e2d\u7684\u540c\u4e00\u4e2atype\u7684interceptor\u3002 \u5982\u679c\u4e0d\u5e0c\u671b\u8986\u76d6\u76f8\u540c\u7c7b\u578b\u7684interceptor\uff0c\u800c\u662f\u6dfb\u52a0\u76f8\u540ctype\u7684interceptor\uff0c\u4f9d\u6b21\u8fdb\u884c\u5904\u7406\uff0c\u9700\u8981\u989d\u5916\u586b\u5199name\u5b57\u6bb5\uff0c\u8fdb\u884c\u552f\u4e00\u6027\u6807\u8bc6\u3002 \u5728defaults\u4e2d\u5df2\u7ecf\u5b9a\u4e49normalize interceptor\u5982\u4e0b: defaults : interceptors : - type : normalize processor : - addMeta : ~ \u5982\u679c\u5728pipelines\u4e2d\u5b9a\u4e49\u5982\u4e0bnormalize interceptor\uff1a pipelines : interceptors : - type : normalize processor : - drop : ... \u6b64\u65f6defaults\u4e2d\u7684normalize interceptor\u4f1a\u88ab\u8986\u76d6\uff0c\u4e0d\u4f1a\u751f\u6548\u3002 \u5982\u679c\u6211\u4eec\u5e0c\u671b\u5148\u6267\u884cdefaults\u4e2d\u7684normalize interceptor\uff0c\u63a5\u7740\u518d\u6267\u884cpipeline\u4e2d\u7684normalize interceptor\uff0c\u53ef\u4ee5\u5728defaults\u4e2d\u6539\u4e3a\uff1a defaults : interceptors : - type : normalize name : global # \u7528\u4e8e\u533a\u5206pipelines\u4e2d\u7684normalize order : 500 # \u9ed8\u8ba4normalize\u7684order\u503c\u4e3a900\uff0c\u8fd9\u91cc\u5b9a\u4e49\u4e00\u4e2a\u76f8\u5bf9\u8f83\u5c0f\u503c\uff0c\u53ef\u63a7\u5236\u5148\u6267\u884cdefaults\u4e2d\u7684normalize processor : - addMeta : ~ Loggie\u4f1a\u9ed8\u8ba4\u8bbe\u7f6e metric \u3001 maxbytes \u3001 retry 3\u4e2a\u7cfb\u7edf\u5185\u7f6einterceptors\u3002 \u5982\u679c\u9700\u8981\u6dfb\u52a0\u5176\u4ed6\u7684\u9ed8\u8ba4interceptors\uff0c\u4f1a\u8986\u76d6\u6389\u4ee5\u4e0a\u7684\u5185\u7f6einterceptors\uff0c\u6240\u4ee5\u5f3a\u70c8\u5efa\u8bae\u6b64\u65f6\u5c06\u5185\u7f6einterceptors\u52a0\u4e0a\uff0c\u9664\u975e\u4f60\u786e\u8ba4\u4e0d\u9700\u8981\u4ee5\u4e0a\u7cfb\u7edf\u5185\u7f6e\u7684interceptors\u3002","title":"interceptors"},{"location":"reference/global/defaults/#queue","text":"\u9ed8\u8ba4\u4e3achannel queue\u3002","title":"queue"},{"location":"reference/global/discovery/","text":"Discovery \u00b6 Example discovery : enabled : true kubernetes : cluster : aggregator containerRuntime : containerd k8sFields : logconfig : \"${_k8s.logconfig}\" namespace : \"${_k8s.pod.namespace}\" nodename : \"${_k8s.node.name}\" podname : \"${_k8s.pod.name}\" containername : \"${_k8s.pod.container.name}\" enabled \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 enabled bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542f\u670d\u52a1\u53d1\u73b0\u914d\u7f6e\u4e0b\u53d1\u6a21\u5757 Kubernetes \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 cluster string \u975e\u5fc5\u586b \"\" \u6807\u8bc6Loggie\u96c6\u7fa4\u540d\u79f0\u3002Loggie\u652f\u6301\u5728\u4e00\u4e2aKubernetes\u96c6\u7fa4\u4e2d\u90e8\u7f72\u591a\u5957Loggie\uff0c\u53ef\u4ee5\u901a\u8fc7\u5728LogConfig CRD\u4e2d\u6307\u5b9a selector.cluster \uff0c\u6307\u5b9a\u914d\u7f6e\u4e0b\u53d1\u7684Loggie\u96c6\u7fa4 kubeconfig string \u975e\u5fc5\u586b \u6307\u5b9a\u8bf7\u6c42Kubernetes\u96c6\u7fa4API\u7684kubeconfig\u6587\u4ef6\u3002\u901a\u5e38\u5728Loggie\u90e8\u7f72\u5230Kubernetes\u96c6\u7fa4\u4e2d\u65e0\u9700\u586b\u5199\uff0c\u6b64\u65f6\u4e3ainCluster\u6a21\u5f0f\u3002\u5982\u679cLoggie\u90e8\u7f72\u5728Kubernetes\u96c6\u7fa4\u5916\uff08\u4f8b\u5982\u672c\u5730\u8c03\u8bd5\u65f6\uff09\uff0c\u9700\u8981\u6307\u5b9a\u8be5kubeconfig\u6587\u4ef6\u3002 master string \u975e\u5fc5\u586b \u6307\u5b9a\u8bf7\u6c42Kubernetes\u96c6\u7fa4API\u7684master\u5730\u5740\uff0cinCluster\u6a21\u5f0f\u4e00\u822c\u65e0\u9700\u586b\u5199 containerRuntime string \u975e\u5fc5\u586b docker \u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u53ef\u9009 docker \u548c containerd rootFsCollectionEnabled bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542f\u91c7\u96c6root filesystem\u91cc\u7684\u65e5\u5fd7\uff0c\u7528\u4e8e\u4e0d\u6302\u8f7d\u65e5\u5fd7volume\u7684\u573a\u666f parseStdout bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542f\u81ea\u52a8\u63d0\u53d6\u5bb9\u5668\u6807\u51c6\u8f93\u51fa\u539f\u59cb\u5185\u5bb9 kubeletRootDir string \u975e\u5fc5\u586b /var/lib/kubelet kubelet\u7684root\u8def\u5f84 podLogDirPrefix string \u975e\u5fc5\u586b /var/log/pods kubernetes\u9ed8\u8ba4\u653e\u7f6e\u7684pod\u6807\u51c6\u8f93\u51fa\u8def\u5f84 k8sFields map \u975e\u5fc5\u586b \u81ea\u52a8\u6dfb\u52a0\u7684kubernetes\u76f8\u5173\u5143\u4fe1\u606f\uff0ckey\u5373\u4e3a\u6dfb\u52a0\u7684\u5143\u4fe1\u606fkey\uff0cvalue\u8bf7\u4f7f\u7528${_k8s.XX}\u7684\u65b9\u5f0f\u6307\u5b9a \"${_k8s.XX}\"\u7684\u65b9\u5f0f\u53ef\u586b\u5199\u4ee5\u4e0b\u53c2\u6570\uff1a \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 ${_k8s.node.name} string \u975e\u5fc5\u586b node.name \u6dfb\u52a0\u6240\u5728\u8282\u70b9node name\u4f5c\u4e3a\u5143\u4fe1\u606f ${_k8s.node.ip} string \u975e\u5fc5\u586b node.ip \u6dfb\u52a0\u6240\u5728\u8282\u70b9node ip\u4f5c\u4e3a\u5143\u4fe1\u606f ${_k8s.pod.namespace} string \u975e\u5fc5\u586b namespace \u6dfb\u52a0namespace\u4f5c\u4e3a\u5143\u4fe1\u606f ${_k8s.logconfig} string \u975e\u5fc5\u586b logConfig \u6dfb\u52a0logConfig name\u4f5c\u4e3a\u5143\u4fe1\u606f ${_k8s.pod.name} string \u975e\u5fc5\u586b pod.name \u6dfb\u52a0pod name\u4f5c\u4e3a\u5143\u4fe1\u606f ${_k8s.pod.ip} string \u975e\u5fc5\u586b pod.ip \u6dfb\u52a0pod ip\u4f5c\u4e3a\u5143\u4fe1\u606f ${_k8s.pod.container.name} string \u975e\u5fc5\u586b container.name \u6dfb\u52a0container name\u4f5c\u4e3a\u5143\u4fe1\u606f","title":"discovery"},{"location":"reference/global/discovery/#discovery","text":"Example discovery : enabled : true kubernetes : cluster : aggregator containerRuntime : containerd k8sFields : logconfig : \"${_k8s.logconfig}\" namespace : \"${_k8s.pod.namespace}\" nodename : \"${_k8s.node.name}\" podname : \"${_k8s.pod.name}\" containername : \"${_k8s.pod.container.name}\"","title":"Discovery"},{"location":"reference/global/discovery/#enabled","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 enabled bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542f\u670d\u52a1\u53d1\u73b0\u914d\u7f6e\u4e0b\u53d1\u6a21\u5757","title":"enabled"},{"location":"reference/global/discovery/#kubernetes","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 cluster string \u975e\u5fc5\u586b \"\" \u6807\u8bc6Loggie\u96c6\u7fa4\u540d\u79f0\u3002Loggie\u652f\u6301\u5728\u4e00\u4e2aKubernetes\u96c6\u7fa4\u4e2d\u90e8\u7f72\u591a\u5957Loggie\uff0c\u53ef\u4ee5\u901a\u8fc7\u5728LogConfig CRD\u4e2d\u6307\u5b9a selector.cluster \uff0c\u6307\u5b9a\u914d\u7f6e\u4e0b\u53d1\u7684Loggie\u96c6\u7fa4 kubeconfig string \u975e\u5fc5\u586b \u6307\u5b9a\u8bf7\u6c42Kubernetes\u96c6\u7fa4API\u7684kubeconfig\u6587\u4ef6\u3002\u901a\u5e38\u5728Loggie\u90e8\u7f72\u5230Kubernetes\u96c6\u7fa4\u4e2d\u65e0\u9700\u586b\u5199\uff0c\u6b64\u65f6\u4e3ainCluster\u6a21\u5f0f\u3002\u5982\u679cLoggie\u90e8\u7f72\u5728Kubernetes\u96c6\u7fa4\u5916\uff08\u4f8b\u5982\u672c\u5730\u8c03\u8bd5\u65f6\uff09\uff0c\u9700\u8981\u6307\u5b9a\u8be5kubeconfig\u6587\u4ef6\u3002 master string \u975e\u5fc5\u586b \u6307\u5b9a\u8bf7\u6c42Kubernetes\u96c6\u7fa4API\u7684master\u5730\u5740\uff0cinCluster\u6a21\u5f0f\u4e00\u822c\u65e0\u9700\u586b\u5199 containerRuntime string \u975e\u5fc5\u586b docker \u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u53ef\u9009 docker \u548c containerd rootFsCollectionEnabled bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542f\u91c7\u96c6root filesystem\u91cc\u7684\u65e5\u5fd7\uff0c\u7528\u4e8e\u4e0d\u6302\u8f7d\u65e5\u5fd7volume\u7684\u573a\u666f parseStdout bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542f\u81ea\u52a8\u63d0\u53d6\u5bb9\u5668\u6807\u51c6\u8f93\u51fa\u539f\u59cb\u5185\u5bb9 kubeletRootDir string \u975e\u5fc5\u586b /var/lib/kubelet kubelet\u7684root\u8def\u5f84 podLogDirPrefix string \u975e\u5fc5\u586b /var/log/pods kubernetes\u9ed8\u8ba4\u653e\u7f6e\u7684pod\u6807\u51c6\u8f93\u51fa\u8def\u5f84 k8sFields map \u975e\u5fc5\u586b \u81ea\u52a8\u6dfb\u52a0\u7684kubernetes\u76f8\u5173\u5143\u4fe1\u606f\uff0ckey\u5373\u4e3a\u6dfb\u52a0\u7684\u5143\u4fe1\u606fkey\uff0cvalue\u8bf7\u4f7f\u7528${_k8s.XX}\u7684\u65b9\u5f0f\u6307\u5b9a \"${_k8s.XX}\"\u7684\u65b9\u5f0f\u53ef\u586b\u5199\u4ee5\u4e0b\u53c2\u6570\uff1a \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 ${_k8s.node.name} string \u975e\u5fc5\u586b node.name \u6dfb\u52a0\u6240\u5728\u8282\u70b9node name\u4f5c\u4e3a\u5143\u4fe1\u606f ${_k8s.node.ip} string \u975e\u5fc5\u586b node.ip \u6dfb\u52a0\u6240\u5728\u8282\u70b9node ip\u4f5c\u4e3a\u5143\u4fe1\u606f ${_k8s.pod.namespace} string \u975e\u5fc5\u586b namespace \u6dfb\u52a0namespace\u4f5c\u4e3a\u5143\u4fe1\u606f ${_k8s.logconfig} string \u975e\u5fc5\u586b logConfig \u6dfb\u52a0logConfig name\u4f5c\u4e3a\u5143\u4fe1\u606f ${_k8s.pod.name} string \u975e\u5fc5\u586b pod.name \u6dfb\u52a0pod name\u4f5c\u4e3a\u5143\u4fe1\u606f ${_k8s.pod.ip} string \u975e\u5fc5\u586b pod.ip \u6dfb\u52a0pod ip\u4f5c\u4e3a\u5143\u4fe1\u606f ${_k8s.pod.container.name} string \u975e\u5fc5\u586b container.name \u6dfb\u52a0container name\u4f5c\u4e3a\u5143\u4fe1\u606f","title":"Kubernetes"},{"location":"reference/global/http/","text":"Http \u00b6 Loggie\u81ea\u8eab\u63d0\u4f9b\u7684Http\u7aef\u53e3\uff0c\u5305\u542b\u76d1\u63a7metrics\uff0c\u5185\u90e8\u8fd0\u7ef4\u7b49\u63a5\u53e3\u3002 Example http : enabled : true host : \"0.0.0.0\" port : 9196 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 enabled bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542fhttp host string \u975e\u5fc5\u586b 0.0.0.0 http\u76d1\u542c\u7684host port http \u975e\u5fc5\u586b 9196 http\u76d1\u63a7\u7684\u7aef\u53e3 Tips \u4e00\u822c\u63a8\u8350\u6253\u5f00http\u7aef\u53e3\uff0c\u4f46\u662f\u5982\u679cKubernetes\u6216\u8005\u5bb9\u5668\u90e8\u7f72\u65f6\uff0c\u4f7f\u7528hostNetwork\u8bf7\u6ce8\u610f\u7aef\u53e3\u51b2\u7a81\uff0c\u4ee5\u53ca\u76d1\u542chost\u662f\u5426\u66b4\u9732\u7ed9\u516c\u7f51\u3001\u662f\u5426\u6709\u5b89\u5168\u9690\u60a3\u3002","title":"http"},{"location":"reference/global/http/#http","text":"Loggie\u81ea\u8eab\u63d0\u4f9b\u7684Http\u7aef\u53e3\uff0c\u5305\u542b\u76d1\u63a7metrics\uff0c\u5185\u90e8\u8fd0\u7ef4\u7b49\u63a5\u53e3\u3002 Example http : enabled : true host : \"0.0.0.0\" port : 9196 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 enabled bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542fhttp host string \u975e\u5fc5\u586b 0.0.0.0 http\u76d1\u542c\u7684host port http \u975e\u5fc5\u586b 9196 http\u76d1\u63a7\u7684\u7aef\u53e3 Tips \u4e00\u822c\u63a8\u8350\u6253\u5f00http\u7aef\u53e3\uff0c\u4f46\u662f\u5982\u679cKubernetes\u6216\u8005\u5bb9\u5668\u90e8\u7f72\u65f6\uff0c\u4f7f\u7528hostNetwork\u8bf7\u6ce8\u610f\u7aef\u53e3\u51b2\u7a81\uff0c\u4ee5\u53ca\u76d1\u542chost\u662f\u5426\u66b4\u9732\u7ed9\u516c\u7f51\u3001\u662f\u5426\u6709\u5b89\u5168\u9690\u60a3\u3002","title":"Http"},{"location":"reference/global/monitor/","text":"Monitor \u00b6 \u76d1\u63a7\u4e8b\u4ef6\u603b\u7ebf\uff0c\u6240\u6709\u7684\u7ec4\u4ef6\u90fd\u53ef\u4ee5\u53d1\u51fa\u81ea\u5df1\u7684metrics\u6307\u6807\u6570\u636e\uff0c\u7531listeners\u6d88\u8d39\u5904\u7406\u3002 \u5177\u4f53\u8bf7\u53c2\u8003 \u8fd9\u91cc \u3002 Example monitor : logger : period : 30s enabled : true listeners : filesource : ~ filewatcher : ~ reload : ~ sink : ~","title":"monitor"},{"location":"reference/global/monitor/#monitor","text":"\u76d1\u63a7\u4e8b\u4ef6\u603b\u7ebf\uff0c\u6240\u6709\u7684\u7ec4\u4ef6\u90fd\u53ef\u4ee5\u53d1\u51fa\u81ea\u5df1\u7684metrics\u6307\u6807\u6570\u636e\uff0c\u7531listeners\u6d88\u8d39\u5904\u7406\u3002 \u5177\u4f53\u8bf7\u53c2\u8003 \u8fd9\u91cc \u3002 Example monitor : logger : period : 30s enabled : true listeners : filesource : ~ filewatcher : ~ reload : ~ sink : ~","title":"Monitor"},{"location":"reference/global/reload/","text":"Reload \u00b6 reload\u4f1a\u5b9a\u65f6\u68c0\u67e5\u542f\u52a8\u53c2\u6570 -config.pipeline \u6307\u5b9a\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5982\u679c\u68c0\u6d4b\u5230\u6587\u4ef6\u5185\u5bb9\u53d1\u751f\u53d8\u52a8\uff0c\u4f1a\u91cd\u542f\u6709\u53d8\u52a8\u914d\u7f6e\u7684Pipeline\uff0c\u672a\u88ab\u4fee\u6539\u7684Pipeline\u4e0d\u4f1a\u53d7\u5f71\u54cd\u3002 Example reload : enabled : true period : 10s \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 enabled bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542freload period time.Duration \u975e\u5fc5\u586b 10s reload\u68c0\u6d4b\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\uff0c\u4e0d\u5efa\u8bae\u8bbe\u7f6e\u8fc7\u77ed\uff0c\u5426\u5219\u53ef\u80fd\u4f1a\u589e\u52a0CPU\u7684\u6d88\u8017","title":"reload"},{"location":"reference/global/reload/#reload","text":"reload\u4f1a\u5b9a\u65f6\u68c0\u67e5\u542f\u52a8\u53c2\u6570 -config.pipeline \u6307\u5b9a\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5982\u679c\u68c0\u6d4b\u5230\u6587\u4ef6\u5185\u5bb9\u53d1\u751f\u53d8\u52a8\uff0c\u4f1a\u91cd\u542f\u6709\u53d8\u52a8\u914d\u7f6e\u7684Pipeline\uff0c\u672a\u88ab\u4fee\u6539\u7684Pipeline\u4e0d\u4f1a\u53d7\u5f71\u54cd\u3002 Example reload : enabled : true period : 10s \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 enabled bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542freload period time.Duration \u975e\u5fc5\u586b 10s reload\u68c0\u6d4b\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\uff0c\u4e0d\u5efa\u8bae\u8bbe\u7f6e\u8fc7\u77ed\uff0c\u5426\u5219\u53ef\u80fd\u4f1a\u589e\u52a0CPU\u7684\u6d88\u8017","title":"Reload"},{"location":"reference/monitor/filesource/","text":"filesource listener \u00b6 \u5b9e\u65f6\u6587\u4ef6\u91c7\u96c6\u7684\u76d1\u63a7\uff0c\u8868\u793a\u5f53\u524d\u65e5\u5fd7\u91c7\u96c6\u7684\u8fdb\u5ea6\u4e0e\u72b6\u6001\uff0c\u5305\u62ec\u6587\u4ef6\u7684\u540d\u79f0\u3001\u91c7\u96c6\u8fdb\u5ea6\u3001QPS\u7b49\u3002 \u914d\u7f6e \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 period time.Duration \u975e\u5fc5\u586b 10s listener\u6d88\u8d39\u5904\u7406\u6570\u636e\u7684\u65f6\u95f4\u95f4\u9694 Metrics \u00b6 LABELS: pipeline: \u8868\u793a\u6240\u5728\u7684pipeline\u540d\u79f0 source: \u8868\u793a\u6240\u5728\u7684source\u540d\u79f0 filename: \u8868\u793a\u6587\u4ef6\u540d file_size \u00b6 # HELP file size # TYPE loggie_filesource_file_size gauge loggie_filesource_file_size{pipeline=\"xxx\", source=\"access\", filename=\"/var/log/a.log\"} 2048 HELP: \u8868\u793a\u5f53\u524d\u67d0\u4e2a\u65e5\u5fd7\u6587\u4ef6\u88ab\u91c7\u96c6\u65f6\u7684\u6587\u4ef6\u5927\u5c0f TYPE: gauge file_offset \u00b6 # HELP file offset # TYPE loggie_filesource_file_offset gauge loggie_filesource_file_offset{pipeline=\"xxx\", source=\"access\", filename=\"/var/log/a.log\"} 1024 HELP: \u8868\u793a\u5f53\u524d\u67d0\u4e2a\u65e5\u5fd7\u6587\u4ef6\u88ab\u91c7\u96c6\u7684\u8fdb\u5ea6\uff0c\u5f53\u524d\u8bfb\u53d6\u6587\u4ef6\u7684offset TYPE: gauge line_number \u00b6 # HELP current read line number # TYPE loggie_filesource_line_number gauge loggie_filesource_line_number{pipeline=\"xxx\", source=\"access\", filename=\"/var/log/a.log\"} 20 HELP: \u8868\u793a\u5f53\u524d\u67d0\u4e2a\u65e5\u5fd7\u6587\u4ef6\u88ab\u91c7\u96c6\u65f6\u7684\u5f53\u524d\u8bfb\u53d6\u7684\u884c\u6570 TYPE: gauge line_qps \u00b6 # HELP current read line qps # TYPE loggie_filesource_line_qps gauge loggie_filesource_line_qps{pipeline=\"xxx\", source=\"access\", filename=\"/var/log/a.log\"} 48 HELP: \u8868\u793a\u5f53\u524d\u67d0\u4e2a\u65e5\u5fd7\u6587\u4ef6\u88ab\u91c7\u96c6\u65f6\u6bcf\u79d2\u8bfb\u53d6\u7684\u884c\u6570 TYPE: gauge","title":"filesource"},{"location":"reference/monitor/filesource/#filesource-listener","text":"\u5b9e\u65f6\u6587\u4ef6\u91c7\u96c6\u7684\u76d1\u63a7\uff0c\u8868\u793a\u5f53\u524d\u65e5\u5fd7\u91c7\u96c6\u7684\u8fdb\u5ea6\u4e0e\u72b6\u6001\uff0c\u5305\u62ec\u6587\u4ef6\u7684\u540d\u79f0\u3001\u91c7\u96c6\u8fdb\u5ea6\u3001QPS\u7b49\u3002","title":"filesource listener"},{"location":"reference/monitor/filesource/#_1","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 period time.Duration \u975e\u5fc5\u586b 10s listener\u6d88\u8d39\u5904\u7406\u6570\u636e\u7684\u65f6\u95f4\u95f4\u9694","title":"\u914d\u7f6e"},{"location":"reference/monitor/filesource/#metrics","text":"LABELS: pipeline: \u8868\u793a\u6240\u5728\u7684pipeline\u540d\u79f0 source: \u8868\u793a\u6240\u5728\u7684source\u540d\u79f0 filename: \u8868\u793a\u6587\u4ef6\u540d","title":"Metrics"},{"location":"reference/monitor/filesource/#file_size","text":"# HELP file size # TYPE loggie_filesource_file_size gauge loggie_filesource_file_size{pipeline=\"xxx\", source=\"access\", filename=\"/var/log/a.log\"} 2048 HELP: \u8868\u793a\u5f53\u524d\u67d0\u4e2a\u65e5\u5fd7\u6587\u4ef6\u88ab\u91c7\u96c6\u65f6\u7684\u6587\u4ef6\u5927\u5c0f TYPE: gauge","title":"file_size"},{"location":"reference/monitor/filesource/#file_offset","text":"# HELP file offset # TYPE loggie_filesource_file_offset gauge loggie_filesource_file_offset{pipeline=\"xxx\", source=\"access\", filename=\"/var/log/a.log\"} 1024 HELP: \u8868\u793a\u5f53\u524d\u67d0\u4e2a\u65e5\u5fd7\u6587\u4ef6\u88ab\u91c7\u96c6\u7684\u8fdb\u5ea6\uff0c\u5f53\u524d\u8bfb\u53d6\u6587\u4ef6\u7684offset TYPE: gauge","title":"file_offset"},{"location":"reference/monitor/filesource/#line_number","text":"# HELP current read line number # TYPE loggie_filesource_line_number gauge loggie_filesource_line_number{pipeline=\"xxx\", source=\"access\", filename=\"/var/log/a.log\"} 20 HELP: \u8868\u793a\u5f53\u524d\u67d0\u4e2a\u65e5\u5fd7\u6587\u4ef6\u88ab\u91c7\u96c6\u65f6\u7684\u5f53\u524d\u8bfb\u53d6\u7684\u884c\u6570 TYPE: gauge","title":"line_number"},{"location":"reference/monitor/filesource/#line_qps","text":"# HELP current read line qps # TYPE loggie_filesource_line_qps gauge loggie_filesource_line_qps{pipeline=\"xxx\", source=\"access\", filename=\"/var/log/a.log\"} 48 HELP: \u8868\u793a\u5f53\u524d\u67d0\u4e2a\u65e5\u5fd7\u6587\u4ef6\u88ab\u91c7\u96c6\u65f6\u6bcf\u79d2\u8bfb\u53d6\u7684\u884c\u6570 TYPE: gauge","title":"line_qps"},{"location":"reference/monitor/filewatcher/","text":"filewatcher listener \u00b6 \u5bf9\u6587\u4ef6\u91c7\u96c6\u60c5\u51b5\u7684\u5b9a\u65f6\u68c0\u67e5\u5e76\u66b4\u9732\u6307\u6807\uff0c\u5305\u62ec\u6587\u4ef6\u540d\u79f0\u3001ackOffset\u3001\u4fee\u6539\u65f6\u95f4\u3001\u5927\u5c0f\u7b49\u3002 \u914d\u7f6e \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 period time.Duration \u975e\u5fc5\u586b 5m \u5b9a\u65f6\u68c0\u67e5\u95f4\u9694\u65f6\u95f4 checkUnFinishedTimeout time.Duration \u975e\u5fc5\u586b 24h \u68c0\u67e5\u6587\u4ef6\u662f\u5426\u91c7\u96c6\u5b8c\u6bd5\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u5982\u679c\u68c0\u6d4b\u5230\u6587\u4ef6\u7684\u6700\u8fd1\u4fee\u6539\u65f6\u95f4\u4e3a checkUnFinishedTimeout \u4e4b\u524d\uff0c\u540c\u65f6\u6587\u4ef6\u7684\u5e76\u672a\u91c7\u96c6\u5b8c\u6bd5\uff0c\u5219\u4f1a\u5728metrics\u4e2d\u88ab\u6807\u8bb0\u4e3aunfinished\u72b6\u6001\uff0c\u53ef\u7528\u4e8e\u68c0\u67e5\u662f\u5426\u6709\u957f\u65f6\u95f4\u672a\u88ab\u91c7\u96c6\u7684\u65e5\u5fd7\u6587\u4ef6 Metrics \u00b6 \u5168\u5c40\u7ea7\u522b \u00b6 total_file_count \u00b6 # HELP file count total # TYPE loggie_filewatcher_total_file_count gauge loggie_filewatcher_total_file_count{} 20 HELP: \u8868\u793a\u5f53\u524d\u88abLoggie\u68c0\u6d4b\u5230\u6d3b\u8dc3\u7684\u6587\u4ef6\u4e2a\u6570\u603b\u548c TYPE: gauge inactive_file_count \u00b6 # HELP inactive file count # TYPE loggie_filewatcher_inactive_file_count gauge loggie_filewatcher_inactive_file_count{} 20 HELP: \u8868\u793a\u5f53\u524d\u88abLoggie\u68c0\u6d4b\u5230\u7684\u4e0d\u6d3b\u8dc3\u7684\u6587\u4ef6\u4e2a\u6570\u603b\u548c TYPE: gauge \u6587\u4ef6\u7ea7\u522b \u00b6 \u6587\u4ef6\u7ea7\u522b\u5305\u62ec\u4e86\u4ee5\u4e0bprometheus labels: LABELS: pipeline: \u8868\u793a\u6240\u5728\u7684pipeline\u540d\u79f0 source: \u8868\u793a\u6240\u5728\u7684source\u540d\u79f0 filename: \u8868\u793a\u6587\u4ef6\u540d status: \u8868\u793a\u6587\u4ef6\u72b6\u6001\u3002 pending: \u5df2\u88ab\u68c0\u6d4b\u5230\uff0c\u53ef\u80fd\u91c7\u96c6\u4e2d\u6216\u8005\u91c7\u96c6\u5b8c\u6bd5 unfinished: \u6587\u4ef6\u7684modify time\u8ddd\u5f53\u524d\u65f6\u95f4\u5df2\u7ecf\u8d85\u8fc7 checkUnFinishedTimeout \u65f6\u95f4 ignored: \u6587\u4ef6\u88ab\u5ffd\u7565\uff0c\u53ef\u80fd\u8d85\u8fc7 ignore_older \u65f6\u95f4 \u7531\u4e8e\u5b9a\u65f6\u626b\u63cf\u7684\u65f6\u95f4\u95f4\u9694 period \u9ed8\u8ba4\u4e3a5min\uff0c\u4ee5\u4e0b\u6307\u6807\u53ef\u80fd\u5b58\u5728\u4e00\u5b9a\u7a0b\u5ea6\u7684\u5ef6\u8fdf\u3002 file_size \u00b6 # HELP file size # TYPE loggie_filewatcher_file_size gauge loggie_filewatcher_file_size{pipeline=\"xxx\", source=\"access\", filename=\"/var/log/a.log\", status=\"pending\"} 2048 HELP: \u8868\u793a\u8be5\u6587\u4ef6\u7684\u603b\u5927\u5c0f TYPE: gauge file_ack_offset \u00b6 # HELP file ack offset # TYPE loggie_filewatcher_file_ack_offset gauge loggie_filewatcher_file_ack_offset{pipeline=\"xxx\", source=\"access\", filename=\"/var/log/a.log\", status=\"pending\"} 1024 HELP: \u8868\u793a\u8be5\u6587\u4ef6\u88ab\u91c7\u96c6\u540e\uff0c\u5e76\u4e14\u5df2\u7ecf\u63a5\u6536\u5230ack\u7684offset\uff0c\u53ef\u88ab\u7406\u89e3\u4e3a\u5df2\u7ecf\u53d1\u9001\u6210\u529f\u7684\u6587\u4ef6offset\u8fdb\u5ea6 TYPE: gauge file_last_modify \u00b6 # HELP file last modify timestamp # TYPE loggie_filewatcher_file_last_modify gauge loggie_filewatcher_file_last_modify{pipeline=\"xxx\", source=\"access\", filename=\"/var/log/a.log\", status=\"pending\"} 2343214422 HELP: \u6587\u4ef6\u7684\u6700\u65b0\u88ab\u4fee\u6539\u65f6\u95f4 TYPE: gauge","title":"filewatcher"},{"location":"reference/monitor/filewatcher/#filewatcher-listener","text":"\u5bf9\u6587\u4ef6\u91c7\u96c6\u60c5\u51b5\u7684\u5b9a\u65f6\u68c0\u67e5\u5e76\u66b4\u9732\u6307\u6807\uff0c\u5305\u62ec\u6587\u4ef6\u540d\u79f0\u3001ackOffset\u3001\u4fee\u6539\u65f6\u95f4\u3001\u5927\u5c0f\u7b49\u3002","title":"filewatcher listener"},{"location":"reference/monitor/filewatcher/#_1","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 period time.Duration \u975e\u5fc5\u586b 5m \u5b9a\u65f6\u68c0\u67e5\u95f4\u9694\u65f6\u95f4 checkUnFinishedTimeout time.Duration \u975e\u5fc5\u586b 24h \u68c0\u67e5\u6587\u4ef6\u662f\u5426\u91c7\u96c6\u5b8c\u6bd5\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u5982\u679c\u68c0\u6d4b\u5230\u6587\u4ef6\u7684\u6700\u8fd1\u4fee\u6539\u65f6\u95f4\u4e3a checkUnFinishedTimeout \u4e4b\u524d\uff0c\u540c\u65f6\u6587\u4ef6\u7684\u5e76\u672a\u91c7\u96c6\u5b8c\u6bd5\uff0c\u5219\u4f1a\u5728metrics\u4e2d\u88ab\u6807\u8bb0\u4e3aunfinished\u72b6\u6001\uff0c\u53ef\u7528\u4e8e\u68c0\u67e5\u662f\u5426\u6709\u957f\u65f6\u95f4\u672a\u88ab\u91c7\u96c6\u7684\u65e5\u5fd7\u6587\u4ef6","title":"\u914d\u7f6e"},{"location":"reference/monitor/filewatcher/#metrics","text":"","title":"Metrics"},{"location":"reference/monitor/filewatcher/#_2","text":"","title":"\u5168\u5c40\u7ea7\u522b"},{"location":"reference/monitor/filewatcher/#total_file_count","text":"# HELP file count total # TYPE loggie_filewatcher_total_file_count gauge loggie_filewatcher_total_file_count{} 20 HELP: \u8868\u793a\u5f53\u524d\u88abLoggie\u68c0\u6d4b\u5230\u6d3b\u8dc3\u7684\u6587\u4ef6\u4e2a\u6570\u603b\u548c TYPE: gauge","title":"total_file_count"},{"location":"reference/monitor/filewatcher/#inactive_file_count","text":"# HELP inactive file count # TYPE loggie_filewatcher_inactive_file_count gauge loggie_filewatcher_inactive_file_count{} 20 HELP: \u8868\u793a\u5f53\u524d\u88abLoggie\u68c0\u6d4b\u5230\u7684\u4e0d\u6d3b\u8dc3\u7684\u6587\u4ef6\u4e2a\u6570\u603b\u548c TYPE: gauge","title":"inactive_file_count"},{"location":"reference/monitor/filewatcher/#_3","text":"\u6587\u4ef6\u7ea7\u522b\u5305\u62ec\u4e86\u4ee5\u4e0bprometheus labels: LABELS: pipeline: \u8868\u793a\u6240\u5728\u7684pipeline\u540d\u79f0 source: \u8868\u793a\u6240\u5728\u7684source\u540d\u79f0 filename: \u8868\u793a\u6587\u4ef6\u540d status: \u8868\u793a\u6587\u4ef6\u72b6\u6001\u3002 pending: \u5df2\u88ab\u68c0\u6d4b\u5230\uff0c\u53ef\u80fd\u91c7\u96c6\u4e2d\u6216\u8005\u91c7\u96c6\u5b8c\u6bd5 unfinished: \u6587\u4ef6\u7684modify time\u8ddd\u5f53\u524d\u65f6\u95f4\u5df2\u7ecf\u8d85\u8fc7 checkUnFinishedTimeout \u65f6\u95f4 ignored: \u6587\u4ef6\u88ab\u5ffd\u7565\uff0c\u53ef\u80fd\u8d85\u8fc7 ignore_older \u65f6\u95f4 \u7531\u4e8e\u5b9a\u65f6\u626b\u63cf\u7684\u65f6\u95f4\u95f4\u9694 period \u9ed8\u8ba4\u4e3a5min\uff0c\u4ee5\u4e0b\u6307\u6807\u53ef\u80fd\u5b58\u5728\u4e00\u5b9a\u7a0b\u5ea6\u7684\u5ef6\u8fdf\u3002","title":"\u6587\u4ef6\u7ea7\u522b"},{"location":"reference/monitor/filewatcher/#file_size","text":"# HELP file size # TYPE loggie_filewatcher_file_size gauge loggie_filewatcher_file_size{pipeline=\"xxx\", source=\"access\", filename=\"/var/log/a.log\", status=\"pending\"} 2048 HELP: \u8868\u793a\u8be5\u6587\u4ef6\u7684\u603b\u5927\u5c0f TYPE: gauge","title":"file_size"},{"location":"reference/monitor/filewatcher/#file_ack_offset","text":"# HELP file ack offset # TYPE loggie_filewatcher_file_ack_offset gauge loggie_filewatcher_file_ack_offset{pipeline=\"xxx\", source=\"access\", filename=\"/var/log/a.log\", status=\"pending\"} 1024 HELP: \u8868\u793a\u8be5\u6587\u4ef6\u88ab\u91c7\u96c6\u540e\uff0c\u5e76\u4e14\u5df2\u7ecf\u63a5\u6536\u5230ack\u7684offset\uff0c\u53ef\u88ab\u7406\u89e3\u4e3a\u5df2\u7ecf\u53d1\u9001\u6210\u529f\u7684\u6587\u4ef6offset\u8fdb\u5ea6 TYPE: gauge","title":"file_ack_offset"},{"location":"reference/monitor/filewatcher/#file_last_modify","text":"# HELP file last modify timestamp # TYPE loggie_filewatcher_file_last_modify gauge loggie_filewatcher_file_last_modify{pipeline=\"xxx\", source=\"access\", filename=\"/var/log/a.log\", status=\"pending\"} 2343214422 HELP: \u6587\u4ef6\u7684\u6700\u65b0\u88ab\u4fee\u6539\u65f6\u95f4 TYPE: gauge","title":"file_last_modify"},{"location":"reference/monitor/logalert/","text":"logAlert listener \u00b6 \u7528\u4e8e\u65e5\u5fd7\u62a5\u8b66\u7684\u53d1\u9001\u3002 \u914d\u7f6e \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 alertManagerAddress string\u6570\u7ec4 \u5fc5\u586b alertManager\u5730\u5740 bufferSize int \u975e\u5fc5\u586b 100 \u65e5\u5fd7\u62a5\u8b66\u53d1\u9001\u7684buffer\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3a\u62a5\u8b66\u4e8b\u4ef6\u4e2a\u6570 batchTimeout time.Duration \u975e\u5fc5\u586b 10s \u6bcf\u4e2a\u62a5\u8b66\u53d1\u9001batch\u7684\u6700\u5927\u53d1\u9001\u65f6\u95f4 batchSize int \u975e\u5fc5\u586b 10 \u6bcf\u4e2a\u62a5\u8b66\u53d1\u9001batch\u7684\u6700\u5927\u5305\u542b\u62a5\u8b66\u8bf7\u6c42\u4e2a\u6570","title":"logAlert"},{"location":"reference/monitor/logalert/#logalert-listener","text":"\u7528\u4e8e\u65e5\u5fd7\u62a5\u8b66\u7684\u53d1\u9001\u3002","title":"logAlert listener"},{"location":"reference/monitor/logalert/#_1","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 alertManagerAddress string\u6570\u7ec4 \u5fc5\u586b alertManager\u5730\u5740 bufferSize int \u975e\u5fc5\u586b 100 \u65e5\u5fd7\u62a5\u8b66\u53d1\u9001\u7684buffer\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3a\u62a5\u8b66\u4e8b\u4ef6\u4e2a\u6570 batchTimeout time.Duration \u975e\u5fc5\u586b 10s \u6bcf\u4e2a\u62a5\u8b66\u53d1\u9001batch\u7684\u6700\u5927\u53d1\u9001\u65f6\u95f4 batchSize int \u975e\u5fc5\u586b 10 \u6bcf\u4e2a\u62a5\u8b66\u53d1\u9001batch\u7684\u6700\u5927\u5305\u542b\u62a5\u8b66\u8bf7\u6c42\u4e2a\u6570","title":"\u914d\u7f6e"},{"location":"reference/monitor/overview/","text":"Monitor \u00b6 \u76d1\u63a7\u4e8b\u4ef6\u603b\u7ebf\uff0c\u6240\u6709\u7684\u7ec4\u4ef6\u90fd\u53ef\u4ee5\u53d1\u51fa\u81ea\u5df1\u7684metrics\u6307\u6807\u6570\u636e\uff0c\u7531listeners\u6d88\u8d39\u5904\u7406\u3002 Example monitor : logger : period : 30s enabled : true listeners : filesource : ~ filewatcher : ~ reload : ~ sink : ~ logger \u00b6 Loggie\u652f\u6301\u5c06metrics\u6307\u6807\u8f93\u51fa\u5230\u65e5\u5fd7\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7logger\u914d\u7f6e\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 logger.enabled bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542f logger.period time.Duration \u975e\u5fc5\u586b 10s \u6307\u6807\u6253\u5370\u7684\u65f6\u95f4\u95f4\u9694\uff0c\u6570\u636e\u91cf\u8f83\u5927\u65f6\u5efa\u8bae\u5c06\u95f4\u9694\u5ef6\u957f\uff0c\u598230s\u30015m logger.pretty bool \u975e\u5fc5\u586b false \u6253\u5370\u7684\u6307\u6807json\u662f\u5426\u9700\u8981\u53cb\u597d\u5c55\u793a logger.additionLogEnabled bool \u975e\u5fc5\u586b false \u662f\u5426\u9700\u8981\u5c06\u6253\u5370\u7684\u6307\u6807\u5355\u72ec\u8f93\u51fa\u5230\u53e6\u5916\u7684\u65e5\u5fd7\u6587\u4ef6\u4e2d\uff0c\u5728\u6570\u636e\u91cf\u6bd4\u8f83\u591a\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u6211\u4eec\u914d\u7f6e\u7684\u6253\u5370\u65f6\u95f4\u95f4\u9694\u8f83\u77ed\uff0c\u53ef\u4ee5\u6253\u5f00\u8be5\u5f00\u5173\uff0c\u907f\u514d\u592a\u591a\u7684metrics\u65e5\u5fd7\u5e72\u6270 logger.additionLogConfig \u975e\u5fc5\u586b \u989d\u5916\u8f93\u51fa\u7684\u65e5\u5fd7\u914d\u7f6e\u53c2\u6570 logger.additionLogConfig.directory bool \u975e\u5fc5\u586b /data/loggie/log \u989d\u5916\u8f93\u51fa\u7684\u65e5\u5fd7\u76ee\u5f55 logger.additionLogConfig.maxBackups int \u975e\u5fc5\u586b metrics.log \u65e5\u5fd7\u8f6e\u8f6c\u6700\u591a\u4fdd\u7559\u7684\u6587\u4ef6\u4e2a\u6570\uff0c\u9ed8\u8ba4\u4e3a3 logger.additionLogConfig.maxSize int \u975e\u5fc5\u586b 1024 \u65e5\u5fd7\u8f6e\u8f6c\u7684\u65f6\u5019\uff0c\u6700\u5927\u7684\u6587\u4ef6\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3aMB logger.additionLogConfig.maxAge int \u975e\u5fc5\u586b 14 \u65e5\u5fd7\u8f6e\u8f6c\u6700\u5927\u4fdd\u7559\u7684\u5929\u6570 logger.additionLogConfig.timeFormat string \u975e\u5fc5\u586b 2006-01-02 15:04:05 \u6bcf\u884c\u65e5\u5fd7\u8f93\u51fa\u7684\u65f6\u95f4\u683c\u5f0f listeners \u00b6 \u8868\u793a\u5177\u4f53\u542f\u52a8\u7684listeners\u3002 \u914d\u7f6e\u4e0d\u586b\u5199\u5373\u4e3a\u5173\u95ed\uff0c\u4e0d\u542f\u52a8\u8be5Listener\uff0c\u76f8\u5173\u7684\u7684\u6307\u6807\u4e5f\u4e0d\u4f1a\u88ab\u5904\u7406\u548c\u66b4\u9732\u3002","title":"Overview"},{"location":"reference/monitor/overview/#monitor","text":"\u76d1\u63a7\u4e8b\u4ef6\u603b\u7ebf\uff0c\u6240\u6709\u7684\u7ec4\u4ef6\u90fd\u53ef\u4ee5\u53d1\u51fa\u81ea\u5df1\u7684metrics\u6307\u6807\u6570\u636e\uff0c\u7531listeners\u6d88\u8d39\u5904\u7406\u3002 Example monitor : logger : period : 30s enabled : true listeners : filesource : ~ filewatcher : ~ reload : ~ sink : ~","title":"Monitor"},{"location":"reference/monitor/overview/#logger","text":"Loggie\u652f\u6301\u5c06metrics\u6307\u6807\u8f93\u51fa\u5230\u65e5\u5fd7\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7logger\u914d\u7f6e\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 logger.enabled bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542f logger.period time.Duration \u975e\u5fc5\u586b 10s \u6307\u6807\u6253\u5370\u7684\u65f6\u95f4\u95f4\u9694\uff0c\u6570\u636e\u91cf\u8f83\u5927\u65f6\u5efa\u8bae\u5c06\u95f4\u9694\u5ef6\u957f\uff0c\u598230s\u30015m logger.pretty bool \u975e\u5fc5\u586b false \u6253\u5370\u7684\u6307\u6807json\u662f\u5426\u9700\u8981\u53cb\u597d\u5c55\u793a logger.additionLogEnabled bool \u975e\u5fc5\u586b false \u662f\u5426\u9700\u8981\u5c06\u6253\u5370\u7684\u6307\u6807\u5355\u72ec\u8f93\u51fa\u5230\u53e6\u5916\u7684\u65e5\u5fd7\u6587\u4ef6\u4e2d\uff0c\u5728\u6570\u636e\u91cf\u6bd4\u8f83\u591a\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u6211\u4eec\u914d\u7f6e\u7684\u6253\u5370\u65f6\u95f4\u95f4\u9694\u8f83\u77ed\uff0c\u53ef\u4ee5\u6253\u5f00\u8be5\u5f00\u5173\uff0c\u907f\u514d\u592a\u591a\u7684metrics\u65e5\u5fd7\u5e72\u6270 logger.additionLogConfig \u975e\u5fc5\u586b \u989d\u5916\u8f93\u51fa\u7684\u65e5\u5fd7\u914d\u7f6e\u53c2\u6570 logger.additionLogConfig.directory bool \u975e\u5fc5\u586b /data/loggie/log \u989d\u5916\u8f93\u51fa\u7684\u65e5\u5fd7\u76ee\u5f55 logger.additionLogConfig.maxBackups int \u975e\u5fc5\u586b metrics.log \u65e5\u5fd7\u8f6e\u8f6c\u6700\u591a\u4fdd\u7559\u7684\u6587\u4ef6\u4e2a\u6570\uff0c\u9ed8\u8ba4\u4e3a3 logger.additionLogConfig.maxSize int \u975e\u5fc5\u586b 1024 \u65e5\u5fd7\u8f6e\u8f6c\u7684\u65f6\u5019\uff0c\u6700\u5927\u7684\u6587\u4ef6\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3aMB logger.additionLogConfig.maxAge int \u975e\u5fc5\u586b 14 \u65e5\u5fd7\u8f6e\u8f6c\u6700\u5927\u4fdd\u7559\u7684\u5929\u6570 logger.additionLogConfig.timeFormat string \u975e\u5fc5\u586b 2006-01-02 15:04:05 \u6bcf\u884c\u65e5\u5fd7\u8f93\u51fa\u7684\u65f6\u95f4\u683c\u5f0f","title":"logger"},{"location":"reference/monitor/overview/#listeners","text":"\u8868\u793a\u5177\u4f53\u542f\u52a8\u7684listeners\u3002 \u914d\u7f6e\u4e0d\u586b\u5199\u5373\u4e3a\u5173\u95ed\uff0c\u4e0d\u542f\u52a8\u8be5Listener\uff0c\u76f8\u5173\u7684\u7684\u6307\u6807\u4e5f\u4e0d\u4f1a\u88ab\u5904\u7406\u548c\u66b4\u9732\u3002","title":"listeners"},{"location":"reference/monitor/queue/","text":"queue listener \u00b6 \u914d\u7f6e \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 period time.Duration \u975e\u5fc5\u586b 10s listener\u6d88\u8d39\u5904\u7406\u6570\u636e\u7684\u65f6\u95f4\u95f4\u9694 Metrics \u00b6 LABELS: pipeline: \u8868\u793a\u6240\u5728\u7684pipeline\u540d\u79f0 type: queue\u961f\u5217\u7684\u7c7b\u578b capacity \u00b6 # HELP queue capacity # TYPE loggie_queue_capacity gauge loggie_queue_capacity{pipeline=\"xxx\", type=\"channel\"} 2048 HELP: \u5f53\u524d\u961f\u5217\u7684\u5bb9\u91cf TYPE: gauge size \u00b6 # HELP queue size # TYPE loggie_queue_size gauge loggie_queue_size{pipeline=\"xxx\", type=\"channel\"} 2048 HELP: \u5f53\u524d\u961f\u5217\u88ab\u4f7f\u7528\u7684\u957f\u5ea6 TYPE: gauge fill_percentage \u00b6 # HELP how full is queue # TYPE loggie_queue_fill_percentage gauge loggie_queue_fill_percentage{pipeline=\"xxx\", type=\"channel\"} 50 HELP: \u5f53\u524d\u961f\u5217\u4f7f\u7528\u7684\u767e\u5206\u6bd4 TYPE: gauge","title":"queue"},{"location":"reference/monitor/queue/#queue-listener","text":"","title":"queue listener"},{"location":"reference/monitor/queue/#_1","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 period time.Duration \u975e\u5fc5\u586b 10s listener\u6d88\u8d39\u5904\u7406\u6570\u636e\u7684\u65f6\u95f4\u95f4\u9694","title":"\u914d\u7f6e"},{"location":"reference/monitor/queue/#metrics","text":"LABELS: pipeline: \u8868\u793a\u6240\u5728\u7684pipeline\u540d\u79f0 type: queue\u961f\u5217\u7684\u7c7b\u578b","title":"Metrics"},{"location":"reference/monitor/queue/#capacity","text":"# HELP queue capacity # TYPE loggie_queue_capacity gauge loggie_queue_capacity{pipeline=\"xxx\", type=\"channel\"} 2048 HELP: \u5f53\u524d\u961f\u5217\u7684\u5bb9\u91cf TYPE: gauge","title":"capacity"},{"location":"reference/monitor/queue/#size","text":"# HELP queue size # TYPE loggie_queue_size gauge loggie_queue_size{pipeline=\"xxx\", type=\"channel\"} 2048 HELP: \u5f53\u524d\u961f\u5217\u88ab\u4f7f\u7528\u7684\u957f\u5ea6 TYPE: gauge","title":"size"},{"location":"reference/monitor/queue/#fill_percentage","text":"# HELP how full is queue # TYPE loggie_queue_fill_percentage gauge loggie_queue_fill_percentage{pipeline=\"xxx\", type=\"channel\"} 50 HELP: \u5f53\u524d\u961f\u5217\u4f7f\u7528\u7684\u767e\u5206\u6bd4 TYPE: gauge","title":"fill_percentage"},{"location":"reference/monitor/reload/","text":"reload listener \u00b6 reload\u7684\u6307\u6807\uff0c\u603b\u7684reload\u6b21\u6570\u3002 Metrics \u00b6 total \u00b6 # HELP Loggie reload total count # TYPE loggie_reload_total gauge loggie_reload_total{} 10 HELP: \u8868\u793a\u5f53\u524dreload\u7684\u603b\u6b21\u6570 TYPE: counter","title":"reload"},{"location":"reference/monitor/reload/#reload-listener","text":"reload\u7684\u6307\u6807\uff0c\u603b\u7684reload\u6b21\u6570\u3002","title":"reload listener"},{"location":"reference/monitor/reload/#metrics","text":"","title":"Metrics"},{"location":"reference/monitor/reload/#total","text":"# HELP Loggie reload total count # TYPE loggie_reload_total gauge loggie_reload_total{} 10 HELP: \u8868\u793a\u5f53\u524dreload\u7684\u603b\u6b21\u6570 TYPE: counter","title":"total"},{"location":"reference/monitor/sink/","text":"sink listener \u00b6 sink\u53d1\u9001\u7aef\u7684\u76d1\u63a7\u6307\u6807\u5904\u7406\uff0c\u5305\u62ec\u53d1\u9001\u6210\u529f\u7684event\u6570\u91cf\u3001\u53d1\u9001\u5931\u8d25\u7684event\u6570\u91cf\u3001event qps\u7b49 \u914d\u7f6e \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 period time.Duration \u975e\u5fc5\u586b 10s listener\u6d88\u8d39\u5904\u7406\u6570\u636e\u7684\u65f6\u95f4\u95f4\u9694 Metrics \u00b6 LABELS: pipeline: \u8868\u793a\u6240\u5728\u7684pipeline\u540d\u79f0 source: \u8868\u793a\u6240\u5728\u7684source\u540d\u79f0 success_event \u00b6 # HELP send event success count # TYPE loggie_sink_success_event gauge loggie_sink_success_event{pipeline=\"xxx\", source=\"access\"} 2048 HELP: \u5728 period \u65f6\u95f4\u6bb5\u5185\uff0c\u53d1\u9001\u6210\u529f\u7684event\u4e2a\u6570 TYPE: gauge failed_event \u00b6 # HELP send event failed count # TYPE loggie_sink_failed_event gauge loggie_sink_failed_event{pipeline=\"xxx\", source=\"access\"} 2048 HELP: \u5728 period \u65f6\u95f4\u6bb5\u5185\uff0c\u53d1\u9001\u5931\u8d25\u7684event\u4e2a\u6570 TYPE: gauge event_qps \u00b6 # HELP send success event failed count # TYPE loggie_sink_event_qps gauge loggie_sink_event_qps{pipeline=\"xxx\", source=\"access\"} 2048 HELP: \u5728 period \u65f6\u95f4\u6bb5\u5185\uff0c\u53d1\u9001\u7684event QPS TYPE: gauge","title":"sink"},{"location":"reference/monitor/sink/#sink-listener","text":"sink\u53d1\u9001\u7aef\u7684\u76d1\u63a7\u6307\u6807\u5904\u7406\uff0c\u5305\u62ec\u53d1\u9001\u6210\u529f\u7684event\u6570\u91cf\u3001\u53d1\u9001\u5931\u8d25\u7684event\u6570\u91cf\u3001event qps\u7b49","title":"sink listener"},{"location":"reference/monitor/sink/#_1","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 period time.Duration \u975e\u5fc5\u586b 10s listener\u6d88\u8d39\u5904\u7406\u6570\u636e\u7684\u65f6\u95f4\u95f4\u9694","title":"\u914d\u7f6e"},{"location":"reference/monitor/sink/#metrics","text":"LABELS: pipeline: \u8868\u793a\u6240\u5728\u7684pipeline\u540d\u79f0 source: \u8868\u793a\u6240\u5728\u7684source\u540d\u79f0","title":"Metrics"},{"location":"reference/monitor/sink/#success_event","text":"# HELP send event success count # TYPE loggie_sink_success_event gauge loggie_sink_success_event{pipeline=\"xxx\", source=\"access\"} 2048 HELP: \u5728 period \u65f6\u95f4\u6bb5\u5185\uff0c\u53d1\u9001\u6210\u529f\u7684event\u4e2a\u6570 TYPE: gauge","title":"success_event"},{"location":"reference/monitor/sink/#failed_event","text":"# HELP send event failed count # TYPE loggie_sink_failed_event gauge loggie_sink_failed_event{pipeline=\"xxx\", source=\"access\"} 2048 HELP: \u5728 period \u65f6\u95f4\u6bb5\u5185\uff0c\u53d1\u9001\u5931\u8d25\u7684event\u4e2a\u6570 TYPE: gauge","title":"failed_event"},{"location":"reference/monitor/sink/#event_qps","text":"# HELP send success event failed count # TYPE loggie_sink_event_qps gauge loggie_sink_event_qps{pipeline=\"xxx\", source=\"access\"} 2048 HELP: \u5728 period \u65f6\u95f4\u6bb5\u5185\uff0c\u53d1\u9001\u7684event QPS TYPE: gauge","title":"event_qps"},{"location":"reference/monitor/sys/","text":"sys listener \u00b6 Loggie\u672c\u8eab\u7684CPU\u548cMemory\u6307\u6807 \u914d\u7f6e \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 period time.Duration \u975e\u5fc5\u586b 10s listener\u6d88\u8d39\u5904\u7406\u6570\u636e\u7684\u65f6\u95f4\u95f4\u9694 Metrics \u00b6 cpu_percent \u00b6 # HELP loggie_sys_cpu_percent Loggie cpu percent # TYPE loggie_sys_cpu_percent gauge loggie_sys_cpu_percent 0.37 HELP: Loggie\u7684cpu\u4f7f\u7528\u7387 TYPE: gauge mem_rss \u00b6 # HELP loggie_sys_mem_rss Loggie memory rss bytes # TYPE loggie_sys_mem_rss gauge loggie_sys_mem_rss 2.5853952e+07 HELP: Loggie\u7684\u5185\u5b58\u5360\u7528\u5b57\u8282\u6570 TYPE: gauge","title":"sys"},{"location":"reference/monitor/sys/#sys-listener","text":"Loggie\u672c\u8eab\u7684CPU\u548cMemory\u6307\u6807","title":"sys listener"},{"location":"reference/monitor/sys/#_1","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 period time.Duration \u975e\u5fc5\u586b 10s listener\u6d88\u8d39\u5904\u7406\u6570\u636e\u7684\u65f6\u95f4\u95f4\u9694","title":"\u914d\u7f6e"},{"location":"reference/monitor/sys/#metrics","text":"","title":"Metrics"},{"location":"reference/monitor/sys/#cpu_percent","text":"# HELP loggie_sys_cpu_percent Loggie cpu percent # TYPE loggie_sys_cpu_percent gauge loggie_sys_cpu_percent 0.37 HELP: Loggie\u7684cpu\u4f7f\u7528\u7387 TYPE: gauge","title":"cpu_percent"},{"location":"reference/monitor/sys/#mem_rss","text":"# HELP loggie_sys_mem_rss Loggie memory rss bytes # TYPE loggie_sys_mem_rss gauge loggie_sys_mem_rss 2.5853952e+07 HELP: Loggie\u7684\u5185\u5b58\u5360\u7528\u5b57\u8282\u6570 TYPE: gauge","title":"mem_rss"},{"location":"reference/pipelines/interceptor/addk8smeta/","text":"addK8sMeta \u00b6 \u7528\u4e8e\u4eceevent\u4e2d\u7684\u67d0\u4e9b\u5b57\u6bb5\uff08\u6bd4\u5982\u65e5\u5fd7\u6587\u4ef6\u7684\u8def\u5f84\u4e2d\uff09\uff0c\u83b7\u53d6\u5230\uff1a pod.uid namespace \u4e0e pod.name container.id \u4ee5\u4e0a3\u79cd\u4efb\u610f\u5176\u4e00\u7684\u7d22\u5f15\u4fe1\u606f\uff0c\u6b64\u65f6Loggie\u53ef\u6839\u636e\u8be5\u7d22\u5f15\u67e5\u8be2\u5230\u5177\u4f53\u7684Pod\uff0c\u5e76\u6dfb\u52a0\u989d\u5916\u7684kubernetes ${node.name} \u3001 ${namespace} \u3001 ${pod.uid} \u3001 ${pod.name} \u7b49\u5143\u4fe1\u606f\u4f5c\u52a0\u5165\u5230event\u4e2d\uff0c\u7528\u4e8e\u540e\u7eed\u7684\u5206\u6790\u5904\u7406\u3002 \u5c5e\u4e8esource interceptor\u3002 Example interceptors : - type : addK8sMeta pattern : \"/var/log/${pod.uid}/${pod.name}/\" addFields : nodename : \"${node.name}\" namespace : \"${namespace}\" podname : \"${pod.name}\" pattern \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 pattern string \u5fc5\u586b \u63d0\u53d6\u5b57\u6bb5\u7684\u5339\u914d\u6a21\u578b \u5fc5\u987b\u5305\u542b\u6709\uff1a pod.uid namespace\u4e0epod.name container.id \u5176\u4e2d\u4e4b\u4e00\u3002 \u6bd4\u5982\uff1a /var/log/${pod.uid}/${pod.name}/ patternFields \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 patternFields string \u975e\u5fc5\u586b \u9ed8\u8ba4\u4f1a\u4eceevent\u4e2d\u83b7\u53d6\u7cfb\u7edf\u5b57\u6bb5\u91cc\u7684filename\uff0c\u6b64\u65f6\u9700\u8981\u4f7f\u7528file source \u4eceevent\u4e2d\u7528\u4e8e\u63d0\u53d6\u7684pattern\u7684\u5b57\u6bb5 fieldsName \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 fieldsName string \u975e\u5fc5\u586b kubernetes \u6dfb\u52a0\u5143\u4fe1\u606f\u7684\u5b57\u6bb5 addFields \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 addFields map \u975e\u5fc5\u586b \u9700\u8981\u6dfb\u52a0\u7684\u5143\u4fe1\u606f \u76ee\u524d\u652f\u6301\u6dfb\u52a0\u7684\u5143\u4fe1\u606f\u5b57\u6bb5\u6709\uff1a ${cluster} \uff1a\u96c6\u7fa4\u4fe1\u606f\uff0c\u4e3a\u7cfb\u7edf\u914d\u7f6e\u4e2d discovery.kubernetes.cluster \u5b57\u6bb5\u3002 ${node.name} ${namespace} ${workload.kind} \uff1aDeployment/StatefulSet/DaemonSet/Job\u7b49 ${workload.name} \uff1a\u5de5\u4f5c\u8d1f\u8f7d\u7684\u540d\u79f0 ${pod.uid} ${pod.name}","title":"addK8sMeta"},{"location":"reference/pipelines/interceptor/addk8smeta/#addk8smeta","text":"\u7528\u4e8e\u4eceevent\u4e2d\u7684\u67d0\u4e9b\u5b57\u6bb5\uff08\u6bd4\u5982\u65e5\u5fd7\u6587\u4ef6\u7684\u8def\u5f84\u4e2d\uff09\uff0c\u83b7\u53d6\u5230\uff1a pod.uid namespace \u4e0e pod.name container.id \u4ee5\u4e0a3\u79cd\u4efb\u610f\u5176\u4e00\u7684\u7d22\u5f15\u4fe1\u606f\uff0c\u6b64\u65f6Loggie\u53ef\u6839\u636e\u8be5\u7d22\u5f15\u67e5\u8be2\u5230\u5177\u4f53\u7684Pod\uff0c\u5e76\u6dfb\u52a0\u989d\u5916\u7684kubernetes ${node.name} \u3001 ${namespace} \u3001 ${pod.uid} \u3001 ${pod.name} \u7b49\u5143\u4fe1\u606f\u4f5c\u52a0\u5165\u5230event\u4e2d\uff0c\u7528\u4e8e\u540e\u7eed\u7684\u5206\u6790\u5904\u7406\u3002 \u5c5e\u4e8esource interceptor\u3002 Example interceptors : - type : addK8sMeta pattern : \"/var/log/${pod.uid}/${pod.name}/\" addFields : nodename : \"${node.name}\" namespace : \"${namespace}\" podname : \"${pod.name}\"","title":"addK8sMeta"},{"location":"reference/pipelines/interceptor/addk8smeta/#pattern","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 pattern string \u5fc5\u586b \u63d0\u53d6\u5b57\u6bb5\u7684\u5339\u914d\u6a21\u578b \u5fc5\u987b\u5305\u542b\u6709\uff1a pod.uid namespace\u4e0epod.name container.id \u5176\u4e2d\u4e4b\u4e00\u3002 \u6bd4\u5982\uff1a /var/log/${pod.uid}/${pod.name}/","title":"pattern"},{"location":"reference/pipelines/interceptor/addk8smeta/#patternfields","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 patternFields string \u975e\u5fc5\u586b \u9ed8\u8ba4\u4f1a\u4eceevent\u4e2d\u83b7\u53d6\u7cfb\u7edf\u5b57\u6bb5\u91cc\u7684filename\uff0c\u6b64\u65f6\u9700\u8981\u4f7f\u7528file source \u4eceevent\u4e2d\u7528\u4e8e\u63d0\u53d6\u7684pattern\u7684\u5b57\u6bb5","title":"patternFields"},{"location":"reference/pipelines/interceptor/addk8smeta/#fieldsname","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 fieldsName string \u975e\u5fc5\u586b kubernetes \u6dfb\u52a0\u5143\u4fe1\u606f\u7684\u5b57\u6bb5","title":"fieldsName"},{"location":"reference/pipelines/interceptor/addk8smeta/#addfields","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 addFields map \u975e\u5fc5\u586b \u9700\u8981\u6dfb\u52a0\u7684\u5143\u4fe1\u606f \u76ee\u524d\u652f\u6301\u6dfb\u52a0\u7684\u5143\u4fe1\u606f\u5b57\u6bb5\u6709\uff1a ${cluster} \uff1a\u96c6\u7fa4\u4fe1\u606f\uff0c\u4e3a\u7cfb\u7edf\u914d\u7f6e\u4e2d discovery.kubernetes.cluster \u5b57\u6bb5\u3002 ${node.name} ${namespace} ${workload.kind} \uff1aDeployment/StatefulSet/DaemonSet/Job\u7b49 ${workload.name} \uff1a\u5de5\u4f5c\u8d1f\u8f7d\u7684\u540d\u79f0 ${pod.uid} ${pod.name}","title":"addFields"},{"location":"reference/pipelines/interceptor/limit/","text":"rateLimit \u00b6 \u7528\u4e8e\u65e5\u5fd7\u9650\u6d41\u3002 \u5c5e\u4e8esource interceptor\u3002 Example interceptors : - type : rateLimit qps : 4000 qps \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 qps int \u975e\u5fc5\u586b 2048 \u9650\u6d41qps","title":"rateLimit"},{"location":"reference/pipelines/interceptor/limit/#ratelimit","text":"\u7528\u4e8e\u65e5\u5fd7\u9650\u6d41\u3002 \u5c5e\u4e8esource interceptor\u3002 Example interceptors : - type : rateLimit qps : 4000","title":"rateLimit"},{"location":"reference/pipelines/interceptor/limit/#qps","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 qps int \u975e\u5fc5\u586b 2048 \u9650\u6d41qps","title":"qps"},{"location":"reference/pipelines/interceptor/logalert/","text":"logAlert \u00b6 \u7528\u4e8e\u65e5\u5fd7\u62a5\u8b66\u68c0\u6d4b\u3002 \u5c5e\u4e8esource interceptor\u3002 \u4f7f\u7528\u793a\u4f8b\u8bf7\u53c2\u8003 \u65e5\u5fd7\u62a5\u8b66 \u3002 Example interceptors : - type : logAlert matcher : contains : [ \"error\" , \"err\" ] matcher \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 matcher.contains string\u6570\u7ec4 \u975e\u5fc5\u586b \u65e5\u5fd7\u6570\u636e\u5305\u542b\u5b57\u7b26\u4e32\u68c0\u6d4b matcher.regexp string\u6570\u7ec4 \u975e\u5fc5\u586b \u65e5\u5fd7\u6570\u636e\u6b63\u5219\u68c0\u6d4b matcher.target string \u975e\u5fc5\u586b body \u6839\u636e\u65e5\u5fd7\u6570\u636e\u7684\u8be5\u5b57\u6bb5\u8fdb\u884c\u68c0\u6d4b\uff0c\u5982\u679c\u8fdb\u884c\u65e5\u5fd7\u5207\u5206\u6216\u8005drop body\u5b57\u6bb5\uff0c\u8bf7\u586b\u5199\u6240\u9700\u5b57\u6bb5 labels \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 labels \u975e\u5fc5\u586b \u589e\u52a0\u989d\u5916\u7684label labels.from string\u6570\u7ec4 \u975e\u5fc5\u586b \u4eceheader\u4e2d\u83b7\u53d6\u989d\u5916\u7684label\uff0c\u8fd9\u91cc\u8bf7\u586bheader\u91cc\u5177\u4f53\u7684key\u540d\u79f0","title":"logAlert"},{"location":"reference/pipelines/interceptor/logalert/#logalert","text":"\u7528\u4e8e\u65e5\u5fd7\u62a5\u8b66\u68c0\u6d4b\u3002 \u5c5e\u4e8esource interceptor\u3002 \u4f7f\u7528\u793a\u4f8b\u8bf7\u53c2\u8003 \u65e5\u5fd7\u62a5\u8b66 \u3002 Example interceptors : - type : logAlert matcher : contains : [ \"error\" , \"err\" ]","title":"logAlert"},{"location":"reference/pipelines/interceptor/logalert/#matcher","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 matcher.contains string\u6570\u7ec4 \u975e\u5fc5\u586b \u65e5\u5fd7\u6570\u636e\u5305\u542b\u5b57\u7b26\u4e32\u68c0\u6d4b matcher.regexp string\u6570\u7ec4 \u975e\u5fc5\u586b \u65e5\u5fd7\u6570\u636e\u6b63\u5219\u68c0\u6d4b matcher.target string \u975e\u5fc5\u586b body \u6839\u636e\u65e5\u5fd7\u6570\u636e\u7684\u8be5\u5b57\u6bb5\u8fdb\u884c\u68c0\u6d4b\uff0c\u5982\u679c\u8fdb\u884c\u65e5\u5fd7\u5207\u5206\u6216\u8005drop body\u5b57\u6bb5\uff0c\u8bf7\u586b\u5199\u6240\u9700\u5b57\u6bb5","title":"matcher"},{"location":"reference/pipelines/interceptor/logalert/#labels","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 labels \u975e\u5fc5\u586b \u589e\u52a0\u989d\u5916\u7684label labels.from string\u6570\u7ec4 \u975e\u5fc5\u586b \u4eceheader\u4e2d\u83b7\u53d6\u989d\u5916\u7684label\uff0c\u8fd9\u91cc\u8bf7\u586bheader\u91cc\u5177\u4f53\u7684key\u540d\u79f0","title":"labels"},{"location":"reference/pipelines/interceptor/maxbytes/","text":"maxbytes \u00b6 \u5bf9\u539f\u59cb\u5355\u884c\u65e5\u5fd7\u7684\u5927\u5c0f\u8fdb\u884c\u9650\u5236\uff0c\u907f\u514d\u5355\u884c\u65e5\u5fd7\u6570\u636e\u91cf\u592a\u5927\u5f71\u54cdLoggie\u5185\u5b58\u548c\u7a33\u5b9a\u6027\u3002 \u7cfb\u7edf\u5185\u7f6e\uff0c\u9ed8\u8ba4\u52a0\u8f7d\uff0c\u5c5e\u4e8esource interceptor\u3002 Example interceptors : - type : maxbytes maxBytes : 102400 maxBytes \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxBytes int \u975e\u5fc5\u586b \u5355\u884c\u6700\u5927\u5b57\u8282\u4e2a\u6570\uff0c\u8d85\u51fa\u7684\u90e8\u5206\u5c06\u4f1a\u88ab\u4e22\u5f03","title":"maxbytes"},{"location":"reference/pipelines/interceptor/maxbytes/#maxbytes","text":"\u5bf9\u539f\u59cb\u5355\u884c\u65e5\u5fd7\u7684\u5927\u5c0f\u8fdb\u884c\u9650\u5236\uff0c\u907f\u514d\u5355\u884c\u65e5\u5fd7\u6570\u636e\u91cf\u592a\u5927\u5f71\u54cdLoggie\u5185\u5b58\u548c\u7a33\u5b9a\u6027\u3002 \u7cfb\u7edf\u5185\u7f6e\uff0c\u9ed8\u8ba4\u52a0\u8f7d\uff0c\u5c5e\u4e8esource interceptor\u3002 Example interceptors : - type : maxbytes maxBytes : 102400","title":"maxbytes"},{"location":"reference/pipelines/interceptor/maxbytes/#maxbytes_1","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxBytes int \u975e\u5fc5\u586b \u5355\u884c\u6700\u5927\u5b57\u8282\u4e2a\u6570\uff0c\u8d85\u51fa\u7684\u90e8\u5206\u5c06\u4f1a\u88ab\u4e22\u5f03","title":"maxBytes"},{"location":"reference/pipelines/interceptor/metrics/","text":"metric \u00b6 \u5bf9\u6570\u636e\u4f20\u8f93\u8fdb\u884c\u91c7\u6837metics\uff0c\u63d0\u4f9b\u7ed9monitor eventbus\u4e2dlistener\u4f7f\u7528\u3002 \u7cfb\u7edf\u5185\u7f6e\uff0c\u9ed8\u8ba4\u52a0\u8f7d\uff0c\u5c5e\u4e8esink interceptor\u3002 Example interceptors : - type : metric","title":"metrics"},{"location":"reference/pipelines/interceptor/metrics/#metric","text":"\u5bf9\u6570\u636e\u4f20\u8f93\u8fdb\u884c\u91c7\u6837metics\uff0c\u63d0\u4f9b\u7ed9monitor eventbus\u4e2dlistener\u4f7f\u7528\u3002 \u7cfb\u7edf\u5185\u7f6e\uff0c\u9ed8\u8ba4\u52a0\u8f7d\uff0c\u5c5e\u4e8esink interceptor\u3002 Example interceptors : - type : metric","title":"metric"},{"location":"reference/pipelines/interceptor/normalize/","text":"normalize \u00b6 \u7528\u4e8e\u65e5\u5fd7\u5207\u5206\u5904\u7406\u3002 \u5c5e\u4e8esource interceptor\u3002\u53ef\u6307\u5b9a\u53ea\u88ab\u67d0\u4e9bsource\u4f7f\u7528\u3002 \u5177\u4f53\u4f7f\u7528\u793a\u4f8b\u53ef\u53c2\u8003 \u65e5\u5fd7\u5207\u5206\u4e0e\u5904\u7406 \u3002 processors \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 processors \u6570\u7ec4 \u5fc5\u586b \u65e0 \u6240\u6709\u7684\u5904\u7406processor\u5217\u8868 \u914d\u7f6e\u7684processor\u5c06\u6309\u7167\u987a\u5e8f\u4f9d\u6b21\u6267\u884c\u3002 Tips Loggie\u652f\u6301\u4f7f\u7528 a.b \u7684\u5f62\u5f0f\u5f15\u7528\u5d4c\u5957\u7684\u5b57\u6bb5\u3002 \u6bd4\u5982\u6570\u636e\u4e3a: { \"fields\" : { \"hello\" : \"world\" } } \u4e0b\u9762\u7684processor\u914d\u7f6e\u4e2d\u5747\u53ef\u4ee5\u4f7f\u7528 fields.hello \u6307\u5b9a\u5d4c\u5957\u5728 fields \u91cc\u7684 hello: world \u3002 addMeta \u00b6 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cLoggie\u4e0d\u4f1a\u6dfb\u52a0\u4efb\u4f55\u7684\u7cfb\u7edf\u5185\u90e8\u4fe1\u606f\u5230\u539f\u59cb\u6570\u636e\u4e2d\u3002 \u53ef\u901a\u8fc7addMeta\u6dfb\u52a0\u7cfb\u7edf\u5185\u7f6e\u5b57\u6bb5\u53d1\u9001\u7ed9\u4e0b\u6e38\u3002 Note \u8bf7\u6ce8\u610f\uff0c\u5728pipeline\u4e2d\u914d\u7f6eaddMeta\uff0c\u53ea\u4f1a\u5f71\u54cd\u8be5pipeline\u53d1\u9001\u7684\u6240\u6709\u6570\u636e\uff0c\u5982\u679c\u9700\u8981\u5168\u5c40\u751f\u6548\uff0c\u8bf7\u5728 defaults \u4e2d\u914d\u7f6enormalize.addMeta\u3002 loggie: defaults: interceptors: - type: normalize name: global processors: - addMeta: ~ \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 target string \u975e\u5fc5\u586b meta \u7cfb\u7edf\u5185\u7f6e\u5b57\u6bb5\u6dfb\u52a0\u5230event\u4e2d\u7684\u5b57\u6bb5\u540d regex \u00b6 \u5c06\u6307\u5b9a\u5b57\u6bb5\u8fdb\u884c\u6b63\u5219\u63d0\u53d6\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 regex.pattern string \u5fc5\u586b \u65e0 \u6b63\u5219\u89e3\u6790\u89c4\u5219 regex.target string \u975e\u5fc5\u586b body \u6b63\u5219\u89e3\u6790\u7684\u76ee\u6807\u5b57\u6bb5 regex.ignoreError bool \u975e\u5fc5\u586b false \u662f\u5426\u5ffd\u7565\u9519\u8bef Example interceptors : - type : normalize processors : - regex : pattern : '(?<ip>\\S+) (?<id>\\S+) (?<u>\\S+) (?<time>\\[.*?\\]) (?<url>\\\".*?\\\") (?<status>\\S+) (?<size>\\S+)' \u4f7f\u7528\u4ee5\u4e0a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u53ef\u4ee5\u5c06\u4ee5\u4e0b\u793a\u4f8b\u7684\u65e5\u5fd7\uff1a 10.244.0.1 - - [13/Dec/2021:12:40:48 +0000] \"GET / HTTP/1.1\" 404 683 \u8f6c\u6362\u6210\uff1a \"ip\": \"10.244.0.1\", \"id\": \"-\", \"u\": \"-\", \"time\": \"[13/Dec/2021:12:40:48 +0000]\", \"url\": \"\\\"GET / HTTP/1.1\\\"\", \"status\": \"404\", \"size\": \"683\" \u5177\u4f53\u914d\u7f6e\u7684\u65f6\u5019\uff0c\u5efa\u8bae\u5148\u4f7f\u7528\u4e00\u4e9b\u6b63\u5219\u8c03\u8bd5\u5de5\u5177 ( https://regex101.com/ ) \u9a8c\u8bc1\u662f\u5426\u53ef\u4ee5\u5339\u914d\u3002 jsonDecode \u00b6 \u5c06\u6307\u5b9a\u5b57\u6bb5json\u89e3\u6790\u63d0\u53d6\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 jsonDecode.target string \u975e\u5fc5\u586b body json decode\u7684\u76ee\u6807\u5b57\u6bb5 jsonDecode.ignoreError bool \u975e\u5fc5\u586b false \u662f\u5426\u5ffd\u7565\u9519\u8bef Example interceptors : - type : normalize processors : - jsonDecode : ~ split \u00b6 \u5c06\u6307\u5b9a\u5b57\u6bb5\u901a\u8fc7\u5206\u9694\u7b26\u8fdb\u884c\u63d0\u53d6\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 split.target string \u975e\u5fc5\u586b body split\u7684\u76ee\u6807\u5b57\u6bb5 split.separator string \u5fc5\u586b \u65e0 \u5206\u9694\u7b26 split.max int \u975e\u5fc5\u586b -1 \u901a\u8fc7\u5206\u5272\u7b26\u5206\u5272\u540e\u5f97\u5230\u7684\u6700\u591a\u7684\u5b57\u6bb5\u6570 split.keys string\u6570\u7ec4 \u5fc5\u586b \u65e0 \u5206\u5272\u540e\u5b57\u6bb5\u5bf9\u5e94\u7684key split.ignoreError bool \u975e\u5fc5\u586b false \u662f\u5426\u5ffd\u7565\u9519\u8bef Example base interceptors : - type : normalize processors : - split : separator : '|' keys : [ \"time\" , \"order\" , \"service\" , \"price\" ] \u4f7f\u7528\u4ee5\u4e0asplit\u914d\u7f6e\u53ef\u4ee5\u5c06\u65e5\u5fd7\uff1a 2021-08-08|U12345|storeCenter|13.14 \u8f6c\u6362\u6210\uff1a \"time\": \"2021-08-08\" \"order\": \"U12345\" \"service\": \"storeCenter\" \"price: 13.14 max interceptors : - type : normalize processors : - split : separator : ' ' max : 2 keys : [ \"time\" , \"content\" ] \u901a\u8fc7\u589e\u52a0 max \u53c2\u6570\uff0c\u53ef\u4ee5\u63a7\u5236\u6700\u591a\u5206\u5272\u7684\u5b57\u6bb5\u3002 \u6bd4\u5982\u4ee5\u4e0b\u65e5\u5fd7: 2021-08-08 U12345 storeCenter 13.14 \u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0a\u914d\u7f6e\u63d0\u53d6\u4e3a: \"time\": \"2021-08-08\" \"content\": \"U12345 storeCenter 13.14\" drop \u00b6 \u4e22\u5f03\u6307\u5b9a\u5b57\u6bb5\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 drop.targets string\u6570\u7ec4 \u5fc5\u586b \u65e0 drop\u7684\u5b57\u6bb5 Example interceptors : - type : normalize processors : - drop : targets : [ \"id\" , \"body\" ] rename \u00b6 \u91cd\u547d\u540d\u6307\u5b9a\u5b57\u6bb5\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 rename.convert \u6570\u7ec4 \u5fc5\u586b \u65e0 rename.convert[n].from string \u5fc5\u586b \u65e0 rename\u7684\u76ee\u6807 rename.convert[n].to string \u5fc5\u586b \u65e0 rename\u540e\u7684\u540d\u79f0 Example interceptors : - type : normalize processors : - rename : convert : - from : \"hello\" to : \"world\" add \u00b6 \u65b0\u589e\u5b57\u6bb5\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 add.fields map \u5fc5\u586b \u65e0 \u65b0\u589e\u7684key:value\u503c Example interceptors : - type : normalize processors : - add : fields : hello : world convert \u00b6 \u5b57\u6bb5\u7c7b\u578b\u8f6c\u6362\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 convert.convert \u6570\u7ec4 \u5fc5\u586b \u65e0 convert.convert[n].from string \u5fc5\u586b \u65e0 \u9700\u8981\u8f6c\u6362\u7684\u5b57\u6bb5\u540d convert.convert[n].to string \u5fc5\u586b \u65e0 \u8f6c\u6362\u540e\u7684\u7c7b\u578b\uff0c\u53ef\u4e3a\uff1a\"bool\", \"integer\", \"float\" Example interceptors : - type : normalize processors : - convert : convert : - from : count to : float copy \u00b6 \u5b57\u6bb5\u590d\u5236\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 copy.convert \u6570\u7ec4 \u5fc5\u586b \u65e0 copy.convert[n].from string \u5fc5\u586b \u65e0 \u9700\u8981\u590d\u5236\u7684\u5b57\u6bb5\u540d copy.convert[n].to string \u5fc5\u586b \u65e0 \u590d\u5236\u540e\u7684\u5b57\u6bb5\u540d Example interceptors : - type : normalize processors : - copy : convert : - from : hello to : world underRoot \u00b6 \u5c06\u5b57\u6bb5\u4e2d\u7684\u6240\u6709 key:value \u653e\u5230event\u6700\u5916\u5c42\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 underRoot.keys string\u6570\u7ec4 \u5fc5\u586b \u65e0 \u9700\u8981underRoot\u7684\u5b57\u6bb5\u540d Example interceptors : - type : normalize processors : - underRoot : keys : [ \"fields\" ] timestamp \u00b6 \u8f6c\u6362\u65f6\u95f4\u683c\u5f0f\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 timestamp.convert \u6570\u7ec4 \u5fc5\u586b \u65e0 timestamp.convert[n].from string \u5fc5\u586b \u65e0 \u6307\u5b9a\u8f6c\u6362\u65f6\u95f4\u683c\u5f0f\u7684\u5b57\u6bb5 timestamp.convert[n].fromLayout string \u5fc5\u586b \u65e0 \u6307\u5b9a\u5b57\u6bb5\u7684\u65f6\u95f4\u683c\u5f0f(golang\u5f62\u5f0f) timestamp.convert[n].toLayout string \u5fc5\u586b \u65e0 \u8f6c\u6362\u540e\u7684\u65f6\u95f4\u683c\u5f0f(golang\u5f62\u5f0f)\uff0c\u53e6\u5916\u53ef\u4e3a unix \u548c unix_ms timestamp.convert[n].toType string \u975e\u5fc5\u586b \u65e0 \u8f6c\u6362\u540e\u7684\u65f6\u95f4\u5b57\u6bb5\u7c7b\u578b timestamp.convert[n].local bool \u975e\u5fc5\u586b false \u662f\u5426\u5c06\u89e3\u6790\u7684\u65f6\u95f4\u8f6c\u6210\u5f53\u524d\u65f6\u533a Example interceptors : - type : normalize processors : - timestamp : convert : - from : logtime fromLayout : \"2006-01-02T15:04:05Z07:00\" toLayout : \"unix\" \u4ee5\u4e0a\u7684layout\u53c2\u6570\u9700\u8981\u586b\u5199golang\u5f62\u5f0f\uff0c\u53ef\u53c2\u8003\uff1a const ( Layout = \"01/02 03:04:05PM '06 -0700\" // The reference time, in numerical order. ANSIC = \"Mon Jan _2 15:04:05 2006\" UnixDate = \"Mon Jan _2 15:04:05 MST 2006\" RubyDate = \"Mon Jan 02 15:04:05 -0700 2006\" RFC822 = \"02 Jan 06 15:04 MST\" RFC822Z = \"02 Jan 06 15:04 -0700\" // RFC822 with numeric zone RFC850 = \"Monday, 02-Jan-06 15:04:05 MST\" RFC1123 = \"Mon, 02 Jan 2006 15:04:05 MST\" RFC1123Z = \"Mon, 02 Jan 2006 15:04:05 -0700\" // RFC1123 with numeric zone RFC3339 = \"2006-01-02T15:04:05Z07:00\" RFC3339Nano = \"2006-01-02T15:04:05.999999999Z07:00\" Kitchen = \"3:04PM\" // Handy time stamps. Stamp = \"Jan _2 15:04:05\" StampMilli = \"Jan _2 15:04:05.000\" StampMicro = \"Jan _2 15:04:05.000000\" StampNano = \"Jan _2 15:04:05.000000000\" ) \u8fd8\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u4fee\u6539\u3002 fmt \u00b6 \u5b57\u6bb5\u5185\u5bb9\u91cd\u65b0\u683c\u5f0f\u5316\u3002\u53ef\u6839\u636e\u5176\u4ed6\u5b57\u6bb5\u5185\u5bb9\u8fdb\u884c\u7ec4\u5408\u548c\u683c\u5f0f\u5316\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 fmt.fields map \u5fc5\u586b \u65e0 key\u8868\u793a\u9700\u8981\u683c\u5f0f\u5316\u7684\u5b57\u6bb5\u540d\u79f0\uff0cvalue\u4e3a\u9700\u8981\u683c\u5f0f\u5316\u7684\u5185\u5bb9\u3002\u53ef\u4f7f\u7528 ${} \u7684\u65b9\u5f0f\u8868\u793a\u53d6\u503c\u67d0\u4e2a\u5b57\u6bb5 Example interceptors : - type : normalize processors : - fmt : fields : d : new-${a.b}-${c}","title":"normalize"},{"location":"reference/pipelines/interceptor/normalize/#normalize","text":"\u7528\u4e8e\u65e5\u5fd7\u5207\u5206\u5904\u7406\u3002 \u5c5e\u4e8esource interceptor\u3002\u53ef\u6307\u5b9a\u53ea\u88ab\u67d0\u4e9bsource\u4f7f\u7528\u3002 \u5177\u4f53\u4f7f\u7528\u793a\u4f8b\u53ef\u53c2\u8003 \u65e5\u5fd7\u5207\u5206\u4e0e\u5904\u7406 \u3002","title":"normalize"},{"location":"reference/pipelines/interceptor/normalize/#processors","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 processors \u6570\u7ec4 \u5fc5\u586b \u65e0 \u6240\u6709\u7684\u5904\u7406processor\u5217\u8868 \u914d\u7f6e\u7684processor\u5c06\u6309\u7167\u987a\u5e8f\u4f9d\u6b21\u6267\u884c\u3002 Tips Loggie\u652f\u6301\u4f7f\u7528 a.b \u7684\u5f62\u5f0f\u5f15\u7528\u5d4c\u5957\u7684\u5b57\u6bb5\u3002 \u6bd4\u5982\u6570\u636e\u4e3a: { \"fields\" : { \"hello\" : \"world\" } } \u4e0b\u9762\u7684processor\u914d\u7f6e\u4e2d\u5747\u53ef\u4ee5\u4f7f\u7528 fields.hello \u6307\u5b9a\u5d4c\u5957\u5728 fields \u91cc\u7684 hello: world \u3002","title":"processors"},{"location":"reference/pipelines/interceptor/normalize/#addmeta","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cLoggie\u4e0d\u4f1a\u6dfb\u52a0\u4efb\u4f55\u7684\u7cfb\u7edf\u5185\u90e8\u4fe1\u606f\u5230\u539f\u59cb\u6570\u636e\u4e2d\u3002 \u53ef\u901a\u8fc7addMeta\u6dfb\u52a0\u7cfb\u7edf\u5185\u7f6e\u5b57\u6bb5\u53d1\u9001\u7ed9\u4e0b\u6e38\u3002 Note \u8bf7\u6ce8\u610f\uff0c\u5728pipeline\u4e2d\u914d\u7f6eaddMeta\uff0c\u53ea\u4f1a\u5f71\u54cd\u8be5pipeline\u53d1\u9001\u7684\u6240\u6709\u6570\u636e\uff0c\u5982\u679c\u9700\u8981\u5168\u5c40\u751f\u6548\uff0c\u8bf7\u5728 defaults \u4e2d\u914d\u7f6enormalize.addMeta\u3002 loggie: defaults: interceptors: - type: normalize name: global processors: - addMeta: ~ \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 target string \u975e\u5fc5\u586b meta \u7cfb\u7edf\u5185\u7f6e\u5b57\u6bb5\u6dfb\u52a0\u5230event\u4e2d\u7684\u5b57\u6bb5\u540d","title":"addMeta"},{"location":"reference/pipelines/interceptor/normalize/#regex","text":"\u5c06\u6307\u5b9a\u5b57\u6bb5\u8fdb\u884c\u6b63\u5219\u63d0\u53d6\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 regex.pattern string \u5fc5\u586b \u65e0 \u6b63\u5219\u89e3\u6790\u89c4\u5219 regex.target string \u975e\u5fc5\u586b body \u6b63\u5219\u89e3\u6790\u7684\u76ee\u6807\u5b57\u6bb5 regex.ignoreError bool \u975e\u5fc5\u586b false \u662f\u5426\u5ffd\u7565\u9519\u8bef Example interceptors : - type : normalize processors : - regex : pattern : '(?<ip>\\S+) (?<id>\\S+) (?<u>\\S+) (?<time>\\[.*?\\]) (?<url>\\\".*?\\\") (?<status>\\S+) (?<size>\\S+)' \u4f7f\u7528\u4ee5\u4e0a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u53ef\u4ee5\u5c06\u4ee5\u4e0b\u793a\u4f8b\u7684\u65e5\u5fd7\uff1a 10.244.0.1 - - [13/Dec/2021:12:40:48 +0000] \"GET / HTTP/1.1\" 404 683 \u8f6c\u6362\u6210\uff1a \"ip\": \"10.244.0.1\", \"id\": \"-\", \"u\": \"-\", \"time\": \"[13/Dec/2021:12:40:48 +0000]\", \"url\": \"\\\"GET / HTTP/1.1\\\"\", \"status\": \"404\", \"size\": \"683\" \u5177\u4f53\u914d\u7f6e\u7684\u65f6\u5019\uff0c\u5efa\u8bae\u5148\u4f7f\u7528\u4e00\u4e9b\u6b63\u5219\u8c03\u8bd5\u5de5\u5177 ( https://regex101.com/ ) \u9a8c\u8bc1\u662f\u5426\u53ef\u4ee5\u5339\u914d\u3002","title":"regex"},{"location":"reference/pipelines/interceptor/normalize/#jsondecode","text":"\u5c06\u6307\u5b9a\u5b57\u6bb5json\u89e3\u6790\u63d0\u53d6\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 jsonDecode.target string \u975e\u5fc5\u586b body json decode\u7684\u76ee\u6807\u5b57\u6bb5 jsonDecode.ignoreError bool \u975e\u5fc5\u586b false \u662f\u5426\u5ffd\u7565\u9519\u8bef Example interceptors : - type : normalize processors : - jsonDecode : ~","title":"jsonDecode"},{"location":"reference/pipelines/interceptor/normalize/#split","text":"\u5c06\u6307\u5b9a\u5b57\u6bb5\u901a\u8fc7\u5206\u9694\u7b26\u8fdb\u884c\u63d0\u53d6\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 split.target string \u975e\u5fc5\u586b body split\u7684\u76ee\u6807\u5b57\u6bb5 split.separator string \u5fc5\u586b \u65e0 \u5206\u9694\u7b26 split.max int \u975e\u5fc5\u586b -1 \u901a\u8fc7\u5206\u5272\u7b26\u5206\u5272\u540e\u5f97\u5230\u7684\u6700\u591a\u7684\u5b57\u6bb5\u6570 split.keys string\u6570\u7ec4 \u5fc5\u586b \u65e0 \u5206\u5272\u540e\u5b57\u6bb5\u5bf9\u5e94\u7684key split.ignoreError bool \u975e\u5fc5\u586b false \u662f\u5426\u5ffd\u7565\u9519\u8bef Example base interceptors : - type : normalize processors : - split : separator : '|' keys : [ \"time\" , \"order\" , \"service\" , \"price\" ] \u4f7f\u7528\u4ee5\u4e0asplit\u914d\u7f6e\u53ef\u4ee5\u5c06\u65e5\u5fd7\uff1a 2021-08-08|U12345|storeCenter|13.14 \u8f6c\u6362\u6210\uff1a \"time\": \"2021-08-08\" \"order\": \"U12345\" \"service\": \"storeCenter\" \"price: 13.14 max interceptors : - type : normalize processors : - split : separator : ' ' max : 2 keys : [ \"time\" , \"content\" ] \u901a\u8fc7\u589e\u52a0 max \u53c2\u6570\uff0c\u53ef\u4ee5\u63a7\u5236\u6700\u591a\u5206\u5272\u7684\u5b57\u6bb5\u3002 \u6bd4\u5982\u4ee5\u4e0b\u65e5\u5fd7: 2021-08-08 U12345 storeCenter 13.14 \u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0a\u914d\u7f6e\u63d0\u53d6\u4e3a: \"time\": \"2021-08-08\" \"content\": \"U12345 storeCenter 13.14\"","title":"split"},{"location":"reference/pipelines/interceptor/normalize/#drop","text":"\u4e22\u5f03\u6307\u5b9a\u5b57\u6bb5\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 drop.targets string\u6570\u7ec4 \u5fc5\u586b \u65e0 drop\u7684\u5b57\u6bb5 Example interceptors : - type : normalize processors : - drop : targets : [ \"id\" , \"body\" ]","title":"drop"},{"location":"reference/pipelines/interceptor/normalize/#rename","text":"\u91cd\u547d\u540d\u6307\u5b9a\u5b57\u6bb5\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 rename.convert \u6570\u7ec4 \u5fc5\u586b \u65e0 rename.convert[n].from string \u5fc5\u586b \u65e0 rename\u7684\u76ee\u6807 rename.convert[n].to string \u5fc5\u586b \u65e0 rename\u540e\u7684\u540d\u79f0 Example interceptors : - type : normalize processors : - rename : convert : - from : \"hello\" to : \"world\"","title":"rename"},{"location":"reference/pipelines/interceptor/normalize/#add","text":"\u65b0\u589e\u5b57\u6bb5\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 add.fields map \u5fc5\u586b \u65e0 \u65b0\u589e\u7684key:value\u503c Example interceptors : - type : normalize processors : - add : fields : hello : world","title":"add"},{"location":"reference/pipelines/interceptor/normalize/#convert","text":"\u5b57\u6bb5\u7c7b\u578b\u8f6c\u6362\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 convert.convert \u6570\u7ec4 \u5fc5\u586b \u65e0 convert.convert[n].from string \u5fc5\u586b \u65e0 \u9700\u8981\u8f6c\u6362\u7684\u5b57\u6bb5\u540d convert.convert[n].to string \u5fc5\u586b \u65e0 \u8f6c\u6362\u540e\u7684\u7c7b\u578b\uff0c\u53ef\u4e3a\uff1a\"bool\", \"integer\", \"float\" Example interceptors : - type : normalize processors : - convert : convert : - from : count to : float","title":"convert"},{"location":"reference/pipelines/interceptor/normalize/#copy","text":"\u5b57\u6bb5\u590d\u5236\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 copy.convert \u6570\u7ec4 \u5fc5\u586b \u65e0 copy.convert[n].from string \u5fc5\u586b \u65e0 \u9700\u8981\u590d\u5236\u7684\u5b57\u6bb5\u540d copy.convert[n].to string \u5fc5\u586b \u65e0 \u590d\u5236\u540e\u7684\u5b57\u6bb5\u540d Example interceptors : - type : normalize processors : - copy : convert : - from : hello to : world","title":"copy"},{"location":"reference/pipelines/interceptor/normalize/#underroot","text":"\u5c06\u5b57\u6bb5\u4e2d\u7684\u6240\u6709 key:value \u653e\u5230event\u6700\u5916\u5c42\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 underRoot.keys string\u6570\u7ec4 \u5fc5\u586b \u65e0 \u9700\u8981underRoot\u7684\u5b57\u6bb5\u540d Example interceptors : - type : normalize processors : - underRoot : keys : [ \"fields\" ]","title":"underRoot"},{"location":"reference/pipelines/interceptor/normalize/#timestamp","text":"\u8f6c\u6362\u65f6\u95f4\u683c\u5f0f\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 timestamp.convert \u6570\u7ec4 \u5fc5\u586b \u65e0 timestamp.convert[n].from string \u5fc5\u586b \u65e0 \u6307\u5b9a\u8f6c\u6362\u65f6\u95f4\u683c\u5f0f\u7684\u5b57\u6bb5 timestamp.convert[n].fromLayout string \u5fc5\u586b \u65e0 \u6307\u5b9a\u5b57\u6bb5\u7684\u65f6\u95f4\u683c\u5f0f(golang\u5f62\u5f0f) timestamp.convert[n].toLayout string \u5fc5\u586b \u65e0 \u8f6c\u6362\u540e\u7684\u65f6\u95f4\u683c\u5f0f(golang\u5f62\u5f0f)\uff0c\u53e6\u5916\u53ef\u4e3a unix \u548c unix_ms timestamp.convert[n].toType string \u975e\u5fc5\u586b \u65e0 \u8f6c\u6362\u540e\u7684\u65f6\u95f4\u5b57\u6bb5\u7c7b\u578b timestamp.convert[n].local bool \u975e\u5fc5\u586b false \u662f\u5426\u5c06\u89e3\u6790\u7684\u65f6\u95f4\u8f6c\u6210\u5f53\u524d\u65f6\u533a Example interceptors : - type : normalize processors : - timestamp : convert : - from : logtime fromLayout : \"2006-01-02T15:04:05Z07:00\" toLayout : \"unix\" \u4ee5\u4e0a\u7684layout\u53c2\u6570\u9700\u8981\u586b\u5199golang\u5f62\u5f0f\uff0c\u53ef\u53c2\u8003\uff1a const ( Layout = \"01/02 03:04:05PM '06 -0700\" // The reference time, in numerical order. ANSIC = \"Mon Jan _2 15:04:05 2006\" UnixDate = \"Mon Jan _2 15:04:05 MST 2006\" RubyDate = \"Mon Jan 02 15:04:05 -0700 2006\" RFC822 = \"02 Jan 06 15:04 MST\" RFC822Z = \"02 Jan 06 15:04 -0700\" // RFC822 with numeric zone RFC850 = \"Monday, 02-Jan-06 15:04:05 MST\" RFC1123 = \"Mon, 02 Jan 2006 15:04:05 MST\" RFC1123Z = \"Mon, 02 Jan 2006 15:04:05 -0700\" // RFC1123 with numeric zone RFC3339 = \"2006-01-02T15:04:05Z07:00\" RFC3339Nano = \"2006-01-02T15:04:05.999999999Z07:00\" Kitchen = \"3:04PM\" // Handy time stamps. Stamp = \"Jan _2 15:04:05\" StampMilli = \"Jan _2 15:04:05.000\" StampMicro = \"Jan _2 15:04:05.000000\" StampNano = \"Jan _2 15:04:05.000000000\" ) \u8fd8\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u4fee\u6539\u3002","title":"timestamp"},{"location":"reference/pipelines/interceptor/normalize/#fmt","text":"\u5b57\u6bb5\u5185\u5bb9\u91cd\u65b0\u683c\u5f0f\u5316\u3002\u53ef\u6839\u636e\u5176\u4ed6\u5b57\u6bb5\u5185\u5bb9\u8fdb\u884c\u7ec4\u5408\u548c\u683c\u5f0f\u5316\u3002 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 fmt.fields map \u5fc5\u586b \u65e0 key\u8868\u793a\u9700\u8981\u683c\u5f0f\u5316\u7684\u5b57\u6bb5\u540d\u79f0\uff0cvalue\u4e3a\u9700\u8981\u683c\u5f0f\u5316\u7684\u5185\u5bb9\u3002\u53ef\u4f7f\u7528 ${} \u7684\u65b9\u5f0f\u8868\u793a\u53d6\u503c\u67d0\u4e2a\u5b57\u6bb5 Example interceptors : - type : normalize processors : - fmt : fields : d : new-${a.b}-${c}","title":"fmt"},{"location":"reference/pipelines/interceptor/overview/","text":"Overview \u00b6 interceptors\u5b57\u6bb5\u4e3a\u6570\u7ec4\uff0c\u4e00\u4e2aPipeline\u4e2d\u53ef\u586b\u5199\u591a\u4e2ainterceptor\u7ec4\u4ef6\u914d\u7f6e\u3002 \u76ee\u524d\uff0cinterceptor\u5206\u4e3a\u4e24\u79cd\u7c7b\u578b\uff1a source interceptor\uff1a\u8fd0\u884c\u5728source\u53d1\u9001\u6570\u636e\u5230queue\u7684\u8fc7\u7a0b\u4e2d\uff0c source -> source interceptor -> queue \u3002 sink interceptor\uff1a\u8fd0\u884c\u5728queue\u5230sink\u7684\u8fc7\u7a0b\u4e2d\uff0c queue -> sink interceptor -> sink \u3002 \u4e00\u4e2ainterceptor\u53ea\u5c5e\u4e8e\u5176\u4e2d\u4e00\u79cd\u3002\u5927\u90e8\u5206\u7ec4\u4ef6\u4e3asource interceptor\u7c7b\u578b\uff0c\u53ef\u652f\u6301\u914d\u7f6ebelongTo\u88ab\u90e8\u5206source\u4f7f\u7528\u3002\u5c11\u6570\u901a\u7528\u6027\u8d28\u7684\u6bd4\u5982retry interceptor\u4e3asink interceptor\u7c7b\u578b\u3002 Interceptor\u901a\u7528\u914d\u7f6e \u00b6 enabled \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 enabled bool \u975e\u5fc5\u586b true \u8868\u793a\u662f\u5426\u5f00\u542f\u8be5interceptor name \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 name string \u975e\u5fc5\u586b \u8868\u793ainterceptor\u7684\u540d\u79f0\u3002\u5f53pipeline\u91cc\u914d\u7f6e\u76f8\u540ctype interceptor\u7684\u60c5\u51b5\u4e0b\uff0c\u5fc5\u586b\uff0c\u7528\u4e8e\u533a\u5206\u6807\u8bc6 belongTo \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 belongTo string\u6570\u7ec4 \u975e\u5fc5\u586b \u4ec5source interceptor\u53ef\u7528\uff0c\u7528\u4e8e\u6307\u5b9a\u8be5interceptor\u4ec5\u88ab\u54ea\u4e9bsource\u4f7f\u7528 order \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 order int \u975e\u5fc5\u586b interceptor\u7684\u6392\u5217\u987a\u5e8f\u6743\u91cd","title":"Overview"},{"location":"reference/pipelines/interceptor/overview/#overview","text":"interceptors\u5b57\u6bb5\u4e3a\u6570\u7ec4\uff0c\u4e00\u4e2aPipeline\u4e2d\u53ef\u586b\u5199\u591a\u4e2ainterceptor\u7ec4\u4ef6\u914d\u7f6e\u3002 \u76ee\u524d\uff0cinterceptor\u5206\u4e3a\u4e24\u79cd\u7c7b\u578b\uff1a source interceptor\uff1a\u8fd0\u884c\u5728source\u53d1\u9001\u6570\u636e\u5230queue\u7684\u8fc7\u7a0b\u4e2d\uff0c source -> source interceptor -> queue \u3002 sink interceptor\uff1a\u8fd0\u884c\u5728queue\u5230sink\u7684\u8fc7\u7a0b\u4e2d\uff0c queue -> sink interceptor -> sink \u3002 \u4e00\u4e2ainterceptor\u53ea\u5c5e\u4e8e\u5176\u4e2d\u4e00\u79cd\u3002\u5927\u90e8\u5206\u7ec4\u4ef6\u4e3asource interceptor\u7c7b\u578b\uff0c\u53ef\u652f\u6301\u914d\u7f6ebelongTo\u88ab\u90e8\u5206source\u4f7f\u7528\u3002\u5c11\u6570\u901a\u7528\u6027\u8d28\u7684\u6bd4\u5982retry interceptor\u4e3asink interceptor\u7c7b\u578b\u3002","title":"Overview"},{"location":"reference/pipelines/interceptor/overview/#interceptor","text":"","title":"Interceptor\u901a\u7528\u914d\u7f6e"},{"location":"reference/pipelines/interceptor/overview/#enabled","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 enabled bool \u975e\u5fc5\u586b true \u8868\u793a\u662f\u5426\u5f00\u542f\u8be5interceptor","title":"enabled"},{"location":"reference/pipelines/interceptor/overview/#name","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 name string \u975e\u5fc5\u586b \u8868\u793ainterceptor\u7684\u540d\u79f0\u3002\u5f53pipeline\u91cc\u914d\u7f6e\u76f8\u540ctype interceptor\u7684\u60c5\u51b5\u4e0b\uff0c\u5fc5\u586b\uff0c\u7528\u4e8e\u533a\u5206\u6807\u8bc6","title":"name"},{"location":"reference/pipelines/interceptor/overview/#belongto","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 belongTo string\u6570\u7ec4 \u975e\u5fc5\u586b \u4ec5source interceptor\u53ef\u7528\uff0c\u7528\u4e8e\u6307\u5b9a\u8be5interceptor\u4ec5\u88ab\u54ea\u4e9bsource\u4f7f\u7528","title":"belongTo"},{"location":"reference/pipelines/interceptor/overview/#order","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 order int \u975e\u5fc5\u586b interceptor\u7684\u6392\u5217\u987a\u5e8f\u6743\u91cd","title":"order"},{"location":"reference/pipelines/interceptor/retry/","text":"retry \u00b6 \u7528\u4e8e\u7ed9\u4e0b\u6e38\u53d1\u9001\u5931\u8d25\u65f6\u91cd\u8bd5\u3002 \u7cfb\u7edf\u5185\u7f6e\uff0c\u9ed8\u8ba4\u52a0\u8f7d\uff0c\u5c5e\u4e8esink interceptor\u3002 Example interceptors : - type : retry retryMaxCount \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 retryMaxCount int \u975e\u5fc5\u586b 0 \u6700\u5927\u7684\u91cd\u8bd5\u6b21\u6570","title":"retry"},{"location":"reference/pipelines/interceptor/retry/#retry","text":"\u7528\u4e8e\u7ed9\u4e0b\u6e38\u53d1\u9001\u5931\u8d25\u65f6\u91cd\u8bd5\u3002 \u7cfb\u7edf\u5185\u7f6e\uff0c\u9ed8\u8ba4\u52a0\u8f7d\uff0c\u5c5e\u4e8esink interceptor\u3002 Example interceptors : - type : retry","title":"retry"},{"location":"reference/pipelines/interceptor/retry/#retrymaxcount","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 retryMaxCount int \u975e\u5fc5\u586b 0 \u6700\u5927\u7684\u91cd\u8bd5\u6b21\u6570","title":"retryMaxCount"},{"location":"reference/pipelines/queue/channel/","text":"channel \u00b6 channel queue,\u662f\u57fa\u4e8ego chan\u5b9e\u73b0\u7684\u5185\u5b58\u7f13\u51b2queue\u3002 Example queue : type : channel batchSize \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchSize int \u4e0d\u5fc5\u586b 2048 \u4e00\u4e2a\u6279\u6b21\u5305\u542b\u7684event\u6570\u91cf batchBytes \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchBytes int64 \u4e0d\u5fc5\u586b 33554432(32MB) \u4e00\u4e2a\u6279\u6b21\u5305\u542b\u7684\u6570\u636e\u6700\u5927\u5b57\u8282\u6570 batchAggTimeout \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchAggTimeout time.Duration \u4e0d\u5fc5\u586b 1s \u7ec4\u88c5\u805a\u5408\u591a\u4e2aevent\u6210\u4e00\u4e2abatch\u7b49\u5f85\u7684\u8d85\u65f6\u65f6\u95f4","title":"channel"},{"location":"reference/pipelines/queue/channel/#channel","text":"channel queue,\u662f\u57fa\u4e8ego chan\u5b9e\u73b0\u7684\u5185\u5b58\u7f13\u51b2queue\u3002 Example queue : type : channel","title":"channel"},{"location":"reference/pipelines/queue/channel/#batchsize","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchSize int \u4e0d\u5fc5\u586b 2048 \u4e00\u4e2a\u6279\u6b21\u5305\u542b\u7684event\u6570\u91cf","title":"batchSize"},{"location":"reference/pipelines/queue/channel/#batchbytes","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchBytes int64 \u4e0d\u5fc5\u586b 33554432(32MB) \u4e00\u4e2a\u6279\u6b21\u5305\u542b\u7684\u6570\u636e\u6700\u5927\u5b57\u8282\u6570","title":"batchBytes"},{"location":"reference/pipelines/queue/channel/#batchaggtimeout","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchAggTimeout time.Duration \u4e0d\u5fc5\u586b 1s \u7ec4\u88c5\u805a\u5408\u591a\u4e2aevent\u6210\u4e00\u4e2abatch\u7b49\u5f85\u7684\u8d85\u65f6\u65f6\u95f4","title":"batchAggTimeout"},{"location":"reference/pipelines/queue/memory/","text":"memory \u00b6 memory queue,\u662f\u57fa\u4e8e go-disruptor \u5b9e\u73b0\u7684\u5185\u5b58\u7f13\u51b2queue\u3002 Note \u7531\u4e8ego-disruptor\u7248\u672c\u8fd8\u672arelease\uff0cmemory queue\u8fd8\u5c5e\u4e8e\u5b9e\u9a8c\u9636\u6bb5\u3002\u751f\u4ea7\u73af\u5883\u4e0d\u5efa\u8bae\u4f7f\u7528\uff01 Example queue : type : memory batchSize \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchSize int \u4e0d\u5fc5\u586b 2048 \u4e00\u4e2a\u6279\u6b21\u5305\u542b\u7684event\u6570\u91cf batchBufferFactor \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchBufferFactor int \u4e0d\u5fc5\u586b 2 queue\u7f13\u51b2\u533a\u7684\u5927\u5c0f(channel\u7684\u5bb9\u91cf)=batchSize*batchBufferFactor batchBytes \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchBytes int64 \u4e0d\u5fc5\u586b 33554432(32MB) \u4e00\u4e2a\u6279\u6b21\u5305\u542b\u7684\u6570\u636e\u6700\u5927\u5b57\u8282\u6570 batchAggTimeout \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchAggTimeout time.Duration \u4e0d\u5fc5\u586b 1s \u7ec4\u88c5\u805a\u5408\u591a\u4e2aevent\u6210\u4e00\u4e2abatch\u7b49\u5f85\u7684\u8d85\u65f6\u65f6\u95f4","title":"memory"},{"location":"reference/pipelines/queue/memory/#memory","text":"memory queue,\u662f\u57fa\u4e8e go-disruptor \u5b9e\u73b0\u7684\u5185\u5b58\u7f13\u51b2queue\u3002 Note \u7531\u4e8ego-disruptor\u7248\u672c\u8fd8\u672arelease\uff0cmemory queue\u8fd8\u5c5e\u4e8e\u5b9e\u9a8c\u9636\u6bb5\u3002\u751f\u4ea7\u73af\u5883\u4e0d\u5efa\u8bae\u4f7f\u7528\uff01 Example queue : type : memory","title":"memory"},{"location":"reference/pipelines/queue/memory/#batchsize","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchSize int \u4e0d\u5fc5\u586b 2048 \u4e00\u4e2a\u6279\u6b21\u5305\u542b\u7684event\u6570\u91cf","title":"batchSize"},{"location":"reference/pipelines/queue/memory/#batchbufferfactor","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchBufferFactor int \u4e0d\u5fc5\u586b 2 queue\u7f13\u51b2\u533a\u7684\u5927\u5c0f(channel\u7684\u5bb9\u91cf)=batchSize*batchBufferFactor","title":"batchBufferFactor"},{"location":"reference/pipelines/queue/memory/#batchbytes","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchBytes int64 \u4e0d\u5fc5\u586b 33554432(32MB) \u4e00\u4e2a\u6279\u6b21\u5305\u542b\u7684\u6570\u636e\u6700\u5927\u5b57\u8282\u6570","title":"batchBytes"},{"location":"reference/pipelines/queue/memory/#batchaggtimeout","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchAggTimeout time.Duration \u4e0d\u5fc5\u586b 1s \u7ec4\u88c5\u805a\u5408\u591a\u4e2aevent\u6210\u4e00\u4e2abatch\u7b49\u5f85\u7684\u8d85\u65f6\u65f6\u95f4","title":"batchAggTimeout"},{"location":"reference/pipelines/sink/dev/","text":"dev \u00b6 dev sink\u5c06\u65e5\u5fd7\u6570\u636e\u6253\u5370\u5230\u63a7\u5236\u53f0\uff0c\u4e00\u822c\u53ef\u4ee5\u7528\u4e8edebug\u6216\u8005\u6392\u67e5\u95ee\u9898\u3002 \u914d\u7f6edev sink\u540e\uff0c\u53ef\u4ee5\u8bbe\u7f6eprintEvents=true\uff0c\u67e5\u770b\u5728Loggie\u4e2d\u53d1\u9001\u81f3sink\u7684\u65e5\u5fd7\u6570\u636e\uff0c\u8be5\u6570\u636e\u9664\u4e86source\u63a5\u6536\u6216\u8005\u91c7\u96c6\u7684\u539f\u59cb\u65e5\u5fd7\uff0c\u4e00\u822c\u8fd8\u5305\u542b\u5176\u4ed6\u5143\u4fe1\u606f\u3002 Example sink : type : dev printEvents : true codec : type : json pretty : true printEvents \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 printEvents bool \u975e\u5fc5\u586b false \u662f\u5426\u6253\u5370\u91c7\u96c6\u7684\u65e5\u5fd7 \u9ed8\u8ba4\u60c5\u51b5\u4e0bLoggie\u7684\u65e5\u5fd7\u6253\u5370\u4e3ajson\u683c\u5f0f\uff0c\u53ef\u4ee5\u914d\u7f6e\u542f\u52a8\u53c2\u6570 -log.jsonFormat=false \uff0c\u4fbf\u4e8e\u5728Loggie\u65e5\u5fd7\u4e0a\u67e5\u770b\u8f93\u51fa\u7ed3\u679c\u3002","title":"dev"},{"location":"reference/pipelines/sink/dev/#dev","text":"dev sink\u5c06\u65e5\u5fd7\u6570\u636e\u6253\u5370\u5230\u63a7\u5236\u53f0\uff0c\u4e00\u822c\u53ef\u4ee5\u7528\u4e8edebug\u6216\u8005\u6392\u67e5\u95ee\u9898\u3002 \u914d\u7f6edev sink\u540e\uff0c\u53ef\u4ee5\u8bbe\u7f6eprintEvents=true\uff0c\u67e5\u770b\u5728Loggie\u4e2d\u53d1\u9001\u81f3sink\u7684\u65e5\u5fd7\u6570\u636e\uff0c\u8be5\u6570\u636e\u9664\u4e86source\u63a5\u6536\u6216\u8005\u91c7\u96c6\u7684\u539f\u59cb\u65e5\u5fd7\uff0c\u4e00\u822c\u8fd8\u5305\u542b\u5176\u4ed6\u5143\u4fe1\u606f\u3002 Example sink : type : dev printEvents : true codec : type : json pretty : true","title":"dev"},{"location":"reference/pipelines/sink/dev/#printevents","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 printEvents bool \u975e\u5fc5\u586b false \u662f\u5426\u6253\u5370\u91c7\u96c6\u7684\u65e5\u5fd7 \u9ed8\u8ba4\u60c5\u51b5\u4e0bLoggie\u7684\u65e5\u5fd7\u6253\u5370\u4e3ajson\u683c\u5f0f\uff0c\u53ef\u4ee5\u914d\u7f6e\u542f\u52a8\u53c2\u6570 -log.jsonFormat=false \uff0c\u4fbf\u4e8e\u5728Loggie\u65e5\u5fd7\u4e0a\u67e5\u770b\u8f93\u51fa\u7ed3\u679c\u3002","title":"printEvents"},{"location":"reference/pipelines/sink/elasticsearch/","text":"elasticsearch \u00b6 \u4f7f\u7528Elasticsearch sink\u53d1\u9001\u6570\u636e\u81f3Elasticsearch\u96c6\u7fa4\u3002 Example sink : type : elasticsearch hosts : [ \"elasticsearch1:9200\" , \"elasticsearch2:9200\" , \"elasticsearch3:9200\" ] index : \"log-${fields.service}-${+YYYY.MM.DD}\" hosts \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 hosts string\u6570\u7ec4 \u5fc5\u586b \u65e0 \u53d1\u9001\u65e5\u5fd7\u81f3Elasticsearch\u7684\u5730\u5740 index \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 index string \u5fc5\u586b \u65e0 \u53d1\u9001\u81f3Elasticsearch\u540e\uff0c\u65e5\u5fd7\u6570\u636e\u5b58\u50a8\u7684index \u53ef\u4ee5\u4f7f\u7528 ${a.b} \u7684\u65b9\u5f0f\u83b7\u53d6\u65e5\u5fd7\u6570\u636e\u91cc\u7684\u5b57\u6bb5\uff0c\u6216\u8005\u52a0\u4e0a ${+YYYY.MM.DD.hh} \u65f6\u95f4\u6233\u7b49\u65b9\u5f0f\u6765\u52a8\u6001\u751f\u6210index\u3002 username \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 username string \u975e\u5fc5\u586b \u65e0 \u5982\u679cElasticsearch\u914d\u7f6e\u4e86\u7528\u6237\u540d\u5bc6\u7801\u9a8c\u8bc1\uff0c\u9700\u8981\u586b\u5199\u8bf7\u6c42\u7684\u7528\u6237\u540d password \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 password string \u975e\u5fc5\u586b \u65e0 \u5982\u679cElasticsearch\u914d\u7f6e\u4e86\u7528\u6237\u540d\u5bc6\u7801\u9a8c\u8bc1\uff0c\u9700\u8981\u586b\u5199\u8bf7\u6c42\u7684\u5bc6\u7801 schema \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 schema string \u975e\u5fc5\u586b http client sniffing\u65f6\u4f7f\u7528 sniff \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 sniff bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542fsniffer gzip \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 gzip bool \u975e\u5fc5\u586b false \u53d1\u9001\u6570\u636e\u662f\u5426\u5f00\u542fgzip\u538b\u7f29 documentId \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 documentId string \u975e\u5fc5\u586b \u53d1\u9001\u81f3elasticsearch\u7684id\u503c\uff0c\u53ef\u4f7f\u7528 ${} \u7684\u65b9\u5f0f\u53d6\u67d0\u4e2a\u5b57\u6bb5","title":"elasticsearch"},{"location":"reference/pipelines/sink/elasticsearch/#elasticsearch","text":"\u4f7f\u7528Elasticsearch sink\u53d1\u9001\u6570\u636e\u81f3Elasticsearch\u96c6\u7fa4\u3002 Example sink : type : elasticsearch hosts : [ \"elasticsearch1:9200\" , \"elasticsearch2:9200\" , \"elasticsearch3:9200\" ] index : \"log-${fields.service}-${+YYYY.MM.DD}\"","title":"elasticsearch"},{"location":"reference/pipelines/sink/elasticsearch/#hosts","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 hosts string\u6570\u7ec4 \u5fc5\u586b \u65e0 \u53d1\u9001\u65e5\u5fd7\u81f3Elasticsearch\u7684\u5730\u5740","title":"hosts"},{"location":"reference/pipelines/sink/elasticsearch/#index","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 index string \u5fc5\u586b \u65e0 \u53d1\u9001\u81f3Elasticsearch\u540e\uff0c\u65e5\u5fd7\u6570\u636e\u5b58\u50a8\u7684index \u53ef\u4ee5\u4f7f\u7528 ${a.b} \u7684\u65b9\u5f0f\u83b7\u53d6\u65e5\u5fd7\u6570\u636e\u91cc\u7684\u5b57\u6bb5\uff0c\u6216\u8005\u52a0\u4e0a ${+YYYY.MM.DD.hh} \u65f6\u95f4\u6233\u7b49\u65b9\u5f0f\u6765\u52a8\u6001\u751f\u6210index\u3002","title":"index"},{"location":"reference/pipelines/sink/elasticsearch/#username","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 username string \u975e\u5fc5\u586b \u65e0 \u5982\u679cElasticsearch\u914d\u7f6e\u4e86\u7528\u6237\u540d\u5bc6\u7801\u9a8c\u8bc1\uff0c\u9700\u8981\u586b\u5199\u8bf7\u6c42\u7684\u7528\u6237\u540d","title":"username"},{"location":"reference/pipelines/sink/elasticsearch/#password","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 password string \u975e\u5fc5\u586b \u65e0 \u5982\u679cElasticsearch\u914d\u7f6e\u4e86\u7528\u6237\u540d\u5bc6\u7801\u9a8c\u8bc1\uff0c\u9700\u8981\u586b\u5199\u8bf7\u6c42\u7684\u5bc6\u7801","title":"password"},{"location":"reference/pipelines/sink/elasticsearch/#schema","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 schema string \u975e\u5fc5\u586b http client sniffing\u65f6\u4f7f\u7528","title":"schema"},{"location":"reference/pipelines/sink/elasticsearch/#sniff","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 sniff bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542fsniffer","title":"sniff"},{"location":"reference/pipelines/sink/elasticsearch/#gzip","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 gzip bool \u975e\u5fc5\u586b false \u53d1\u9001\u6570\u636e\u662f\u5426\u5f00\u542fgzip\u538b\u7f29","title":"gzip"},{"location":"reference/pipelines/sink/elasticsearch/#documentid","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 documentId string \u975e\u5fc5\u586b \u53d1\u9001\u81f3elasticsearch\u7684id\u503c\uff0c\u53ef\u4f7f\u7528 ${} \u7684\u65b9\u5f0f\u53d6\u67d0\u4e2a\u5b57\u6bb5","title":"documentId"},{"location":"reference/pipelines/sink/file/","text":"file \u00b6 \u5c06\u63a5\u6536\u5230\u7684\u6570\u636e\u4ee5\u6587\u4ef6\u7684\u5f62\u5f0f\u5199\u5165\u5230\u672c\u5730\u3002 Example sink : type : file workerCount : 1024 baseDirs : - /data0 - /data1 - /data2 dirHashKey : ${namespace}-${deployName} filename : /${namespace}/${deployName}/${podName}/${filename} maxSize : 500 maxAge : 7 maxBackups : 50 compress : true workerCount \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 workerCount int \u975e\u5fc5\u586b 1 \u5199\u6587\u4ef6\u7684\u5e76\u53d1\u6570 baseDirs \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 baseDirs string\u6570\u7ec4 \u975e\u5fc5\u586b \u6587\u4ef6\u7684\u57fa\u7840\u76ee\u5f55\uff0c\u53ef\u4ee5\u6309\u67d0\u4e2akey\u505a\u54c8\u5e0c\uff0c\u7136\u540e\u5b58\u50a8\u5230\u5bf9\u5e94\u7684\u57fa\u7840\u76ee\u5f55\u4e0a dirHashKey \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 baseDirs string \u975e\u5fc5\u586b \u6309\u6307\u5b9aKey\u505a\u54c8\u5e0c\uff0c\u652f\u6301\u53d8\u91cf filename \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 filename string \u5fc5\u586b \u6587\u4ef6\u540d\uff0c\u652f\u6301\u53d8\u91cf maxSize \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxSize int \u975e\u5fc5\u586b 1 \u6587\u4ef6\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3aMiB maxAge \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxAge int \u975e\u5fc5\u586b \u65e7\u6587\u4ef6\u4fdd\u7559\u5929\u6570\uff0c\u5355\u4f4d\u300c\u5929\u300d\uff0c\u9ed8\u8ba4\u4e0d\u5220\u9664 maxBackups \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxBackups int \u975e\u5fc5\u586b 1 \u6700\u5927\u4fdd\u7559\u7684\u5907\u4efd\u6587\u4ef6\u6570\uff0c\u9ed8\u8ba4\u4e0d\u5220\u9664\uff08\u5982\u679cmaxAge\u914d\u7f6e\u4e86\uff0c\u90a3\u4e48\u6587\u4ef6\u4f9d\u65e7\u4f1a\u88ab\u5220\u9664\uff09 localTime \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 localTime bool \u975e\u5fc5\u586b false \u662f\u5426\u7528\u672c\u5730\u65f6\u95f4\u683c\u5f0f\u5316\u5907\u4efd\u6587\u4ef6\uff0c\u9ed8\u8ba4\u4f7f\u7528UTC\u65f6\u95f4 compress \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 compress bool \u975e\u5fc5\u586b false \u662f\u5426\u538b\u7f29\uff0c\u4f7f\u7528gzip\uff0c\u9ed8\u8ba4\u4e0d\u538b\u7f29","title":"file"},{"location":"reference/pipelines/sink/file/#file","text":"\u5c06\u63a5\u6536\u5230\u7684\u6570\u636e\u4ee5\u6587\u4ef6\u7684\u5f62\u5f0f\u5199\u5165\u5230\u672c\u5730\u3002 Example sink : type : file workerCount : 1024 baseDirs : - /data0 - /data1 - /data2 dirHashKey : ${namespace}-${deployName} filename : /${namespace}/${deployName}/${podName}/${filename} maxSize : 500 maxAge : 7 maxBackups : 50 compress : true","title":"file"},{"location":"reference/pipelines/sink/file/#workercount","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 workerCount int \u975e\u5fc5\u586b 1 \u5199\u6587\u4ef6\u7684\u5e76\u53d1\u6570","title":"workerCount"},{"location":"reference/pipelines/sink/file/#basedirs","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 baseDirs string\u6570\u7ec4 \u975e\u5fc5\u586b \u6587\u4ef6\u7684\u57fa\u7840\u76ee\u5f55\uff0c\u53ef\u4ee5\u6309\u67d0\u4e2akey\u505a\u54c8\u5e0c\uff0c\u7136\u540e\u5b58\u50a8\u5230\u5bf9\u5e94\u7684\u57fa\u7840\u76ee\u5f55\u4e0a","title":"baseDirs"},{"location":"reference/pipelines/sink/file/#dirhashkey","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 baseDirs string \u975e\u5fc5\u586b \u6309\u6307\u5b9aKey\u505a\u54c8\u5e0c\uff0c\u652f\u6301\u53d8\u91cf","title":"dirHashKey"},{"location":"reference/pipelines/sink/file/#filename","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 filename string \u5fc5\u586b \u6587\u4ef6\u540d\uff0c\u652f\u6301\u53d8\u91cf","title":"filename"},{"location":"reference/pipelines/sink/file/#maxsize","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxSize int \u975e\u5fc5\u586b 1 \u6587\u4ef6\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3aMiB","title":"maxSize"},{"location":"reference/pipelines/sink/file/#maxage","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxAge int \u975e\u5fc5\u586b \u65e7\u6587\u4ef6\u4fdd\u7559\u5929\u6570\uff0c\u5355\u4f4d\u300c\u5929\u300d\uff0c\u9ed8\u8ba4\u4e0d\u5220\u9664","title":"maxAge"},{"location":"reference/pipelines/sink/file/#maxbackups","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxBackups int \u975e\u5fc5\u586b 1 \u6700\u5927\u4fdd\u7559\u7684\u5907\u4efd\u6587\u4ef6\u6570\uff0c\u9ed8\u8ba4\u4e0d\u5220\u9664\uff08\u5982\u679cmaxAge\u914d\u7f6e\u4e86\uff0c\u90a3\u4e48\u6587\u4ef6\u4f9d\u65e7\u4f1a\u88ab\u5220\u9664\uff09","title":"maxBackups"},{"location":"reference/pipelines/sink/file/#localtime","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 localTime bool \u975e\u5fc5\u586b false \u662f\u5426\u7528\u672c\u5730\u65f6\u95f4\u683c\u5f0f\u5316\u5907\u4efd\u6587\u4ef6\uff0c\u9ed8\u8ba4\u4f7f\u7528UTC\u65f6\u95f4","title":"localTime"},{"location":"reference/pipelines/sink/file/#compress","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 compress bool \u975e\u5fc5\u586b false \u662f\u5426\u538b\u7f29\uff0c\u4f7f\u7528gzip\uff0c\u9ed8\u8ba4\u4e0d\u538b\u7f29","title":"compress"},{"location":"reference/pipelines/sink/grpc/","text":"grpc \u00b6 \u4f7f\u7528grpc sink\u53d1\u9001\u81f3\u4e0b\u6e38\uff0c\u9700\u8981\u4e0b\u6e38\u652f\u6301\u76f8\u540c\u683c\u5f0f\u7684grpc\u534f\u8bae\u3002\u53ef\u4ee5\u4f7f\u7528\u8be5sink\u53d1\u9001\u81f3grpc source\u7684Loggie\u4e2d\u8f6c\u673a\u3002 Example sink : type : grpc host : \"loggie-aggregator.loggie-aggregator:6166\" host \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 host string \u5fc5\u586b \u65e0 \u53d1\u9001\u81f3\u4e0b\u6e38\u7684host\u5730\u5740\uff0c\u591a\u4e2aip\u4f7f\u7528 , \u9017\u53f7\u5206\u9694 loadBalance \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 loadBalance string \u975e\u5fc5\u586b round_robin grpc\u8d1f\u8f7d\u5747\u8861\u7b56\u7565 timeout \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 timeout time.Duration \u975e\u5fc5\u586b 30s \u53d1\u9001\u8d85\u65f6\u65f6\u95f4 grpcHeaderKey \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 grpcHeaderKey string \u975e\u5fc5\u586b \u65e0","title":"grpc"},{"location":"reference/pipelines/sink/grpc/#grpc","text":"\u4f7f\u7528grpc sink\u53d1\u9001\u81f3\u4e0b\u6e38\uff0c\u9700\u8981\u4e0b\u6e38\u652f\u6301\u76f8\u540c\u683c\u5f0f\u7684grpc\u534f\u8bae\u3002\u53ef\u4ee5\u4f7f\u7528\u8be5sink\u53d1\u9001\u81f3grpc source\u7684Loggie\u4e2d\u8f6c\u673a\u3002 Example sink : type : grpc host : \"loggie-aggregator.loggie-aggregator:6166\"","title":"grpc"},{"location":"reference/pipelines/sink/grpc/#host","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 host string \u5fc5\u586b \u65e0 \u53d1\u9001\u81f3\u4e0b\u6e38\u7684host\u5730\u5740\uff0c\u591a\u4e2aip\u4f7f\u7528 , \u9017\u53f7\u5206\u9694","title":"host"},{"location":"reference/pipelines/sink/grpc/#loadbalance","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 loadBalance string \u975e\u5fc5\u586b round_robin grpc\u8d1f\u8f7d\u5747\u8861\u7b56\u7565","title":"loadBalance"},{"location":"reference/pipelines/sink/grpc/#timeout","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 timeout time.Duration \u975e\u5fc5\u586b 30s \u53d1\u9001\u8d85\u65f6\u65f6\u95f4","title":"timeout"},{"location":"reference/pipelines/sink/grpc/#grpcheaderkey","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 grpcHeaderKey string \u975e\u5fc5\u586b \u65e0","title":"grpcHeaderKey"},{"location":"reference/pipelines/sink/kafka/","text":"kafka \u00b6 \u4f7f\u7528sink kafka\u5c06\u65e5\u5fd7\u6570\u636e\u53d1\u9001\u81f3\u4e0b\u6e38Kafka\u3002 Example sink : type : kafka brokers : [ \"127.0.0.1:6400\" ] topic : \"log-${fields.topic}\" brokers \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 brokers string\u6570\u7ec4 \u5fc5\u586b \u65e0 \u53d1\u9001\u65e5\u5fd7\u81f3Kafka\u7684brokers\u5730\u5740 topic \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 topic string \u975e\u5fc5\u586b loggie \u53d1\u9001\u65e5\u5fd7\u81f3Kafka\u7684topic \u53ef\u4f7f\u7528 ${a.b} \u7684\u65b9\u5f0f\uff0c\u83b7\u53d6event\u91cc\u7684\u5b57\u6bb5\u503c\u4f5c\u4e3a\u5177\u4f53\u7684topic\u540d\u79f0\u3002 \u6bd4\u5982\uff0c\u4e00\u4e2aevent\u4e3a\uff1a { \"topic\" : \"loggie\" , \"hello\" : \"world\" } \u53ef\u914d\u7f6e topic: ${topic} \uff0c\u6b64\u65f6\u8be5event\u53d1\u9001\u5230Kafka\u7684topic\u4e3a\"loggie\"\u3002 \u540c\u65f6\u652f\u6301\u5d4c\u5957\u7684\u9009\u62e9\u65b9\u5f0f\uff1a { \"fields\" : { \"topic\" : \"loggie\" }, \"hello\" : \"world\" } \u53ef\u914d\u7f6e topic: ${fields.topic} \uff0c\u540c\u6837\u4e5f\u4f1a\u53d1\u9001\u5230topic \"loggie\"\u3002 balance \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 balance string \u975e\u5fc5\u586b roundRobin \u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c\u53ef\u586b hash \u3001 roundRobin \u3001 leastBytes compression \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 compression string \u975e\u5fc5\u586b gzip \u65e5\u5fd7\u53d1\u9001\u81f3Kafka\u7684\u538b\u7f29\u7b56\u7565\uff0c\u53ef\u586b gzip \u3001 snappy \u3001 lz4 \u3001 zstd maxAttempts \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxAttempts int \u975e\u5fc5\u586b 10 \u53d1\u9001\u6700\u591a\u91cd\u8bd5\u6b21\u6570 batchSize \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchSize int \u975e\u5fc5\u586b 100 \u53d1\u9001\u65f6\u6bcf\u4e2abatch\u6700\u591a\u5305\u542b\u7684\u6570\u636e\u4e2a\u6570 batchBytes \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchBytes int \u975e\u5fc5\u586b 1048576 \u6bcf\u4e2a\u53d1\u9001\u8bf7\u6c42\u5305\u542b\u7684\u6700\u5927\u5b57\u8282\u6570 batchTimeout \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchTimeout time.Duration \u975e\u5fc5\u586b 1s \u5f62\u6210\u6bcf\u4e2a\u53d1\u9001batch\u7684\u6700\u957f\u65f6\u95f4 readTimeout \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 readTimeout time.Duration \u975e\u5fc5\u586b 10s \u8bfb\u53d6\u8d85\u65f6\u65f6\u95f4 writeTimeout \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 writeTimeout time.Duration \u975e\u5fc5\u586b 10s \u5199\u5165\u8d85\u65f6\u65f6\u95f4 requiredAcks \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 requiredAcks int \u975e\u5fc5\u586b 0 \u7b49\u5f85ack\u53c2\u6570\uff0c\u53ef\u4e3a 0 \u3001 1 \u3001 -1 0 : \u4e0d\u8981\u6c42ack 1 : \u7b49\u5f85leader partition ack -1 : \u7b49\u5f85ISR\u4e2d\u6240\u6709replica ack sasl \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 sasl \u975e\u5fc5\u586b SASL authentication sasl.type string \u5fc5\u586b SASL\u7c7b\u578b\uff0c\u53ef\u4e3a\uff1a plain \u3001 scram sasl.userName string \u5fc5\u586b \u7528\u6237\u540d sasl.password string \u5fc5\u586b \u5bc6\u7801 sasl.algorithm string type=scram\u65f6\u5fc5\u586b type=scram\u65f6\u4f7f\u7528\u7684\u7b97\u6cd5\uff0c\u53ef\u9009 sha256 \u3001 sha512","title":"kafka"},{"location":"reference/pipelines/sink/kafka/#kafka","text":"\u4f7f\u7528sink kafka\u5c06\u65e5\u5fd7\u6570\u636e\u53d1\u9001\u81f3\u4e0b\u6e38Kafka\u3002 Example sink : type : kafka brokers : [ \"127.0.0.1:6400\" ] topic : \"log-${fields.topic}\"","title":"kafka"},{"location":"reference/pipelines/sink/kafka/#brokers","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 brokers string\u6570\u7ec4 \u5fc5\u586b \u65e0 \u53d1\u9001\u65e5\u5fd7\u81f3Kafka\u7684brokers\u5730\u5740","title":"brokers"},{"location":"reference/pipelines/sink/kafka/#topic","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 topic string \u975e\u5fc5\u586b loggie \u53d1\u9001\u65e5\u5fd7\u81f3Kafka\u7684topic \u53ef\u4f7f\u7528 ${a.b} \u7684\u65b9\u5f0f\uff0c\u83b7\u53d6event\u91cc\u7684\u5b57\u6bb5\u503c\u4f5c\u4e3a\u5177\u4f53\u7684topic\u540d\u79f0\u3002 \u6bd4\u5982\uff0c\u4e00\u4e2aevent\u4e3a\uff1a { \"topic\" : \"loggie\" , \"hello\" : \"world\" } \u53ef\u914d\u7f6e topic: ${topic} \uff0c\u6b64\u65f6\u8be5event\u53d1\u9001\u5230Kafka\u7684topic\u4e3a\"loggie\"\u3002 \u540c\u65f6\u652f\u6301\u5d4c\u5957\u7684\u9009\u62e9\u65b9\u5f0f\uff1a { \"fields\" : { \"topic\" : \"loggie\" }, \"hello\" : \"world\" } \u53ef\u914d\u7f6e topic: ${fields.topic} \uff0c\u540c\u6837\u4e5f\u4f1a\u53d1\u9001\u5230topic \"loggie\"\u3002","title":"topic"},{"location":"reference/pipelines/sink/kafka/#balance","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 balance string \u975e\u5fc5\u586b roundRobin \u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c\u53ef\u586b hash \u3001 roundRobin \u3001 leastBytes","title":"balance"},{"location":"reference/pipelines/sink/kafka/#compression","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 compression string \u975e\u5fc5\u586b gzip \u65e5\u5fd7\u53d1\u9001\u81f3Kafka\u7684\u538b\u7f29\u7b56\u7565\uff0c\u53ef\u586b gzip \u3001 snappy \u3001 lz4 \u3001 zstd","title":"compression"},{"location":"reference/pipelines/sink/kafka/#maxattempts","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxAttempts int \u975e\u5fc5\u586b 10 \u53d1\u9001\u6700\u591a\u91cd\u8bd5\u6b21\u6570","title":"maxAttempts"},{"location":"reference/pipelines/sink/kafka/#batchsize","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchSize int \u975e\u5fc5\u586b 100 \u53d1\u9001\u65f6\u6bcf\u4e2abatch\u6700\u591a\u5305\u542b\u7684\u6570\u636e\u4e2a\u6570","title":"batchSize"},{"location":"reference/pipelines/sink/kafka/#batchbytes","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchBytes int \u975e\u5fc5\u586b 1048576 \u6bcf\u4e2a\u53d1\u9001\u8bf7\u6c42\u5305\u542b\u7684\u6700\u5927\u5b57\u8282\u6570","title":"batchBytes"},{"location":"reference/pipelines/sink/kafka/#batchtimeout","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 batchTimeout time.Duration \u975e\u5fc5\u586b 1s \u5f62\u6210\u6bcf\u4e2a\u53d1\u9001batch\u7684\u6700\u957f\u65f6\u95f4","title":"batchTimeout"},{"location":"reference/pipelines/sink/kafka/#readtimeout","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 readTimeout time.Duration \u975e\u5fc5\u586b 10s \u8bfb\u53d6\u8d85\u65f6\u65f6\u95f4","title":"readTimeout"},{"location":"reference/pipelines/sink/kafka/#writetimeout","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 writeTimeout time.Duration \u975e\u5fc5\u586b 10s \u5199\u5165\u8d85\u65f6\u65f6\u95f4","title":"writeTimeout"},{"location":"reference/pipelines/sink/kafka/#requiredacks","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 requiredAcks int \u975e\u5fc5\u586b 0 \u7b49\u5f85ack\u53c2\u6570\uff0c\u53ef\u4e3a 0 \u3001 1 \u3001 -1 0 : \u4e0d\u8981\u6c42ack 1 : \u7b49\u5f85leader partition ack -1 : \u7b49\u5f85ISR\u4e2d\u6240\u6709replica ack","title":"requiredAcks"},{"location":"reference/pipelines/sink/kafka/#sasl","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 sasl \u975e\u5fc5\u586b SASL authentication sasl.type string \u5fc5\u586b SASL\u7c7b\u578b\uff0c\u53ef\u4e3a\uff1a plain \u3001 scram sasl.userName string \u5fc5\u586b \u7528\u6237\u540d sasl.password string \u5fc5\u586b \u5bc6\u7801 sasl.algorithm string type=scram\u65f6\u5fc5\u586b type=scram\u65f6\u4f7f\u7528\u7684\u7b97\u6cd5\uff0c\u53ef\u9009 sha256 \u3001 sha512","title":"sasl"},{"location":"reference/pipelines/sink/loki/","text":"loki \u00b6 loki sink\u7528\u4e8e\u53d1\u9001\u6570\u636e\u81f3Loki\u5b58\u50a8\u3002Loki\u6587\u6863\u53ef\u53c2\u8003 \u8fd9\u91cc \u3002 Example sink : type : loki url : \"http://localhost:3100/loki/api/v1/push\" url \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 url string \u5fc5\u586b push loki\u7684api tenantId \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 tenantId string \u975e\u5fc5\u586b \u53d1\u9001\u4f7f\u7528\u7684\u79df\u6237\u540d\u79f0 timeout \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 timeout time.Duration \u975e\u5fc5\u586b 30s \u53d1\u9001\u7684\u8d85\u65f6\u65f6\u95f4 entryLine \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 entryLine string \u975e\u5fc5\u586b \u53d1\u9001\u81f3Loki\u7684\u65e5\u5fd7\u5185\u5bb9\uff0c\u9ed8\u8ba4\u4e3aloggie event\u7684body Loki\u7684\u65e5\u5fd7\u6570\u636e\u7ed3\u6784\u5927\u6982\u5206\u4e3alabel\u548c\u4e3b\u4f53\u6570\u636e\uff0cloggie\u4f1a\u9ed8\u8ba4\u5c06header\u91cc\u7684\u5143\u4fe1\u606f\u5b57\u6bb5\uff0c\u8f6c\u6210\u4ee5\u4e0b\u5212\u7ebf _ \u8fde\u63a5\u7684label\u3002","title":"loki"},{"location":"reference/pipelines/sink/loki/#loki","text":"loki sink\u7528\u4e8e\u53d1\u9001\u6570\u636e\u81f3Loki\u5b58\u50a8\u3002Loki\u6587\u6863\u53ef\u53c2\u8003 \u8fd9\u91cc \u3002 Example sink : type : loki url : \"http://localhost:3100/loki/api/v1/push\"","title":"loki"},{"location":"reference/pipelines/sink/loki/#url","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 url string \u5fc5\u586b push loki\u7684api","title":"url"},{"location":"reference/pipelines/sink/loki/#tenantid","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 tenantId string \u975e\u5fc5\u586b \u53d1\u9001\u4f7f\u7528\u7684\u79df\u6237\u540d\u79f0","title":"tenantId"},{"location":"reference/pipelines/sink/loki/#timeout","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 timeout time.Duration \u975e\u5fc5\u586b 30s \u53d1\u9001\u7684\u8d85\u65f6\u65f6\u95f4","title":"timeout"},{"location":"reference/pipelines/sink/loki/#entryline","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 entryLine string \u975e\u5fc5\u586b \u53d1\u9001\u81f3Loki\u7684\u65e5\u5fd7\u5185\u5bb9\uff0c\u9ed8\u8ba4\u4e3aloggie event\u7684body Loki\u7684\u65e5\u5fd7\u6570\u636e\u7ed3\u6784\u5927\u6982\u5206\u4e3alabel\u548c\u4e3b\u4f53\u6570\u636e\uff0cloggie\u4f1a\u9ed8\u8ba4\u5c06header\u91cc\u7684\u5143\u4fe1\u606f\u5b57\u6bb5\uff0c\u8f6c\u6210\u4ee5\u4e0b\u5212\u7ebf _ \u8fde\u63a5\u7684label\u3002","title":"entryLine"},{"location":"reference/pipelines/sink/overview/","text":"Overview \u00b6 \u4e00\u4e2aPipeline\u5bf9\u5e94\u4e00\u4e2aSink\u3002 Sink\u901a\u7528\u914d\u7f6e \u00b6 Example sink : type : \"dev\" codec : type : json pretty : true parallelism \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 parallelism int \u975e\u5fc5\u586b 1 sink\u5ba2\u6237\u7aef\u7684\u5e76\u53d1\u5ea6\uff0c\u53ef\u540c\u65f6\u542f\u52a8\u591a\u4e2a\u589e\u5927\u53d1\u9001\u541e\u5410\u91cf codec \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 codec \u975e\u5fc5\u586b sink\u53d1\u9001\u6570\u636e\u7ed9\u4e0b\u6e38\u65f6\uff0c\u6570\u636e\u4f7f\u7528\u7684\u683c\u5f0f codec.type string \u975e\u5fc5\u586b json codec\u7c7b\u578b type: json \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 codec.pretty \u975e\u5fc5\u586b false \u662f\u5426\u8fdb\u884cjson\u683c\u5f0f\u7f8e\u5316 codec.beatsFormat \u975e\u5fc5\u586b false \u65e5\u5fd7\u8f6c\u6210\u7c7bfilebeats\u683c\u5f0f\uff1a\u589e\u52a0 @timestamp \u5b57\u6bb5\uff0c\u540c\u65f6body\u5b57\u6bb5\u547d\u540d\u4e3a message type: raw \u00b6 \u7528\u4e8e\u53d1\u9001\u91c7\u96c6\u7684\u539f\u59cbbody\u6570\u636e\u3002 Example sink : type : dev codec : type : raw","title":"Overview"},{"location":"reference/pipelines/sink/overview/#overview","text":"\u4e00\u4e2aPipeline\u5bf9\u5e94\u4e00\u4e2aSink\u3002","title":"Overview"},{"location":"reference/pipelines/sink/overview/#sink","text":"Example sink : type : \"dev\" codec : type : json pretty : true","title":"Sink\u901a\u7528\u914d\u7f6e"},{"location":"reference/pipelines/sink/overview/#parallelism","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 parallelism int \u975e\u5fc5\u586b 1 sink\u5ba2\u6237\u7aef\u7684\u5e76\u53d1\u5ea6\uff0c\u53ef\u540c\u65f6\u542f\u52a8\u591a\u4e2a\u589e\u5927\u53d1\u9001\u541e\u5410\u91cf","title":"parallelism"},{"location":"reference/pipelines/sink/overview/#codec","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 codec \u975e\u5fc5\u586b sink\u53d1\u9001\u6570\u636e\u7ed9\u4e0b\u6e38\u65f6\uff0c\u6570\u636e\u4f7f\u7528\u7684\u683c\u5f0f codec.type string \u975e\u5fc5\u586b json codec\u7c7b\u578b","title":"codec"},{"location":"reference/pipelines/sink/overview/#type-json","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 codec.pretty \u975e\u5fc5\u586b false \u662f\u5426\u8fdb\u884cjson\u683c\u5f0f\u7f8e\u5316 codec.beatsFormat \u975e\u5fc5\u586b false \u65e5\u5fd7\u8f6c\u6210\u7c7bfilebeats\u683c\u5f0f\uff1a\u589e\u52a0 @timestamp \u5b57\u6bb5\uff0c\u540c\u65f6body\u5b57\u6bb5\u547d\u540d\u4e3a message","title":"type: json"},{"location":"reference/pipelines/sink/overview/#type-raw","text":"\u7528\u4e8e\u53d1\u9001\u91c7\u96c6\u7684\u539f\u59cbbody\u6570\u636e\u3002 Example sink : type : dev codec : type : raw","title":"type: raw"},{"location":"reference/pipelines/sink/sls/","text":"sls \u00b6 sls sink\u7528\u4e8e\u5c06\u65e5\u5fd7\u53d1\u9001\u81f3 \u963f\u91cc\u4e91\u53ef\u89c2\u6d4b\u7edf\u4e00\u5b58\u50a8SLS \u3002 Example sink : type : sls name : demo endpoint : cn-hangzhou.log.aliyuncs.com accessKeyId : ${id} accessKeySecret : ${secret} project : test logstore : test1 topic : myservice endpoint \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 endpoint string \u5fc5\u586b SLS\u5b58\u50a8\u7684\u8bbf\u95ee\u57df\u540d \u4f60\u53ef\u4ee5\u5728\u5177\u4f53project\u9875\u9762\u7684\u9879\u76ee\u6982\u89c8\u4e2d\u67e5\u770b\u5230\u3002 accessKeyId \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 accessKeyId string \u5fc5\u586b \u8bbf\u95ee\u7684accessKeyId\uff0c\u8bf7\u67e5\u770b\u963f\u91cc\u4e91\u8d26\u53f7\u7684\u8bbf\u95ee\u51ed\u8bc1\u7ba1\u7406 \u5efa\u8bae\u4f7f\u7528\u963f\u91cc\u4e91\u7684\u5b50\u8d26\u53f7\uff0c\u5b50\u8d26\u53f7\u9700\u8981\u6709\u5bf9\u5e94project\u3001logstore\u7684\u6743\u9650\u3002 accessKeySecret \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 accessKeySecret string \u5fc5\u586b \u8bbf\u95ee\u7684accessKeySecret\uff0c\u8bf7\u67e5\u770b\u963f\u91cc\u4e91\u8d26\u53f7\u7684\u8bbf\u95ee\u51ed\u8bc1\u7ba1\u7406 project \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 project string \u5fc5\u586b SLS\u5b58\u50a8\u7684project\u540d\u79f0 logstore \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 logstore string \u5fc5\u586b SLS\u5b58\u50a8\u7684logstore\u540d\u79f0 topic \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 topic string \u975e\u5fc5\u586b \u65e5\u5fd7\u4e3b\u9898\uff08Topic\uff09\u662f\u65e5\u5fd7\u670d\u52a1\u7684\u57fa\u7840\u7ba1\u7406\u5355\u5143\u3002\u60a8\u53ef\u5728\u91c7\u96c6\u65e5\u5fd7\u65f6\u6307\u5b9aTopic\uff0c\u7528\u4e8e\u533a\u5206\u65e5\u5fd7","title":"sls"},{"location":"reference/pipelines/sink/sls/#sls","text":"sls sink\u7528\u4e8e\u5c06\u65e5\u5fd7\u53d1\u9001\u81f3 \u963f\u91cc\u4e91\u53ef\u89c2\u6d4b\u7edf\u4e00\u5b58\u50a8SLS \u3002 Example sink : type : sls name : demo endpoint : cn-hangzhou.log.aliyuncs.com accessKeyId : ${id} accessKeySecret : ${secret} project : test logstore : test1 topic : myservice","title":"sls"},{"location":"reference/pipelines/sink/sls/#endpoint","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 endpoint string \u5fc5\u586b SLS\u5b58\u50a8\u7684\u8bbf\u95ee\u57df\u540d \u4f60\u53ef\u4ee5\u5728\u5177\u4f53project\u9875\u9762\u7684\u9879\u76ee\u6982\u89c8\u4e2d\u67e5\u770b\u5230\u3002","title":"endpoint"},{"location":"reference/pipelines/sink/sls/#accesskeyid","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 accessKeyId string \u5fc5\u586b \u8bbf\u95ee\u7684accessKeyId\uff0c\u8bf7\u67e5\u770b\u963f\u91cc\u4e91\u8d26\u53f7\u7684\u8bbf\u95ee\u51ed\u8bc1\u7ba1\u7406 \u5efa\u8bae\u4f7f\u7528\u963f\u91cc\u4e91\u7684\u5b50\u8d26\u53f7\uff0c\u5b50\u8d26\u53f7\u9700\u8981\u6709\u5bf9\u5e94project\u3001logstore\u7684\u6743\u9650\u3002","title":"accessKeyId"},{"location":"reference/pipelines/sink/sls/#accesskeysecret","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 accessKeySecret string \u5fc5\u586b \u8bbf\u95ee\u7684accessKeySecret\uff0c\u8bf7\u67e5\u770b\u963f\u91cc\u4e91\u8d26\u53f7\u7684\u8bbf\u95ee\u51ed\u8bc1\u7ba1\u7406","title":"accessKeySecret"},{"location":"reference/pipelines/sink/sls/#project","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 project string \u5fc5\u586b SLS\u5b58\u50a8\u7684project\u540d\u79f0","title":"project"},{"location":"reference/pipelines/sink/sls/#logstore","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 logstore string \u5fc5\u586b SLS\u5b58\u50a8\u7684logstore\u540d\u79f0","title":"logstore"},{"location":"reference/pipelines/sink/sls/#topic","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 topic string \u975e\u5fc5\u586b \u65e5\u5fd7\u4e3b\u9898\uff08Topic\uff09\u662f\u65e5\u5fd7\u670d\u52a1\u7684\u57fa\u7840\u7ba1\u7406\u5355\u5143\u3002\u60a8\u53ef\u5728\u91c7\u96c6\u65e5\u5fd7\u65f6\u6307\u5b9aTopic\uff0c\u7528\u4e8e\u533a\u5206\u65e5\u5fd7","title":"topic"},{"location":"reference/pipelines/source/dev/","text":"dev \u00b6 \u7528\u4e8e\u5f00\u53d1\u6216\u8005\u538b\u6d4b\u573a\u666f\u4e0b\uff0c\u81ea\u52a8\u751f\u6210\u6570\u636e\u3002 Example sources : - type : dev name : benchmark qps : 100 qps \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 qps int \u975e\u5fc5\u586b 1000 \u751f\u6210event\u7684QPS byteSize \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 byteSize int \u975e\u5fc5\u586b 1024 \u5355\u6761event\u7684\u5b57\u8282\u6570","title":"dev"},{"location":"reference/pipelines/source/dev/#dev","text":"\u7528\u4e8e\u5f00\u53d1\u6216\u8005\u538b\u6d4b\u573a\u666f\u4e0b\uff0c\u81ea\u52a8\u751f\u6210\u6570\u636e\u3002 Example sources : - type : dev name : benchmark qps : 100","title":"dev"},{"location":"reference/pipelines/source/dev/#qps","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 qps int \u975e\u5fc5\u586b 1000 \u751f\u6210event\u7684QPS","title":"qps"},{"location":"reference/pipelines/source/dev/#bytesize","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 byteSize int \u975e\u5fc5\u586b 1024 \u5355\u6761event\u7684\u5b57\u8282\u6570","title":"byteSize"},{"location":"reference/pipelines/source/file/","text":"file \u00b6 file source\u7528\u4e8e\u65e5\u5fd7\u91c7\u96c6\u3002 Example sources : - type : file name : accesslog paths \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 paths string\u6570\u7ec4 \u5fc5\u586b \u65e0 \u91c7\u96c6\u7684path\u8def\u5f84\uff0c\u4f7f\u7528glob\u8868\u8fbe\u5f0f\u6765\u5339\u914d\u3002\u652f\u6301glob\u6269\u5c55\u8868\u8fbe\u5f0f Brace Expansion \u548c Glob Star Example \u9700\u8981\u91c7\u96c6\u7684\u76ee\u6807\u6587\u4ef6\uff1a /tmp/loggie/service/order/access.log /tmp/loggie/service/order/access.log.2022-04-11 /tmp/loggie/service/pay/access.log /tmp/loggie/service/pay/access.log.2022-04-11 \u5bf9\u5e94\u914d\u7f6e\uff1a sources : - type : file paths : - /tmp/loggie/**/access.log{,.[2-9][0-9][0-9][0-9]-[01][0-9]-[0123][0-9]} excludeFiles \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 excludeFiles string\u6570\u7ec4 \u975e\u5fc5\u586b \u65e0 \u6392\u9664\u91c7\u96c6\u7684\u6587\u4ef6\u6b63\u5219\u8868\u8fbe\u5f0f ignoreOlder \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 ignoreOlder time.Duration \u975e\u5fc5\u586b \u65e0 \u4f8b\u598248h\uff0c\u8868\u793a\u5ffd\u7565\u66f4\u65b0\u65f6\u95f4\u57282\u5929\u4e4b\u524d\u7684\u6587\u4ef6\uff0c\u65e0\u9700\u8fdb\u884c\u91c7\u96c6 ignoreSymlink \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 ignoreSymlink bool \u975e\u5fc5\u586b false \u662f\u5426\u5ffd\u7565\u7b26\u53f7\u94fe\u63a5\uff08\u8f6f\u94fe\u63a5\uff09\u7684\u6587\u4ef6 addonMeta \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 addonMeta bool \u975e\u5fc5\u586b false \u662f\u5426\u6dfb\u52a0\u9ed8\u8ba4\u7684\u65e5\u5fd7\u91c7\u96c6state\u5143\u4fe1\u606f event\u793a\u4f8b { \"body\" : \"this is test\" , \"state\" : { \"pipeline\" : \"local\" , \"source\" : \"demo\" , \"filename\" : \"/var/log/a.log\" , \"timestamp\" : \"2006-01-02T15:04:05.000Z\" , \"offset\" : 1024 , \"bytes\" : 4096 , \"hostname\" : \"node-1\" } } state\u542b\u4e49\u89e3\u91ca\uff1a - pipeline: \u6240\u5728\u7684pipeline\u540d\u79f0 - source: \u6240\u5728\u7684source\u540d\u79f0 - filename: \u91c7\u96c6\u7684\u6587\u4ef6\u540d\u79f0 - timestamp: \u91c7\u96c6\u65f6\u523b\u7684\u65f6\u95f4\u6233 - offset: \u91c7\u96c6\u7684\u6570\u636e\u5728\u6587\u4ef6\u7684offset\u504f\u79fb\u91cf - bytes: \u91c7\u96c6\u7684\u6570\u636e\u5b57\u8282\u6570 - hostname: \u6240\u5728\u8282\u70b9\u540d\u79f0 workerCount \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 workerCount int \u975e\u5fc5\u586b 1 \u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u7684\u5de5\u4f5c\u7ebf\u7a0b(goroutine)\u6570\u3002\u5355\u8282\u70b9\u8d85\u8fc7100\u4e2a\u6587\u4ef6\u7684\u65f6\u5019\u8003\u8651\u63d0\u9ad8 readChanSize \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 readChanSize int \u975e\u5fc5\u586b 512 \u8bfb\u53d6\u4efb\u52a1\u7684channel size readBufferSize \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 readBufferSize int \u975e\u5fc5\u586b 65536 \u5355\u6b21\u8bfb\u53d6\u6587\u4ef6\u7684\u6570\u636e\u91cf\u3002\u9ed8\u8ba464K=65536 maxContinueRead \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxContinueRead int \u975e\u5fc5\u586b 16 \u8fde\u7eed\u8bfb\u53d6\u540c\u4e00\u4e2a\u6587\u4ef6\u5185\u5bb9\u7684\u6b21\u6570\uff0c\u8fbe\u5230\u8fd9\u4e2a\u6b21\u6570\u5c06\u5f3a\u5236\u5207\u6362\u5230\u4e0b\u4e2a\u6587\u4ef6\u8bfb\u53d6\u3002\u4e3b\u8981\u4f5c\u7528\u662f\u7528\u6765\u907f\u514d\u6d3b\u8dc3\u6587\u4ef6\u4e00\u76f4\u5360\u636e\u8bfb\u53d6\u8d44\u6e90\uff0c\u975e\u6d3b\u8dc3\u6587\u4ef6\u957f\u65f6\u95f4\u5f97\u4e0d\u5230\u8bfb\u53d6\u91c7\u96c6 maxContinueReadTimeout \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxContinueReadTimeout time.Duration \u975e\u5fc5\u586b 3s \u540c\u4e00\u4e2a\u6587\u4ef6\u6700\u957f\u8bfb\u53d6\u65f6\u95f4\uff0c\u8d85\u8fc7\u8fd9\u4e2a\u65f6\u95f4\u5c06\u5f3a\u5236\u5207\u6362\u4e0b\u4e2a\u6587\u4ef6\u8bfb\u53d6\u3002\u4f5c\u7528\u4e0e maxContinueRead \u7c7b\u4f3c inactiveTimeout \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 inactiveTimeout time.Duration \u975e\u5fc5\u586b 3s \u5982\u679c\u5f53\u6587\u4ef6\u4ece\u4e0a\u4e00\u6b21\u91c7\u96c6\u5230\u73b0\u5728\u8d85\u8fc7inactiveTimeout\u7684\u8bdd\uff0c\u5219\u8ba4\u4e3a\u6587\u4ef6\u8fdb\u5165\u4e0d\u6d3b\u8dc3\u72b6\u6001(\u5373\u6700\u540e\u4e00\u6761\u65e5\u5fd7\u5df2\u7ecf\u5199\u5165\u5b8c\u6210)\uff0c\u5219\u53ef\u4ee5\u5b89\u5168\u7684\u91c7\u96c6\u6700\u540e\u4e00\u884c\u65e5\u5fd7 firstNBytesForIdentifier \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 firstNBytesForIdentifier int \u975e\u5fc5\u586b 128 \u4f7f\u7528\u91c7\u96c6\u76ee\u6807\u6587\u4ef6\u7684\u524dn\u4e2a\u5b57\u7b26\u6765\u751f\u6210\u6587\u4ef6\u552f\u4e00code\u3002 \u5982\u679c\u6587\u4ef6\u7684\u5927\u5c0f\u5c0f\u4e8en\uff0c\u5219\u8be5\u6587\u4ef6\u6682\u65f6\u4e0d\u4f1a\u91c7\u96c6 \u3002\u7528\u9014\u4e3b\u8981\u662f\uff0c\u7ed3\u5408\u6587\u4ef6inode\u4fe1\u606f\uff0c\u7528\u6765\u7cbe\u786e\u6807\u8bc6\u4e00\u4e2a\u6587\u4ef6\u3002\u8f85\u52a9\u5224\u65ad\u6587\u4ef6\u662f\u5426\u5220\u9664\u6216\u8005\u662f\u6539\u540d multi \u00b6 \u591a\u884c\u91c7\u96c6\u76f8\u5173\u914d\u7f6e Example sources : - type : file name : accesslog multi : active : true active \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 active bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542f\u591a\u884c\u91c7\u96c6\u6a21\u5f0f pattern \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 pattern string \u5f53multi.active=true\u7684\u65f6\u5019\u5fc5\u586b false \u5224\u65ad\u4e3a\u4e00\u6761\u5168\u65b0\u65e5\u5fd7\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u3002\u4f8b\u5982\u914d\u7f6e\u4e3a '^\\[' \uff0c\u5219\u8ba4\u4e3a\u884c\u9996\u4ee5 [ \u5f00\u5934\u624d\u662f\u4e00\u6761\u65b0\u65e5\u5fd7\uff0c\u5426\u5219\u5c06\u8fd9\u884c\u5185\u5bb9\u5408\u5165\u4e0a\u4e00\u6761\u65e5\u5fd7\u4f5c\u4e3a\u4e0a\u4e00\u6761\u65e5\u5fd7\u7684\u4e00\u90e8\u5206 maxLines \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxLines int \u975e\u5fc5\u586b 500 1\u6761\u65e5\u5fd7\u6700\u591a\u5305\u542b\u51e0\u884c\u5185\u5bb9\u3002\u9ed8\u8ba4500\u884c\uff0c\u8d85\u8fc7\u4e0a\u9650\u5c06\u5f3a\u5236\u53d1\u9001\u5f53\u524d\u65e5\u5fd7\uff0c\u8d85\u51fa\u90e8\u5206\u4f5c\u4e3a\u65b0\u7684\u4e00\u6761\u65e5\u5fd7 maxBytes \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxBytes int64 \u975e\u5fc5\u586b 131072 1\u6761\u65e5\u5fd7\u6700\u591a\u5305\u542b\u51e0\u4e2a\u5b57\u8282\u3002\u9ed8\u8ba4128K\uff0c\u8d85\u8fc7\u4e0a\u9650\u5c06\u5f3a\u5236\u53d1\u9001\u5f53\u524d\u65e5\u5fd7\uff0c\u8d85\u51fa\u90e8\u5206\u4f5c\u4e3a\u65b0\u7684\u4e00\u6761\u65e5\u5fd7 timeout \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 timeout time.Duration \u975e\u5fc5\u586b 5s 1\u6761\u65e5\u5fd7\u6700\u591a\u7b49\u5f85\u591a\u4e45\u91c7\u96c6\u4e3a\u5b8c\u6574\u76841\u6761\u65e5\u5fd7\u3002\u9ed8\u8ba45s\uff0c\u8d85\u8fc7\u4e0a\u9650\u5c06\u5f3a\u5236\u53d1\u9001\u5f53\u524d\u65e5\u5fd7\uff0c\u8d85\u51fa\u90e8\u5206\u4f5c\u4e3a\u65b0\u7684\u4e00\u6761\u65e5\u5fd7 ack \u00b6 source\u7684\u786e\u8ba4\u673a\u5236\u76f8\u5173\u914d\u7f6e\u3002\u5982\u679c\u9700\u786e\u4fdd\u8981 at least once \uff0c\u9700\u8981\u5f00\u542fack\u673a\u5236\uff0c\u4f46\u662f\u4f1a\u6709\u4e00\u5b9a\u6027\u80fd\u987a\u8017 Caution \u8be5\u914d\u7f6e\u53ea\u80fd\u914d\u7f6e\u5728defaults\u4e2d Example defaults : sources : - type : file ack : enable : true enable \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 enable bool \u975e\u5fc5\u586b true \u662f\u5426\u5f00\u542f\u786e\u8ba4\u673a\u5236 maintenanceInterval \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maintenanceInterval time.Duration \u975e\u5fc5\u586b 20h \u7ef4\u62a4\u5468\u671f\u3002\u7528\u6765\u5b9a\u65f6\u6e05\u7406\u8fc7\u671f\u7684\u786e\u8ba4\u6587\u4ef6\u6570\u636e(\u4f8b\u5982\u4e0d\u518d\u91c7\u96c6\u7684\u6587\u4ef6\u7684ack\u4fe1\u606f) db \u00b6 \u4f7f\u7528 sqlite3 \u4f5c\u4e3a\u6570\u636e\u5e93\u3002\u4fdd\u5b58\u91c7\u96c6\u8fc7\u7a0b\u4e2d\u7684\u6587\u4ef6\u540d\u79f0\u3001\u6587\u4ef6inode\u3001\u6587\u4ef6\u91c7\u96c6\u7684offset\u7b49\u4fe1\u606f\u3002\u7528\u6765\u5728loggie reload\u6216\u8005\u91cd\u542f\u540e\u6062\u590d\u4e0a\u4e00\u6b21\u7684\u91c7\u96c6\u8fdb\u5ea6 Caution \u8be5\u914d\u7f6e\u53ea\u80fd\u914d\u7f6e\u5728defaults\u4e2d Example defaults : sources : - type : file db : file : \"./data/loggie.db\" file \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 file string \u975e\u5fc5\u586b ./data/loggie.db \u6570\u636e\u5e93\u6587\u4ef6\u8def\u5f84 tableName \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 tableName string \u975e\u5fc5\u586b registry \u6570\u636e\u5e93\u8868\u540d\u79f0 flushTimeout \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 flushTimeout time.Duration \u975e\u5fc5\u586b 2s \u5b9a\u65f6\u5c06\u91c7\u96c6\u4fe1\u606f\u5199\u5165\u5230\u6570\u636e\u5e93 bufferSize \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 bufferSize int \u975e\u5fc5\u586b 2048 \u8f93\u5165\u6570\u636e\u5e93\u7684\u91c7\u96c6\u4fe1\u606f\u7684\u7f13\u51b2\u533a\u5927\u5c0f cleanInactiveTimeout \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 cleanInactiveTimeout time.Duration \u975e\u5fc5\u586b 504h \u6e05\u7406\u6570\u636e\u5e93\u4e2d\u7684\u8fc7\u671f\u6570\u636e\u3002\u5982\u679c\u6570\u636e\u7684\u66f4\u65b0\u65f6\u95f4\u8d85\u8fc7\u914d\u7f6e\u503c\uff0c\u5c06\u4f1a\u5220\u9664\u8be5\u6761\u6570\u636e\u3002\u9ed8\u8ba4\u4fdd\u755921\u5929 cleanScanInterval \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 cleanScanInterval time.Duration \u975e\u5fc5\u586b 1h \u5468\u671f\u6027\u7684\u68c0\u67e5\u6570\u636e\u5e93\u4e2d\u7684\u8fc7\u671f\u6570\u636e\u3002\u9ed8\u8ba4\u6bcf\u96941\u5c0f\u65f6\u68c0\u67e5\u4e00\u6b21 watcher \u00b6 \u76d1\u63a7\u6587\u4ef6\u53d8\u5316\u7684\u76f8\u5173\u914d\u7f6e Caution \u8be5\u914d\u7f6e\u53ea\u80fd\u914d\u7f6e\u5728defaults\u4e2d Example defaults : sources : - type : file watcher : enableOsWatch : true enableOsWatch \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 enableOsWatch bool \u975e\u5fc5\u586b true \u662f\u5426\u542f\u7528OS\u7684\u76d1\u63a7\u901a\u77e5\u673a\u5236\u3002\u4f8b\u5982linux\u7684inotify\u6307\u4ee4 scanTimeInterval \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 scanTimeInterval time.Duration \u975e\u5fc5\u586b 10s \u5468\u671f\u6027\u7684\u68c0\u67e5\u6587\u4ef6\u7684\u72b6\u6001\u53d8\u66f4\uff08\u4f8b\u5982\u6587\u4ef6\u7684\u65b0\u5efa\u3001\u5220\u9664\u7b49\uff09\u3002\u9ed8\u8ba4\u6bcf\u969410s\u68c0\u67e5\u4e00\u6b21 maintenanceInterval \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maintenanceInterval time.Duration \u975e\u5fc5\u586b 5m \u5468\u671f\u6027\u7684\u7ef4\u62a4\u5de5\u4f5c\uff08\u4f8b\u5982\u4e0a\u62a5\u91c7\u96c6\u7edf\u8ba1\u4fe1\u606f\u3001\u6e05\u7406\u6587\u4ef6\u7b49\uff09\u3002\u9ed8\u8ba4\u6bcf\u969410s\u68c0\u67e5\u4e00\u6b21 fdHoldTimeoutWhenInactive \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 fdHoldTimeoutWhenInactive time.Duration \u975e\u5fc5\u586b 5m \u5f53\u6587\u4ef6\u7684\u4e0a\u6b21\u91c7\u96c6\u5230\u73b0\u5728\u7684\u65f6\u95f4\u8d85\u8fc7\u9650\u5236\uff08\u6587\u4ef6\u957f\u65f6\u95f4\u6ca1\u6709\u5199\u5165\uff0c\u8ba4\u4e3a\u5927\u6982\u7387\u4e0d\u4f1a\u518d\u5199\u5165\u5185\u5bb9\uff09\uff0c\u5c06\u4f1a\u91ca\u653e\u8be5\u6587\u4ef6\u7684\u6587\u4ef6\u53e5\u67c4\u4ee5\u91ca\u653e\u7cfb\u7edf\u8d44\u6e90 fdHoldTimeoutWhenRemove \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 fdHoldTimeoutWhenRemove time.Duration \u975e\u5fc5\u586b 5m \u5f53\u6587\u4ef6\u88ab\u5220\u9664\u4e14\u672a\u91c7\u96c6\u5b8c\u6210\uff0c\u4f1a\u7b49\u5f85\u7684\u6700\u5927\u65f6\u95f4\u6765\u91c7\u96c6\u5b8c\u6210\u3002\u8d85\u8fc7\u9650\u5236\u4e0d\u7ba1\u6587\u4ef6\u6700\u7ec8\u662f\u5426\u91c7\u96c6\u5b8c\u6210\uff0c\u90fd\u4f1a\u76f4\u63a5\u91ca\u653e\u6587\u4ef6\u53e5\u67c4\u4e0d\u518d\u91c7\u96c6 maxOpenFds \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxOpenFds int \u975e\u5fc5\u586b 512 \u6700\u5927\u6253\u5f00\u7684\u6587\u4ef6\u53e5\u67c4\u6570\u91cf\uff0c\u8d85\u51fa\u540e\u7684\u6587\u4ef6\u5c06\u6682\u65f6\u4e0d\u4f1a\u91c7\u96c6 maxEofCount \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxEofCount int \u975e\u5fc5\u586b 3 \u6700\u5927\u8fde\u7eed\u8bfb\u53d6\u6587\u4ef6\u9047\u5230eof\u7684\u6b21\u6570\u3002\u8d85\u8fc7\u9650\u5236\u8ba4\u4e3a\u6587\u4ef6\u6682\u65f6\u4e0d\u6d3b\u8dc3\uff0c\u5c06\u8fdb\u5165\u201c\u50f5\u5c38\u201d\u961f\u5217\u7b49\u5f85\u66f4\u65b0\u4e8b\u4ef6\u88ab\u6fc0\u6d3b cleanWhenRemoved \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 cleanWhenRemoved bool \u975e\u5fc5\u586b true \u5f53\u6587\u4ef6\u88ab\u5220\u9664\u540e\uff0c\u662f\u5426\u540c\u6b65\u5220\u9664db\u4e2d\u7684\u91c7\u96c6\u76f8\u5173\u4fe1\u606f readFromTail \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 readFromTail bool \u975e\u5fc5\u586b false \u662f\u5426\u4ece\u6587\u4ef6\u7684\u6700\u65b0\u4e00\u884c\u5f00\u59cb\u91c7\u96c6\uff0c\u800c\u4e0d\u7ba1\u5386\u53f2\u5199\u5165\u5230\u6587\u4ef6\u7684\u5185\u5bb9\u3002\u9002\u7528\u4e8e\u91c7\u96c6\u7cfb\u7edf\u7684\u8fc1\u79fb\u7b49\u573a\u666f taskStopTimeout \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 taskStopTimeout time.Duration \u975e\u5fc5\u586b 30s \u91c7\u96c6\u4efb\u52a1\u9000\u51fa\u7684\u8d85\u65f6\u65f6\u95f4\u3002\u662f\u4e00\u4e2a\u515c\u5e95\u65b9\u6848\uff0c\u653e\u5728\u91c7\u96c6\u4efb\u52a1\u5047\u6b7b\u5bfc\u81f4\u65e0\u6cd5reload cleanFiles \u00b6 \u6e05\u7406\u6587\u4ef6\u76f8\u5173\u914d\u7f6e\u3002\u8fc7\u671f\u4e14\u5df2\u7ecf\u91c7\u96c6\u5b8c\u6210\u7684\u6587\u4ef6\u5c06\u4f1a\u76f4\u63a5\u4ece\u78c1\u76d8\u5220\u9664\u4ee5\u91ca\u653e\u78c1\u76d8\u7a7a\u95f4 maxHistoryDays \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxHistoryDays int \u975e\u5fc5\u586b \u65e0 \uff08\u91c7\u96c6\u5b8c\u6210\u540e\u7684\uff09\u6587\u4ef6\u6700\u591a\u4fdd\u7559\u7684\u5929\u6570\u3002\u5982\u679c\u8d85\u51fa\u9650\u5236\uff0c\u5c06\u4f1a\u628a\u6587\u4ef6\u76f4\u63a5\u4ece\u78c1\u76d8\u4e2d\u5220\u9664\u3002\u4e0d\u914d\u7f6e\u5219\u6c38\u8fdc\u4e0d\u4f1a\u5220\u9664\u6587\u4ef6","title":"file"},{"location":"reference/pipelines/source/file/#file","text":"file source\u7528\u4e8e\u65e5\u5fd7\u91c7\u96c6\u3002 Example sources : - type : file name : accesslog","title":"file"},{"location":"reference/pipelines/source/file/#paths","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 paths string\u6570\u7ec4 \u5fc5\u586b \u65e0 \u91c7\u96c6\u7684path\u8def\u5f84\uff0c\u4f7f\u7528glob\u8868\u8fbe\u5f0f\u6765\u5339\u914d\u3002\u652f\u6301glob\u6269\u5c55\u8868\u8fbe\u5f0f Brace Expansion \u548c Glob Star Example \u9700\u8981\u91c7\u96c6\u7684\u76ee\u6807\u6587\u4ef6\uff1a /tmp/loggie/service/order/access.log /tmp/loggie/service/order/access.log.2022-04-11 /tmp/loggie/service/pay/access.log /tmp/loggie/service/pay/access.log.2022-04-11 \u5bf9\u5e94\u914d\u7f6e\uff1a sources : - type : file paths : - /tmp/loggie/**/access.log{,.[2-9][0-9][0-9][0-9]-[01][0-9]-[0123][0-9]}","title":"paths"},{"location":"reference/pipelines/source/file/#excludefiles","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 excludeFiles string\u6570\u7ec4 \u975e\u5fc5\u586b \u65e0 \u6392\u9664\u91c7\u96c6\u7684\u6587\u4ef6\u6b63\u5219\u8868\u8fbe\u5f0f","title":"excludeFiles"},{"location":"reference/pipelines/source/file/#ignoreolder","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 ignoreOlder time.Duration \u975e\u5fc5\u586b \u65e0 \u4f8b\u598248h\uff0c\u8868\u793a\u5ffd\u7565\u66f4\u65b0\u65f6\u95f4\u57282\u5929\u4e4b\u524d\u7684\u6587\u4ef6\uff0c\u65e0\u9700\u8fdb\u884c\u91c7\u96c6","title":"ignoreOlder"},{"location":"reference/pipelines/source/file/#ignoresymlink","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 ignoreSymlink bool \u975e\u5fc5\u586b false \u662f\u5426\u5ffd\u7565\u7b26\u53f7\u94fe\u63a5\uff08\u8f6f\u94fe\u63a5\uff09\u7684\u6587\u4ef6","title":"ignoreSymlink"},{"location":"reference/pipelines/source/file/#addonmeta","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 addonMeta bool \u975e\u5fc5\u586b false \u662f\u5426\u6dfb\u52a0\u9ed8\u8ba4\u7684\u65e5\u5fd7\u91c7\u96c6state\u5143\u4fe1\u606f event\u793a\u4f8b { \"body\" : \"this is test\" , \"state\" : { \"pipeline\" : \"local\" , \"source\" : \"demo\" , \"filename\" : \"/var/log/a.log\" , \"timestamp\" : \"2006-01-02T15:04:05.000Z\" , \"offset\" : 1024 , \"bytes\" : 4096 , \"hostname\" : \"node-1\" } } state\u542b\u4e49\u89e3\u91ca\uff1a - pipeline: \u6240\u5728\u7684pipeline\u540d\u79f0 - source: \u6240\u5728\u7684source\u540d\u79f0 - filename: \u91c7\u96c6\u7684\u6587\u4ef6\u540d\u79f0 - timestamp: \u91c7\u96c6\u65f6\u523b\u7684\u65f6\u95f4\u6233 - offset: \u91c7\u96c6\u7684\u6570\u636e\u5728\u6587\u4ef6\u7684offset\u504f\u79fb\u91cf - bytes: \u91c7\u96c6\u7684\u6570\u636e\u5b57\u8282\u6570 - hostname: \u6240\u5728\u8282\u70b9\u540d\u79f0","title":"addonMeta"},{"location":"reference/pipelines/source/file/#workercount","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 workerCount int \u975e\u5fc5\u586b 1 \u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u7684\u5de5\u4f5c\u7ebf\u7a0b(goroutine)\u6570\u3002\u5355\u8282\u70b9\u8d85\u8fc7100\u4e2a\u6587\u4ef6\u7684\u65f6\u5019\u8003\u8651\u63d0\u9ad8","title":"workerCount"},{"location":"reference/pipelines/source/file/#readchansize","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 readChanSize int \u975e\u5fc5\u586b 512 \u8bfb\u53d6\u4efb\u52a1\u7684channel size","title":"readChanSize"},{"location":"reference/pipelines/source/file/#readbuffersize","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 readBufferSize int \u975e\u5fc5\u586b 65536 \u5355\u6b21\u8bfb\u53d6\u6587\u4ef6\u7684\u6570\u636e\u91cf\u3002\u9ed8\u8ba464K=65536","title":"readBufferSize"},{"location":"reference/pipelines/source/file/#maxcontinueread","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxContinueRead int \u975e\u5fc5\u586b 16 \u8fde\u7eed\u8bfb\u53d6\u540c\u4e00\u4e2a\u6587\u4ef6\u5185\u5bb9\u7684\u6b21\u6570\uff0c\u8fbe\u5230\u8fd9\u4e2a\u6b21\u6570\u5c06\u5f3a\u5236\u5207\u6362\u5230\u4e0b\u4e2a\u6587\u4ef6\u8bfb\u53d6\u3002\u4e3b\u8981\u4f5c\u7528\u662f\u7528\u6765\u907f\u514d\u6d3b\u8dc3\u6587\u4ef6\u4e00\u76f4\u5360\u636e\u8bfb\u53d6\u8d44\u6e90\uff0c\u975e\u6d3b\u8dc3\u6587\u4ef6\u957f\u65f6\u95f4\u5f97\u4e0d\u5230\u8bfb\u53d6\u91c7\u96c6","title":"maxContinueRead"},{"location":"reference/pipelines/source/file/#maxcontinuereadtimeout","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxContinueReadTimeout time.Duration \u975e\u5fc5\u586b 3s \u540c\u4e00\u4e2a\u6587\u4ef6\u6700\u957f\u8bfb\u53d6\u65f6\u95f4\uff0c\u8d85\u8fc7\u8fd9\u4e2a\u65f6\u95f4\u5c06\u5f3a\u5236\u5207\u6362\u4e0b\u4e2a\u6587\u4ef6\u8bfb\u53d6\u3002\u4f5c\u7528\u4e0e maxContinueRead \u7c7b\u4f3c","title":"maxContinueReadTimeout"},{"location":"reference/pipelines/source/file/#inactivetimeout","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 inactiveTimeout time.Duration \u975e\u5fc5\u586b 3s \u5982\u679c\u5f53\u6587\u4ef6\u4ece\u4e0a\u4e00\u6b21\u91c7\u96c6\u5230\u73b0\u5728\u8d85\u8fc7inactiveTimeout\u7684\u8bdd\uff0c\u5219\u8ba4\u4e3a\u6587\u4ef6\u8fdb\u5165\u4e0d\u6d3b\u8dc3\u72b6\u6001(\u5373\u6700\u540e\u4e00\u6761\u65e5\u5fd7\u5df2\u7ecf\u5199\u5165\u5b8c\u6210)\uff0c\u5219\u53ef\u4ee5\u5b89\u5168\u7684\u91c7\u96c6\u6700\u540e\u4e00\u884c\u65e5\u5fd7","title":"inactiveTimeout"},{"location":"reference/pipelines/source/file/#firstnbytesforidentifier","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 firstNBytesForIdentifier int \u975e\u5fc5\u586b 128 \u4f7f\u7528\u91c7\u96c6\u76ee\u6807\u6587\u4ef6\u7684\u524dn\u4e2a\u5b57\u7b26\u6765\u751f\u6210\u6587\u4ef6\u552f\u4e00code\u3002 \u5982\u679c\u6587\u4ef6\u7684\u5927\u5c0f\u5c0f\u4e8en\uff0c\u5219\u8be5\u6587\u4ef6\u6682\u65f6\u4e0d\u4f1a\u91c7\u96c6 \u3002\u7528\u9014\u4e3b\u8981\u662f\uff0c\u7ed3\u5408\u6587\u4ef6inode\u4fe1\u606f\uff0c\u7528\u6765\u7cbe\u786e\u6807\u8bc6\u4e00\u4e2a\u6587\u4ef6\u3002\u8f85\u52a9\u5224\u65ad\u6587\u4ef6\u662f\u5426\u5220\u9664\u6216\u8005\u662f\u6539\u540d","title":"firstNBytesForIdentifier"},{"location":"reference/pipelines/source/file/#multi","text":"\u591a\u884c\u91c7\u96c6\u76f8\u5173\u914d\u7f6e Example sources : - type : file name : accesslog multi : active : true","title":"multi"},{"location":"reference/pipelines/source/file/#active","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 active bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542f\u591a\u884c\u91c7\u96c6\u6a21\u5f0f","title":"active"},{"location":"reference/pipelines/source/file/#pattern","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 pattern string \u5f53multi.active=true\u7684\u65f6\u5019\u5fc5\u586b false \u5224\u65ad\u4e3a\u4e00\u6761\u5168\u65b0\u65e5\u5fd7\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u3002\u4f8b\u5982\u914d\u7f6e\u4e3a '^\\[' \uff0c\u5219\u8ba4\u4e3a\u884c\u9996\u4ee5 [ \u5f00\u5934\u624d\u662f\u4e00\u6761\u65b0\u65e5\u5fd7\uff0c\u5426\u5219\u5c06\u8fd9\u884c\u5185\u5bb9\u5408\u5165\u4e0a\u4e00\u6761\u65e5\u5fd7\u4f5c\u4e3a\u4e0a\u4e00\u6761\u65e5\u5fd7\u7684\u4e00\u90e8\u5206","title":"pattern"},{"location":"reference/pipelines/source/file/#maxlines","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxLines int \u975e\u5fc5\u586b 500 1\u6761\u65e5\u5fd7\u6700\u591a\u5305\u542b\u51e0\u884c\u5185\u5bb9\u3002\u9ed8\u8ba4500\u884c\uff0c\u8d85\u8fc7\u4e0a\u9650\u5c06\u5f3a\u5236\u53d1\u9001\u5f53\u524d\u65e5\u5fd7\uff0c\u8d85\u51fa\u90e8\u5206\u4f5c\u4e3a\u65b0\u7684\u4e00\u6761\u65e5\u5fd7","title":"maxLines"},{"location":"reference/pipelines/source/file/#maxbytes","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxBytes int64 \u975e\u5fc5\u586b 131072 1\u6761\u65e5\u5fd7\u6700\u591a\u5305\u542b\u51e0\u4e2a\u5b57\u8282\u3002\u9ed8\u8ba4128K\uff0c\u8d85\u8fc7\u4e0a\u9650\u5c06\u5f3a\u5236\u53d1\u9001\u5f53\u524d\u65e5\u5fd7\uff0c\u8d85\u51fa\u90e8\u5206\u4f5c\u4e3a\u65b0\u7684\u4e00\u6761\u65e5\u5fd7","title":"maxBytes"},{"location":"reference/pipelines/source/file/#timeout","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 timeout time.Duration \u975e\u5fc5\u586b 5s 1\u6761\u65e5\u5fd7\u6700\u591a\u7b49\u5f85\u591a\u4e45\u91c7\u96c6\u4e3a\u5b8c\u6574\u76841\u6761\u65e5\u5fd7\u3002\u9ed8\u8ba45s\uff0c\u8d85\u8fc7\u4e0a\u9650\u5c06\u5f3a\u5236\u53d1\u9001\u5f53\u524d\u65e5\u5fd7\uff0c\u8d85\u51fa\u90e8\u5206\u4f5c\u4e3a\u65b0\u7684\u4e00\u6761\u65e5\u5fd7","title":"timeout"},{"location":"reference/pipelines/source/file/#ack","text":"source\u7684\u786e\u8ba4\u673a\u5236\u76f8\u5173\u914d\u7f6e\u3002\u5982\u679c\u9700\u786e\u4fdd\u8981 at least once \uff0c\u9700\u8981\u5f00\u542fack\u673a\u5236\uff0c\u4f46\u662f\u4f1a\u6709\u4e00\u5b9a\u6027\u80fd\u987a\u8017 Caution \u8be5\u914d\u7f6e\u53ea\u80fd\u914d\u7f6e\u5728defaults\u4e2d Example defaults : sources : - type : file ack : enable : true","title":"ack"},{"location":"reference/pipelines/source/file/#enable","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 enable bool \u975e\u5fc5\u586b true \u662f\u5426\u5f00\u542f\u786e\u8ba4\u673a\u5236","title":"enable"},{"location":"reference/pipelines/source/file/#maintenanceinterval","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maintenanceInterval time.Duration \u975e\u5fc5\u586b 20h \u7ef4\u62a4\u5468\u671f\u3002\u7528\u6765\u5b9a\u65f6\u6e05\u7406\u8fc7\u671f\u7684\u786e\u8ba4\u6587\u4ef6\u6570\u636e(\u4f8b\u5982\u4e0d\u518d\u91c7\u96c6\u7684\u6587\u4ef6\u7684ack\u4fe1\u606f)","title":"maintenanceInterval"},{"location":"reference/pipelines/source/file/#db","text":"\u4f7f\u7528 sqlite3 \u4f5c\u4e3a\u6570\u636e\u5e93\u3002\u4fdd\u5b58\u91c7\u96c6\u8fc7\u7a0b\u4e2d\u7684\u6587\u4ef6\u540d\u79f0\u3001\u6587\u4ef6inode\u3001\u6587\u4ef6\u91c7\u96c6\u7684offset\u7b49\u4fe1\u606f\u3002\u7528\u6765\u5728loggie reload\u6216\u8005\u91cd\u542f\u540e\u6062\u590d\u4e0a\u4e00\u6b21\u7684\u91c7\u96c6\u8fdb\u5ea6 Caution \u8be5\u914d\u7f6e\u53ea\u80fd\u914d\u7f6e\u5728defaults\u4e2d Example defaults : sources : - type : file db : file : \"./data/loggie.db\"","title":"db"},{"location":"reference/pipelines/source/file/#file_1","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 file string \u975e\u5fc5\u586b ./data/loggie.db \u6570\u636e\u5e93\u6587\u4ef6\u8def\u5f84","title":"file"},{"location":"reference/pipelines/source/file/#tablename","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 tableName string \u975e\u5fc5\u586b registry \u6570\u636e\u5e93\u8868\u540d\u79f0","title":"tableName"},{"location":"reference/pipelines/source/file/#flushtimeout","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 flushTimeout time.Duration \u975e\u5fc5\u586b 2s \u5b9a\u65f6\u5c06\u91c7\u96c6\u4fe1\u606f\u5199\u5165\u5230\u6570\u636e\u5e93","title":"flushTimeout"},{"location":"reference/pipelines/source/file/#buffersize","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 bufferSize int \u975e\u5fc5\u586b 2048 \u8f93\u5165\u6570\u636e\u5e93\u7684\u91c7\u96c6\u4fe1\u606f\u7684\u7f13\u51b2\u533a\u5927\u5c0f","title":"bufferSize"},{"location":"reference/pipelines/source/file/#cleaninactivetimeout","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 cleanInactiveTimeout time.Duration \u975e\u5fc5\u586b 504h \u6e05\u7406\u6570\u636e\u5e93\u4e2d\u7684\u8fc7\u671f\u6570\u636e\u3002\u5982\u679c\u6570\u636e\u7684\u66f4\u65b0\u65f6\u95f4\u8d85\u8fc7\u914d\u7f6e\u503c\uff0c\u5c06\u4f1a\u5220\u9664\u8be5\u6761\u6570\u636e\u3002\u9ed8\u8ba4\u4fdd\u755921\u5929","title":"cleanInactiveTimeout"},{"location":"reference/pipelines/source/file/#cleanscaninterval","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 cleanScanInterval time.Duration \u975e\u5fc5\u586b 1h \u5468\u671f\u6027\u7684\u68c0\u67e5\u6570\u636e\u5e93\u4e2d\u7684\u8fc7\u671f\u6570\u636e\u3002\u9ed8\u8ba4\u6bcf\u96941\u5c0f\u65f6\u68c0\u67e5\u4e00\u6b21","title":"cleanScanInterval"},{"location":"reference/pipelines/source/file/#watcher","text":"\u76d1\u63a7\u6587\u4ef6\u53d8\u5316\u7684\u76f8\u5173\u914d\u7f6e Caution \u8be5\u914d\u7f6e\u53ea\u80fd\u914d\u7f6e\u5728defaults\u4e2d Example defaults : sources : - type : file watcher : enableOsWatch : true","title":"watcher"},{"location":"reference/pipelines/source/file/#enableoswatch","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 enableOsWatch bool \u975e\u5fc5\u586b true \u662f\u5426\u542f\u7528OS\u7684\u76d1\u63a7\u901a\u77e5\u673a\u5236\u3002\u4f8b\u5982linux\u7684inotify\u6307\u4ee4","title":"enableOsWatch"},{"location":"reference/pipelines/source/file/#scantimeinterval","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 scanTimeInterval time.Duration \u975e\u5fc5\u586b 10s \u5468\u671f\u6027\u7684\u68c0\u67e5\u6587\u4ef6\u7684\u72b6\u6001\u53d8\u66f4\uff08\u4f8b\u5982\u6587\u4ef6\u7684\u65b0\u5efa\u3001\u5220\u9664\u7b49\uff09\u3002\u9ed8\u8ba4\u6bcf\u969410s\u68c0\u67e5\u4e00\u6b21","title":"scanTimeInterval"},{"location":"reference/pipelines/source/file/#maintenanceinterval_1","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maintenanceInterval time.Duration \u975e\u5fc5\u586b 5m \u5468\u671f\u6027\u7684\u7ef4\u62a4\u5de5\u4f5c\uff08\u4f8b\u5982\u4e0a\u62a5\u91c7\u96c6\u7edf\u8ba1\u4fe1\u606f\u3001\u6e05\u7406\u6587\u4ef6\u7b49\uff09\u3002\u9ed8\u8ba4\u6bcf\u969410s\u68c0\u67e5\u4e00\u6b21","title":"maintenanceInterval"},{"location":"reference/pipelines/source/file/#fdholdtimeoutwheninactive","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 fdHoldTimeoutWhenInactive time.Duration \u975e\u5fc5\u586b 5m \u5f53\u6587\u4ef6\u7684\u4e0a\u6b21\u91c7\u96c6\u5230\u73b0\u5728\u7684\u65f6\u95f4\u8d85\u8fc7\u9650\u5236\uff08\u6587\u4ef6\u957f\u65f6\u95f4\u6ca1\u6709\u5199\u5165\uff0c\u8ba4\u4e3a\u5927\u6982\u7387\u4e0d\u4f1a\u518d\u5199\u5165\u5185\u5bb9\uff09\uff0c\u5c06\u4f1a\u91ca\u653e\u8be5\u6587\u4ef6\u7684\u6587\u4ef6\u53e5\u67c4\u4ee5\u91ca\u653e\u7cfb\u7edf\u8d44\u6e90","title":"fdHoldTimeoutWhenInactive"},{"location":"reference/pipelines/source/file/#fdholdtimeoutwhenremove","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 fdHoldTimeoutWhenRemove time.Duration \u975e\u5fc5\u586b 5m \u5f53\u6587\u4ef6\u88ab\u5220\u9664\u4e14\u672a\u91c7\u96c6\u5b8c\u6210\uff0c\u4f1a\u7b49\u5f85\u7684\u6700\u5927\u65f6\u95f4\u6765\u91c7\u96c6\u5b8c\u6210\u3002\u8d85\u8fc7\u9650\u5236\u4e0d\u7ba1\u6587\u4ef6\u6700\u7ec8\u662f\u5426\u91c7\u96c6\u5b8c\u6210\uff0c\u90fd\u4f1a\u76f4\u63a5\u91ca\u653e\u6587\u4ef6\u53e5\u67c4\u4e0d\u518d\u91c7\u96c6","title":"fdHoldTimeoutWhenRemove"},{"location":"reference/pipelines/source/file/#maxopenfds","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxOpenFds int \u975e\u5fc5\u586b 512 \u6700\u5927\u6253\u5f00\u7684\u6587\u4ef6\u53e5\u67c4\u6570\u91cf\uff0c\u8d85\u51fa\u540e\u7684\u6587\u4ef6\u5c06\u6682\u65f6\u4e0d\u4f1a\u91c7\u96c6","title":"maxOpenFds"},{"location":"reference/pipelines/source/file/#maxeofcount","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxEofCount int \u975e\u5fc5\u586b 3 \u6700\u5927\u8fde\u7eed\u8bfb\u53d6\u6587\u4ef6\u9047\u5230eof\u7684\u6b21\u6570\u3002\u8d85\u8fc7\u9650\u5236\u8ba4\u4e3a\u6587\u4ef6\u6682\u65f6\u4e0d\u6d3b\u8dc3\uff0c\u5c06\u8fdb\u5165\u201c\u50f5\u5c38\u201d\u961f\u5217\u7b49\u5f85\u66f4\u65b0\u4e8b\u4ef6\u88ab\u6fc0\u6d3b","title":"maxEofCount"},{"location":"reference/pipelines/source/file/#cleanwhenremoved","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 cleanWhenRemoved bool \u975e\u5fc5\u586b true \u5f53\u6587\u4ef6\u88ab\u5220\u9664\u540e\uff0c\u662f\u5426\u540c\u6b65\u5220\u9664db\u4e2d\u7684\u91c7\u96c6\u76f8\u5173\u4fe1\u606f","title":"cleanWhenRemoved"},{"location":"reference/pipelines/source/file/#readfromtail","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 readFromTail bool \u975e\u5fc5\u586b false \u662f\u5426\u4ece\u6587\u4ef6\u7684\u6700\u65b0\u4e00\u884c\u5f00\u59cb\u91c7\u96c6\uff0c\u800c\u4e0d\u7ba1\u5386\u53f2\u5199\u5165\u5230\u6587\u4ef6\u7684\u5185\u5bb9\u3002\u9002\u7528\u4e8e\u91c7\u96c6\u7cfb\u7edf\u7684\u8fc1\u79fb\u7b49\u573a\u666f","title":"readFromTail"},{"location":"reference/pipelines/source/file/#taskstoptimeout","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 taskStopTimeout time.Duration \u975e\u5fc5\u586b 30s \u91c7\u96c6\u4efb\u52a1\u9000\u51fa\u7684\u8d85\u65f6\u65f6\u95f4\u3002\u662f\u4e00\u4e2a\u515c\u5e95\u65b9\u6848\uff0c\u653e\u5728\u91c7\u96c6\u4efb\u52a1\u5047\u6b7b\u5bfc\u81f4\u65e0\u6cd5reload","title":"taskStopTimeout"},{"location":"reference/pipelines/source/file/#cleanfiles","text":"\u6e05\u7406\u6587\u4ef6\u76f8\u5173\u914d\u7f6e\u3002\u8fc7\u671f\u4e14\u5df2\u7ecf\u91c7\u96c6\u5b8c\u6210\u7684\u6587\u4ef6\u5c06\u4f1a\u76f4\u63a5\u4ece\u78c1\u76d8\u5220\u9664\u4ee5\u91ca\u653e\u78c1\u76d8\u7a7a\u95f4","title":"cleanFiles"},{"location":"reference/pipelines/source/file/#maxhistorydays","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxHistoryDays int \u975e\u5fc5\u586b \u65e0 \uff08\u91c7\u96c6\u5b8c\u6210\u540e\u7684\uff09\u6587\u4ef6\u6700\u591a\u4fdd\u7559\u7684\u5929\u6570\u3002\u5982\u679c\u8d85\u51fa\u9650\u5236\uff0c\u5c06\u4f1a\u628a\u6587\u4ef6\u76f4\u63a5\u4ece\u78c1\u76d8\u4e2d\u5220\u9664\u3002\u4e0d\u914d\u7f6e\u5219\u6c38\u8fdc\u4e0d\u4f1a\u5220\u9664\u6587\u4ef6","title":"maxHistoryDays"},{"location":"reference/pipelines/source/grpc/","text":"grpc \u00b6 Grpc source\u7528\u4e8e\u63a5\u6536Loggie Grpc\u683c\u5f0f\u7684\u6570\u636e\u8bf7\u6c42\u3002 \u4e00\u822c\u7528\u5728 \u4e2d\u8f6c\u673a \u573a\u666f\uff0c\u63a5\u6536\u5176\u4ed6Loggie\u96c6\u7fa4\u53d1\u9001\u7684\u65e5\u5fd7\u3002 Example sources : - type : grpc name : aggre port : 6066 bind \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 bind string \u975e\u5fc5\u586b 0.0.0.0 \u63d0\u4f9bserver\u7ed1\u5b9a\u7684host port \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 port string \u975e\u5fc5\u586b 6066 \u63d0\u4f9b\u670d\u52a1\u7684\u7aef\u53e3\u53f7 timeout \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 timeout time.Duration \u975e\u5fc5\u586b 20s \u8d85\u65f6\u65f6\u95f4","title":"grpc"},{"location":"reference/pipelines/source/grpc/#grpc","text":"Grpc source\u7528\u4e8e\u63a5\u6536Loggie Grpc\u683c\u5f0f\u7684\u6570\u636e\u8bf7\u6c42\u3002 \u4e00\u822c\u7528\u5728 \u4e2d\u8f6c\u673a \u573a\u666f\uff0c\u63a5\u6536\u5176\u4ed6Loggie\u96c6\u7fa4\u53d1\u9001\u7684\u65e5\u5fd7\u3002 Example sources : - type : grpc name : aggre port : 6066","title":"grpc"},{"location":"reference/pipelines/source/grpc/#bind","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 bind string \u975e\u5fc5\u586b 0.0.0.0 \u63d0\u4f9bserver\u7ed1\u5b9a\u7684host","title":"bind"},{"location":"reference/pipelines/source/grpc/#port","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 port string \u975e\u5fc5\u586b 6066 \u63d0\u4f9b\u670d\u52a1\u7684\u7aef\u53e3\u53f7","title":"port"},{"location":"reference/pipelines/source/grpc/#timeout","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 timeout time.Duration \u975e\u5fc5\u586b 20s \u8d85\u65f6\u65f6\u95f4","title":"timeout"},{"location":"reference/pipelines/source/kafka/","text":"kafka \u00b6 Kafka source\u7528\u4e8e\u63a5\u6536Kafka\u6570\u636e\u3002 Example sources : - type : kafka brokers : [ \"kafka1.kafka.svc:9092\" ] topic : log-* brokers \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 brokers string\u6570\u7ec4 \u5fc5\u586b \u65e0 Kafka broker\u5730\u5740 topic \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 topic string \u5fc5\u586b \u65e0 \u63a5\u6536\u7684topics\uff0c\u53ef\u4f7f\u7528\u6b63\u5219\u6765\u5339\u914d\u591a\u4e2atopic groupId \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 groupId string \u975e\u5fc5\u586b loggie Loggie\u6d88\u8d39kafka\u7684groupId queueCapacity \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 queueCapacity int \u975e\u5fc5\u586b 100 \u5185\u90e8\u53d1\u9001\u7684\u961f\u5217\u5bb9\u91cf minAcceptedBytes \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 minAcceptedBytes int \u975e\u5fc5\u586b 1 \u6700\u5c0f\u63a5\u6536\u7684batch\u5b57\u8282\u6570 maxAcceptedBytes \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxAcceptedBytes int \u975e\u5fc5\u586b 1e6 \u6700\u5927\u63a5\u6536\u7684batch\u5b57\u8282\u6570 readMaxAttempts \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 readMaxAttempts int \u975e\u5fc5\u586b 3 \u6700\u5927\u7684\u91cd\u8bd5\u6b21\u6570 maxPollWait \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxPollWait time.Duration \u975e\u5fc5\u586b 10s \u63a5\u6536\u7684\u6700\u957f\u7b49\u5f85\u65f6\u95f4 readBackoffMin \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 readBackoffMin time.Duration \u975e\u5fc5\u586b 100ms \u5728\u63a5\u6536\u65b0\u7684\u6d88\u606f\u524d\uff0c\u6700\u5c0f\u7684\u65f6\u95f4\u95f4\u9694 readBackoffMax \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 readBackoffMax time.Duration \u975e\u5fc5\u586b 1s \u5728\u63a5\u6536\u65b0\u7684\u6d88\u606f\u524d\uff0c\u6700\u5927\u7684\u65f6\u95f4\u95f4\u9694 enableAutoCommit \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 enableAutoCommit bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542fautoCommit autoCommitInterval \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 autoCommitInterval time.Duration \u975e\u5fc5\u586b 1s autoCommit\u7684\u95f4\u9694\u65f6\u95f4 autoOffsetReset \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 autoOffsetReset string \u975e\u5fc5\u586b latest \u6ca1\u6709offset\u65f6\uff0c\u521d\u59cb\u7684offset\u91c7\u7528\u65b9\u5f0f\uff0c\u53ef\u4e3a earliest \u548c latest","title":"kafka"},{"location":"reference/pipelines/source/kafka/#kafka","text":"Kafka source\u7528\u4e8e\u63a5\u6536Kafka\u6570\u636e\u3002 Example sources : - type : kafka brokers : [ \"kafka1.kafka.svc:9092\" ] topic : log-*","title":"kafka"},{"location":"reference/pipelines/source/kafka/#brokers","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 brokers string\u6570\u7ec4 \u5fc5\u586b \u65e0 Kafka broker\u5730\u5740","title":"brokers"},{"location":"reference/pipelines/source/kafka/#topic","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 topic string \u5fc5\u586b \u65e0 \u63a5\u6536\u7684topics\uff0c\u53ef\u4f7f\u7528\u6b63\u5219\u6765\u5339\u914d\u591a\u4e2atopic","title":"topic"},{"location":"reference/pipelines/source/kafka/#groupid","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 groupId string \u975e\u5fc5\u586b loggie Loggie\u6d88\u8d39kafka\u7684groupId","title":"groupId"},{"location":"reference/pipelines/source/kafka/#queuecapacity","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 queueCapacity int \u975e\u5fc5\u586b 100 \u5185\u90e8\u53d1\u9001\u7684\u961f\u5217\u5bb9\u91cf","title":"queueCapacity"},{"location":"reference/pipelines/source/kafka/#minacceptedbytes","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 minAcceptedBytes int \u975e\u5fc5\u586b 1 \u6700\u5c0f\u63a5\u6536\u7684batch\u5b57\u8282\u6570","title":"minAcceptedBytes"},{"location":"reference/pipelines/source/kafka/#maxacceptedbytes","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxAcceptedBytes int \u975e\u5fc5\u586b 1e6 \u6700\u5927\u63a5\u6536\u7684batch\u5b57\u8282\u6570","title":"maxAcceptedBytes"},{"location":"reference/pipelines/source/kafka/#readmaxattempts","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 readMaxAttempts int \u975e\u5fc5\u586b 3 \u6700\u5927\u7684\u91cd\u8bd5\u6b21\u6570","title":"readMaxAttempts"},{"location":"reference/pipelines/source/kafka/#maxpollwait","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxPollWait time.Duration \u975e\u5fc5\u586b 10s \u63a5\u6536\u7684\u6700\u957f\u7b49\u5f85\u65f6\u95f4","title":"maxPollWait"},{"location":"reference/pipelines/source/kafka/#readbackoffmin","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 readBackoffMin time.Duration \u975e\u5fc5\u586b 100ms \u5728\u63a5\u6536\u65b0\u7684\u6d88\u606f\u524d\uff0c\u6700\u5c0f\u7684\u65f6\u95f4\u95f4\u9694","title":"readBackoffMin"},{"location":"reference/pipelines/source/kafka/#readbackoffmax","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 readBackoffMax time.Duration \u975e\u5fc5\u586b 1s \u5728\u63a5\u6536\u65b0\u7684\u6d88\u606f\u524d\uff0c\u6700\u5927\u7684\u65f6\u95f4\u95f4\u9694","title":"readBackoffMax"},{"location":"reference/pipelines/source/kafka/#enableautocommit","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 enableAutoCommit bool \u975e\u5fc5\u586b false \u662f\u5426\u5f00\u542fautoCommit","title":"enableAutoCommit"},{"location":"reference/pipelines/source/kafka/#autocommitinterval","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 autoCommitInterval time.Duration \u975e\u5fc5\u586b 1s autoCommit\u7684\u95f4\u9694\u65f6\u95f4","title":"autoCommitInterval"},{"location":"reference/pipelines/source/kafka/#autooffsetreset","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 autoOffsetReset string \u975e\u5fc5\u586b latest \u6ca1\u6709offset\u65f6\uff0c\u521d\u59cb\u7684offset\u91c7\u7528\u65b9\u5f0f\uff0c\u53ef\u4e3a earliest \u548c latest","title":"autoOffsetReset"},{"location":"reference/pipelines/source/kube-event/","text":"kubeEvent \u00b6 \u63a5\u6536Kubernetes events\u7684source\u3002 \u4f7f\u7528\u65b9\u5f0f\u53ef\u53c2\u8003 \u91c7\u96c6Kubernetes Events \u3002 Example sources : - type : kubeEvent name : event kubeconfig \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 kubeconfig string \u975e\u5fc5\u586b \u8bf7\u6c42Kubernetes\u7684kubeconfig\u6587\u4ef6\uff0c\u5f53Loggie\u90e8\u7f72\u5728Kubernetes\u96c6\u7fa4\u4e2d\u65f6\uff0c\u65e0\u9700\u586b\u5199\uff0c\u4f1a\u8fdb\u5165 in cluster \u6a21\u5f0f master \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 master string \u975e\u5fc5\u586b \u8bf7\u6c42Kubernetes\u7684master\u5730\u5740\uff0c\u5f53Loggie\u90e8\u7f72\u5728Kubernetes\u96c6\u7fa4\u4e2d\u65f6\uff0c\u65e0\u9700\u586b\u5199 bufferSize \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 bufferSize int \u975e\u5fc5\u586b 1000 \u76d1\u542c\u7684\u961f\u5217\u5927\u5c0f\uff0c\u6700\u5c0f\u4e3a1 watchLatestEvents \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 watchLatestEvents bool \u975e\u5fc5\u586b false \u662f\u5426\u53ea\u76d1\u542c\u6700\u65b0\u7684events \u7531\u4e8eLoggie\u91cd\u542f\u540e\u4f1a\u91cd\u65b0list\u6240\u6709\u7684events\uff0c\u4f1a\u5bfc\u81f4\u91cd\u590d\u53d1\u9001\uff0c\u5982\u679c\u4e0d\u5e0c\u671b\u91cd\u590d\u53d1\u9001\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e3atrue\uff0c\u5f53\u7136\u53ef\u80fd\u5bfc\u81f4\u91cd\u542f\u65f6\u95f4\u6bb5\u5185\u65b0\u4ea7\u751f\u7684events\u4e22\u5931\u3002 blackListNamespaces \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 blackListNamespaces string\u6570\u7ec4 \u975e\u5fc5\u586b \u4e0d\u63a5\u6536\u5176\u4e2d\u5b9a\u4e49\u7684namespaces\u4e2d\u4ea7\u751f\u7684events","title":"kubeEvent"},{"location":"reference/pipelines/source/kube-event/#kubeevent","text":"\u63a5\u6536Kubernetes events\u7684source\u3002 \u4f7f\u7528\u65b9\u5f0f\u53ef\u53c2\u8003 \u91c7\u96c6Kubernetes Events \u3002 Example sources : - type : kubeEvent name : event","title":"kubeEvent"},{"location":"reference/pipelines/source/kube-event/#kubeconfig","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 kubeconfig string \u975e\u5fc5\u586b \u8bf7\u6c42Kubernetes\u7684kubeconfig\u6587\u4ef6\uff0c\u5f53Loggie\u90e8\u7f72\u5728Kubernetes\u96c6\u7fa4\u4e2d\u65f6\uff0c\u65e0\u9700\u586b\u5199\uff0c\u4f1a\u8fdb\u5165 in cluster \u6a21\u5f0f","title":"kubeconfig"},{"location":"reference/pipelines/source/kube-event/#master","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 master string \u975e\u5fc5\u586b \u8bf7\u6c42Kubernetes\u7684master\u5730\u5740\uff0c\u5f53Loggie\u90e8\u7f72\u5728Kubernetes\u96c6\u7fa4\u4e2d\u65f6\uff0c\u65e0\u9700\u586b\u5199","title":"master"},{"location":"reference/pipelines/source/kube-event/#buffersize","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 bufferSize int \u975e\u5fc5\u586b 1000 \u76d1\u542c\u7684\u961f\u5217\u5927\u5c0f\uff0c\u6700\u5c0f\u4e3a1","title":"bufferSize"},{"location":"reference/pipelines/source/kube-event/#watchlatestevents","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 watchLatestEvents bool \u975e\u5fc5\u586b false \u662f\u5426\u53ea\u76d1\u542c\u6700\u65b0\u7684events \u7531\u4e8eLoggie\u91cd\u542f\u540e\u4f1a\u91cd\u65b0list\u6240\u6709\u7684events\uff0c\u4f1a\u5bfc\u81f4\u91cd\u590d\u53d1\u9001\uff0c\u5982\u679c\u4e0d\u5e0c\u671b\u91cd\u590d\u53d1\u9001\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e3atrue\uff0c\u5f53\u7136\u53ef\u80fd\u5bfc\u81f4\u91cd\u542f\u65f6\u95f4\u6bb5\u5185\u65b0\u4ea7\u751f\u7684events\u4e22\u5931\u3002","title":"watchLatestEvents"},{"location":"reference/pipelines/source/kube-event/#blacklistnamespaces","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 blackListNamespaces string\u6570\u7ec4 \u975e\u5fc5\u586b \u4e0d\u63a5\u6536\u5176\u4e2d\u5b9a\u4e49\u7684namespaces\u4e2d\u4ea7\u751f\u7684events","title":"blackListNamespaces"},{"location":"reference/pipelines/source/overview/","text":"Overview \u00b6 sources\u5b57\u6bb5\u4e3a\u6570\u7ec4\uff0c\u4e00\u4e2aPipeline\u4e2d\u53ef\u586b\u5199\u591a\u4e2asource\u7ec4\u4ef6\u914d\u7f6e\u3002 \u56e0\u6b64\uff0c\u8bf7\u6ce8\u610f\u6240\u6709\u7684source\u4e2d name \u5fc5\u586b\uff0c\u4f5c\u4e3apipeline\u4e2dsource\u7684\u552f\u4e00\u6807\u8bc6\u3002 Source\u901a\u7528\u914d\u7f6e \u00b6 \u6240\u6709Source\u5747\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u914d\u7f6e\u3002 enabled \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 enabled bool \u975e\u5fc5\u586b true \u8868\u793a\u662f\u5426\u5f00\u542f\u8be5source name \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 name string \u5fc5\u586b \u8868\u793asource\u7684\u540d\u79f0\uff0c\u5efa\u8bae\u586b\u5199\u6709\u6807\u8bc6\u610f\u4e49\u7684\u8bcd fields \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 fields map \u975e\u5fc5\u586b \u81ea\u5b9a\u4e49\u989d\u5916\u6dfb\u52a0\u5230event\u4e2d\u7684\u5b57\u6bb5 \u6bd4\u5982\u5982\u4e0b\u914d\u7f6e: Example sources: - type: file name: access paths: - /var/log/*.log fields: service: demo \u4f1a\u7ed9\u91c7\u96c6\u7684\u6240\u6709\u65e5\u5fd7\u4e0a\uff0c\u90fd\u52a0\u4e0a service: demo \u5b57\u6bb5\u3002 fieldsFromEnv \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 fieldsFromEnv map \u975e\u5fc5\u586b \u989d\u5916\u6dfb\u52a0\u5230event\u4e2d\u7684\u5b57\u6bb5\uff0cvalue\u4e3aenv\u73af\u5883\u53d8\u91cf\u7684key \u6bd4\u5982\u5982\u4e0b\u914d\u7f6e: Example sources: - type: file name: access paths: - /var/log/*.log fieldsFromEnv: service: SVC_NAME \u4f1a\u4eceLoggie\u6240\u5728\u7684\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u83b7\u53d6 SVC_NAME \u7684\u503c ${SVC_NAME} \uff0c\u7136\u540e\u7ed9\u6240\u6709\u7684\u65e5\u5fd7event\u4e0a\u6dfb\u52a0\u5b57\u6bb5\uff1a service: ${SVC_NAME} \u3002 fieldsUnderRoot \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 fieldsUnderRoot bool \u975e\u5fc5\u586b false \u989d\u5916\u6dfb\u52a0\u7684fields\u662f\u5426\u653e\u5728event\u7684\u6839\u90e8 \u6bd4\u5982\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8f93\u51fa\u7684\u65e5\u5fd7\u683c\u5f0f\u4e3a\uff1a { \"body\" : \"hello world\" , \"fields\" : { \"service\" : \"demo\" } } \u5982\u679c\u8bbe\u7f6efieldsUnderRoot=true\uff0c\u8f93\u51fa\u7684\u65e5\u5fd7\u683c\u5f0f\u4e3a\uff1a { \"body\" : \"hello world\" , \"service\" : \"demo\" } fieldsUnderKey \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 fieldsUnderKey string \u975e\u5fc5\u586b fields \u5f53 fieldsUnderRoot=false \u65f6\uff0c\u5b57\u6bb5\u7684\u540d\u79f0 \u6bd4\u5982\u53ef\u4ee5\u4fee\u6539\u9ed8\u8ba4\u7684\u5b57\u6bb5 fields \u4e3a tag \uff0c\u8f93\u51fa\u7684\u65e5\u5fd7\u4e3a\uff1a { \"body\" : \"hello world\" , \"tag\" : { \"service\" : \"demo\" } } codec \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 codec \u975e\u5fc5\u586b source\u63a5\u6536\u5230\u6570\u636e\u7684\u65f6\u5019\u7528\u4e8e\u89e3\u6790\u9884\u5904\u7406 codec.type string \u975e\u5fc5\u586b \u65e0 \u8bf7\u6ce8\u610f\uff1a\u76ee\u524d\u4ec5 file source \u652f\u6301source codec\u3002 type: json \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 codec.bodyFields \u5fc5\u586b \u4f7f\u7528\u89e3\u6790\u8bfb\u53d6\u5230\u7684json\u6570\u636e\u4e2d\u7684\u8be5\u5b57\u6bb5\u4f5c\u4e3a body \u914d\u7f6e\u793a\u4f8b\uff1a type: json sources : - type : file name : nginx paths : - /var/log/*.log codec : type : json bodyFields : log \u5982\u679c\u91c7\u96c6\u5230\u7684\u65e5\u5fd7\u4e3a\uff1a { \"log\" : \"I0610 08:29:07.698664 Waiting for caches to sync\\n\" , \"stream\" : \"stderr\" , \"time:\" 2021-06-10 T 08 : 29 : 07.698731204 Z\"} \u5219codec\u540e\u5f97\u5230\u7684event\u4e3a\uff1a body: \"I0610 08:29:07.698664 Waiting for caches to sync\" \u8bf7\u6ce8\u610f\uff1a\u76ee\u524d\u975ebodyFields\u7684\u5b57\u6bb5\u5747\u4f1a\u88ab\u4e22\u5f03\u3002 type: regex \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 codec.pattern \u5fc5\u586b \u6b63\u5219\u8868\u8fbe\u5f0f codec.bodyFields \u5fc5\u586b \u4f7f\u7528\u6b63\u5219\u63d0\u53d6\u5230\u7684\u8be5\u5b57\u6bb5\u4f5c\u4e3a body \u914d\u7f6e\u793a\u4f8b\uff1a type: regex sources : - type : file name : nginx paths : - /var/log/*.log codec : type : regex pattern : ^(?P<time>[^ ^Z]+Z) (?P<stream>stdout|stderr) (?P<logtag>[^ ]*) (?P<log>.*)$ bodyFields : log \u5982\u679c\u91c7\u96c6\u5230\u7684\u65e5\u5fd7\u4e3a\uff1a 2021-12-01T03:13:58.298476921Z stderr F INFO [main] Starting service [Catalina] \u5219codec\u540e\u5f97\u5230\u7684event\u4e3a\uff1a body: \"INFO [main] Starting service [Catalina]\" \u8bf7\u6ce8\u610f\uff1a\u76ee\u524d\u975ebodyFields\u7684\u5b57\u6bb5\u5747\u4f1a\u88ab\u4e22\u5f03\u3002","title":"Overview"},{"location":"reference/pipelines/source/overview/#overview","text":"sources\u5b57\u6bb5\u4e3a\u6570\u7ec4\uff0c\u4e00\u4e2aPipeline\u4e2d\u53ef\u586b\u5199\u591a\u4e2asource\u7ec4\u4ef6\u914d\u7f6e\u3002 \u56e0\u6b64\uff0c\u8bf7\u6ce8\u610f\u6240\u6709\u7684source\u4e2d name \u5fc5\u586b\uff0c\u4f5c\u4e3apipeline\u4e2dsource\u7684\u552f\u4e00\u6807\u8bc6\u3002","title":"Overview"},{"location":"reference/pipelines/source/overview/#source","text":"\u6240\u6709Source\u5747\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u914d\u7f6e\u3002","title":"Source\u901a\u7528\u914d\u7f6e"},{"location":"reference/pipelines/source/overview/#enabled","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 enabled bool \u975e\u5fc5\u586b true \u8868\u793a\u662f\u5426\u5f00\u542f\u8be5source","title":"enabled"},{"location":"reference/pipelines/source/overview/#name","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 name string \u5fc5\u586b \u8868\u793asource\u7684\u540d\u79f0\uff0c\u5efa\u8bae\u586b\u5199\u6709\u6807\u8bc6\u610f\u4e49\u7684\u8bcd","title":"name"},{"location":"reference/pipelines/source/overview/#fields","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 fields map \u975e\u5fc5\u586b \u81ea\u5b9a\u4e49\u989d\u5916\u6dfb\u52a0\u5230event\u4e2d\u7684\u5b57\u6bb5 \u6bd4\u5982\u5982\u4e0b\u914d\u7f6e: Example sources: - type: file name: access paths: - /var/log/*.log fields: service: demo \u4f1a\u7ed9\u91c7\u96c6\u7684\u6240\u6709\u65e5\u5fd7\u4e0a\uff0c\u90fd\u52a0\u4e0a service: demo \u5b57\u6bb5\u3002","title":"fields"},{"location":"reference/pipelines/source/overview/#fieldsfromenv","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 fieldsFromEnv map \u975e\u5fc5\u586b \u989d\u5916\u6dfb\u52a0\u5230event\u4e2d\u7684\u5b57\u6bb5\uff0cvalue\u4e3aenv\u73af\u5883\u53d8\u91cf\u7684key \u6bd4\u5982\u5982\u4e0b\u914d\u7f6e: Example sources: - type: file name: access paths: - /var/log/*.log fieldsFromEnv: service: SVC_NAME \u4f1a\u4eceLoggie\u6240\u5728\u7684\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u83b7\u53d6 SVC_NAME \u7684\u503c ${SVC_NAME} \uff0c\u7136\u540e\u7ed9\u6240\u6709\u7684\u65e5\u5fd7event\u4e0a\u6dfb\u52a0\u5b57\u6bb5\uff1a service: ${SVC_NAME} \u3002","title":"fieldsFromEnv"},{"location":"reference/pipelines/source/overview/#fieldsunderroot","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 fieldsUnderRoot bool \u975e\u5fc5\u586b false \u989d\u5916\u6dfb\u52a0\u7684fields\u662f\u5426\u653e\u5728event\u7684\u6839\u90e8 \u6bd4\u5982\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8f93\u51fa\u7684\u65e5\u5fd7\u683c\u5f0f\u4e3a\uff1a { \"body\" : \"hello world\" , \"fields\" : { \"service\" : \"demo\" } } \u5982\u679c\u8bbe\u7f6efieldsUnderRoot=true\uff0c\u8f93\u51fa\u7684\u65e5\u5fd7\u683c\u5f0f\u4e3a\uff1a { \"body\" : \"hello world\" , \"service\" : \"demo\" }","title":"fieldsUnderRoot"},{"location":"reference/pipelines/source/overview/#fieldsunderkey","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 fieldsUnderKey string \u975e\u5fc5\u586b fields \u5f53 fieldsUnderRoot=false \u65f6\uff0c\u5b57\u6bb5\u7684\u540d\u79f0 \u6bd4\u5982\u53ef\u4ee5\u4fee\u6539\u9ed8\u8ba4\u7684\u5b57\u6bb5 fields \u4e3a tag \uff0c\u8f93\u51fa\u7684\u65e5\u5fd7\u4e3a\uff1a { \"body\" : \"hello world\" , \"tag\" : { \"service\" : \"demo\" } }","title":"fieldsUnderKey"},{"location":"reference/pipelines/source/overview/#codec","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 codec \u975e\u5fc5\u586b source\u63a5\u6536\u5230\u6570\u636e\u7684\u65f6\u5019\u7528\u4e8e\u89e3\u6790\u9884\u5904\u7406 codec.type string \u975e\u5fc5\u586b \u65e0 \u8bf7\u6ce8\u610f\uff1a\u76ee\u524d\u4ec5 file source \u652f\u6301source codec\u3002","title":"codec"},{"location":"reference/pipelines/source/overview/#type-json","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 codec.bodyFields \u5fc5\u586b \u4f7f\u7528\u89e3\u6790\u8bfb\u53d6\u5230\u7684json\u6570\u636e\u4e2d\u7684\u8be5\u5b57\u6bb5\u4f5c\u4e3a body \u914d\u7f6e\u793a\u4f8b\uff1a type: json sources : - type : file name : nginx paths : - /var/log/*.log codec : type : json bodyFields : log \u5982\u679c\u91c7\u96c6\u5230\u7684\u65e5\u5fd7\u4e3a\uff1a { \"log\" : \"I0610 08:29:07.698664 Waiting for caches to sync\\n\" , \"stream\" : \"stderr\" , \"time:\" 2021-06-10 T 08 : 29 : 07.698731204 Z\"} \u5219codec\u540e\u5f97\u5230\u7684event\u4e3a\uff1a body: \"I0610 08:29:07.698664 Waiting for caches to sync\" \u8bf7\u6ce8\u610f\uff1a\u76ee\u524d\u975ebodyFields\u7684\u5b57\u6bb5\u5747\u4f1a\u88ab\u4e22\u5f03\u3002","title":"type: json"},{"location":"reference/pipelines/source/overview/#type-regex","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 codec.pattern \u5fc5\u586b \u6b63\u5219\u8868\u8fbe\u5f0f codec.bodyFields \u5fc5\u586b \u4f7f\u7528\u6b63\u5219\u63d0\u53d6\u5230\u7684\u8be5\u5b57\u6bb5\u4f5c\u4e3a body \u914d\u7f6e\u793a\u4f8b\uff1a type: regex sources : - type : file name : nginx paths : - /var/log/*.log codec : type : regex pattern : ^(?P<time>[^ ^Z]+Z) (?P<stream>stdout|stderr) (?P<logtag>[^ ]*) (?P<log>.*)$ bodyFields : log \u5982\u679c\u91c7\u96c6\u5230\u7684\u65e5\u5fd7\u4e3a\uff1a 2021-12-01T03:13:58.298476921Z stderr F INFO [main] Starting service [Catalina] \u5219codec\u540e\u5f97\u5230\u7684event\u4e3a\uff1a body: \"INFO [main] Starting service [Catalina]\" \u8bf7\u6ce8\u610f\uff1a\u76ee\u524d\u975ebodyFields\u7684\u5b57\u6bb5\u5747\u4f1a\u88ab\u4e22\u5f03\u3002","title":"type: regex"},{"location":"reference/pipelines/source/prometheus-exporter/","text":"prometheusExporter \u00b6 \u91c7\u96c6Prometheus Metrics\u7684\u6307\u6807\u6570\u636e\u3002 Example sources : - type : prometheusExporter name : metric endpoints : - \"http://127.0.0.1:9196/metrics\" endpoints \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 endpoints string\u6570\u7ec4 \u5fc5\u586b \u6293\u53d6\u7684\u8fdc\u7aefexporter\u5730\u5740\uff0c\u8bf7\u6ce8\u610fLoggie\u4e0d\u4f1a\u9ed8\u8ba4\u5728\u8bf7\u6c42\u8def\u5f84\u4e2d\u6dfb\u52a0/metrics interval \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 interval time.Duration \u975e\u5fc5\u586b 30s \u5b9a\u65f6\u6293\u53d6\u8fdc\u7aefexporter\u7684\u65f6\u95f4\u95f4\u9694 timeout \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 timeout time.Duration \u975e\u5fc5\u586b 5s \u6293\u53d6\u8bf7\u6c42\u7684\u8d85\u65f6\u65f6\u95f4 toJson \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 toJson bool \u975e\u5fc5\u586b false \u662f\u5426\u5c06\u6293\u53d6\u5230\u7684prometheus\u539f\u751f\u6307\u6807\uff0c\u8f6c\u6362\u6210JSON\u683c\u5f0f labels \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 labels map \u975e\u5fc5\u586b \u7ed9\u6240\u6709metrics\u6307\u6807\u589e\u52a0\u989d\u5916\u7684label labels\u652f\u6301\u914d\u7f6e${_env.XX}\u7684\u65b9\u5f0f\u83b7\u53d6\u73af\u5883\u53d8\u91cf\u3002 \u4f8b\u5982\uff0c\u914d\u7f6e\uff1a labels sources : - type : prometheusExporter name : metric endpoints : - \"http://127.0.0.1:9196/metrics\" labels : svc : ${_env.SVC} \u5047\u8bbe\u73af\u5883\u53d8\u91cfSVC=test\uff0c\u4f1a\u5c06\u6240\u6709\u7684metrics\u52a0\u4e0asvc=test\u7684label\u3002","title":"prometheusExporter"},{"location":"reference/pipelines/source/prometheus-exporter/#prometheusexporter","text":"\u91c7\u96c6Prometheus Metrics\u7684\u6307\u6807\u6570\u636e\u3002 Example sources : - type : prometheusExporter name : metric endpoints : - \"http://127.0.0.1:9196/metrics\"","title":"prometheusExporter"},{"location":"reference/pipelines/source/prometheus-exporter/#endpoints","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 endpoints string\u6570\u7ec4 \u5fc5\u586b \u6293\u53d6\u7684\u8fdc\u7aefexporter\u5730\u5740\uff0c\u8bf7\u6ce8\u610fLoggie\u4e0d\u4f1a\u9ed8\u8ba4\u5728\u8bf7\u6c42\u8def\u5f84\u4e2d\u6dfb\u52a0/metrics","title":"endpoints"},{"location":"reference/pipelines/source/prometheus-exporter/#interval","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 interval time.Duration \u975e\u5fc5\u586b 30s \u5b9a\u65f6\u6293\u53d6\u8fdc\u7aefexporter\u7684\u65f6\u95f4\u95f4\u9694","title":"interval"},{"location":"reference/pipelines/source/prometheus-exporter/#timeout","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 timeout time.Duration \u975e\u5fc5\u586b 5s \u6293\u53d6\u8bf7\u6c42\u7684\u8d85\u65f6\u65f6\u95f4","title":"timeout"},{"location":"reference/pipelines/source/prometheus-exporter/#tojson","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 toJson bool \u975e\u5fc5\u586b false \u662f\u5426\u5c06\u6293\u53d6\u5230\u7684prometheus\u539f\u751f\u6307\u6807\uff0c\u8f6c\u6362\u6210JSON\u683c\u5f0f","title":"toJson"},{"location":"reference/pipelines/source/prometheus-exporter/#labels","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 labels map \u975e\u5fc5\u586b \u7ed9\u6240\u6709metrics\u6307\u6807\u589e\u52a0\u989d\u5916\u7684label labels\u652f\u6301\u914d\u7f6e${_env.XX}\u7684\u65b9\u5f0f\u83b7\u53d6\u73af\u5883\u53d8\u91cf\u3002 \u4f8b\u5982\uff0c\u914d\u7f6e\uff1a labels sources : - type : prometheusExporter name : metric endpoints : - \"http://127.0.0.1:9196/metrics\" labels : svc : ${_env.SVC} \u5047\u8bbe\u73af\u5883\u53d8\u91cfSVC=test\uff0c\u4f1a\u5c06\u6240\u6709\u7684metrics\u52a0\u4e0asvc=test\u7684label\u3002","title":"labels"},{"location":"reference/pipelines/source/unix/","text":"unix \u00b6 \u901a\u8fc7unix socket\u63a5\u6536\u6570\u636e\u3002 Example sources : - type : unix name : demo path : - \"/tmp/loggie.sock\" path \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 path string \u5fc5\u586b \u63a5\u6536\u7684\u8def\u5f84\u540d maxBytes \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxBytes int \u975e\u5fc5\u586b 40960 \u63a5\u6536\u7684\u6700\u5927\u5b57\u8282\u6570 maxConnections \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxConnections int \u975e\u5fc5\u586b 512 \u540c\u65f6\u4fdd\u6301\u6700\u591a\u7684\u8fde\u63a5\u6570 timeout \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 timeout time.Duration \u975e\u5fc5\u586b 5m \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 mode \u00b6 \u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 mode string \u975e\u5fc5\u586b 0755","title":"unix"},{"location":"reference/pipelines/source/unix/#unix","text":"\u901a\u8fc7unix socket\u63a5\u6536\u6570\u636e\u3002 Example sources : - type : unix name : demo path : - \"/tmp/loggie.sock\"","title":"unix"},{"location":"reference/pipelines/source/unix/#path","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 path string \u5fc5\u586b \u63a5\u6536\u7684\u8def\u5f84\u540d","title":"path"},{"location":"reference/pipelines/source/unix/#maxbytes","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxBytes int \u975e\u5fc5\u586b 40960 \u63a5\u6536\u7684\u6700\u5927\u5b57\u8282\u6570","title":"maxBytes"},{"location":"reference/pipelines/source/unix/#maxconnections","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 maxConnections int \u975e\u5fc5\u586b 512 \u540c\u65f6\u4fdd\u6301\u6700\u591a\u7684\u8fde\u63a5\u6570","title":"maxConnections"},{"location":"reference/pipelines/source/unix/#timeout","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 timeout time.Duration \u975e\u5fc5\u586b 5m \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4","title":"timeout"},{"location":"reference/pipelines/source/unix/#mode","text":"\u5b57\u6bb5 \u7c7b\u578b \u662f\u5426\u5fc5\u586b \u9ed8\u8ba4\u503c \u542b\u4e49 mode string \u975e\u5fc5\u586b 0755","title":"mode"},{"location":"user-guide/","text":"\u7528\u6237\u6307\u5357 \u00b6 \u5728\u672c\u300c\u7528\u6237\u6307\u5357\u300d\u90e8\u5206\uff0c\u6211\u4eec\u4e3b\u8981\u4ecb\u7ecdLoggie\u7684\u4e3b\u8981\u529f\u80fd\u548c\u7279\u6027\uff0c\u540c\u65f6\u5c55\u793a\u5728\u5404\u79cd\u4e0d\u540c\u7684\u573a\u666f\u4e0b\uff0c\u5982\u4f55\u4f7f\u7528Loggie\u6ee1\u8db3\u5404\u7c7b\u9700\u6c42\u3002 \u5982\u679c\u5e0c\u671b\u67e5\u8be2\u5177\u4f53\u7ec4\u4ef6\u7684\u4f7f\u7528\u4e0e\u914d\u7f6e\u65b9\u5f0f\uff0c\u8bf7\u6233\u300c \u7ec4\u4ef6\u914d\u7f6e \u300d\u3002 \u843d\u5730\u4e00\u5957\u65e5\u5fd7\u7cfb\u7edf\u4f1a\u9047\u5230\u54ea\u4e9b\u95ee\u9898\uff1f \u00b6 \u5728\u4f01\u4e1a\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u600e\u4e48\u53bb\u6784\u5efa\u4e00\u5957\u5b8c\u6574\u7684\u65e5\u5fd7\u7cfb\u7edf\uff1f\u5982\u4f55\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u9009\u578b\uff0c\u5176\u4e2d\u53c8\u4f1a\u78b0\u5230\u54ea\u4e9b\u95ee\u9898\uff1f \u5728\u4e0d\u540c\u7684\u4e1a\u52a1\u7c7b\u578b\u3001\u4e0d\u540c\u7684\u4f7f\u7528\u573a\u666f\u3001\u4e0d\u540c\u7684\u65e5\u5fd7\u89c4\u6a21\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u54ea\u4e9b\u65e5\u5fd7\u7cfb\u7edf\u67b6\u6784\uff1f \u8bf7\u770b\u300c \u4f01\u4e1a\u5b9e\u6218 \u300d\u3002 \u5728\u6211\u4eec\u5bf9\u843d\u5730\u4e00\u5957\u529f\u80fd\u5b8c\u5584\u3001\u67b6\u6784\u5b8c\u6574\u7684\u65e5\u5fd7\u7cfb\u7edf\u6709\u521d\u6b65\u4e86\u89e3\u540e\uff0c\u60f3\u8981\u77e5\u9053\uff1a \u4e3a\u4ec0\u4e48Loggie\u80fd\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff1f \u00b6 \u5e02\u9762\u4e0a\u5f00\u6e90\u7684\u65e5\u5fd7\u91c7\u96c6Agent\u5df2\u7ecf\u5f88\u591a\u4e86\uff0c\u6211\u4eec\u4e3a\u4ec0\u4e48\u53c8\u9009\u62e9\u7814\u53d1Loggie\u5462\uff1f Loggie\u7684\u8bde\u751f\u662f\u4e3a\u4e86\u89e3\u51b3\u4ec0\u4e48\u95ee\u9898\u5462\uff1f Loggie\u548c\u5176\u4ed6\u7684\u5f00\u6e90\u65e5\u5fd7Agent\u533a\u522b\u662f\u4ec0\u4e48\uff1f \u8bf7\u770b\u300c \u67b6\u6784\u4e0e\u7279\u6027 \u300d\u3002 \u5982\u4f55\u4f7f\u7528Loggie\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff1f \u00b6 \u5982\u4f55\u5728Kubernetes\u96c6\u7fa4\u4e0b\u4f7f\u7528Loggie\uff1f \u8bf7\u770b\u300c Kubernetes \u300d\u3002 \u5982\u4f55\u914d\u7f6e\u5404\u79cd\u4e0d\u540c\u7684\u65e5\u5fd7\u67b6\u6784\uff1f\u5982\u4f55\u63a5\u5165\u73b0\u6709\u7684\u670d\u52a1\uff1f\u5982\u4f55\u914d\u7f6e\u65e5\u5fd7\u7684\u5904\u7406\u548c\u5207\u5206\uff1fLoggie\u8fd8\u63d0\u4f9b\u4e86\u54ea\u4e9b\u6709\u7528\u53c8\u597d\u7528\u7684\u529f\u80fd\uff1f \u8bf7\u770b\u300c \u6700\u4f73\u5b9e\u8df5 \u300d\u3002 \u5982\u4f55\u914d\u7f6e\u6574\u4f53\u7684\u76d1\u63a7\u548c\u62a5\u8b66\uff0c\u4fdd\u8bc1Loggie\u6b63\u5e38\u8fd0\u884c\uff1f\u5982\u4f55\u76d1\u63a7\u662f\u5426\u91c7\u96c6\u5230ERROR\u65e5\u5fd7\uff1f \u8bf7\u770b\u300c \u76d1\u63a7\u62a5\u8b66 \u300d\u3002","title":"Overview"},{"location":"user-guide/#_1","text":"\u5728\u672c\u300c\u7528\u6237\u6307\u5357\u300d\u90e8\u5206\uff0c\u6211\u4eec\u4e3b\u8981\u4ecb\u7ecdLoggie\u7684\u4e3b\u8981\u529f\u80fd\u548c\u7279\u6027\uff0c\u540c\u65f6\u5c55\u793a\u5728\u5404\u79cd\u4e0d\u540c\u7684\u573a\u666f\u4e0b\uff0c\u5982\u4f55\u4f7f\u7528Loggie\u6ee1\u8db3\u5404\u7c7b\u9700\u6c42\u3002 \u5982\u679c\u5e0c\u671b\u67e5\u8be2\u5177\u4f53\u7ec4\u4ef6\u7684\u4f7f\u7528\u4e0e\u914d\u7f6e\u65b9\u5f0f\uff0c\u8bf7\u6233\u300c \u7ec4\u4ef6\u914d\u7f6e \u300d\u3002","title":"\u7528\u6237\u6307\u5357"},{"location":"user-guide/#_2","text":"\u5728\u4f01\u4e1a\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u600e\u4e48\u53bb\u6784\u5efa\u4e00\u5957\u5b8c\u6574\u7684\u65e5\u5fd7\u7cfb\u7edf\uff1f\u5982\u4f55\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u9009\u578b\uff0c\u5176\u4e2d\u53c8\u4f1a\u78b0\u5230\u54ea\u4e9b\u95ee\u9898\uff1f \u5728\u4e0d\u540c\u7684\u4e1a\u52a1\u7c7b\u578b\u3001\u4e0d\u540c\u7684\u4f7f\u7528\u573a\u666f\u3001\u4e0d\u540c\u7684\u65e5\u5fd7\u89c4\u6a21\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u54ea\u4e9b\u65e5\u5fd7\u7cfb\u7edf\u67b6\u6784\uff1f \u8bf7\u770b\u300c \u4f01\u4e1a\u5b9e\u6218 \u300d\u3002 \u5728\u6211\u4eec\u5bf9\u843d\u5730\u4e00\u5957\u529f\u80fd\u5b8c\u5584\u3001\u67b6\u6784\u5b8c\u6574\u7684\u65e5\u5fd7\u7cfb\u7edf\u6709\u521d\u6b65\u4e86\u89e3\u540e\uff0c\u60f3\u8981\u77e5\u9053\uff1a","title":"\u843d\u5730\u4e00\u5957\u65e5\u5fd7\u7cfb\u7edf\u4f1a\u9047\u5230\u54ea\u4e9b\u95ee\u9898\uff1f"},{"location":"user-guide/#loggie","text":"\u5e02\u9762\u4e0a\u5f00\u6e90\u7684\u65e5\u5fd7\u91c7\u96c6Agent\u5df2\u7ecf\u5f88\u591a\u4e86\uff0c\u6211\u4eec\u4e3a\u4ec0\u4e48\u53c8\u9009\u62e9\u7814\u53d1Loggie\u5462\uff1f Loggie\u7684\u8bde\u751f\u662f\u4e3a\u4e86\u89e3\u51b3\u4ec0\u4e48\u95ee\u9898\u5462\uff1f Loggie\u548c\u5176\u4ed6\u7684\u5f00\u6e90\u65e5\u5fd7Agent\u533a\u522b\u662f\u4ec0\u4e48\uff1f \u8bf7\u770b\u300c \u67b6\u6784\u4e0e\u7279\u6027 \u300d\u3002","title":"\u4e3a\u4ec0\u4e48Loggie\u80fd\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff1f"},{"location":"user-guide/#loggie_1","text":"\u5982\u4f55\u5728Kubernetes\u96c6\u7fa4\u4e0b\u4f7f\u7528Loggie\uff1f \u8bf7\u770b\u300c Kubernetes \u300d\u3002 \u5982\u4f55\u914d\u7f6e\u5404\u79cd\u4e0d\u540c\u7684\u65e5\u5fd7\u67b6\u6784\uff1f\u5982\u4f55\u63a5\u5165\u73b0\u6709\u7684\u670d\u52a1\uff1f\u5982\u4f55\u914d\u7f6e\u65e5\u5fd7\u7684\u5904\u7406\u548c\u5207\u5206\uff1fLoggie\u8fd8\u63d0\u4f9b\u4e86\u54ea\u4e9b\u6709\u7528\u53c8\u597d\u7528\u7684\u529f\u80fd\uff1f \u8bf7\u770b\u300c \u6700\u4f73\u5b9e\u8df5 \u300d\u3002 \u5982\u4f55\u914d\u7f6e\u6574\u4f53\u7684\u76d1\u63a7\u548c\u62a5\u8b66\uff0c\u4fdd\u8bc1Loggie\u6b63\u5e38\u8fd0\u884c\uff1f\u5982\u4f55\u76d1\u63a7\u662f\u5426\u91c7\u96c6\u5230ERROR\u65e5\u5fd7\uff1f \u8bf7\u770b\u300c \u76d1\u63a7\u62a5\u8b66 \u300d\u3002","title":"\u5982\u4f55\u4f7f\u7528Loggie\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff1f"},{"location":"user-guide/architecture/advantages/","text":"Loggie\u7684\u4f18\u52bf\u4e0e\u7279\u6027 \u00b6 Loggie\u652f\u6301\u591a\u4e2aPipeline\uff0c\u6bcf\u4e2aPipeline\u90fd\u57fa\u4e8e\u7b80\u5355\u76f4\u89c2\u7684source->interceptor->sink\u7684\u67b6\u6784\u3002 \u8fd9\u6837\u8bbe\u8ba1\u5e26\u6765\u7684\u597d\u5904\u6709\uff1a \u5f3a\u9694\u79bb \u00b6 \u591aPipeline\u8bbe\u8ba1\uff0c\u51cf\u5c11\u4e92\u76f8\u5e72\u6270\u3002\u6bd4\u5982\u6211\u4eec\u53ef\u4ee5\u5c06\u91cd\u8981\u7684\u4e1a\u52a1\u65e5\u5fd7\u653e\u5728\u4e00\u4e2aPipeline\u4e2d\uff0c\u5176\u4ed6\u7684\u4e0d\u91cd\u8981\u7684\u65e5\u5fd7\u914d\u7f6e\u4e3a\u53e6\u5916\u7684Pipeline\uff0c\u4e0d\u91cd\u8981\u7684\u65e5\u5fd7\u914d\u7f6e\u53d8\u52a8\u3001\u53d1\u751f\u4e0b\u6e38\u5835\u585e\u65f6\uff0c\u4e0d\u4f1a\u5f71\u54cd\u91cd\u8981\u65e5\u5fd7\u7684\u91c7\u96c6\u548c\u53d1\u9001\u3002 \u901a\u7528\u6027\u66f4\u597d \u00b6 \u5728\u4e00\u4e9b\u573a\u666f\u4e0b\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u5c06\u4e0d\u540c\u7c7b\u578b\u7684\u670d\u52a1\u6df7\u5408\u90e8\u7f72\u5728\u4e00\u4e2a\u8282\u70b9\u4e0a\uff0c\u5f88\u53ef\u80fd\u4ed6\u4eec\u7684\u65e5\u5fd7\u4f1a\u53d1\u9001\u5230\u4e0d\u540c\u7684Kafka\u96c6\u7fa4\u4e2d\uff0c\u5982\u679c\u53ea\u6709\u4e00\u4e2a\u5168\u5c40\u7684\u8f93\u51fa\u6e90\uff0c\u9700\u8981\u5728\u8282\u70b9\u4e0a\u90e8\u7f72\u4e24\u4e2aAgent\uff0c\u5982\u679c\u4f7f\u7528Loggie\u5219\u53ea\u9700\u8981\u4f7f\u7528\u4e0d\u540c\u7684Pipeline\u5373\u53ef\uff0c\u6bcf\u4e2aPipeline\u914d\u7f6e\u4e0d\u540c\u7684Sink\uff0c\u51cf\u5c11\u90e8\u7f72\u6210\u672c\u3002 \u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u91c7\u96c6\u76f8\u540c\u7684\u65e5\u5fd7\uff0c\u53d1\u9001\u5230\u4e0d\u540c\u7684\u540e\u7aef\u8f93\u51fa\u6e90\uff0c\u6839\u636e\u5b9e\u9645\u9700\u6c42\u7075\u6d3b\u914d\u7f6e\u3002 \u7075\u6d3b\u3001\u70ed\u63d2\u62d4\u3001\u53ef\u6269\u5c55 \u00b6 \u672c\u8d28\u4e0asource->interceptor->sink\u67b6\u6784\u662f\u4e00\u4e2a\u6570\u636e\u6d41\u5f0f\u7684\u8bbe\u8ba1\uff0c\u4e0d\u540c\u7c7b\u578b\u7684source/interceptor/sink\u7684\u6392\u5217\u7ec4\u5408\uff0c\u53ef\u4ee5\u6ee1\u8db3\u65e5\u5fd7\u7684\u4e0d\u540c\u9700\u6c42\uff0c Loggie\u5e76\u6ca1\u6709\u5c06interceptor\u66f4\u7ec6\u5316\u7684\u5206\u7c7b\u6210\u6bd4\u5982Filter/Formater\u7b49\u7c7b\u578b\uff0cinterceptor\u627f\u62c5\u4e86\u9664\u4e86source\u8bfb\u53d6\uff0csink\u53d1\u9001\u4e4b\u5916\u7684\u5927\u90e8\u5206\u5de5\u4f5c\uff0c\u53ea\u9700\u8981\u914d\u7f6e\u4e0d\u540c\u7684interceptor\u5c31\u53ef\u4ee5\u62e5\u6709\u4e2d\u8f6c\u3001\u8fc7\u6ee4\u3001\u89e3\u6790\u3001\u5207\u5206\u3001\u65e5\u5fd7\u62a5\u8b66\u7b49\u80fd\u529b\u3002 \u4e8e\u662f\uff0cLoggie\u53ef\u4ee5\uff1a \u72ec\u7acb\u90e8\u7f72\u5f53\u4f5c\u65e5\u5fd7\u4e2d\u8f6c\u673a \u5728Agent\u7aef\u6216\u8005\u4e2d\u8f6c\u673a\u7aef\u89e3\u6790\u5904\u7406\u65e5\u5fd7 \u975e\u65e5\u5fd7\u91c7\u96c6\u573a\u666f\u4e5f\u53ef\u4ee5\u4f7f\u7528\uff1a\u6bd4\u5982\u76d1\u542ck8s events\uff0c\u6bd4\u5982\u5b9a\u65f6\u540c\u6b65\u6570\u636e\u7b49 \u5728\u90e8\u7f72\u548c\u7ef4\u62a4\u5c42\u9762\u5e26\u6765\u7684\u597d\u5904\u662f\uff1a \u5982\u679c\u4e4b\u524d\u91c7\u7528\u5e38\u89c4\u7684ELK\u67b6\u6784\uff0c\u4f7f\u7528Filebeat\u91c7\u96c6\u65e5\u5fd7\u3001Logstash\u4e2d\u8f6c\u548c\u89e3\u6790\u65e5\u5fd7\uff0c\u7531\u4e8eFilebeat\u548cLogstash\u662f\u4e24\u4e2a\u4e0d\u540c\u7684\u8bed\u8a00\u6808\uff0c\u5e26\u6765\u6392\u67e5\u95ee\u9898\u548c\u6269\u5c55\u5f00\u53d1\u6210\u672c\u5747\u8f83\u9ad8\u3002 \u6539\u7528Loggie\u540e\u6211\u4eec\u65e0\u9700\u7ef4\u62a4\u4e24\u4e2a\u9879\u76ee\uff0c\u751a\u81f3\u5982\u679c\u6ca1\u6709\u4e2d\u8f6c\u673a\u7684\u9700\u6c42\uff0c\u53ef\u4ee5\u9009\u62e9\u5728Agent\u7aef\u914d\u7f6e\u65e5\u5fd7\u89e3\u6790\u3002 \u53e6\u5916\uff0c\u76ee\u524d\u9488\u5bf9\u65e5\u5fd7\u62a5\u8b66\uff0c\u5f00\u6e90\u7684\u65b9\u6848\u4e00\u822c\u4e3a\u4f7f\u7528elastAlert\uff0c\u4f46\u662felastAlert\u65e0\u6cd5\u76f4\u63a5\u5bf9\u63a5AlertManager\uff0c\u5e76\u4e14\u5728\u9ad8\u53ef\u7528\u7b49\u65b9\u9762\u5b58\u5728\u95ee\u9898\uff0c\u540c\u65f6\u4f1a\u5f3a\u4f9d\u8d56Elasticsearch\u3002\u6240\u4ee5\u5982\u679c\u4f7f\u7528Loggie\uff0c\u53ef\u4ee5\u65e0\u9700\u5f15\u5165\u989d\u5916\u7684\u7ec4\u4ef6\uff0c\u76f4\u63a5\u4f7f\u7528Loggie\u6765\u68c0\u6d4b\u5f02\u5e38\u65e5\u5fd7\u5e76\u63a5\u5165\u62a5\u8b66\u3002 \u53ef\u5feb\u901f\u65b9\u4fbf\u7684\u5199\u4e00\u4e2a\u7ec4\u4ef6 \u00b6 Loggie\u57fa\u4e8e\u5fae\u5185\u6838\u7684\u67b6\u6784\uff0c\u6240\u6709\u7684source/interceptor/sink/queue\u90fd\u88ab\u62bd\u8c61\u6210component\uff0c\u53ea\u9700\u8981\u5728\u4ee3\u7801\u4e2d\u5b9e\u73b0Golang\u63a5\u53e3\uff0c\u5373\u53ef\u65b9\u4fbf\u7684\u7814\u53d1\u4e00\u4e2acomponent\u3002 \u5982\u679cLoggie\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u65e0\u6cd5\u6ee1\u8db3\u4f60\u7684\u9700\u6c42\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u5199\u4e00\u4e2a\u81ea\u5df1\u7684component\u3002 \u6bd4\u5982\u9700\u8981Loggie\u8f6c\u6362\u6210\u7279\u5b9a\u7684\u65e5\u5fd7\u683c\u5f0f\uff0c\u53ef\u4ee5\u5199\u4e00\u4e2ainterceptor\u53bb\u5904\u7406\uff1b\u9700\u8981Loggie\u5c06\u91c7\u96c6\u7684\u65e5\u5fd7\u53d1\u9001\u81f3\u5c1a\u672a\u652f\u6301\u7684\u670d\u52a1\uff0c\u53ef\u4ee5\u5199\u4e00\u4e2asink\u3002 \u5f53\u7136\uff0cLoggie\u4f7f\u7528Golang\u7f16\u5199\uff0c\u6240\u4ee5\u4f60\u76ee\u524d\u9700\u8981\u7528Golang\u6765\u5199component\u3002Golang\u548cJava\u6216\u8005C/C++\u76f8\u6bd4\uff0c\u5728\u6027\u80fd\u548c\u7814\u53d1\u6548\u7387\u4e0a\u6709\u4e00\u4e2a\u6298\u4e2d\uff0c\u66f4\u9002\u5408\u7c7b\u4f3c\u65e5\u5fd7Agent\u7684\u573a\u666f\u3002 \u66f4\u65b9\u4fbf\u7684Kubernetes\u5bb9\u5668\u65e5\u5fd7\u91c7\u96c6\uff0c\u66f4\u597d\u7684\u4e91\u539f\u751f\u652f\u6301 \u00b6 \u5982\u679c\u4f60\u5c1d\u8bd5\u8fc7\u5728Kubernetes\u73af\u5883\u4e0b\u91c7\u96c6\u65e5\u5fd7\uff0c\u5e94\u8be5\u9047\u5230\u8fc7\u8fd9\u4e9b\u95ee\u9898\uff1a \u91c7\u7528sidecar\u8fd8\u662fdaemonset\u90e8\u7f72\u65e5\u5fd7Agent\uff1f \u4f7f\u7528\u4ec0\u4e48\u65b9\u5f0f\u6302\u8f7d\u65e5\u5fd7\u6587\u4ef6\uff1f\u96be\u9053\u53ea\u63a8\u8350\u7528stdout\u8f93\u51fa\u65e5\u5fd7\u5417\uff1f \u91c7\u96c6\u7684\u65e5\u5fd7\u5982\u4f55\u548cPod\u3001Namespace\u3001Node\u7b49\u4fe1\u606f\u5173\u8054\u4e0a\uff1f Kubernetes\u4e0bPod\u4f1a\u52a8\u6001\u7684\u521b\u5efa\u548c\u9500\u6bc1\uff0c\u8fc1\u79fb\u5230\u4e86\u5176\u4ed6\u7684Node\uff0c\u76f8\u5e94\u7684\u65e5\u5fd7Agent\u914d\u7f6e\u600e\u4e48\u529e\u5462\uff1f \u5982\u679c\u4f60\u4f7f\u7528Loggie\uff0c\u4f60\u53ef\u4ee5\uff1a \u5feb\u901f\u90e8\u7f72\uff0c\u652f\u6301\u5404\u79cd\u90e8\u7f72\u67b6\u6784 \u53ea\u9700\u8981\u4f7f\u7528ClusterLogConfig/LogConfig CRD\u914d\u7f6e\u7ba1\u7406\u65e5\u5fd7\u914d\u7f6e\uff0c\u66f4\u65b9\u4fbf\u7684\u63a5\u5165\u5404\u7c7b\u5bb9\u5668\u4e91\u5e73\u53f0\uff0c\u5bf9\u4e1a\u52a1\u65e0\u4fb5\u5165\uff0c\u65e0\u9700\u5173\u5fc3Pod\u8fc1\u79fb\u7b49\uff0c\u65e0\u9700\u624b\u52a8\u5728\u8282\u70b9\u4e0a\u64cd\u4f5c\u914d\u7f6e\u65e5\u5fd7\u6587\u4ef6\uff0c\u540c\u65f6\u53ef\u914d\u7f6e\u6ce8\u5165Namespace/PodName/NodeName\u7b49\u5143\u4fe1\u606f\u4f9b\u67e5\u8be2\u4f7f\u7528 \u66f4\u597d\u7684\u7a33\u5b9a\u6027\u3001\u66f4\u8be6\u7ec6\u7684\u76d1\u63a7\u6307\u6807\u3001\u66f4\u65b9\u4fbf\u7684\u6392\u969c\u65b9\u5f0f \u00b6 \u5728\u5b9e\u9645\u7684\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u65e5\u5fd7Agent\u672c\u8eab\u7684\u7a33\u5b9a\u6027\u5f88\u91cd\u8981\uff0c\u540c\u65f6\u4e0d\u5f71\u54cd\u4e1a\u52a1\u4e5f\u5f88\u91cd\u8981\u3002 Loggie\u53ef\u914d\u7f6e\u9650\u6d41interceptor\uff0c\u5728\u65e5\u5fd7\u91cf\u592a\u5927\u65f6\uff0c\u53ef\u4ee5\u907f\u514d\u53d1\u9001\u65e5\u5fd7\u6570\u636e\u5360\u636e\u4e86\u592a\u591a\u7f51\u7edc\u5e26\u5bbd\u3002 Loggie\u6709\u5408\u7406\u7684\u6587\u4ef6\u53e5\u67c4\u5904\u7406\u673a\u5236\uff0c\u907f\u514dfd\u88ab\u5360\u7528\u7684\u5404\u79cd\u5f02\u5e38\u573a\u666f\u5bfc\u81f4\u8282\u70b9\u4e0d\u7a33\u5b9a\u3002 \u53e6\u5916\uff0cLoggie\u7ed3\u5408\u6211\u4eec\u5728\u5404\u79cd\u73af\u5883\u4e2d\u9047\u5230\u7684\u5404\u79cd\u95ee\u9898\uff0c\u9488\u5bf9\u6027\u7684\u68c0\u6d4b\u66b4\u9732\u51fa\u76f8\u5e94\u7684\u6307\u6807\u3002 \u6bd4\u5982\u6307\u6807\u652f\u6301\u91c7\u96c6\u548c\u53d1\u9001\u5ef6\u8fdf\u68c0\u6d4b\u3002\u6bd4\u5982\u9488\u5bf9\u6587\u4ef6size\u589e\u957f\u592a\u5feb\uff0c\u6216\u8005\u6587\u4ef6size\u592a\u5927\u7b49\u573a\u666f\uff0c\u652f\u6301\u8be5\u7c7bmetric\u4e0a\u62a5\u3002 \u540c\u65f6Loggie\u652f\u6301\u539f\u751fPrometheus metric\uff0c\u53ef\u907f\u514d\u989d\u5916\u90e8\u7f72exporter\u5e26\u6765\u7684\u90e8\u7f72\u6210\u672c\u548c\u8d44\u6e90\u6d88\u8017\u3002Loggie\u8fd8\u63d0\u4f9b\u4e86\u5b8c\u5584\u7684Grafana\u76d1\u63a7\u56fe\u8868\uff0c\u53ef\u4ee5\u65b9\u4fbf\u5feb\u901f\u63a5\u5165\u4f7f\u7528\u3002 \u66f4\u4f4e\u7684\u8d44\u6e90\u5360\u7528\uff0c\u66f4\u597d\u7684\u6027\u80fd \u00b6 Loggie\u57fa\u4e8eGolang\u7f16\u5199\uff0c\u5728\u4ee3\u7801\u5c42\u9762\u6211\u4eec\u6709\u5f88\u591a\u4f18\u5316\uff0c\u5728\u8f83\u5c11\u8d44\u6e90\u5360\u7528\u7684\u540c\u65f6\uff0c\u8fd8\u53ef\u63d0\u4f9b\u5f3a\u5927\u7684\u541e\u5410\u6027\u80fd\u3002","title":"\u4f18\u52bf\u4e0e\u7279\u6027"},{"location":"user-guide/architecture/advantages/#loggie","text":"Loggie\u652f\u6301\u591a\u4e2aPipeline\uff0c\u6bcf\u4e2aPipeline\u90fd\u57fa\u4e8e\u7b80\u5355\u76f4\u89c2\u7684source->interceptor->sink\u7684\u67b6\u6784\u3002 \u8fd9\u6837\u8bbe\u8ba1\u5e26\u6765\u7684\u597d\u5904\u6709\uff1a","title":"Loggie\u7684\u4f18\u52bf\u4e0e\u7279\u6027"},{"location":"user-guide/architecture/advantages/#_1","text":"\u591aPipeline\u8bbe\u8ba1\uff0c\u51cf\u5c11\u4e92\u76f8\u5e72\u6270\u3002\u6bd4\u5982\u6211\u4eec\u53ef\u4ee5\u5c06\u91cd\u8981\u7684\u4e1a\u52a1\u65e5\u5fd7\u653e\u5728\u4e00\u4e2aPipeline\u4e2d\uff0c\u5176\u4ed6\u7684\u4e0d\u91cd\u8981\u7684\u65e5\u5fd7\u914d\u7f6e\u4e3a\u53e6\u5916\u7684Pipeline\uff0c\u4e0d\u91cd\u8981\u7684\u65e5\u5fd7\u914d\u7f6e\u53d8\u52a8\u3001\u53d1\u751f\u4e0b\u6e38\u5835\u585e\u65f6\uff0c\u4e0d\u4f1a\u5f71\u54cd\u91cd\u8981\u65e5\u5fd7\u7684\u91c7\u96c6\u548c\u53d1\u9001\u3002","title":"\u5f3a\u9694\u79bb"},{"location":"user-guide/architecture/advantages/#_2","text":"\u5728\u4e00\u4e9b\u573a\u666f\u4e0b\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u5c06\u4e0d\u540c\u7c7b\u578b\u7684\u670d\u52a1\u6df7\u5408\u90e8\u7f72\u5728\u4e00\u4e2a\u8282\u70b9\u4e0a\uff0c\u5f88\u53ef\u80fd\u4ed6\u4eec\u7684\u65e5\u5fd7\u4f1a\u53d1\u9001\u5230\u4e0d\u540c\u7684Kafka\u96c6\u7fa4\u4e2d\uff0c\u5982\u679c\u53ea\u6709\u4e00\u4e2a\u5168\u5c40\u7684\u8f93\u51fa\u6e90\uff0c\u9700\u8981\u5728\u8282\u70b9\u4e0a\u90e8\u7f72\u4e24\u4e2aAgent\uff0c\u5982\u679c\u4f7f\u7528Loggie\u5219\u53ea\u9700\u8981\u4f7f\u7528\u4e0d\u540c\u7684Pipeline\u5373\u53ef\uff0c\u6bcf\u4e2aPipeline\u914d\u7f6e\u4e0d\u540c\u7684Sink\uff0c\u51cf\u5c11\u90e8\u7f72\u6210\u672c\u3002 \u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u91c7\u96c6\u76f8\u540c\u7684\u65e5\u5fd7\uff0c\u53d1\u9001\u5230\u4e0d\u540c\u7684\u540e\u7aef\u8f93\u51fa\u6e90\uff0c\u6839\u636e\u5b9e\u9645\u9700\u6c42\u7075\u6d3b\u914d\u7f6e\u3002","title":"\u901a\u7528\u6027\u66f4\u597d"},{"location":"user-guide/architecture/advantages/#_3","text":"\u672c\u8d28\u4e0asource->interceptor->sink\u67b6\u6784\u662f\u4e00\u4e2a\u6570\u636e\u6d41\u5f0f\u7684\u8bbe\u8ba1\uff0c\u4e0d\u540c\u7c7b\u578b\u7684source/interceptor/sink\u7684\u6392\u5217\u7ec4\u5408\uff0c\u53ef\u4ee5\u6ee1\u8db3\u65e5\u5fd7\u7684\u4e0d\u540c\u9700\u6c42\uff0c Loggie\u5e76\u6ca1\u6709\u5c06interceptor\u66f4\u7ec6\u5316\u7684\u5206\u7c7b\u6210\u6bd4\u5982Filter/Formater\u7b49\u7c7b\u578b\uff0cinterceptor\u627f\u62c5\u4e86\u9664\u4e86source\u8bfb\u53d6\uff0csink\u53d1\u9001\u4e4b\u5916\u7684\u5927\u90e8\u5206\u5de5\u4f5c\uff0c\u53ea\u9700\u8981\u914d\u7f6e\u4e0d\u540c\u7684interceptor\u5c31\u53ef\u4ee5\u62e5\u6709\u4e2d\u8f6c\u3001\u8fc7\u6ee4\u3001\u89e3\u6790\u3001\u5207\u5206\u3001\u65e5\u5fd7\u62a5\u8b66\u7b49\u80fd\u529b\u3002 \u4e8e\u662f\uff0cLoggie\u53ef\u4ee5\uff1a \u72ec\u7acb\u90e8\u7f72\u5f53\u4f5c\u65e5\u5fd7\u4e2d\u8f6c\u673a \u5728Agent\u7aef\u6216\u8005\u4e2d\u8f6c\u673a\u7aef\u89e3\u6790\u5904\u7406\u65e5\u5fd7 \u975e\u65e5\u5fd7\u91c7\u96c6\u573a\u666f\u4e5f\u53ef\u4ee5\u4f7f\u7528\uff1a\u6bd4\u5982\u76d1\u542ck8s events\uff0c\u6bd4\u5982\u5b9a\u65f6\u540c\u6b65\u6570\u636e\u7b49 \u5728\u90e8\u7f72\u548c\u7ef4\u62a4\u5c42\u9762\u5e26\u6765\u7684\u597d\u5904\u662f\uff1a \u5982\u679c\u4e4b\u524d\u91c7\u7528\u5e38\u89c4\u7684ELK\u67b6\u6784\uff0c\u4f7f\u7528Filebeat\u91c7\u96c6\u65e5\u5fd7\u3001Logstash\u4e2d\u8f6c\u548c\u89e3\u6790\u65e5\u5fd7\uff0c\u7531\u4e8eFilebeat\u548cLogstash\u662f\u4e24\u4e2a\u4e0d\u540c\u7684\u8bed\u8a00\u6808\uff0c\u5e26\u6765\u6392\u67e5\u95ee\u9898\u548c\u6269\u5c55\u5f00\u53d1\u6210\u672c\u5747\u8f83\u9ad8\u3002 \u6539\u7528Loggie\u540e\u6211\u4eec\u65e0\u9700\u7ef4\u62a4\u4e24\u4e2a\u9879\u76ee\uff0c\u751a\u81f3\u5982\u679c\u6ca1\u6709\u4e2d\u8f6c\u673a\u7684\u9700\u6c42\uff0c\u53ef\u4ee5\u9009\u62e9\u5728Agent\u7aef\u914d\u7f6e\u65e5\u5fd7\u89e3\u6790\u3002 \u53e6\u5916\uff0c\u76ee\u524d\u9488\u5bf9\u65e5\u5fd7\u62a5\u8b66\uff0c\u5f00\u6e90\u7684\u65b9\u6848\u4e00\u822c\u4e3a\u4f7f\u7528elastAlert\uff0c\u4f46\u662felastAlert\u65e0\u6cd5\u76f4\u63a5\u5bf9\u63a5AlertManager\uff0c\u5e76\u4e14\u5728\u9ad8\u53ef\u7528\u7b49\u65b9\u9762\u5b58\u5728\u95ee\u9898\uff0c\u540c\u65f6\u4f1a\u5f3a\u4f9d\u8d56Elasticsearch\u3002\u6240\u4ee5\u5982\u679c\u4f7f\u7528Loggie\uff0c\u53ef\u4ee5\u65e0\u9700\u5f15\u5165\u989d\u5916\u7684\u7ec4\u4ef6\uff0c\u76f4\u63a5\u4f7f\u7528Loggie\u6765\u68c0\u6d4b\u5f02\u5e38\u65e5\u5fd7\u5e76\u63a5\u5165\u62a5\u8b66\u3002","title":"\u7075\u6d3b\u3001\u70ed\u63d2\u62d4\u3001\u53ef\u6269\u5c55"},{"location":"user-guide/architecture/advantages/#_4","text":"Loggie\u57fa\u4e8e\u5fae\u5185\u6838\u7684\u67b6\u6784\uff0c\u6240\u6709\u7684source/interceptor/sink/queue\u90fd\u88ab\u62bd\u8c61\u6210component\uff0c\u53ea\u9700\u8981\u5728\u4ee3\u7801\u4e2d\u5b9e\u73b0Golang\u63a5\u53e3\uff0c\u5373\u53ef\u65b9\u4fbf\u7684\u7814\u53d1\u4e00\u4e2acomponent\u3002 \u5982\u679cLoggie\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u65e0\u6cd5\u6ee1\u8db3\u4f60\u7684\u9700\u6c42\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u5199\u4e00\u4e2a\u81ea\u5df1\u7684component\u3002 \u6bd4\u5982\u9700\u8981Loggie\u8f6c\u6362\u6210\u7279\u5b9a\u7684\u65e5\u5fd7\u683c\u5f0f\uff0c\u53ef\u4ee5\u5199\u4e00\u4e2ainterceptor\u53bb\u5904\u7406\uff1b\u9700\u8981Loggie\u5c06\u91c7\u96c6\u7684\u65e5\u5fd7\u53d1\u9001\u81f3\u5c1a\u672a\u652f\u6301\u7684\u670d\u52a1\uff0c\u53ef\u4ee5\u5199\u4e00\u4e2asink\u3002 \u5f53\u7136\uff0cLoggie\u4f7f\u7528Golang\u7f16\u5199\uff0c\u6240\u4ee5\u4f60\u76ee\u524d\u9700\u8981\u7528Golang\u6765\u5199component\u3002Golang\u548cJava\u6216\u8005C/C++\u76f8\u6bd4\uff0c\u5728\u6027\u80fd\u548c\u7814\u53d1\u6548\u7387\u4e0a\u6709\u4e00\u4e2a\u6298\u4e2d\uff0c\u66f4\u9002\u5408\u7c7b\u4f3c\u65e5\u5fd7Agent\u7684\u573a\u666f\u3002","title":"\u53ef\u5feb\u901f\u65b9\u4fbf\u7684\u5199\u4e00\u4e2a\u7ec4\u4ef6"},{"location":"user-guide/architecture/advantages/#kubernetes","text":"\u5982\u679c\u4f60\u5c1d\u8bd5\u8fc7\u5728Kubernetes\u73af\u5883\u4e0b\u91c7\u96c6\u65e5\u5fd7\uff0c\u5e94\u8be5\u9047\u5230\u8fc7\u8fd9\u4e9b\u95ee\u9898\uff1a \u91c7\u7528sidecar\u8fd8\u662fdaemonset\u90e8\u7f72\u65e5\u5fd7Agent\uff1f \u4f7f\u7528\u4ec0\u4e48\u65b9\u5f0f\u6302\u8f7d\u65e5\u5fd7\u6587\u4ef6\uff1f\u96be\u9053\u53ea\u63a8\u8350\u7528stdout\u8f93\u51fa\u65e5\u5fd7\u5417\uff1f \u91c7\u96c6\u7684\u65e5\u5fd7\u5982\u4f55\u548cPod\u3001Namespace\u3001Node\u7b49\u4fe1\u606f\u5173\u8054\u4e0a\uff1f Kubernetes\u4e0bPod\u4f1a\u52a8\u6001\u7684\u521b\u5efa\u548c\u9500\u6bc1\uff0c\u8fc1\u79fb\u5230\u4e86\u5176\u4ed6\u7684Node\uff0c\u76f8\u5e94\u7684\u65e5\u5fd7Agent\u914d\u7f6e\u600e\u4e48\u529e\u5462\uff1f \u5982\u679c\u4f60\u4f7f\u7528Loggie\uff0c\u4f60\u53ef\u4ee5\uff1a \u5feb\u901f\u90e8\u7f72\uff0c\u652f\u6301\u5404\u79cd\u90e8\u7f72\u67b6\u6784 \u53ea\u9700\u8981\u4f7f\u7528ClusterLogConfig/LogConfig CRD\u914d\u7f6e\u7ba1\u7406\u65e5\u5fd7\u914d\u7f6e\uff0c\u66f4\u65b9\u4fbf\u7684\u63a5\u5165\u5404\u7c7b\u5bb9\u5668\u4e91\u5e73\u53f0\uff0c\u5bf9\u4e1a\u52a1\u65e0\u4fb5\u5165\uff0c\u65e0\u9700\u5173\u5fc3Pod\u8fc1\u79fb\u7b49\uff0c\u65e0\u9700\u624b\u52a8\u5728\u8282\u70b9\u4e0a\u64cd\u4f5c\u914d\u7f6e\u65e5\u5fd7\u6587\u4ef6\uff0c\u540c\u65f6\u53ef\u914d\u7f6e\u6ce8\u5165Namespace/PodName/NodeName\u7b49\u5143\u4fe1\u606f\u4f9b\u67e5\u8be2\u4f7f\u7528","title":"\u66f4\u65b9\u4fbf\u7684Kubernetes\u5bb9\u5668\u65e5\u5fd7\u91c7\u96c6\uff0c\u66f4\u597d\u7684\u4e91\u539f\u751f\u652f\u6301"},{"location":"user-guide/architecture/advantages/#_5","text":"\u5728\u5b9e\u9645\u7684\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u65e5\u5fd7Agent\u672c\u8eab\u7684\u7a33\u5b9a\u6027\u5f88\u91cd\u8981\uff0c\u540c\u65f6\u4e0d\u5f71\u54cd\u4e1a\u52a1\u4e5f\u5f88\u91cd\u8981\u3002 Loggie\u53ef\u914d\u7f6e\u9650\u6d41interceptor\uff0c\u5728\u65e5\u5fd7\u91cf\u592a\u5927\u65f6\uff0c\u53ef\u4ee5\u907f\u514d\u53d1\u9001\u65e5\u5fd7\u6570\u636e\u5360\u636e\u4e86\u592a\u591a\u7f51\u7edc\u5e26\u5bbd\u3002 Loggie\u6709\u5408\u7406\u7684\u6587\u4ef6\u53e5\u67c4\u5904\u7406\u673a\u5236\uff0c\u907f\u514dfd\u88ab\u5360\u7528\u7684\u5404\u79cd\u5f02\u5e38\u573a\u666f\u5bfc\u81f4\u8282\u70b9\u4e0d\u7a33\u5b9a\u3002 \u53e6\u5916\uff0cLoggie\u7ed3\u5408\u6211\u4eec\u5728\u5404\u79cd\u73af\u5883\u4e2d\u9047\u5230\u7684\u5404\u79cd\u95ee\u9898\uff0c\u9488\u5bf9\u6027\u7684\u68c0\u6d4b\u66b4\u9732\u51fa\u76f8\u5e94\u7684\u6307\u6807\u3002 \u6bd4\u5982\u6307\u6807\u652f\u6301\u91c7\u96c6\u548c\u53d1\u9001\u5ef6\u8fdf\u68c0\u6d4b\u3002\u6bd4\u5982\u9488\u5bf9\u6587\u4ef6size\u589e\u957f\u592a\u5feb\uff0c\u6216\u8005\u6587\u4ef6size\u592a\u5927\u7b49\u573a\u666f\uff0c\u652f\u6301\u8be5\u7c7bmetric\u4e0a\u62a5\u3002 \u540c\u65f6Loggie\u652f\u6301\u539f\u751fPrometheus metric\uff0c\u53ef\u907f\u514d\u989d\u5916\u90e8\u7f72exporter\u5e26\u6765\u7684\u90e8\u7f72\u6210\u672c\u548c\u8d44\u6e90\u6d88\u8017\u3002Loggie\u8fd8\u63d0\u4f9b\u4e86\u5b8c\u5584\u7684Grafana\u76d1\u63a7\u56fe\u8868\uff0c\u53ef\u4ee5\u65b9\u4fbf\u5feb\u901f\u63a5\u5165\u4f7f\u7528\u3002","title":"\u66f4\u597d\u7684\u7a33\u5b9a\u6027\u3001\u66f4\u8be6\u7ec6\u7684\u76d1\u63a7\u6307\u6807\u3001\u66f4\u65b9\u4fbf\u7684\u6392\u969c\u65b9\u5f0f"},{"location":"user-guide/architecture/advantages/#_6","text":"Loggie\u57fa\u4e8eGolang\u7f16\u5199\uff0c\u5728\u4ee3\u7801\u5c42\u9762\u6211\u4eec\u6709\u5f88\u591a\u4f18\u5316\uff0c\u5728\u8f83\u5c11\u8d44\u6e90\u5360\u7528\u7684\u540c\u65f6\uff0c\u8fd8\u53ef\u63d0\u4f9b\u5f3a\u5927\u7684\u541e\u5410\u6027\u80fd\u3002","title":"\u66f4\u4f4e\u7684\u8d44\u6e90\u5360\u7528\uff0c\u66f4\u597d\u7684\u6027\u80fd"},{"location":"user-guide/architecture/background/","text":"Loggie\u7684\u8bde\u751f\u80cc\u666f \u00b6 \u4e3a\u4ec0\u4e48\u6211\u4eec\u4f1a\u9009\u62e9\u7814\u53d1Loggie\uff0c\u5f53\u65f6\u7684\u80cc\u666f\u548c\u539f\u56e0\u662f\u4ec0\u4e48\uff1f \u4e00\u3001\u90a3\u4e9b\u5e74\u6211\u4eec\u9047\u5230\u7684\u95ee\u9898 \u00b6 \u5728\u7814\u53d1Loggie\u4e4b\u524d\uff0c\u6211\u4eec\u7684\u65e5\u5fd7\u670d\u52a1\u91c7\u96c6\u7aef\u90fd\u662f\u4f7f\u7528Filebeat\uff0c\u5f53\u65f6\u4e3a\u4ec0\u4e48\u9009\u62e9Filebeat\u5462\uff1f Filebeat\u662fElastic\u516c\u53f8\u7684\u4ea7\u54c1\uff0c\u4e3b\u6253\u8f7b\u91cf\u7ea7\uff0c\u7528\u4e8e\u66ff\u6362\u539f\u6709Logstash\u53bb\u5b9e\u73b0\u65e5\u5fd7\u91c7\u96c6\u7684\u5de5\u4f5c\uff0c\u76f8\u6bd4\u4ed6\u4eec\u81ea\u5bb6\u57fa\u4e8eJRuby\u8bed\u8a00\u7684Logstash\uff0cFilebeat\u786e\u5b9e\u662f\u76f8\u5bf9\u8f7b\u91cf\u3001\u8d44\u6e90\u5360\u7528\u5c11\u3002\u548c\u5176\u4ed6\u7684\u5f00\u6e90\u65e5\u5fd7\u91c7\u96c6Agent\u76f8\u6bd4\uff0c\u57fa\u4e8eGolang\u5f00\u53d1\u7684Filebeat\uff0c\u4e5f\u6709\u5f88\u591a\u4f18\u52bf\u3002 \u4f8b\u5982\uff0c\u76f8\u6bd4\u57fa\u4e8eJava\u7684Flume\uff0c\u6027\u80fd\u66f4\u597d\uff0c\u8d44\u6e90\u5360\u7528\u66f4\u5c11\uff1b\u76f8\u6bd4\u57fa\u4e8eRuby\u7684Fluentd\uff0c\u6027\u80fd\u66f4\u597d\uff0c\u4e8c\u6b21\u5f00\u53d1\u66f4\u65b9\u4fbf\uff1b\u76f8\u6bd4\u57fa\u4e8eC\u7684Fluentd-bit\uff0c\u529f\u80fd\u66f4\u5b8c\u5584\uff0c\u5f00\u53d1\u66f4\u53cb\u597d\u3002 \u6240\u4ee5\uff0c\u603b\u4f53\u6765\u8bf4\uff0cFilebeat\u662f\u4e00\u4e2a\u76f8\u5bf9\u6bd4\u8f83\u5e73\u8861\u7684\u65e5\u5fd7\u91c7\u96c6Agent\uff0c\u8fd9\u4e5f\u662f\u6211\u4eec\u5f53\u521d\u9009\u62e9Filebeat\u4f5c\u4e3a\u9ed8\u8ba4\u65e5\u5fd7\u91c7\u96c6Agent\u7684\u539f\u56e0\u3002 \u4f46\u662f\u968f\u7740\u6211\u4eec\u5bf9Filebeat\u66f4\u52a0\u6df1\u5ea6\u7684\u4f7f\u7528\uff0c\u5728\u516c\u53f8\u96c6\u56e2\u5185\u90e8\u5b9e\u8df5\u548c\u5916\u90e8\u5ba2\u6237\u7684\u4ea4\u4ed8\u4e2d\uff0c\u4e5f\u78b0\u5230\u4e86\u4e00\u4e9b\u95ee\u9898\u3002 \u7531\u4e8eFilebeat\u8bbe\u8ba1\u5f53\u521d\u8bbe\u8ba1\u65f6\uff0c\u4e3a\u4e86\u533a\u5206\u4e8eLogstash\uff0c\u7a81\u51fa\u8f7b\u91cf\u7ea7\uff0c\u727a\u7272\u4e86\u5f88\u591a\u53ef\u6269\u5c55\u6027\u7684\u8bbe\u8ba1\u3002 \u6700\u660e\u663e\u7684\u5c31\u662f\uff0cFilebeat\u53ea\u6709\u4e00\u4e2aQueue\u548c\u4e00\u4e2aOutput\u3002\u8fd9\u6837\u4e5f\u5bfc\u81f4\u4e86\uff1a \u9694\u79bb\u6027\u5f31 \u00b6 \u7531\u4e8e\u6240\u6709\u7684\u670d\u52a1\u65e5\u5fd7\u90fd\u4f1a\u53d1\u9001\u5230\u5168\u5c40\u552f\u4e00\u7684Queue\u91cc\uff0c\u5bfc\u81f4\u670d\u52a1\u65e5\u5fd7\u6570\u636e\u6df7\u5728\u4e00\u8d77\uff0c\u5728\u5f02\u5e38\u573a\u666f\u53d1\u751f\u65f6\uff0c\u65e0\u6cd5\u6709\u9694\u79bb\u6027\u7684\u4fdd\u969c\u3002 \u6bd4\u5982Filebeat\u5168\u5c40\u7684Queue\u5806\u79ef\uff0c\u4f1a\u5bfc\u81f4\u8282\u70b9\u7684\u6240\u6709\u670d\u52a1\u65e5\u5fd7\u5747\u65e0\u6cd5\u53d1\u9001\uff0c\u5982\u679c\u6211\u4eec\u5bf9\u4e0d\u540c\u670d\u52a1\u7684\u65e5\u5fd7\u7684\u7ea7\u522b\u548c\u8981\u6c42\u4e0d\u4e00\u6837\uff0c\u4e0d\u7ba1\u91cd\u8981\u8fd8\u662f\u4e0d\u91cd\u8981\u7684\u65e5\u5fd7\u90fd\u4f1a\u53d7\u5230\u5f71\u54cd\u3002 \u4e0d\u652f\u6301\u591a\u4e2aOutput \u00b6 \u6709\u4e00\u4e9b\u573a\u666f\u4e0b\uff0c\u6211\u4eec\u53ef\u80fd\u9700\u8981\u5c06\u4e0d\u540c\u670d\u52a1\u7684\u4e0d\u540c\u7c7b\u578b\u65e5\u5fd7\u53d1\u9001\u81f3\u4e0d\u540c\u7684\u540e\u7aef\uff0c\u4f46Filebeat\u65e0\u6cd5\u4f7f\u7528\u540c\u4e00\u4e2aAgent\u53bb\u53d1\u9001\u5230\u4e0d\u540c\u7684Kafka\u96c6\u7fa4\uff0c\u53ea\u80fd\u5728\u8282\u70b9\u4e0a\u90e8\u7f72\u591a\u4e2aAgent\uff0c\u5bfc\u81f4\u7ef4\u62a4\u548c\u8d44\u6e90\u6210\u672c\u4e0a\u5347\u3002 \u53ef\u6269\u5c55\u6027\u6709\u9650 \u00b6 \u76f8\u6bd4Logstash/Flume\u7b49\uff0cFilebeat\u5e76\u975e\u4f7f\u7528\u7c7b\u4f3c\u7684input->queue->output\u7684\u7075\u6d3b\u591a\u4e2apipeline\u8bbe\u8ba1\uff0c\u5728\u5bf9\u4e8e\u65e5\u5fd7\u6570\u636e\u7684\u5904\u7406/\u8fc7\u6ee4/\u589e\u5f3a\u4e0a\uff0c\u4f9d\u8d56\u7684\u662fFilebeat\u6709\u9650\u7684\u4e00\u4e9bprocessor\uff0c\u53ef\u6269\u5c55\u6027\u4e0d\u8db3\u3002 \u540c\u65f6Filebeat\u4e5f\u65e0\u6cd5\u4f5c\u4e3a\u4e2d\u8f6c\u805a\u5408\u4f7f\u7528\uff0c\u5728\u4f7f\u7528\u573a\u666f\u4e0b\u5927\u5927\u53d7\u9650\uff0c\u9700\u8981\u989d\u5916\u5f15\u5165\u5176\u4ed6\u7ec4\u4ef6\u3002\u53e6\u5916\u7c7b\u4f3c\u65e5\u5fd7\u62a5\u8b66\u7b49\u573a\u666f\uff0cFilebeat\u4e5f\u65e0\u6cd5\u6ee1\u8db3\u3002 \u6211\u4eec\u4e5f\u5c1d\u8bd5\u8fc7\u5b9a\u5236\u5316\u5f00\u53d1\uff0c\u4f46Filebeat\u672c\u8eab\u7684\u67b6\u6784\u8bbe\u8ba1\u4e0a\u96be\u4ee5\u5b9e\u73b0\u66f4\u591a\u7684\u6269\u5c55\u80fd\u529b\uff0c\u5e76\u4e14\u957f\u671f\u4f1a\u5e26\u6765\u5347\u7ea7\u4e0e\u4e0a\u6e38\u793e\u533a\u4ee3\u7801\u540c\u6b65\u7684\u95ee\u9898\u3002 \u65e5\u5fd7\u6392\u969c\u8fd0\u7ef4\u56f0\u5883 \u00b6 Filebeat\u7684metrics\u6bd4\u8f83\u6709\u9650\uff0c\u5f88\u591a\u65f6\u5019\u6211\u4eec\u60f3\u8981\u6392\u67e5\u8bf8\u5982\u5e38\u89c1\u7684\u65e5\u5fd7\u662f\u5426\u6709\u91c7\u96c6\u3001\u91c7\u96c6\u7684\u65e5\u5fd7\u662f\u5426\u5b8c\u6574\u3001\u53d1\u9001\u662f\u5426\u6709\u5ef6\u8fdf\u7b49\u7b49\u6392\u969c\u573a\u666f\uff0cFilebeat\u6ca1\u6709\u63d0\u4f9b\u76f8\u5e94\u7684\u529f\u80fd\uff0c\u5341\u5206\u5f71\u54cd\u7ebf\u4e0a\u7684\u95ee\u9898\u6392\u67e5\u6548\u7387\u3002\u800c\u4e14Filebeat\u672a\u63d0\u4f9bPrometheus\u683c\u5f0f\u7684\u76d1\u63a7\u6307\u6807\uff0c\u9700\u8981\u989d\u5916\u6ce8\u5165exporter\u3002 \u6027\u80fd\u4e0d\u591f \u00b6 \u867d\u7136Filebeat\u6027\u80fd\u5c1a\u53ef\uff0c\u4f46\u662f\u5728\u6211\u4eec\u7684\u5b9e\u9645\u4f7f\u7528\u65f6\uff0c\u9047\u5230\u65e5\u5fd7\u573a\u666f\u590d\u6742\u3001\u65e5\u5fd7\u91cf\u5927\u7684\u60c5\u51b5\u65f6\uff0c\u5b58\u5728\u541e\u5410\u91cf\u7684\u74f6\u9888\uff0c\u65e0\u6cd5\u6ee1\u8db3\u5b9e\u65f6\u6027\u7684\u9700\u6c42\u3002 \u4e8c\u3001\u4e3a\u4ec0\u4e48\u73b0\u6709\u7684\u5176\u4ed6\u5f00\u6e90\u65e5\u5fd7\u9879\u76ee\u4e0d\u80fd\u6ee1\u8db3\u9700\u6c42\uff1f \u00b6 Fluentd/Fluent-bit Fluentd\u57fa\u4e8eRuby\u6027\u80fd\u4e00\u822c\uff0c\u5355\u7ebf\u7a0b\uff1bFluent-bit\u57fa\u4e8eC\uff0c\u5bf9\u4e8e\u6211\u4eec\u7684\u6280\u672f\u6808\u6765\u8bf4\uff0cRuby\u548cC\u7684\u7ef4\u62a4\u548c\u4e8c\u6b21\u5f00\u53d1\u6210\u672c\u6bd4\u8f83\u5927\u3002 Logstash Logstash\u6027\u80fd\u8f83\u5dee\uff0c\u57fa\u4e8eJRuby\u7684\u8d44\u6e90\u5360\u7528\u548c\u635f\u8017\u90fd\u6bd4\u8f83\u5927\u3002 Flume \u8d44\u6e90\u5360\u7528\u8f83\u5927\uff0c\u6027\u80fd\u4e00\u822c\uff0c\u4e4b\u524d\u6709\u5185\u90e8\u90e8\u95e8\u4f7f\u7528\u8fc7Flume\uff0c\u5bf9\u6bd4\u7684\u538b\u6d4b\u7ed3\u8bba\u8bc1\u5b9e\u786e\u5b9e\u4e0d\u5982Filebeat\u3002 \u6700\u91cd\u8981\u7684\u662f\uff0c\u76ee\u524d\u6240\u6709\u7684\u5f00\u6e90Agent\uff0c\u5747\u6ca1\u6709\u5bf9K8s\u6709\u5f88\u597d\u7684\u539f\u751f\u652f\u6301\uff0c\u4e2a\u522b\u652f\u6301\u7684\u4e5f\u53ea\u80fd\u91c7\u96c6stdout\u7684\u65e5\u5fd7\u3002 \u6b63\u662f\u7531\u4e8e\u76ee\u524d\u5f00\u6e90\u7684Agent\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff0c\u4e0d\u80fd\u6ee1\u8db3\u957f\u671f\u7684\u9700\u6c42\uff0c\u6240\u4ee5\u6211\u4eec\u51b3\u5b9a\u5f00\u59cb\u81ea\u7814\u3002 \u4e09\u3001\u4ec0\u4e48\u624d\u662f\u6211\u4eec\u7406\u60f3\u4e2d\u7684\u65e5\u5fd7Agent\uff1f \u00b6 \u6574\u4f53\u7684\u76ee\u6807\uff1a \u9ad8\u6027\u80fd\u3001\u8d44\u6e90\u5360\u7528\u4f4e\u3001\u9ad8\u53ef\u7528\u3001\u7a33\u5b9a\u6027\u5f3a\u3001\u53ef\u6269\u5c55\u6027\u5f3a\u3001\u66f4\u9002\u5408\u4e91\u539f\u751f\u3002 \u6027\u80fd\u4e0e\u8d44\u6e90\uff1a \u6027\u80fd\u76f8\u540c\u7684\u60c5\u51b5\u4e0b\uff0cCPU\u6bd4\u793e\u533aFilebeat\u5927\u5927\u964d\u4f4e\uff0c\u541e\u5410\u91cf\u4e0a\u9650\u8981\u8fdc\u9ad8\u4e8eFilebeat\u3002 \u9ad8\u53ef\u7528\u3001\u7a33\u5b9a\u6027\u5f3a\uff1a \u8d44\u6e90\u9694\u79bb\uff0c\u4f5c\u4e3a\u57fa\u7840\u8bbe\u65bd\u4e00\u5b9a\u8981\u7a33\u5b9a\u53ef\u9760\uff0c\u540c\u65f6\u9ed8\u8ba4\u652f\u6301\u5927\u91cf\u76d1\u63a7\u6307\u6807\uff0c\u5bf9\u5e38\u89c1\u7684\u8fd0\u7ef4\u7c7b\u95ee\u9898\u6709\u826f\u597d\u7684\u652f\u6491\uff0c\u51cf\u5c11\u8fd0\u7ef4\u8d1f\u62c5\u3002 \u53ef\u6269\u5c55\u6027\uff1a \u6574\u4f53\u8bbe\u8ba1\u4e0a\uff0c\u65b9\u4fbf\u7528\u6237\u6269\u5c55\uff0c\u5b9e\u73b0\u8fc7\u6ee4\u3001\u8def\u7531\u3001\u7f16\u7801\u7b49\u80fd\u529b\u3002\u6bd4\u5982\u53ef\u4ee5\u5f88\u5feb\u901f\u7684\u5199\u4e00\u4e2a\u5904\u7406\u903b\u8f91\uff0c\u5c31\u53ef\u4ee5\u8fdb\u884c\u6570\u636e\u5904\u7406\u3002 \u603b\u7ed3\u4e00\u4e0b\uff0c\u6211\u4eec\u7406\u60f3\u4e2d\u7684\u65e5\u5fd7Agent\u662f\u4e00\u4e2a\uff1a \u5f00\u7bb1\u5373\u7528\uff1a\u53ef\u5feb\u901f\u90e8\u7f72\u5bb9\u5668\u5316\u573a\u666f\u4e0b\u7684\u65e5\u5fd7\u91c7\u96c6\u670d\u52a1\uff1b\u6709\u5b8c\u5584\u7684\u6587\u6863\u4e0e\u7ecf\u9a8c\u4ecb\u7ecd\uff1b \u9ad8\u6027\u80fd\uff1a\u6bd4\u539f\u751fFilebeat\u6027\u80fd\u9ad8\uff0c\u8d44\u6e90\u5360\u7528\u5c11\uff1b \u9ad8\u53ef\u9760\uff1a\u9694\u79bb\u6027\u7a33\u5b9a\u6027\u66f4\u5f3a\uff1b\u9ed8\u8ba4\u96c6\u6210\u66f4\u591a\u7684\u76d1\u63a7\u6307\u6807\uff0c\u65b9\u4fbf\u8fd0\u7ef4\u6392\u969c\uff1b \u53ef\u6269\u5c55\uff1a\u57fa\u4e8e\u5fae\u5185\u6838\u7684\u67b6\u6784\uff0c\u7528\u6237\u53ef\u65b9\u4fbf\u5feb\u6377\u7684\u5199\u81ea\u5df1\u7684\u63d2\u4ef6\uff0c\u6ee1\u8db3\u5404\u79cd\u5b9a\u5236\u5316\u9700\u6c42\uff1b","title":"\u8bde\u751f\u80cc\u666f"},{"location":"user-guide/architecture/background/#loggie","text":"\u4e3a\u4ec0\u4e48\u6211\u4eec\u4f1a\u9009\u62e9\u7814\u53d1Loggie\uff0c\u5f53\u65f6\u7684\u80cc\u666f\u548c\u539f\u56e0\u662f\u4ec0\u4e48\uff1f","title":"Loggie\u7684\u8bde\u751f\u80cc\u666f"},{"location":"user-guide/architecture/background/#_1","text":"\u5728\u7814\u53d1Loggie\u4e4b\u524d\uff0c\u6211\u4eec\u7684\u65e5\u5fd7\u670d\u52a1\u91c7\u96c6\u7aef\u90fd\u662f\u4f7f\u7528Filebeat\uff0c\u5f53\u65f6\u4e3a\u4ec0\u4e48\u9009\u62e9Filebeat\u5462\uff1f Filebeat\u662fElastic\u516c\u53f8\u7684\u4ea7\u54c1\uff0c\u4e3b\u6253\u8f7b\u91cf\u7ea7\uff0c\u7528\u4e8e\u66ff\u6362\u539f\u6709Logstash\u53bb\u5b9e\u73b0\u65e5\u5fd7\u91c7\u96c6\u7684\u5de5\u4f5c\uff0c\u76f8\u6bd4\u4ed6\u4eec\u81ea\u5bb6\u57fa\u4e8eJRuby\u8bed\u8a00\u7684Logstash\uff0cFilebeat\u786e\u5b9e\u662f\u76f8\u5bf9\u8f7b\u91cf\u3001\u8d44\u6e90\u5360\u7528\u5c11\u3002\u548c\u5176\u4ed6\u7684\u5f00\u6e90\u65e5\u5fd7\u91c7\u96c6Agent\u76f8\u6bd4\uff0c\u57fa\u4e8eGolang\u5f00\u53d1\u7684Filebeat\uff0c\u4e5f\u6709\u5f88\u591a\u4f18\u52bf\u3002 \u4f8b\u5982\uff0c\u76f8\u6bd4\u57fa\u4e8eJava\u7684Flume\uff0c\u6027\u80fd\u66f4\u597d\uff0c\u8d44\u6e90\u5360\u7528\u66f4\u5c11\uff1b\u76f8\u6bd4\u57fa\u4e8eRuby\u7684Fluentd\uff0c\u6027\u80fd\u66f4\u597d\uff0c\u4e8c\u6b21\u5f00\u53d1\u66f4\u65b9\u4fbf\uff1b\u76f8\u6bd4\u57fa\u4e8eC\u7684Fluentd-bit\uff0c\u529f\u80fd\u66f4\u5b8c\u5584\uff0c\u5f00\u53d1\u66f4\u53cb\u597d\u3002 \u6240\u4ee5\uff0c\u603b\u4f53\u6765\u8bf4\uff0cFilebeat\u662f\u4e00\u4e2a\u76f8\u5bf9\u6bd4\u8f83\u5e73\u8861\u7684\u65e5\u5fd7\u91c7\u96c6Agent\uff0c\u8fd9\u4e5f\u662f\u6211\u4eec\u5f53\u521d\u9009\u62e9Filebeat\u4f5c\u4e3a\u9ed8\u8ba4\u65e5\u5fd7\u91c7\u96c6Agent\u7684\u539f\u56e0\u3002 \u4f46\u662f\u968f\u7740\u6211\u4eec\u5bf9Filebeat\u66f4\u52a0\u6df1\u5ea6\u7684\u4f7f\u7528\uff0c\u5728\u516c\u53f8\u96c6\u56e2\u5185\u90e8\u5b9e\u8df5\u548c\u5916\u90e8\u5ba2\u6237\u7684\u4ea4\u4ed8\u4e2d\uff0c\u4e5f\u78b0\u5230\u4e86\u4e00\u4e9b\u95ee\u9898\u3002 \u7531\u4e8eFilebeat\u8bbe\u8ba1\u5f53\u521d\u8bbe\u8ba1\u65f6\uff0c\u4e3a\u4e86\u533a\u5206\u4e8eLogstash\uff0c\u7a81\u51fa\u8f7b\u91cf\u7ea7\uff0c\u727a\u7272\u4e86\u5f88\u591a\u53ef\u6269\u5c55\u6027\u7684\u8bbe\u8ba1\u3002 \u6700\u660e\u663e\u7684\u5c31\u662f\uff0cFilebeat\u53ea\u6709\u4e00\u4e2aQueue\u548c\u4e00\u4e2aOutput\u3002\u8fd9\u6837\u4e5f\u5bfc\u81f4\u4e86\uff1a","title":"\u4e00\u3001\u90a3\u4e9b\u5e74\u6211\u4eec\u9047\u5230\u7684\u95ee\u9898"},{"location":"user-guide/architecture/background/#_2","text":"\u7531\u4e8e\u6240\u6709\u7684\u670d\u52a1\u65e5\u5fd7\u90fd\u4f1a\u53d1\u9001\u5230\u5168\u5c40\u552f\u4e00\u7684Queue\u91cc\uff0c\u5bfc\u81f4\u670d\u52a1\u65e5\u5fd7\u6570\u636e\u6df7\u5728\u4e00\u8d77\uff0c\u5728\u5f02\u5e38\u573a\u666f\u53d1\u751f\u65f6\uff0c\u65e0\u6cd5\u6709\u9694\u79bb\u6027\u7684\u4fdd\u969c\u3002 \u6bd4\u5982Filebeat\u5168\u5c40\u7684Queue\u5806\u79ef\uff0c\u4f1a\u5bfc\u81f4\u8282\u70b9\u7684\u6240\u6709\u670d\u52a1\u65e5\u5fd7\u5747\u65e0\u6cd5\u53d1\u9001\uff0c\u5982\u679c\u6211\u4eec\u5bf9\u4e0d\u540c\u670d\u52a1\u7684\u65e5\u5fd7\u7684\u7ea7\u522b\u548c\u8981\u6c42\u4e0d\u4e00\u6837\uff0c\u4e0d\u7ba1\u91cd\u8981\u8fd8\u662f\u4e0d\u91cd\u8981\u7684\u65e5\u5fd7\u90fd\u4f1a\u53d7\u5230\u5f71\u54cd\u3002","title":"\u9694\u79bb\u6027\u5f31"},{"location":"user-guide/architecture/background/#output","text":"\u6709\u4e00\u4e9b\u573a\u666f\u4e0b\uff0c\u6211\u4eec\u53ef\u80fd\u9700\u8981\u5c06\u4e0d\u540c\u670d\u52a1\u7684\u4e0d\u540c\u7c7b\u578b\u65e5\u5fd7\u53d1\u9001\u81f3\u4e0d\u540c\u7684\u540e\u7aef\uff0c\u4f46Filebeat\u65e0\u6cd5\u4f7f\u7528\u540c\u4e00\u4e2aAgent\u53bb\u53d1\u9001\u5230\u4e0d\u540c\u7684Kafka\u96c6\u7fa4\uff0c\u53ea\u80fd\u5728\u8282\u70b9\u4e0a\u90e8\u7f72\u591a\u4e2aAgent\uff0c\u5bfc\u81f4\u7ef4\u62a4\u548c\u8d44\u6e90\u6210\u672c\u4e0a\u5347\u3002","title":"\u4e0d\u652f\u6301\u591a\u4e2aOutput"},{"location":"user-guide/architecture/background/#_3","text":"\u76f8\u6bd4Logstash/Flume\u7b49\uff0cFilebeat\u5e76\u975e\u4f7f\u7528\u7c7b\u4f3c\u7684input->queue->output\u7684\u7075\u6d3b\u591a\u4e2apipeline\u8bbe\u8ba1\uff0c\u5728\u5bf9\u4e8e\u65e5\u5fd7\u6570\u636e\u7684\u5904\u7406/\u8fc7\u6ee4/\u589e\u5f3a\u4e0a\uff0c\u4f9d\u8d56\u7684\u662fFilebeat\u6709\u9650\u7684\u4e00\u4e9bprocessor\uff0c\u53ef\u6269\u5c55\u6027\u4e0d\u8db3\u3002 \u540c\u65f6Filebeat\u4e5f\u65e0\u6cd5\u4f5c\u4e3a\u4e2d\u8f6c\u805a\u5408\u4f7f\u7528\uff0c\u5728\u4f7f\u7528\u573a\u666f\u4e0b\u5927\u5927\u53d7\u9650\uff0c\u9700\u8981\u989d\u5916\u5f15\u5165\u5176\u4ed6\u7ec4\u4ef6\u3002\u53e6\u5916\u7c7b\u4f3c\u65e5\u5fd7\u62a5\u8b66\u7b49\u573a\u666f\uff0cFilebeat\u4e5f\u65e0\u6cd5\u6ee1\u8db3\u3002 \u6211\u4eec\u4e5f\u5c1d\u8bd5\u8fc7\u5b9a\u5236\u5316\u5f00\u53d1\uff0c\u4f46Filebeat\u672c\u8eab\u7684\u67b6\u6784\u8bbe\u8ba1\u4e0a\u96be\u4ee5\u5b9e\u73b0\u66f4\u591a\u7684\u6269\u5c55\u80fd\u529b\uff0c\u5e76\u4e14\u957f\u671f\u4f1a\u5e26\u6765\u5347\u7ea7\u4e0e\u4e0a\u6e38\u793e\u533a\u4ee3\u7801\u540c\u6b65\u7684\u95ee\u9898\u3002","title":"\u53ef\u6269\u5c55\u6027\u6709\u9650"},{"location":"user-guide/architecture/background/#_4","text":"Filebeat\u7684metrics\u6bd4\u8f83\u6709\u9650\uff0c\u5f88\u591a\u65f6\u5019\u6211\u4eec\u60f3\u8981\u6392\u67e5\u8bf8\u5982\u5e38\u89c1\u7684\u65e5\u5fd7\u662f\u5426\u6709\u91c7\u96c6\u3001\u91c7\u96c6\u7684\u65e5\u5fd7\u662f\u5426\u5b8c\u6574\u3001\u53d1\u9001\u662f\u5426\u6709\u5ef6\u8fdf\u7b49\u7b49\u6392\u969c\u573a\u666f\uff0cFilebeat\u6ca1\u6709\u63d0\u4f9b\u76f8\u5e94\u7684\u529f\u80fd\uff0c\u5341\u5206\u5f71\u54cd\u7ebf\u4e0a\u7684\u95ee\u9898\u6392\u67e5\u6548\u7387\u3002\u800c\u4e14Filebeat\u672a\u63d0\u4f9bPrometheus\u683c\u5f0f\u7684\u76d1\u63a7\u6307\u6807\uff0c\u9700\u8981\u989d\u5916\u6ce8\u5165exporter\u3002","title":"\u65e5\u5fd7\u6392\u969c\u8fd0\u7ef4\u56f0\u5883"},{"location":"user-guide/architecture/background/#_5","text":"\u867d\u7136Filebeat\u6027\u80fd\u5c1a\u53ef\uff0c\u4f46\u662f\u5728\u6211\u4eec\u7684\u5b9e\u9645\u4f7f\u7528\u65f6\uff0c\u9047\u5230\u65e5\u5fd7\u573a\u666f\u590d\u6742\u3001\u65e5\u5fd7\u91cf\u5927\u7684\u60c5\u51b5\u65f6\uff0c\u5b58\u5728\u541e\u5410\u91cf\u7684\u74f6\u9888\uff0c\u65e0\u6cd5\u6ee1\u8db3\u5b9e\u65f6\u6027\u7684\u9700\u6c42\u3002","title":"\u6027\u80fd\u4e0d\u591f"},{"location":"user-guide/architecture/background/#_6","text":"Fluentd/Fluent-bit Fluentd\u57fa\u4e8eRuby\u6027\u80fd\u4e00\u822c\uff0c\u5355\u7ebf\u7a0b\uff1bFluent-bit\u57fa\u4e8eC\uff0c\u5bf9\u4e8e\u6211\u4eec\u7684\u6280\u672f\u6808\u6765\u8bf4\uff0cRuby\u548cC\u7684\u7ef4\u62a4\u548c\u4e8c\u6b21\u5f00\u53d1\u6210\u672c\u6bd4\u8f83\u5927\u3002 Logstash Logstash\u6027\u80fd\u8f83\u5dee\uff0c\u57fa\u4e8eJRuby\u7684\u8d44\u6e90\u5360\u7528\u548c\u635f\u8017\u90fd\u6bd4\u8f83\u5927\u3002 Flume \u8d44\u6e90\u5360\u7528\u8f83\u5927\uff0c\u6027\u80fd\u4e00\u822c\uff0c\u4e4b\u524d\u6709\u5185\u90e8\u90e8\u95e8\u4f7f\u7528\u8fc7Flume\uff0c\u5bf9\u6bd4\u7684\u538b\u6d4b\u7ed3\u8bba\u8bc1\u5b9e\u786e\u5b9e\u4e0d\u5982Filebeat\u3002 \u6700\u91cd\u8981\u7684\u662f\uff0c\u76ee\u524d\u6240\u6709\u7684\u5f00\u6e90Agent\uff0c\u5747\u6ca1\u6709\u5bf9K8s\u6709\u5f88\u597d\u7684\u539f\u751f\u652f\u6301\uff0c\u4e2a\u522b\u652f\u6301\u7684\u4e5f\u53ea\u80fd\u91c7\u96c6stdout\u7684\u65e5\u5fd7\u3002 \u6b63\u662f\u7531\u4e8e\u76ee\u524d\u5f00\u6e90\u7684Agent\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff0c\u4e0d\u80fd\u6ee1\u8db3\u957f\u671f\u7684\u9700\u6c42\uff0c\u6240\u4ee5\u6211\u4eec\u51b3\u5b9a\u5f00\u59cb\u81ea\u7814\u3002","title":"\u4e8c\u3001\u4e3a\u4ec0\u4e48\u73b0\u6709\u7684\u5176\u4ed6\u5f00\u6e90\u65e5\u5fd7\u9879\u76ee\u4e0d\u80fd\u6ee1\u8db3\u9700\u6c42\uff1f"},{"location":"user-guide/architecture/background/#agent","text":"\u6574\u4f53\u7684\u76ee\u6807\uff1a \u9ad8\u6027\u80fd\u3001\u8d44\u6e90\u5360\u7528\u4f4e\u3001\u9ad8\u53ef\u7528\u3001\u7a33\u5b9a\u6027\u5f3a\u3001\u53ef\u6269\u5c55\u6027\u5f3a\u3001\u66f4\u9002\u5408\u4e91\u539f\u751f\u3002 \u6027\u80fd\u4e0e\u8d44\u6e90\uff1a \u6027\u80fd\u76f8\u540c\u7684\u60c5\u51b5\u4e0b\uff0cCPU\u6bd4\u793e\u533aFilebeat\u5927\u5927\u964d\u4f4e\uff0c\u541e\u5410\u91cf\u4e0a\u9650\u8981\u8fdc\u9ad8\u4e8eFilebeat\u3002 \u9ad8\u53ef\u7528\u3001\u7a33\u5b9a\u6027\u5f3a\uff1a \u8d44\u6e90\u9694\u79bb\uff0c\u4f5c\u4e3a\u57fa\u7840\u8bbe\u65bd\u4e00\u5b9a\u8981\u7a33\u5b9a\u53ef\u9760\uff0c\u540c\u65f6\u9ed8\u8ba4\u652f\u6301\u5927\u91cf\u76d1\u63a7\u6307\u6807\uff0c\u5bf9\u5e38\u89c1\u7684\u8fd0\u7ef4\u7c7b\u95ee\u9898\u6709\u826f\u597d\u7684\u652f\u6491\uff0c\u51cf\u5c11\u8fd0\u7ef4\u8d1f\u62c5\u3002 \u53ef\u6269\u5c55\u6027\uff1a \u6574\u4f53\u8bbe\u8ba1\u4e0a\uff0c\u65b9\u4fbf\u7528\u6237\u6269\u5c55\uff0c\u5b9e\u73b0\u8fc7\u6ee4\u3001\u8def\u7531\u3001\u7f16\u7801\u7b49\u80fd\u529b\u3002\u6bd4\u5982\u53ef\u4ee5\u5f88\u5feb\u901f\u7684\u5199\u4e00\u4e2a\u5904\u7406\u903b\u8f91\uff0c\u5c31\u53ef\u4ee5\u8fdb\u884c\u6570\u636e\u5904\u7406\u3002 \u603b\u7ed3\u4e00\u4e0b\uff0c\u6211\u4eec\u7406\u60f3\u4e2d\u7684\u65e5\u5fd7Agent\u662f\u4e00\u4e2a\uff1a \u5f00\u7bb1\u5373\u7528\uff1a\u53ef\u5feb\u901f\u90e8\u7f72\u5bb9\u5668\u5316\u573a\u666f\u4e0b\u7684\u65e5\u5fd7\u91c7\u96c6\u670d\u52a1\uff1b\u6709\u5b8c\u5584\u7684\u6587\u6863\u4e0e\u7ecf\u9a8c\u4ecb\u7ecd\uff1b \u9ad8\u6027\u80fd\uff1a\u6bd4\u539f\u751fFilebeat\u6027\u80fd\u9ad8\uff0c\u8d44\u6e90\u5360\u7528\u5c11\uff1b \u9ad8\u53ef\u9760\uff1a\u9694\u79bb\u6027\u7a33\u5b9a\u6027\u66f4\u5f3a\uff1b\u9ed8\u8ba4\u96c6\u6210\u66f4\u591a\u7684\u76d1\u63a7\u6307\u6807\uff0c\u65b9\u4fbf\u8fd0\u7ef4\u6392\u969c\uff1b \u53ef\u6269\u5c55\uff1a\u57fa\u4e8e\u5fae\u5185\u6838\u7684\u67b6\u6784\uff0c\u7528\u6237\u53ef\u65b9\u4fbf\u5feb\u6377\u7684\u5199\u81ea\u5df1\u7684\u63d2\u4ef6\uff0c\u6ee1\u8db3\u5404\u79cd\u5b9a\u5236\u5316\u9700\u6c42\uff1b","title":"\u4e09\u3001\u4ec0\u4e48\u624d\u662f\u6211\u4eec\u7406\u60f3\u4e2d\u7684\u65e5\u5fd7Agent\uff1f"},{"location":"user-guide/architecture/compare/","text":"\u5f00\u6e90\u9879\u76ee\u5bf9\u6bd4 \u00b6 Loggie Filebeat Fluentd Logstash Flume \u5f00\u53d1\u8bed\u8a00 Golang Golang Ruby JRuby Java \u591aPipeline \u652f\u6301 \u5355\u961f\u5217 \u5355\u961f\u5217 \u652f\u6301 \u652f\u6301 \u591a\u8f93\u51fa\u6e90 \u652f\u6301 \u4e0d\u652f\u6301\uff0c\u4ec5\u4e00\u4e2aOutput \u914d\u7f6ecopy \u652f\u6301 \u652f\u6301 \u4e2d\u8f6c\u673a \u652f\u6301 \u4e0d\u652f\u6301 \u652f\u6301 \u652f\u6301 \u652f\u6301 \u65e5\u5fd7\u62a5\u8b66 \u652f\u6301 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 Kubernetes\u5bb9\u5668\u65e5\u5fd7\u91c7\u96c6 \u652f\u6301\u5bb9\u5668\u7684stdout\u548c\u5bb9\u5668\u5185\u90e8\u65e5\u5fd7\u6587\u4ef6 \u53ea\u652f\u6301\u5bb9\u5668stdout \u53ea\u652f\u6301\u5bb9\u5668stdout \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \u914d\u7f6e\u4e0b\u53d1 Kubernetes\u4e0b\u53ef\u901a\u8fc7CRD\u914d\u7f6e\uff0c\u4e3b\u673a\u573a\u666f\u914d\u7f6e\u4e2d\u5fc3\u9646\u7eed\u652f\u6301\u4e2d \u624b\u52a8\u914d\u7f6e \u624b\u52a8\u914d\u7f6e \u624b\u52a8\u914d\u7f6e \u624b\u52a8\u914d\u7f6e \u76d1\u63a7 \u539f\u751f\u652f\u6301Prometheus metrics\uff0c\u540c\u65f6\u53ef\u914d\u7f6e\u5355\u72ec\u8f93\u51fa\u6307\u6807\u65e5\u5fd7\u6587\u4ef6\u3001\u53d1\u9001metrics\u7b49\u65b9\u5f0f API\u63a5\u53e3\u66b4\u9732\uff0c\u63a5\u5165Prometheus\u9700\u4f7f\u7528\u989d\u5916\u7684exporter \u652f\u6301API\u548cPrometheus metrics \u9700\u4f7f\u7528\u989d\u5916\u7684exporter \u9700\u4f7f\u7528\u989d\u5916\u7684exporter \u8d44\u6e90\u5360\u7528 \u4f4e \u4f4e \u4e00\u822c \u8f83\u9ad8 \u8f83\u9ad8 \u57fa\u51c6\u6027\u80fd\u6d4b\u8bd5\u4e0e\u5bf9\u6bd4 \u00b6 \u6d4b\u8bd5\u73af\u5883\uff1a \u7269\u7406\u673a 48C\uff0c256G Kafka 3 Broker\uff0c\u6302\u8f7dSSD\u76d8 Filebeat v7.8\u7248\u672c\uff0c\u65e0\u914d\u7f6eprocessor\u7b49\u5904\u7406\uff1bLoggie\u9ed8\u8ba4\u5305\u542bcost\u3001retry\u3001metric interceptor\uff1b \u6d4b\u8bd5\u76ee\u7684\uff1a Filebeat\u548cLoggie\u7684\u6027\u80fd\u5bf9\u6bd4 \u6d4b\u8bd5\u601d\u8def\uff1a Filebeat\u548cLoggie\uff0c\u5747\u91c7\u96c6\u65e5\u5fd7\u53d1\u9001\u81f3Kafka\uff0c\u89c2\u5bdf\u76f8\u5e94\u7684\u8d44\u6e90\u5360\u7528\u548c\u53d1\u9001\u541e\u5410\u91cf \u6d4b\u8bd5\u8be6\u60c5\uff1a \u5355\u6587\u4ef6\u81ea\u52a8\u751f\u62105000000\u884c\u65e5\u5fd7\uff0c\u6bcf\u884c\u5185\u5bb9\u5982\u4e0b\u6240\u793a\uff1a [13/May/2021:10:20:29 +0800] 0.015 10.200.170.107 \"GET /static/3tJHS3Ubrf.html?activity_channel_id=22=1_00000&fromMiniapp=1&miniapp_uuid=uEd93lG2eG8Qj5fRXuiJwNt4bmiylkmg HTTP/1.1\" 200 138957 \"110.183.45.54, 10.200.151.37\" act.you.163.com \"\" \"Mozilla/5.0 (Linux; Android 8.1.0; PADM00Build/O11019; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/67.0.3396.87 XWEB/568 MMWEBSDK/190102 Mobile Safari/537.36 MMWEBID/6881 MicroMessenger/7.0.3.1400(0x2700033B) Process/appbrand0 NetType/WIFI Language/zh_CN miniProgram\" \"\" [127.0.0.1:8990] [0.014] [] [] immsg={\"st\":1553307293614,\"sb\":138963,\"rc\":200,\"cf\":{\"sr\":1},\"if\":\"default\",\"ut\":14,\"sv\":\"static\",\"pd\":\"activity\",\"qb\":764} \u914d\u7f6eFilebeat\u548cLoggie\u91c7\u96c6\u65e5\u5fd7\uff0c\u5e76\u53d1\u9001\u81f3Kafka\u67d0\u4e2aTopic\uff0c\u4e0d\u4f7f\u7528\u5ba2\u6237\u7aef\u538b\u7f29\uff0cKafka Topic\u914d\u7f6ePartition\u4e3a3\u3002 \u5728\u4fdd\u8bc1Agent\u89c4\u683c\u8d44\u6e90\u5145\u8db3\u7684\u60c5\u51b5\u4e0b\uff0c\u4fee\u6539\u91c7\u96c6\u7684\u6587\u4ef6\u4e2a\u6570\u3001\u53d1\u9001\u5ba2\u6237\u7aef\u5e76\u53d1\u5ea6\uff08\u914d\u7f6eFilebeat worker\u548cLoggie parallelism)\uff0c\u89c2\u5bdf\u5404\u81ea\u7684CPU\u3001Memory\u548cPod\u7f51\u5361\u53d1\u9001\u901f\u7387\u3002 \u6d4b\u8bd5\u5f97\u5230\u5982\u4e0b\u6570\u636e\uff1a Agent \u6587\u4ef6\u5927\u5c0f \u65e5\u5fd7\u6587\u4ef6\u6570 \u53d1\u9001\u5e76\u53d1\u5ea6 CPU MEM (rss) \u7f51\u5361\u53d1\u5305\u901f\u7387 Filebeat 3.2G 1 3 7.5~8.5c 63.8MiB 75.9MiB/s Filebeat 3.2G 1 8 10c 65MiB 70MiB/s Filebeat 3.2G 10 8 11c 65MiB 80MiB/s Loggie 3.2G 1 3 2.1c 60MiB 120MiB/s Loggie 3.2G 1 8 2.4c 68.7MiB 120MiB/s Loggie 3.2G 10 8 3.5c 70MiB 210MiB/s \u6d4b\u8bd5\u7ed3\u8bba\uff1a \u76f8\u540c\u538b\u6d4b\u6761\u4ef6\u548c\u573a\u666f\u4e0b\uff1a Loggie\u548cFilebeat\u6d88\u8017\u7684CPU\u76f8\u6bd4\uff0c\u5927\u6982\u4ec5\u4e3a\u540e\u8005\u7684\u00bc\uff0c\u540c\u65f6\u53d1\u9001\u541e\u5410\u91cf\u4e3a\u540e\u8005\u76841.6\uff5e2.6\u500d\u3002 Memory\u76f8\u5f53\uff0c\u5747\u5904\u4e8e\u8f83\u4f4e\u7684\u6c34\u51c6\u3002 Filebeat\u7684\u6781\u9650\u541e\u5410\u91cf\u5b58\u5728\u74f6\u9888\uff0c80MB/s\u540e\u5f88\u96be\u63d0\u5347\uff0c\u800cLoggie\u5219\u53ef\u4ee5\u8fbe\u5230200MiB/s\u4ee5\u4e0a\u3002","title":"\u5f00\u6e90\u9879\u76ee\u5bf9\u6bd4"},{"location":"user-guide/architecture/compare/#_1","text":"Loggie Filebeat Fluentd Logstash Flume \u5f00\u53d1\u8bed\u8a00 Golang Golang Ruby JRuby Java \u591aPipeline \u652f\u6301 \u5355\u961f\u5217 \u5355\u961f\u5217 \u652f\u6301 \u652f\u6301 \u591a\u8f93\u51fa\u6e90 \u652f\u6301 \u4e0d\u652f\u6301\uff0c\u4ec5\u4e00\u4e2aOutput \u914d\u7f6ecopy \u652f\u6301 \u652f\u6301 \u4e2d\u8f6c\u673a \u652f\u6301 \u4e0d\u652f\u6301 \u652f\u6301 \u652f\u6301 \u652f\u6301 \u65e5\u5fd7\u62a5\u8b66 \u652f\u6301 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 Kubernetes\u5bb9\u5668\u65e5\u5fd7\u91c7\u96c6 \u652f\u6301\u5bb9\u5668\u7684stdout\u548c\u5bb9\u5668\u5185\u90e8\u65e5\u5fd7\u6587\u4ef6 \u53ea\u652f\u6301\u5bb9\u5668stdout \u53ea\u652f\u6301\u5bb9\u5668stdout \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \u914d\u7f6e\u4e0b\u53d1 Kubernetes\u4e0b\u53ef\u901a\u8fc7CRD\u914d\u7f6e\uff0c\u4e3b\u673a\u573a\u666f\u914d\u7f6e\u4e2d\u5fc3\u9646\u7eed\u652f\u6301\u4e2d \u624b\u52a8\u914d\u7f6e \u624b\u52a8\u914d\u7f6e \u624b\u52a8\u914d\u7f6e \u624b\u52a8\u914d\u7f6e \u76d1\u63a7 \u539f\u751f\u652f\u6301Prometheus metrics\uff0c\u540c\u65f6\u53ef\u914d\u7f6e\u5355\u72ec\u8f93\u51fa\u6307\u6807\u65e5\u5fd7\u6587\u4ef6\u3001\u53d1\u9001metrics\u7b49\u65b9\u5f0f API\u63a5\u53e3\u66b4\u9732\uff0c\u63a5\u5165Prometheus\u9700\u4f7f\u7528\u989d\u5916\u7684exporter \u652f\u6301API\u548cPrometheus metrics \u9700\u4f7f\u7528\u989d\u5916\u7684exporter \u9700\u4f7f\u7528\u989d\u5916\u7684exporter \u8d44\u6e90\u5360\u7528 \u4f4e \u4f4e \u4e00\u822c \u8f83\u9ad8 \u8f83\u9ad8","title":"\u5f00\u6e90\u9879\u76ee\u5bf9\u6bd4"},{"location":"user-guide/architecture/compare/#_2","text":"\u6d4b\u8bd5\u73af\u5883\uff1a \u7269\u7406\u673a 48C\uff0c256G Kafka 3 Broker\uff0c\u6302\u8f7dSSD\u76d8 Filebeat v7.8\u7248\u672c\uff0c\u65e0\u914d\u7f6eprocessor\u7b49\u5904\u7406\uff1bLoggie\u9ed8\u8ba4\u5305\u542bcost\u3001retry\u3001metric interceptor\uff1b \u6d4b\u8bd5\u76ee\u7684\uff1a Filebeat\u548cLoggie\u7684\u6027\u80fd\u5bf9\u6bd4 \u6d4b\u8bd5\u601d\u8def\uff1a Filebeat\u548cLoggie\uff0c\u5747\u91c7\u96c6\u65e5\u5fd7\u53d1\u9001\u81f3Kafka\uff0c\u89c2\u5bdf\u76f8\u5e94\u7684\u8d44\u6e90\u5360\u7528\u548c\u53d1\u9001\u541e\u5410\u91cf \u6d4b\u8bd5\u8be6\u60c5\uff1a \u5355\u6587\u4ef6\u81ea\u52a8\u751f\u62105000000\u884c\u65e5\u5fd7\uff0c\u6bcf\u884c\u5185\u5bb9\u5982\u4e0b\u6240\u793a\uff1a [13/May/2021:10:20:29 +0800] 0.015 10.200.170.107 \"GET /static/3tJHS3Ubrf.html?activity_channel_id=22=1_00000&fromMiniapp=1&miniapp_uuid=uEd93lG2eG8Qj5fRXuiJwNt4bmiylkmg HTTP/1.1\" 200 138957 \"110.183.45.54, 10.200.151.37\" act.you.163.com \"\" \"Mozilla/5.0 (Linux; Android 8.1.0; PADM00Build/O11019; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/67.0.3396.87 XWEB/568 MMWEBSDK/190102 Mobile Safari/537.36 MMWEBID/6881 MicroMessenger/7.0.3.1400(0x2700033B) Process/appbrand0 NetType/WIFI Language/zh_CN miniProgram\" \"\" [127.0.0.1:8990] [0.014] [] [] immsg={\"st\":1553307293614,\"sb\":138963,\"rc\":200,\"cf\":{\"sr\":1},\"if\":\"default\",\"ut\":14,\"sv\":\"static\",\"pd\":\"activity\",\"qb\":764} \u914d\u7f6eFilebeat\u548cLoggie\u91c7\u96c6\u65e5\u5fd7\uff0c\u5e76\u53d1\u9001\u81f3Kafka\u67d0\u4e2aTopic\uff0c\u4e0d\u4f7f\u7528\u5ba2\u6237\u7aef\u538b\u7f29\uff0cKafka Topic\u914d\u7f6ePartition\u4e3a3\u3002 \u5728\u4fdd\u8bc1Agent\u89c4\u683c\u8d44\u6e90\u5145\u8db3\u7684\u60c5\u51b5\u4e0b\uff0c\u4fee\u6539\u91c7\u96c6\u7684\u6587\u4ef6\u4e2a\u6570\u3001\u53d1\u9001\u5ba2\u6237\u7aef\u5e76\u53d1\u5ea6\uff08\u914d\u7f6eFilebeat worker\u548cLoggie parallelism)\uff0c\u89c2\u5bdf\u5404\u81ea\u7684CPU\u3001Memory\u548cPod\u7f51\u5361\u53d1\u9001\u901f\u7387\u3002 \u6d4b\u8bd5\u5f97\u5230\u5982\u4e0b\u6570\u636e\uff1a Agent \u6587\u4ef6\u5927\u5c0f \u65e5\u5fd7\u6587\u4ef6\u6570 \u53d1\u9001\u5e76\u53d1\u5ea6 CPU MEM (rss) \u7f51\u5361\u53d1\u5305\u901f\u7387 Filebeat 3.2G 1 3 7.5~8.5c 63.8MiB 75.9MiB/s Filebeat 3.2G 1 8 10c 65MiB 70MiB/s Filebeat 3.2G 10 8 11c 65MiB 80MiB/s Loggie 3.2G 1 3 2.1c 60MiB 120MiB/s Loggie 3.2G 1 8 2.4c 68.7MiB 120MiB/s Loggie 3.2G 10 8 3.5c 70MiB 210MiB/s \u6d4b\u8bd5\u7ed3\u8bba\uff1a \u76f8\u540c\u538b\u6d4b\u6761\u4ef6\u548c\u573a\u666f\u4e0b\uff1a Loggie\u548cFilebeat\u6d88\u8017\u7684CPU\u76f8\u6bd4\uff0c\u5927\u6982\u4ec5\u4e3a\u540e\u8005\u7684\u00bc\uff0c\u540c\u65f6\u53d1\u9001\u541e\u5410\u91cf\u4e3a\u540e\u8005\u76841.6\uff5e2.6\u500d\u3002 Memory\u76f8\u5f53\uff0c\u5747\u5904\u4e8e\u8f83\u4f4e\u7684\u6c34\u51c6\u3002 Filebeat\u7684\u6781\u9650\u541e\u5410\u91cf\u5b58\u5728\u74f6\u9888\uff0c80MB/s\u540e\u5f88\u96be\u63d0\u5347\uff0c\u800cLoggie\u5219\u53ef\u4ee5\u8fbe\u5230200MiB/s\u4ee5\u4e0a\u3002","title":"\u57fa\u51c6\u6027\u80fd\u6d4b\u8bd5\u4e0e\u5bf9\u6bd4"},{"location":"user-guide/architecture/core-arch/","text":"\u8bbe\u8ba1\u67b6\u6784 \u00b6 \u5185\u90e8\u8bbe\u8ba1 \u00b6 Loggie\u8be6\u7ec6\u7684\u8bbe\u8ba1\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u6570\u636e\u94fe\u8def : \u652f\u6301\u591apipeline\uff0c\u6bcf\u4e2apipeline\u76f8\u5bf9\u72ec\u7acb \u6bcf\u4e2apipeline\u6709\u591a\u4e2asource\u3001\u4e00\u4e2aqueue\u548c\u4e00\u4e2asink interceptor\u5b9e\u9645\u4e0a\u5206\u4e3asource interceptor\u548csink interceptor\u4e24\u79cd\u4e0d\u540c\u7c7b\u578b\uff0csource\u7c7b\u7684interceptor\u53ef\u914d\u7f6e\u88ab\u67d0\u4e2asource\u72ec\u5360 \u63a7\u5236\u94fe\u8def : \u76ee\u524d\u6709Kubernetes\u4e3a\u914d\u7f6e\u4e2d\u5fc3\uff0c\u53ef\u4ee5\u901a\u8fc7CRD\u7684\u65b9\u5f0f\u4e0b\u53d1\u65e5\u5fd7\u914d\u7f6e\uff0c\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u624b\u52a8\u914d\u7f6e\u6587\u4ef6 \u6253\u5f00Reloader\u53ef\u4ee5\u52a8\u6001\u68c0\u6d4b\u914d\u7f6e\u53d8\u52a8\u5e76\u91cd\u8f7d \u7ec4\u4ef6\u53ef\u53d1\u9001\u5bf9\u5e94topic\u7684metrics\uff0c\u7531listener\u6765\u6d88\u8d39\u5904\u7406\uff0c\u5e76\u8fdb\u4e00\u6b65\u66b4\u9732\u6216\u8005\u53d1\u9001\u6307\u6807 \u4f7f\u7528\u5f62\u6001 \u00b6 \u672c\u8d28\u4e0aLoggie\u662f\u4e00\u4e2a\u6570\u636e\u4f20\u8f93\u6d41\u5f0f\u8bbe\u8ba1\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7075\u6d3b\u7684\u4f7f\u7528Loggie\u7684Pipeline\u3002\u4ece\u4f7f\u7528\u5f62\u6001\u4e0a\u53ef\u5206\u4e3a\uff1a Agent \u5f62\u6001\uff1a\u6bcf\u4e2a\u8282\u70b9\u4e00\u4e2a\u6216\u8005\u6bcf\u4e2aPod\u4e00\u4e2a\uff0c\u7528\u4e8e\u91c7\u96c6\u914d\u7f6e\u7684\u65e5\u5fd7\u6216\u8005\u5176\u4ed6\u6570\u636e Aggregator \u5f62\u6001\uff1a\u7528\u4e8e\u4e2d\u8f6c\u548c\u8f6c\u53d1\uff0c\u53ef\u72ec\u7acb\u90e8\u7f72\u6210\u96c6\u7fa4 \u9664\u4e86\u65e5\u5fd7\u91c7\u96c6\uff0c\u5f88\u591a\u6d89\u53ca\u5230\u6570\u636e\u4f20\u8f93\u3001\u8f6c\u6362\u7684\u573a\u666f\uff0c\u90fd\u53ef\u4ee5\u8003\u8651\u4f7f\u7528Loggie\uff0c\u5373\u4f7fLoggie\u6ca1\u6709\u4f60\u60f3\u8981\u7684\u7ec4\u4ef6\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5feb\u901f\u5f00\u53d1\u4e00\u4e2asource\u3001sink\u6216interceptor\uff0c\u540c\u65f6\u590d\u7528Loggie\u7684\u5f88\u591a\u80fd\u529b\uff0c\u907f\u514d\u91cd\u590d\u7684\u5f00\u53d1\u5de5\u4f5c\uff0c\u6bd4\u5982\uff1a \u5728Kubernetes\u96c6\u7fa4\u4e2d\u53ef\u65b9\u4fbf\u3001\u76f4\u63a5\u7684\u4f7f\u7528CRD\u4e0b\u53d1\u914d\u7f6e\uff0c\u5e76\u4e14\u652f\u6301\u81ea\u52a8reload\u3001\u652f\u6301\u6307\u5b9aLoggie\u96c6\u7fa4\uff0c\u65e0\u9700\u8003\u8651\u90e8\u7f72\u3001\u914d\u7f6e\u66f4\u65b0\u7b49\u95ee\u9898 \u4f9d\u8d56Loggie\u63d0\u4f9b\u4f20\u8f93\u8fc7\u7a0b\u7684\u7a33\u5b9a\u6027\u548c\u53ef\u9760\u6027\uff0c\u4fdd\u8bc1at-least-once\u548c\u91cd\u8bd5\u673a\u5236\uff0c\u907f\u514d\u6570\u636e\u4e22\u5931\uff0c\u4ee5\u53ca\u6570\u636e\u91cf\u8fc7\u591a\u6216\u8fc7\u5927\u9020\u6210\u7684\u9690\u60a3 \u4f7f\u7528Loggie\u63d0\u4f9b\u7684\u4e00\u7cfb\u5217\u76d1\u63a7\u6307\u6807\uff0c\u6bd4\u5982\u961f\u5217\u957f\u5ea6\u3001\u4f20\u8f93\u5ef6\u8fdf\u3001\u53d1\u9001QPS\u7b49\uff0c\u53ef\u5feb\u901f\u63a5\u5165Prometheus\uff0c\u540c\u65f6\u8fd8\u53ef\u4f7f\u7528\u4e00\u4e9b\u7cfb\u7edf\u5185\u7f6e\u7684\u5feb\u901f\u6392\u969c\u7684\u63a5\u53e3\u4e0e\u80fd\u529b \u4f7f\u7528\u53ef\u63d2\u62d4\u7684Interceptor\u53ef\u7528\u4e8e\u81ea\u5b9a\u4e49\u7684\u6570\u636e\u5904\u7406\u3001\u683c\u5f0f\u8f6c\u6362\u7b49\uff0c\u907f\u514d\u8fc7\u591a\u7684\u5b9a\u5236\u5316\u4ee3\u7801\u5f00\u53d1 ... \u5e94\u7528\u573a\u666f \u00b6 \u65e5\u5fd7\u91c7\u96c6\uff1a\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\u3001\u91c7\u96c6\u8282\u70b9\u65e5\u5fd7 \u6570\u636e\u4e2d\u8f6c\uff1a\u65e5\u5fd7\u4e2d\u8f6c\u673a\u805a\u5408\u3001\u8f6c\u53d1\u3001\u5206\u6d41 \u6570\u636e\u5904\u7406\uff1a\u8fdb\u884c\u6570\u636e\u7684\u5207\u5206\u3001\u8f6c\u6362\u3001\u5904\u7406 \u65e5\u5fd7\u62a5\u8b66\uff1a\u8fdb\u884c\u5f02\u5e38\u65e5\u5fd7\u7684\u68c0\u6d4b\u4e0e\u62a5\u8b66 ...","title":"\u8bbe\u8ba1\u67b6\u6784"},{"location":"user-guide/architecture/core-arch/#_1","text":"","title":"\u8bbe\u8ba1\u67b6\u6784"},{"location":"user-guide/architecture/core-arch/#_2","text":"Loggie\u8be6\u7ec6\u7684\u8bbe\u8ba1\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u6570\u636e\u94fe\u8def : \u652f\u6301\u591apipeline\uff0c\u6bcf\u4e2apipeline\u76f8\u5bf9\u72ec\u7acb \u6bcf\u4e2apipeline\u6709\u591a\u4e2asource\u3001\u4e00\u4e2aqueue\u548c\u4e00\u4e2asink interceptor\u5b9e\u9645\u4e0a\u5206\u4e3asource interceptor\u548csink interceptor\u4e24\u79cd\u4e0d\u540c\u7c7b\u578b\uff0csource\u7c7b\u7684interceptor\u53ef\u914d\u7f6e\u88ab\u67d0\u4e2asource\u72ec\u5360 \u63a7\u5236\u94fe\u8def : \u76ee\u524d\u6709Kubernetes\u4e3a\u914d\u7f6e\u4e2d\u5fc3\uff0c\u53ef\u4ee5\u901a\u8fc7CRD\u7684\u65b9\u5f0f\u4e0b\u53d1\u65e5\u5fd7\u914d\u7f6e\uff0c\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u624b\u52a8\u914d\u7f6e\u6587\u4ef6 \u6253\u5f00Reloader\u53ef\u4ee5\u52a8\u6001\u68c0\u6d4b\u914d\u7f6e\u53d8\u52a8\u5e76\u91cd\u8f7d \u7ec4\u4ef6\u53ef\u53d1\u9001\u5bf9\u5e94topic\u7684metrics\uff0c\u7531listener\u6765\u6d88\u8d39\u5904\u7406\uff0c\u5e76\u8fdb\u4e00\u6b65\u66b4\u9732\u6216\u8005\u53d1\u9001\u6307\u6807","title":"\u5185\u90e8\u8bbe\u8ba1"},{"location":"user-guide/architecture/core-arch/#_3","text":"\u672c\u8d28\u4e0aLoggie\u662f\u4e00\u4e2a\u6570\u636e\u4f20\u8f93\u6d41\u5f0f\u8bbe\u8ba1\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7075\u6d3b\u7684\u4f7f\u7528Loggie\u7684Pipeline\u3002\u4ece\u4f7f\u7528\u5f62\u6001\u4e0a\u53ef\u5206\u4e3a\uff1a Agent \u5f62\u6001\uff1a\u6bcf\u4e2a\u8282\u70b9\u4e00\u4e2a\u6216\u8005\u6bcf\u4e2aPod\u4e00\u4e2a\uff0c\u7528\u4e8e\u91c7\u96c6\u914d\u7f6e\u7684\u65e5\u5fd7\u6216\u8005\u5176\u4ed6\u6570\u636e Aggregator \u5f62\u6001\uff1a\u7528\u4e8e\u4e2d\u8f6c\u548c\u8f6c\u53d1\uff0c\u53ef\u72ec\u7acb\u90e8\u7f72\u6210\u96c6\u7fa4 \u9664\u4e86\u65e5\u5fd7\u91c7\u96c6\uff0c\u5f88\u591a\u6d89\u53ca\u5230\u6570\u636e\u4f20\u8f93\u3001\u8f6c\u6362\u7684\u573a\u666f\uff0c\u90fd\u53ef\u4ee5\u8003\u8651\u4f7f\u7528Loggie\uff0c\u5373\u4f7fLoggie\u6ca1\u6709\u4f60\u60f3\u8981\u7684\u7ec4\u4ef6\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5feb\u901f\u5f00\u53d1\u4e00\u4e2asource\u3001sink\u6216interceptor\uff0c\u540c\u65f6\u590d\u7528Loggie\u7684\u5f88\u591a\u80fd\u529b\uff0c\u907f\u514d\u91cd\u590d\u7684\u5f00\u53d1\u5de5\u4f5c\uff0c\u6bd4\u5982\uff1a \u5728Kubernetes\u96c6\u7fa4\u4e2d\u53ef\u65b9\u4fbf\u3001\u76f4\u63a5\u7684\u4f7f\u7528CRD\u4e0b\u53d1\u914d\u7f6e\uff0c\u5e76\u4e14\u652f\u6301\u81ea\u52a8reload\u3001\u652f\u6301\u6307\u5b9aLoggie\u96c6\u7fa4\uff0c\u65e0\u9700\u8003\u8651\u90e8\u7f72\u3001\u914d\u7f6e\u66f4\u65b0\u7b49\u95ee\u9898 \u4f9d\u8d56Loggie\u63d0\u4f9b\u4f20\u8f93\u8fc7\u7a0b\u7684\u7a33\u5b9a\u6027\u548c\u53ef\u9760\u6027\uff0c\u4fdd\u8bc1at-least-once\u548c\u91cd\u8bd5\u673a\u5236\uff0c\u907f\u514d\u6570\u636e\u4e22\u5931\uff0c\u4ee5\u53ca\u6570\u636e\u91cf\u8fc7\u591a\u6216\u8fc7\u5927\u9020\u6210\u7684\u9690\u60a3 \u4f7f\u7528Loggie\u63d0\u4f9b\u7684\u4e00\u7cfb\u5217\u76d1\u63a7\u6307\u6807\uff0c\u6bd4\u5982\u961f\u5217\u957f\u5ea6\u3001\u4f20\u8f93\u5ef6\u8fdf\u3001\u53d1\u9001QPS\u7b49\uff0c\u53ef\u5feb\u901f\u63a5\u5165Prometheus\uff0c\u540c\u65f6\u8fd8\u53ef\u4f7f\u7528\u4e00\u4e9b\u7cfb\u7edf\u5185\u7f6e\u7684\u5feb\u901f\u6392\u969c\u7684\u63a5\u53e3\u4e0e\u80fd\u529b \u4f7f\u7528\u53ef\u63d2\u62d4\u7684Interceptor\u53ef\u7528\u4e8e\u81ea\u5b9a\u4e49\u7684\u6570\u636e\u5904\u7406\u3001\u683c\u5f0f\u8f6c\u6362\u7b49\uff0c\u907f\u514d\u8fc7\u591a\u7684\u5b9a\u5236\u5316\u4ee3\u7801\u5f00\u53d1 ...","title":"\u4f7f\u7528\u5f62\u6001"},{"location":"user-guide/architecture/core-arch/#_4","text":"\u65e5\u5fd7\u91c7\u96c6\uff1a\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\u3001\u91c7\u96c6\u8282\u70b9\u65e5\u5fd7 \u6570\u636e\u4e2d\u8f6c\uff1a\u65e5\u5fd7\u4e2d\u8f6c\u673a\u805a\u5408\u3001\u8f6c\u53d1\u3001\u5206\u6d41 \u6570\u636e\u5904\u7406\uff1a\u8fdb\u884c\u6570\u636e\u7684\u5207\u5206\u3001\u8f6c\u6362\u3001\u5904\u7406 \u65e5\u5fd7\u62a5\u8b66\uff1a\u8fdb\u884c\u5f02\u5e38\u65e5\u5fd7\u7684\u68c0\u6d4b\u4e0e\u62a5\u8b66 ...","title":"\u5e94\u7528\u573a\u666f"},{"location":"user-guide/architecture/schema/","text":"\u6570\u636e\u683c\u5f0f \u00b6 Info \u4e86\u89e3Loggie\u5185\u90e8\u6570\u636e\u683c\u5f0f\u7684\u8bbe\u8ba1\uff0c\u80fd\u5e2e\u52a9\u6211\u4eec\u914d\u7f6e\u5408\u9002\u7684\u65e5\u5fd7\u5904\u7406\u548c\u65e5\u5fd7\u683c\u5f0f\u8f6c\u6362 \u7ed3\u6784\u8bbe\u8ba1 \u00b6 \u5728Loggie\u5185\u90e8\u7684\u65e5\u5fd7\u6570\u636e\uff0c\u5305\u62ec\uff1a body : source\u63a5\u6536\u7684\u539f\u59cb\u6570\u636e\u3002\u6bd4\u5982\u4f7f\u7528file source\u91c7\u96c6\u7684\u65e5\u5fd7\u6587\u4ef6\u91cc\u7684\u4e00\u884c\u65e5\u5fd7\u6570\u636e header : \u7528\u6237\u4f7f\u7528\u7684\u5b57\u6bb5\u3002\u6bd4\u5982\u7528\u6237\u81ea\u5df1\u6dfb\u52a0\u5230source\u91cc\u7684fields\u5b57\u6bb5\uff0c\u7528\u6237\u5207\u5206\u65e5\u5fd7\u540e\u5f97\u5230\u7684\u5b57\u6bb5\u7b49 meta : Loggie\u7cfb\u7edf\u5185\u7f6e\u7684\u5143\u4fe1\u606f\uff0c\u9ed8\u8ba4\u4e0d\u4f1a\u53d1\u9001\u7ed9\u4e0b\u6e38 \u683c\u5f0f\u8f6c\u6362 \u00b6 \u5982\u679c\u4ee5\u4e0a\u7684\u683c\u5f0f\u4e0d\u6ee1\u8db3\u9700\u6c42\uff0c\u53ef\u4ee5\u53c2\u8003\uff1a \u65e5\u5fd7\u5143\u4fe1\u606f \u65e5\u5fd7\u5207\u5206 \u00b6 \u5bf9\u4e8e\u539f\u59cb\u65e5\u5fd7\u6570\u636e\u7684\u5207\u5206\u4e0e\u5904\u7406\uff0c\u8bf7\u4f7f\u7528 normalize interceptor \uff0c\u8bf7\u53c2\u8003\uff1a \u65e5\u5fd7\u5207\u5206\u5904\u7406","title":"\u6570\u636e\u683c\u5f0f"},{"location":"user-guide/architecture/schema/#_1","text":"Info \u4e86\u89e3Loggie\u5185\u90e8\u6570\u636e\u683c\u5f0f\u7684\u8bbe\u8ba1\uff0c\u80fd\u5e2e\u52a9\u6211\u4eec\u914d\u7f6e\u5408\u9002\u7684\u65e5\u5fd7\u5904\u7406\u548c\u65e5\u5fd7\u683c\u5f0f\u8f6c\u6362","title":"\u6570\u636e\u683c\u5f0f"},{"location":"user-guide/architecture/schema/#_2","text":"\u5728Loggie\u5185\u90e8\u7684\u65e5\u5fd7\u6570\u636e\uff0c\u5305\u62ec\uff1a body : source\u63a5\u6536\u7684\u539f\u59cb\u6570\u636e\u3002\u6bd4\u5982\u4f7f\u7528file source\u91c7\u96c6\u7684\u65e5\u5fd7\u6587\u4ef6\u91cc\u7684\u4e00\u884c\u65e5\u5fd7\u6570\u636e header : \u7528\u6237\u4f7f\u7528\u7684\u5b57\u6bb5\u3002\u6bd4\u5982\u7528\u6237\u81ea\u5df1\u6dfb\u52a0\u5230source\u91cc\u7684fields\u5b57\u6bb5\uff0c\u7528\u6237\u5207\u5206\u65e5\u5fd7\u540e\u5f97\u5230\u7684\u5b57\u6bb5\u7b49 meta : Loggie\u7cfb\u7edf\u5185\u7f6e\u7684\u5143\u4fe1\u606f\uff0c\u9ed8\u8ba4\u4e0d\u4f1a\u53d1\u9001\u7ed9\u4e0b\u6e38","title":"\u7ed3\u6784\u8bbe\u8ba1"},{"location":"user-guide/architecture/schema/#_3","text":"\u5982\u679c\u4ee5\u4e0a\u7684\u683c\u5f0f\u4e0d\u6ee1\u8db3\u9700\u6c42\uff0c\u53ef\u4ee5\u53c2\u8003\uff1a \u65e5\u5fd7\u5143\u4fe1\u606f","title":"\u683c\u5f0f\u8f6c\u6362"},{"location":"user-guide/architecture/schema/#_4","text":"\u5bf9\u4e8e\u539f\u59cb\u65e5\u5fd7\u6570\u636e\u7684\u5207\u5206\u4e0e\u5904\u7406\uff0c\u8bf7\u4f7f\u7528 normalize interceptor \uff0c\u8bf7\u53c2\u8003\uff1a \u65e5\u5fd7\u5207\u5206\u5904\u7406","title":"\u65e5\u5fd7\u5207\u5206"},{"location":"user-guide/best-practice/aggregator/","text":"\u4f7f\u7528Loggie\u4e2d\u8f6c\u673a \u00b6 Loggie\u53ef\u4ee5\u90e8\u7f72\u4e3aAgent\uff0c\u540c\u65f6\u652f\u6301\u72ec\u7acb\u90e8\u7f72\uff0c\u8fdb\u884c\u805a\u5408\u3001\u8f6c\u53d1\u548c\u5904\u7406\u3002 \u51c6\u5907\uff1a\u9009\u62e9\u67b6\u6784 \u00b6 \u4f7f\u7528\u4e2d\u8f6c\u673a\u67b6\u6784\u7684\u65b9\u5f0f\u4e00\u822c\u6709\u591a\u79cd\uff0c\u5e38\u89c1\u7684\u6709\uff1a Agent -> Aggregator : Agent\u76f4\u63a5\u53d1\u9001\u81f3Aggregator\uff0cAggregator\u518d\u53d1\u9001\u81f3\u540e\u7aef\u5b58\u50a8\u3002 Agent -> MQ -> Aggregator : Agent\u53d1\u9001\u81f3\u6d88\u606f\u961f\u5217\uff0c\u6bd4\u5982Kafka\uff0c\u7136\u540eAggregator\u518d\u6d88\u8d39Kafka\u6d88\u606f\u53d1\u9001\u81f3\u540e\u7aef\u3002 \u662f\u5426\u5f15\u5165Kafka\u7b49\u6d88\u606f\u961f\u5217\uff0c\u4e3b\u8981\u53d6\u51b3\u4e8e\u81ea\u8eab\u7684\u573a\u666f\u9700\u6c42\u548c\u6570\u636e\u7684\u91cf\u7ea7\u3002 \u51c6\u5907\uff1a\u90e8\u7f72 \u00b6 \u90e8\u7f72Agent \u90e8\u7f72 Aggregator \u90e8\u7f72\u4e3aAggregator\u7c7b\u578b\u65f6\uff0c\u8bf7\u52a1\u5fc5\u5728Kubernetes\u914d\u7f6e\u4e2d\u6307\u5b9a cluster \u96c6\u7fa4\u540d\u79f0\u3002 \u4e3a\u4e86\u67e5\u770b\u8f93\u51fa\u65e5\u5fd7\u66f4\u52a0\u65b9\u4fbf\uff0c\u53ef\u4ee5\u5728Loggie\u7684\u542f\u52a8\u53c2\u6570\u4e2d\u52a0\u4e0a -log.jsonFormat=false \uff0c\u4f7f\u7528\u975ejson\u683c\u5f0f\u7684\u65e5\u5fd7\u6253\u5370\u3002 \u914d\u7f6e\u4f7f\u7528 \u00b6 Agent \u00b6 \u91c7\u96c6\u65e5\u5fd7\u7684LogConfig\u914d\u7f6e\u65e0\u533a\u522b\uff0c\u53ea\u9700\u8981\u4fee\u6539sink\u53d1\u9001\u81f3Loggie Aggregator\u6216\u8005Kafka\u5373\u53ef\u3002 \u5982\u679c\u4ec5\u4ec5\u4fee\u6539 sink \u6216\u8005 interceptor CR\u672c\u8eab\u4e0d\u4f1a\u7acb\u5373\u540c\u6b65\u5230\u5df2\u7ecf\u4f7f\u7528\u7684LogConfig\u91cc\uff0c\u53ea\u6709\u7b49\u5f85\u67d0\u4e9b\u4e8b\u4ef6\u89e6\u53d1\u540e\uff08LogConfig\u672c\u8eab\u88ab\u4fee\u6539\u3001\u5173\u8054Pod\u6709\u91cd\u5efa\u7b49\uff09\u624d\u4f1a\u88ab\u5237\u65b0\u914d\u7f6e\u3002\u5982\u679c\u9700\u8981\u7acb\u523b\u66f4\u65b0\uff0c\u53ef\u4ee5\u8003\u8651\u91cd\u542fLoggie\u672c\u8eab\u3002 \u88ab\u91c7\u96c6\u7684\u5bb9\u5668\u521b\u5efa\u4ee5\u53ca\u5339\u914d\u7684LogConfig\uff0c\u8bf7\u53c2\u8003 Loggie\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7 \u3002 \u8fd9\u91cc\u6211\u4eec\u5c06\u5176\u4e2d\u7684sink\u4fee\u6539\u4e3a\u4ee5\u4e0b\u793a\u4f8b\uff1a Example Aggregator apiVersion : loggie.io/v1beta1 kind : Sink metadata : name : aggregator spec : sink : | type: grpc host: \"loggie-aggregator.loggie-aggregator:6166\" Kafka apiVersion : loggie.io/v1beta1 kind : Sink metadata : name : kafka spec : sink : | type: kafka brokers: [\"127.0.0.1:6400\"] topic: \"log-${fields.topic}\" Aggregator \u00b6 \u914d\u7f6eLogConfig\u4e0b\u53d1\u81f3Aggregator\u672c\u8d28\u4e0a\u548cAgent\u4fa7\u65e0\u533a\u522b\uff0c\u53ea\u9700\u8981\u4fee\u6539\u5176\u4e2d selector \u90e8\u5206\u3002 \u7c7b\u4f3c\u5982\u4e0b\uff1a Example apiVersion : loggie.io/v1beta1 kind : ClusterLogConfig metadata : name : aggre spec : selector : type : cluster cluster : aggregator pipeline : sources : | - type: grpc name: rec1 port: 6066 sinkRef : dev apiVersion : loggie.io/v1beta1 kind : Sink metadata : name : dev spec : sink : | type: dev printEvents: true codec: type: json pretty: true type: cluster \u8868\u793a\u9009\u62e9\u4e0b\u53d1\u914d\u7f6e\u5230 cluster \u6307\u5b9a\u7684Loggie\u96c6\u7fa4\uff0c\u5373\u6211\u4eec\u521a\u90e8\u7f72\u7684\u4e2d\u8f6c\u673a\u96c6\u7fa4\uff0c\u5982\u679c\u4e0d\u586b\u5199\u4f1a\u5c06\u914d\u7f6e\u6307\u5b9a\u5230\u9ed8\u8ba4\u7684Agent\u96c6\u7fa4\uff0c\u5bfc\u81f4\u65e0\u6cd5\u751f\u6548\u3002 \u8fd9\u91cc\u7684source\u4e3aGrpc\uff0c\u63a5\u6536Agent Grpc sink\u53d1\u51fa\u7684\u6570\u636e\uff0c\u7136\u540e\u8f6c\u53d1\u81f3\u81ea\u8eabsinkRef\u6307\u5b9a\u7684sink\u4e2d\u3002\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2adev sink\u7528\u4e8e\u67e5\u770b\u4e2d\u8f6c\u673a\u8f93\u51fa\u7684\u6570\u636e\u3002 \u67e5\u770b\u65e5\u5fd7 \u00b6 \u901a\u8fc7 kubectl -nloggie-aggregator logs -f <podName> --tail=200 \u547d\u4ee4\u3002 \u53ef\u4ee5\u5728\u4e2d\u8f6c\u673a\u8282\u70b9\u4e0a\u67e5\u770b\u5230\u7c7b\u4f3c\u5982\u4e0b\u65e5\u5fd7\uff1a events 2021-12-20 09 : 58 : 50 INF go/src/loggie.io/loggie/pkg/si n k/dev/si n k.go : 98 > eve nt : { \"body\" : \"14-Dec-2021 06:19:58.306 INFO [main] org.apache.catalina.startup.Catalina.start Server startup in [141] milliseconds\" , \"fields\" : { \"podname\" : \"tomcat-684c698b66-gkrfs\" , \"containername\" : \"tomcat\" , \"logconfig\" : \"tomcat\" , \"namespace\" : \"default\" , \"nodename\" : \"kind-control-plane\" }, }","title":"\u4f7f\u7528Loggie\u4e2d\u8f6c\u673a"},{"location":"user-guide/best-practice/aggregator/#loggie","text":"Loggie\u53ef\u4ee5\u90e8\u7f72\u4e3aAgent\uff0c\u540c\u65f6\u652f\u6301\u72ec\u7acb\u90e8\u7f72\uff0c\u8fdb\u884c\u805a\u5408\u3001\u8f6c\u53d1\u548c\u5904\u7406\u3002","title":"\u4f7f\u7528Loggie\u4e2d\u8f6c\u673a"},{"location":"user-guide/best-practice/aggregator/#_1","text":"\u4f7f\u7528\u4e2d\u8f6c\u673a\u67b6\u6784\u7684\u65b9\u5f0f\u4e00\u822c\u6709\u591a\u79cd\uff0c\u5e38\u89c1\u7684\u6709\uff1a Agent -> Aggregator : Agent\u76f4\u63a5\u53d1\u9001\u81f3Aggregator\uff0cAggregator\u518d\u53d1\u9001\u81f3\u540e\u7aef\u5b58\u50a8\u3002 Agent -> MQ -> Aggregator : Agent\u53d1\u9001\u81f3\u6d88\u606f\u961f\u5217\uff0c\u6bd4\u5982Kafka\uff0c\u7136\u540eAggregator\u518d\u6d88\u8d39Kafka\u6d88\u606f\u53d1\u9001\u81f3\u540e\u7aef\u3002 \u662f\u5426\u5f15\u5165Kafka\u7b49\u6d88\u606f\u961f\u5217\uff0c\u4e3b\u8981\u53d6\u51b3\u4e8e\u81ea\u8eab\u7684\u573a\u666f\u9700\u6c42\u548c\u6570\u636e\u7684\u91cf\u7ea7\u3002","title":"\u51c6\u5907\uff1a\u9009\u62e9\u67b6\u6784"},{"location":"user-guide/best-practice/aggregator/#_2","text":"\u90e8\u7f72Agent \u90e8\u7f72 Aggregator \u90e8\u7f72\u4e3aAggregator\u7c7b\u578b\u65f6\uff0c\u8bf7\u52a1\u5fc5\u5728Kubernetes\u914d\u7f6e\u4e2d\u6307\u5b9a cluster \u96c6\u7fa4\u540d\u79f0\u3002 \u4e3a\u4e86\u67e5\u770b\u8f93\u51fa\u65e5\u5fd7\u66f4\u52a0\u65b9\u4fbf\uff0c\u53ef\u4ee5\u5728Loggie\u7684\u542f\u52a8\u53c2\u6570\u4e2d\u52a0\u4e0a -log.jsonFormat=false \uff0c\u4f7f\u7528\u975ejson\u683c\u5f0f\u7684\u65e5\u5fd7\u6253\u5370\u3002","title":"\u51c6\u5907\uff1a\u90e8\u7f72"},{"location":"user-guide/best-practice/aggregator/#_3","text":"","title":"\u914d\u7f6e\u4f7f\u7528"},{"location":"user-guide/best-practice/aggregator/#agent","text":"\u91c7\u96c6\u65e5\u5fd7\u7684LogConfig\u914d\u7f6e\u65e0\u533a\u522b\uff0c\u53ea\u9700\u8981\u4fee\u6539sink\u53d1\u9001\u81f3Loggie Aggregator\u6216\u8005Kafka\u5373\u53ef\u3002 \u5982\u679c\u4ec5\u4ec5\u4fee\u6539 sink \u6216\u8005 interceptor CR\u672c\u8eab\u4e0d\u4f1a\u7acb\u5373\u540c\u6b65\u5230\u5df2\u7ecf\u4f7f\u7528\u7684LogConfig\u91cc\uff0c\u53ea\u6709\u7b49\u5f85\u67d0\u4e9b\u4e8b\u4ef6\u89e6\u53d1\u540e\uff08LogConfig\u672c\u8eab\u88ab\u4fee\u6539\u3001\u5173\u8054Pod\u6709\u91cd\u5efa\u7b49\uff09\u624d\u4f1a\u88ab\u5237\u65b0\u914d\u7f6e\u3002\u5982\u679c\u9700\u8981\u7acb\u523b\u66f4\u65b0\uff0c\u53ef\u4ee5\u8003\u8651\u91cd\u542fLoggie\u672c\u8eab\u3002 \u88ab\u91c7\u96c6\u7684\u5bb9\u5668\u521b\u5efa\u4ee5\u53ca\u5339\u914d\u7684LogConfig\uff0c\u8bf7\u53c2\u8003 Loggie\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7 \u3002 \u8fd9\u91cc\u6211\u4eec\u5c06\u5176\u4e2d\u7684sink\u4fee\u6539\u4e3a\u4ee5\u4e0b\u793a\u4f8b\uff1a Example Aggregator apiVersion : loggie.io/v1beta1 kind : Sink metadata : name : aggregator spec : sink : | type: grpc host: \"loggie-aggregator.loggie-aggregator:6166\" Kafka apiVersion : loggie.io/v1beta1 kind : Sink metadata : name : kafka spec : sink : | type: kafka brokers: [\"127.0.0.1:6400\"] topic: \"log-${fields.topic}\"","title":"Agent"},{"location":"user-guide/best-practice/aggregator/#aggregator","text":"\u914d\u7f6eLogConfig\u4e0b\u53d1\u81f3Aggregator\u672c\u8d28\u4e0a\u548cAgent\u4fa7\u65e0\u533a\u522b\uff0c\u53ea\u9700\u8981\u4fee\u6539\u5176\u4e2d selector \u90e8\u5206\u3002 \u7c7b\u4f3c\u5982\u4e0b\uff1a Example apiVersion : loggie.io/v1beta1 kind : ClusterLogConfig metadata : name : aggre spec : selector : type : cluster cluster : aggregator pipeline : sources : | - type: grpc name: rec1 port: 6066 sinkRef : dev apiVersion : loggie.io/v1beta1 kind : Sink metadata : name : dev spec : sink : | type: dev printEvents: true codec: type: json pretty: true type: cluster \u8868\u793a\u9009\u62e9\u4e0b\u53d1\u914d\u7f6e\u5230 cluster \u6307\u5b9a\u7684Loggie\u96c6\u7fa4\uff0c\u5373\u6211\u4eec\u521a\u90e8\u7f72\u7684\u4e2d\u8f6c\u673a\u96c6\u7fa4\uff0c\u5982\u679c\u4e0d\u586b\u5199\u4f1a\u5c06\u914d\u7f6e\u6307\u5b9a\u5230\u9ed8\u8ba4\u7684Agent\u96c6\u7fa4\uff0c\u5bfc\u81f4\u65e0\u6cd5\u751f\u6548\u3002 \u8fd9\u91cc\u7684source\u4e3aGrpc\uff0c\u63a5\u6536Agent Grpc sink\u53d1\u51fa\u7684\u6570\u636e\uff0c\u7136\u540e\u8f6c\u53d1\u81f3\u81ea\u8eabsinkRef\u6307\u5b9a\u7684sink\u4e2d\u3002\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2adev sink\u7528\u4e8e\u67e5\u770b\u4e2d\u8f6c\u673a\u8f93\u51fa\u7684\u6570\u636e\u3002","title":"Aggregator"},{"location":"user-guide/best-practice/aggregator/#_4","text":"\u901a\u8fc7 kubectl -nloggie-aggregator logs -f <podName> --tail=200 \u547d\u4ee4\u3002 \u53ef\u4ee5\u5728\u4e2d\u8f6c\u673a\u8282\u70b9\u4e0a\u67e5\u770b\u5230\u7c7b\u4f3c\u5982\u4e0b\u65e5\u5fd7\uff1a events 2021-12-20 09 : 58 : 50 INF go/src/loggie.io/loggie/pkg/si n k/dev/si n k.go : 98 > eve nt : { \"body\" : \"14-Dec-2021 06:19:58.306 INFO [main] org.apache.catalina.startup.Catalina.start Server startup in [141] milliseconds\" , \"fields\" : { \"podname\" : \"tomcat-684c698b66-gkrfs\" , \"containername\" : \"tomcat\" , \"logconfig\" : \"tomcat\" , \"namespace\" : \"default\" , \"nodename\" : \"kind-control-plane\" }, }","title":"\u67e5\u770b\u65e5\u5fd7"},{"location":"user-guide/best-practice/log-enrich/","text":"\u65e5\u5fd7\u589e\u52a0\u52a0\u5143\u4fe1\u606f \u00b6 \u5efa\u8bae\u5148\u4e86\u89e3Loggie\u5185\u90e8\u65e5\u5fd7\u6570\u636e schema\u8bbe\u8ba1 \u3002 \u9700\u6c42\u573a\u666f \u00b6 Loggie\u90e8\u7f72\u5728\u4e0d\u540c\u7684\u73af\u5883\u4e2d\uff0c\u5982\u679c\u9700\u8981\u5728\u539f\u59cb\u7684\u65e5\u5fd7\u6570\u636e\u91cc\uff0c\u589e\u52a0\u4e00\u4e9b\u5143\u4fe1\u606f\uff0c\u540c\u65f6\u517c\u5bb9\u5df2\u6709\u7684\u683c\u5f0f\uff0c\u53ef\u4ee5\u53c2\u8003\u5982\u4e0b\u7684\u529e\u6cd5\u3002 \u573a\u666f1: \u53d1\u9001\u539f\u59cb\u6570\u636e \u00b6 \u6b63\u5e38\u60c5\u51b5\uff0cLoggie\u4ec5\u5c06\u539f\u59cb\u6570\u636e\u53d1\u9001\u7ed9\u4e0b\u6e38\u3002 \u5982\u679c\u4f60\u914d\u7f6e\uff1a pipelines.yml pipelines : - name : local sources : - type : file name : demo paths : - /tmp/log/*.log sink : type : dev printEvents : true codec : pretty : true sink\u8f93\u51fa\u7684\u6570\u636e\u4ec5\u4e3a\u539f\u59cb\u6570\u636e\uff1a { \"body\" : \"01-Dec-2021 03:13:58.298 INFO [main] Starting service [Catalina]\" } \u573a\u666f2: \u6dfb\u52a0fields\u81ea\u5b9a\u4e49\u5143\u4fe1\u606f \u00b6 \u5982\u679c\u6211\u4eec\u5728source\u4e0a\u914d\u7f6e\u4e86\u4e00\u4e9b\u81ea\u5b9a\u4e49\u7684fields\u3002 pipelines.yml pipelines : - name : local sources : - type : file name : demo paths : - /tmp/log/*.log fields : topic : \"loggie\" sink : type : dev printEvents : true codec : pretty : true \u90a3\u4e48sink\u8f93\u51fa\u7684\u4e3a\uff1a { \"fields\" : { \"topic\" : \"loggie\" , }, \"body\" : \"01-Dec-2021 03:13:58.298 INFO [main] Starting service [Catalina]\" } \u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u914d\u7f6e fieldsUnderRoot: true \uff0c\u8ba9fields\u91cc\u7684 key:value \u548cbody\u540c\u4e00\u5c42\u7ea7\u3002 fields : topic : \"loggie\" fieldsUnderRoot : true { \"topic\" : \"loggie\" , \"body\" : \"01-Dec-2021 03:13:58.298 INFO [main] Starting service [Catalina]\" } \u573a\u666f3: \u6dfb\u52a0\u65e5\u5fd7\u91c7\u96c6file source\u7684\u72b6\u6001\u4fe1\u606f \u00b6 \u5728\u6211\u4eec\u4f7f\u7528file source\u65f6\uff0c\u53ef\u80fd\u5e0c\u671b\u81ea\u52a8\u5728\u65e5\u5fd7\u539f\u59cb\u6570\u636e\u91cc\uff0c\u589e\u52a0\u4e00\u4e9b\u65e5\u5fd7\u91c7\u96c6\u7684\u72b6\u6001\uff0c\u6bd4\u5982\u91c7\u96c6\u7684\u6587\u4ef6\u540d\u79f0\u3001\u91c7\u96c6\u7684\u6587\u4ef6offsest\u7b49\uff0cfile source\u63d0\u4f9b\u4e86\u4e00\u4e2a addonMeta \u914d\u7f6e\uff0c\u53ef\u5feb\u901fenable\u3002 \u793a\u4f8b\uff1a\u6dfb\u52a0\u5982\u4e0b addonMeta \uff0c\u5e76\u8bbe\u7f6e\u4e3atrue\u3002 file source sources : - type : file paths : - /var/log/*.log addonMeta : true \u6b64\u65f6\uff0c\u91c7\u96c6\u7684event\u4f1a\u53d8\u6210\u7c7b\u4f3c\u5982\u4e0b\uff1a Example { \"body\" : \"this is test\" , \"state\" : { \"pipeline\" : \"local\" , \"source\" : \"demo\" , \"filename\" : \"/var/log/a.log\" , \"timestamp\" : \"2006-01-02T15:04:05.000Z\" , \"offset\" : 1024 , \"bytes\" : 4096 , \"hostname\" : \"node-1\" } } \u5177\u4f53\u5b57\u6bb5\u542b\u4e49\u53ef\u53c2\u8003 file source \u573a\u666f4: \u589e\u52a0Kubernetes\u5143\u4fe1\u606f \u00b6 \u5728Kubernetes\u7684\u573a\u666f\u4e2d\uff0c\u91c7\u96c6\u7684\u5bb9\u5668\u65e5\u5fd7\uff0c\u4e3a\u4e86\u5728\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u4f7f\u7528namespace/podName\u7b49\u4fe1\u606f\u8fdb\u884c\u68c0\u7d22\uff0c\u5f80\u5f80\u9700\u8981\u589e\u52a0\u76f8\u5173\u7684\u5143\u6570\u636e\u3002 \u6211\u4eec\u53ef\u4ee5\u5728\u7cfb\u7edf\u914d\u7f6e\u7684discovery.kubernetes\u4e2d\uff0c\u914d\u7f6efields\u5b57\u6bb5\u3002 \u53ef\u53c2\u8003 discovery \u3002 \u573a\u666f5: \u6dfb\u52a0meta\u7cfb\u7edf\u5185\u7f6e\u5143\u4fe1\u606f \u00b6 \u6709\u4e00\u4e9bLoggie\u7cfb\u7edf\u5185\u7f6e\u7684\u5143\u4fe1\u606f\uff0c\u6211\u4eec\u4e5f\u5e0c\u671b\u53d1\u9001\u7ed9\u4e0b\u6e38\uff0c\u8fd9\u4e2a\u65f6\u5019\uff0c\u9700\u8981\u4f7f\u7528normalize interceptor\u4e2d\u7684addMeta processors\u3002 pipelines.yml pipelines : - name : local sources : - type : file name : demo paths : - /tmp/log/*.log fields : topic : \"loggie\" interceptors : - type : normalize processors : - addMeta : ~ sink : type : dev printEvents : true codec : pretty : true \u914d\u7f6e\u4e86addMeta processor\u4e4b\u540e\uff0c\u9ed8\u8ba4\u4f1a\u628a\u6240\u6709\u7684\u7cfb\u7edf\u5185\u7f6e\u5143\u4fe1\u606f\u8f93\u51fa\u3002 \u9ed8\u8ba4Json\u683c\u5f0f\u8f93\u51fa\u793a\u4f8b\u5982\u4e0b\uff1a Example { \"fields\" : { \"topic\" : \"loggie\" }, \"meta\" : { \"systemState\" : { \"nextOffset\" : 720 , \"filename\" : \"/tmp/log/a.log\" , \"collectTime\" : \"2022-03-08T11:33:47.369813+08:00\" , \"contentBytes\" : 90 , \"jobUid\" : \"43772050-16777231\" , \"lineNumber\" : 8 , \"offset\" : 630 }, \"systemProductTime\" : \"2022-03-08T11:33:47.370166+08:00\" , \"systemPipelineName\" : \"local\" , \"systemSourceName\" : \"demo\" }, \"body\" : \"01-Dec-2021 03:13:58.298 INFO [main] Starting service [Catalina]\" } \u5f53\u7136\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u89c9\u5f97\u8fd9\u4e9b\u6570\u636e\u592a\u591a\u4e86\uff0c\u6216\u8005\u60f3\u5bf9\u5b57\u6bb5\u8fdb\u884c\u4fee\u6539\u3002\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528 normalize interceptor \u91cc\u7684\u5176\u4ed6processor\uff0c\u8fdb\u884cdrop\u3001rename\u3001copy\u3001timestamp\u8f6c\u6362\u7b49\u64cd\u4f5c\u3002 \u53e6\u5916\uff0c\u8fd9\u91cc\u7684normalize interceptor\u914d\u7f6e\u5728\u67d0\u4e2aPipeline\u4e2d\uff0c\u5982\u679c\u5e0c\u671b\u5168\u5c40\u751f\u6548\uff0c\u907f\u514d\u6bcf\u4e2apipeline\u90fd\u914d\u7f6e\u8be5interceptor\uff0c\u53ef\u4ee5\u5728defaults\u4e2d\u914d\u7f6e\uff1a loggie.yml defaults : interceptors : - type : normalize name : global # \u7528\u4e8e\u533a\u5206pipelines\u4e2d\u7684normalize\uff0c\u907f\u514dpipeline\u4e2d\u5b9a\u4e49\u4e86normalize\u4f1a\u8986\u76d6\u8fd9\u91cc\u7684defaults order : 500 # \u9ed8\u8ba4normalize\u7684order\u503c\u4e3a900\uff0c\u8fd9\u91cc\u5b9a\u4e49\u4e00\u4e2a\u76f8\u5bf9\u8f83\u5c0f\u503c\uff0c\u53ef\u63a7\u5236\u5148\u6267\u884cdefaults\u4e2d\u7684normalize processor : - addMeta : ~ \u573a\u666f6\uff1abeatsFormat\u5feb\u901f\u8f6c\u6362 \u00b6 \u5982\u679c\u4f60\u671f\u671b\u7684\u683c\u5f0f\u4e3a\u7c7b\u4f3c\uff1a { \"@timestamp\" : \"2021-12-12T11:58:12.141267\" , \"message\" : \"01-Dec-2021 03:13:58.298 INFO [main] Starting service [Catalina]\" , } Loggie\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5185\u7f6e\u7684\u8f6c\u6362\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5728sink codec\u4e2d\u8bbe\u7f6e beatsFormat \u5982\u4e0b: Config sink : type : dev printEvents : true codec : type : json beatsFormat : true \u4f1a\u5c06\u9ed8\u8ba4\u7684 body \u6539\u4e3a message \uff0c\u540c\u65f6\u589e\u52a0 @timestamp \u65f6\u95f4\u5b57\u6bb5\u3002","title":"\u65e5\u5fd7\u589e\u52a0\u5143\u4fe1\u606f"},{"location":"user-guide/best-practice/log-enrich/#_1","text":"\u5efa\u8bae\u5148\u4e86\u89e3Loggie\u5185\u90e8\u65e5\u5fd7\u6570\u636e schema\u8bbe\u8ba1 \u3002","title":"\u65e5\u5fd7\u589e\u52a0\u52a0\u5143\u4fe1\u606f"},{"location":"user-guide/best-practice/log-enrich/#_2","text":"Loggie\u90e8\u7f72\u5728\u4e0d\u540c\u7684\u73af\u5883\u4e2d\uff0c\u5982\u679c\u9700\u8981\u5728\u539f\u59cb\u7684\u65e5\u5fd7\u6570\u636e\u91cc\uff0c\u589e\u52a0\u4e00\u4e9b\u5143\u4fe1\u606f\uff0c\u540c\u65f6\u517c\u5bb9\u5df2\u6709\u7684\u683c\u5f0f\uff0c\u53ef\u4ee5\u53c2\u8003\u5982\u4e0b\u7684\u529e\u6cd5\u3002","title":"\u9700\u6c42\u573a\u666f"},{"location":"user-guide/best-practice/log-enrich/#1","text":"\u6b63\u5e38\u60c5\u51b5\uff0cLoggie\u4ec5\u5c06\u539f\u59cb\u6570\u636e\u53d1\u9001\u7ed9\u4e0b\u6e38\u3002 \u5982\u679c\u4f60\u914d\u7f6e\uff1a pipelines.yml pipelines : - name : local sources : - type : file name : demo paths : - /tmp/log/*.log sink : type : dev printEvents : true codec : pretty : true sink\u8f93\u51fa\u7684\u6570\u636e\u4ec5\u4e3a\u539f\u59cb\u6570\u636e\uff1a { \"body\" : \"01-Dec-2021 03:13:58.298 INFO [main] Starting service [Catalina]\" }","title":"\u573a\u666f1: \u53d1\u9001\u539f\u59cb\u6570\u636e"},{"location":"user-guide/best-practice/log-enrich/#2-fields","text":"\u5982\u679c\u6211\u4eec\u5728source\u4e0a\u914d\u7f6e\u4e86\u4e00\u4e9b\u81ea\u5b9a\u4e49\u7684fields\u3002 pipelines.yml pipelines : - name : local sources : - type : file name : demo paths : - /tmp/log/*.log fields : topic : \"loggie\" sink : type : dev printEvents : true codec : pretty : true \u90a3\u4e48sink\u8f93\u51fa\u7684\u4e3a\uff1a { \"fields\" : { \"topic\" : \"loggie\" , }, \"body\" : \"01-Dec-2021 03:13:58.298 INFO [main] Starting service [Catalina]\" } \u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u914d\u7f6e fieldsUnderRoot: true \uff0c\u8ba9fields\u91cc\u7684 key:value \u548cbody\u540c\u4e00\u5c42\u7ea7\u3002 fields : topic : \"loggie\" fieldsUnderRoot : true { \"topic\" : \"loggie\" , \"body\" : \"01-Dec-2021 03:13:58.298 INFO [main] Starting service [Catalina]\" }","title":"\u573a\u666f2: \u6dfb\u52a0fields\u81ea\u5b9a\u4e49\u5143\u4fe1\u606f"},{"location":"user-guide/best-practice/log-enrich/#3-file-source","text":"\u5728\u6211\u4eec\u4f7f\u7528file source\u65f6\uff0c\u53ef\u80fd\u5e0c\u671b\u81ea\u52a8\u5728\u65e5\u5fd7\u539f\u59cb\u6570\u636e\u91cc\uff0c\u589e\u52a0\u4e00\u4e9b\u65e5\u5fd7\u91c7\u96c6\u7684\u72b6\u6001\uff0c\u6bd4\u5982\u91c7\u96c6\u7684\u6587\u4ef6\u540d\u79f0\u3001\u91c7\u96c6\u7684\u6587\u4ef6offsest\u7b49\uff0cfile source\u63d0\u4f9b\u4e86\u4e00\u4e2a addonMeta \u914d\u7f6e\uff0c\u53ef\u5feb\u901fenable\u3002 \u793a\u4f8b\uff1a\u6dfb\u52a0\u5982\u4e0b addonMeta \uff0c\u5e76\u8bbe\u7f6e\u4e3atrue\u3002 file source sources : - type : file paths : - /var/log/*.log addonMeta : true \u6b64\u65f6\uff0c\u91c7\u96c6\u7684event\u4f1a\u53d8\u6210\u7c7b\u4f3c\u5982\u4e0b\uff1a Example { \"body\" : \"this is test\" , \"state\" : { \"pipeline\" : \"local\" , \"source\" : \"demo\" , \"filename\" : \"/var/log/a.log\" , \"timestamp\" : \"2006-01-02T15:04:05.000Z\" , \"offset\" : 1024 , \"bytes\" : 4096 , \"hostname\" : \"node-1\" } } \u5177\u4f53\u5b57\u6bb5\u542b\u4e49\u53ef\u53c2\u8003 file source","title":"\u573a\u666f3: \u6dfb\u52a0\u65e5\u5fd7\u91c7\u96c6file source\u7684\u72b6\u6001\u4fe1\u606f"},{"location":"user-guide/best-practice/log-enrich/#4-kubernetes","text":"\u5728Kubernetes\u7684\u573a\u666f\u4e2d\uff0c\u91c7\u96c6\u7684\u5bb9\u5668\u65e5\u5fd7\uff0c\u4e3a\u4e86\u5728\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u4f7f\u7528namespace/podName\u7b49\u4fe1\u606f\u8fdb\u884c\u68c0\u7d22\uff0c\u5f80\u5f80\u9700\u8981\u589e\u52a0\u76f8\u5173\u7684\u5143\u6570\u636e\u3002 \u6211\u4eec\u53ef\u4ee5\u5728\u7cfb\u7edf\u914d\u7f6e\u7684discovery.kubernetes\u4e2d\uff0c\u914d\u7f6efields\u5b57\u6bb5\u3002 \u53ef\u53c2\u8003 discovery \u3002","title":"\u573a\u666f4: \u589e\u52a0Kubernetes\u5143\u4fe1\u606f"},{"location":"user-guide/best-practice/log-enrich/#5-meta","text":"\u6709\u4e00\u4e9bLoggie\u7cfb\u7edf\u5185\u7f6e\u7684\u5143\u4fe1\u606f\uff0c\u6211\u4eec\u4e5f\u5e0c\u671b\u53d1\u9001\u7ed9\u4e0b\u6e38\uff0c\u8fd9\u4e2a\u65f6\u5019\uff0c\u9700\u8981\u4f7f\u7528normalize interceptor\u4e2d\u7684addMeta processors\u3002 pipelines.yml pipelines : - name : local sources : - type : file name : demo paths : - /tmp/log/*.log fields : topic : \"loggie\" interceptors : - type : normalize processors : - addMeta : ~ sink : type : dev printEvents : true codec : pretty : true \u914d\u7f6e\u4e86addMeta processor\u4e4b\u540e\uff0c\u9ed8\u8ba4\u4f1a\u628a\u6240\u6709\u7684\u7cfb\u7edf\u5185\u7f6e\u5143\u4fe1\u606f\u8f93\u51fa\u3002 \u9ed8\u8ba4Json\u683c\u5f0f\u8f93\u51fa\u793a\u4f8b\u5982\u4e0b\uff1a Example { \"fields\" : { \"topic\" : \"loggie\" }, \"meta\" : { \"systemState\" : { \"nextOffset\" : 720 , \"filename\" : \"/tmp/log/a.log\" , \"collectTime\" : \"2022-03-08T11:33:47.369813+08:00\" , \"contentBytes\" : 90 , \"jobUid\" : \"43772050-16777231\" , \"lineNumber\" : 8 , \"offset\" : 630 }, \"systemProductTime\" : \"2022-03-08T11:33:47.370166+08:00\" , \"systemPipelineName\" : \"local\" , \"systemSourceName\" : \"demo\" }, \"body\" : \"01-Dec-2021 03:13:58.298 INFO [main] Starting service [Catalina]\" } \u5f53\u7136\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u89c9\u5f97\u8fd9\u4e9b\u6570\u636e\u592a\u591a\u4e86\uff0c\u6216\u8005\u60f3\u5bf9\u5b57\u6bb5\u8fdb\u884c\u4fee\u6539\u3002\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528 normalize interceptor \u91cc\u7684\u5176\u4ed6processor\uff0c\u8fdb\u884cdrop\u3001rename\u3001copy\u3001timestamp\u8f6c\u6362\u7b49\u64cd\u4f5c\u3002 \u53e6\u5916\uff0c\u8fd9\u91cc\u7684normalize interceptor\u914d\u7f6e\u5728\u67d0\u4e2aPipeline\u4e2d\uff0c\u5982\u679c\u5e0c\u671b\u5168\u5c40\u751f\u6548\uff0c\u907f\u514d\u6bcf\u4e2apipeline\u90fd\u914d\u7f6e\u8be5interceptor\uff0c\u53ef\u4ee5\u5728defaults\u4e2d\u914d\u7f6e\uff1a loggie.yml defaults : interceptors : - type : normalize name : global # \u7528\u4e8e\u533a\u5206pipelines\u4e2d\u7684normalize\uff0c\u907f\u514dpipeline\u4e2d\u5b9a\u4e49\u4e86normalize\u4f1a\u8986\u76d6\u8fd9\u91cc\u7684defaults order : 500 # \u9ed8\u8ba4normalize\u7684order\u503c\u4e3a900\uff0c\u8fd9\u91cc\u5b9a\u4e49\u4e00\u4e2a\u76f8\u5bf9\u8f83\u5c0f\u503c\uff0c\u53ef\u63a7\u5236\u5148\u6267\u884cdefaults\u4e2d\u7684normalize processor : - addMeta : ~","title":"\u573a\u666f5: \u6dfb\u52a0meta\u7cfb\u7edf\u5185\u7f6e\u5143\u4fe1\u606f"},{"location":"user-guide/best-practice/log-enrich/#6beatsformat","text":"\u5982\u679c\u4f60\u671f\u671b\u7684\u683c\u5f0f\u4e3a\u7c7b\u4f3c\uff1a { \"@timestamp\" : \"2021-12-12T11:58:12.141267\" , \"message\" : \"01-Dec-2021 03:13:58.298 INFO [main] Starting service [Catalina]\" , } Loggie\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5185\u7f6e\u7684\u8f6c\u6362\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5728sink codec\u4e2d\u8bbe\u7f6e beatsFormat \u5982\u4e0b: Config sink : type : dev printEvents : true codec : type : json beatsFormat : true \u4f1a\u5c06\u9ed8\u8ba4\u7684 body \u6539\u4e3a message \uff0c\u540c\u65f6\u589e\u52a0 @timestamp \u65f6\u95f4\u5b57\u6bb5\u3002","title":"\u573a\u666f6\uff1abeatsFormat\u5feb\u901f\u8f6c\u6362"},{"location":"user-guide/best-practice/log-process/","text":"\u65e5\u5fd7\u5207\u5206\u5904\u7406 \u00b6 Loggie\u53ef\u4f7f\u7528 normalize interceptor \u6765\u8fdb\u884c\u65e5\u5fd7\u7684\u5207\u5206\u548c\u5904\u7406\uff0c\u5c06\u65e5\u5fd7\u6570\u636e\u8fdb\u884c\u7ed3\u6784\u5316\u7684\u63d0\u53d6\uff0c\u540c\u65f6\u53ef\u4ee5\u5bf9\u63d0\u53d6\u540e\u7684\u5b57\u6bb5\u8fdb\u884c\u5904\u7406\u3002 \u5efa\u8bae\u5148\u4e86\u89e3Loggie\u5185\u90e8\u65e5\u5fd7\u6570\u636e schema\u8bbe\u8ba1 \u3002 \u9700\u6c42\u573a\u666f \u00b6 \u6700\u4e3b\u8981\u7684\u662f\u5bf9\u65e5\u5fd7\u8fdb\u884c\u5207\u5206\u89e3\u6790\u63d0\u53d6\u548c\u5904\u7406\u3002 \u6bd4\u5982\u4ee5\u4e0b\u65e5\u5fd7\uff1a 01-Dec-2021 03:13:58.298 INFO [main] Starting service [Catalina] \u6211\u4eec\u53ef\u80fd\u4f1a\u9700\u8981\u5c06\u5176\u4e2d\u7684\u65e5\u671f\u3001\u65e5\u5fd7\u7ea7\u522b\u89e3\u6790\u51fa\u6765\uff0c\u6700\u7ec8\u5f62\u6210\uff1a { \"time\" : \"01-Dec-2021 03:13:58.298\" , \"level\" : \"INFO\" , \"message\" : \"[main] Starting service [Catalina]\" } \u8fd9\u79cd\u7ed3\u6784\u5316\u7684\u6570\u636e\uff0c\u5b58\u50a8\u7684\u65f6\u5019\u4fbf\u4e8e\u8fc7\u6ee4\u67e5\u8be2\uff0c\u6216\u8005\u6839\u636e\u65e5\u5fd7\u91cc\u7684\u65f6\u95f4\u6765\u6392\u5e8f\uff0c\u800c\u4e0d\u662f\u91c7\u96c6\u7684\u65f6\u95f4\u6233\uff0c\u6216\u8005\u6839\u636e\u65e5\u5fd7\u7ea7\u522b\u8fdb\u884c\u4e00\u4e9b\u8fc7\u6ee4\uff0c\u53ef\u4ee5\u65b9\u4fbf\u67e5\u8be2\u5230ERROR\u7ea7\u522b\u7684\u65e5\u5fd7\u7b49\u7b49\u3002 \u5f53\u7136\u4e0d\u4ec5\u4ec5\u662f\u50cf\u4ee5\u4e0atomcat\u7684\u8fd0\u7ef4\u7c7b\u65e5\u5fd7\uff0c\u8fd8\u6709\u8bf8\u5982\u4e1a\u52a1\u7684\u4e00\u4e9b\u8ba2\u5355\u7b49\u7b49\u65e5\u5fd7\uff0c\u90fd\u6709\u7c7b\u4f3c\u7684\u9700\u6c42\u548c\u4f7f\u7528\u573a\u666f\u3002 \u5173\u4e8estdout\u65e5\u5fd7\u7684\u89e3\u6790\u63d0\u53d6 \u4ee5\u4e0b\u793a\u4f8b\u4ec5\u63d0\u4f9b\u65e5\u5fd7\u5207\u5206\u5904\u7406\u7684\u53c2\u8003\u601d\u8def\uff0c\u5982\u679c\u4f60\u9700\u8981\u63d0\u53d6\u5bb9\u5668\u6807\u51c6\u8f93\u51fa\u7684\u539f\u59cb\u65e5\u5fd7\uff0c\u8bf7\u53c2\u8003 \u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7 \u3002 \u529f\u80fd \u00b6 \u76ee\u524d\u5df2\u7ecf\u652f\u6301\u7684\u529f\u80fd\u6709\uff1a regex: \u6b63\u5219\u5207\u5206\u63d0\u53d6\u65e5\u5fd7 jsonDecode: \u89e3\u6790\u63d0\u53d6json\u683c\u5f0f\u7684\u65e5\u5fd7 split: \u901a\u8fc7\u5206\u9694\u7b26\u6765\u63d0\u53d6\u65e5\u5fd7 add/rename/drop/copy/underRoot\u6307\u5b9a\u5b57\u6bb5 convert\u7c7b\u578b\u8f6c\u6362 timestamp: \u8f6c\u6362\u6307\u5b9a\u5b57\u6bb5\u7684\u65f6\u95f4\u683c\u5f0f normalize\u53ef\u4ee5\u914d\u7f6e\u5185\u90e8\u7684processor\u987a\u5e8f\u6267\u884c\u3002 \u914d\u7f6e\u793a\u4f8b \u00b6 \u65e5\u5fd7\u5207\u5206\u5904\u7406\u5728Loggie Agent\u7aef\u6216\u8005Loggie\u4e2d\u8f6c\u673a\u4fa7\u5747\u53ef\uff0c\u53d6\u51b3\u4e8e\u6211\u4eec\u662f\u5426\u9700\u8981\u4e2d\u8f6c\u673a\uff0c\u4ee5\u53ca\u5e0c\u671b\u65e5\u5fd7\u5904\u7406\u8fd9\u79cdCPU\u5bc6\u96c6\u578b\u7684\u8ba1\u7b97\u662f\u5206\u5e03\u5728Agent\u4e0a\uff0c\u7531\u5404\u4e2a\u8282\u70b9\u627f\u62c5\uff0c\u8fd8\u662f\u5e0c\u671b\u5728\u4e2d\u8f6c\u673a\u96c6\u7fa4\u4e2d\u96c6\u4e2d\u8fdb\u884c\u3002 \u4e0b\u9762\u4ee5\u91c7\u96c6tomcat\u670d\u52a1\u7684\u6807\u51c6\u8f93\u51fa\u548caccess\u65e5\u5fd7\u4e3a\u4f8b\uff0c\u5c55\u793a\u5982\u4f55\u5bf9\u6807\u51c6\u8f93\u51fa\u683c\u5f0f\u8fdb\u884c\u5904\u7406\u548caccess\u65e5\u5fd7\u8fdb\u884c\u5b57\u6bb5\u5207\u5206\u3002 \u7b80\u5355\u8d77\u89c1\uff0c\u793a\u4f8b\u4f7f\u7528CRD\u5b9e\u4f8b\u914d\u7f6e\u4e0b\u53d1\u5728Agent\uff0c\u540c\u65f6\u4f7f\u7528dev sink\u76f4\u63a5\u8f93\u51fa\u5904\u7406\u7ed3\u679c\u5c55\u793a\u3002 sink \u00b6 \u521b\u5efa\u5982\u4e0b\u7684sink\u7528\u4e8e\u6f14\u793a\uff0c\u5c06\u91c7\u96c6\u5904\u7406\u540e\u7684\u65e5\u5fd7\u6253\u5370\u5728\u6240\u5c5e\u8282\u70b9Loggie\u7684\u65e5\u5fd7\u4e2d\u3002 Example apiVersion : loggie.io/v1beta1 kind : Sink metadata : name : default spec : sink : | type: dev printEvents: true codec: type: json pretty: true interceptor \u00b6 \u6839\u636e\u5b9e\u9645\u73af\u5883\u521b\u5efa\u5982\u4e0b\u7684interceptor\u3002 Example docker apiVersion : loggie.io/v1beta1 kind : Interceptor metadata : name : tomcat spec : interceptors : | - type: normalize name: stdproc belongTo: [\"stdout\"] processors: - jsonDecode: ~ - drop: targets: [\"stream\", \"time\", \"body\"] - rename: convert: - from: \"log\" to: \"message\" - type: normalize name: accproc belongTo: [\"access\"] processors: - regex: pattern: '(?<ip>\\S+) (?<id>\\S+) (?<u>\\S+) (?<time>\\[.*?\\]) (?<url>\\\".*?\\\") (?<status>\\S+) (?<size>\\S+)' containerd apiVersion : loggie.io/v1beta1 kind : Interceptor metadata : name : tomcat spec : interceptors : | - type: normalize name: stdproc belongTo: [\"stdout\"] processors: - split: separator: ' ' max: 4 keys: [\"time\", \"std\", \"F\", \"message\"] - drop: targets: [\"time\", \"std\", \"F\", \"body\"] - type: normalize name: accproc belongTo: [\"access\"] processors: - regex: pattern: '(?<ip>\\S+) (?<id>\\S+) (?<u>\\S+) (?<time>\\[.*?\\]) (?<url>\\\".*?\\\") (?<status>\\S+) (?<size>\\S+)' \u5982\u679c\u4f7f\u7528docker\u8fd0\u884c\u65f6\uff0c\u9ed8\u8ba4\u91c7\u96c6\u7684\u6807\u51c6\u8f93\u51fa\u4e3ajson\u683c\u5f0f\u3002 \u7c7b\u4f3c\uff1a { \"log\" : \"I0610 08:29:07.698664 Waiting for caches to sync\\n\" , \"stream\" : \"stderr\" , \"time\" : \"2021-06-10T08:29:07.698731204Z\" } \u6211\u4eec\u9700\u8981\u5c06json\u683c\u5f0f\u7684\u539f\u59cb\u65e5\u5fd7\u89e3\u6790\uff0c\u4e00\u822c\u8fd8\u9700\u8981drop stream \u548c time \u5b57\u6bb5\uff0c\u5e76\u5c06\u5176\u4e2d\u7684 log \u5b57\u6bb5key\u6539\u4e3a\u548c\u5176\u4ed6\u683c\u5f0f\u4e00\u81f4\u7684 body \u6216\u8005 message \u3002 \u4f7f\u7528filesource\u91c7\u96c6\u540e\uff0c\u5728Loggie\u91cc\u7684\u539f\u59cb\u683c\u5f0f\u4e3a\uff1a \"body\": '\"log\":\"I0610 08:29:07.698664 Waiting for caches to sync\\n\",\"stream\":\"stderr\", \"time\":\"2021-06-10T08:29:07.698731204Z\"' ... \u53ef\u5728normalize interceptors\u91cc\uff0c\u914d\u7f6e\u4ee5\u4e0bprocessor: jsonDecode : \u89e3\u6790\u5e76\u63d0\u53d6\u5b57\u6bb5\uff0c\u5c06Loggie\u91cc\u5b58\u50a8\u7684\u65e5\u5fd7\u683c\u5f0f\u53d8\u6210\uff1a \"body\": '\"log\":\"I0610 08:29:07.698664 Waiting for caches to sync\\n\",\"stream\":\"stderr\", \"time\":\"2021-06-10T08:29:07.698731204Z\"' \"log\": \"I0610 08:29:07.698664 Waiting for caches to sync\\n\" \"stream\":\"stderr\" \"time\":\"2021-06-10T08:29:07.698731204Z\" ... drop : \u5c06 body \u3001 stream \u548c time \u4e22\u5f03\u3002\uff08 body \u4e3a\u5185\u7f6e\u5b57\u6bb5\u8868\u793a\u539f\u59cb\u65e5\u5fd7\u6570\u636e\uff0c\u4ec5\u80fd\u4e22\u5f03\uff0c\u4e0d\u80fd\u4fee\u6539\uff09 rename : \u5c06 log \u6539\u540d\u4e3a\u7edf\u4e00\u7684\u5b57\u6bb5\u6bd4\u5982 message \u3002 \u6700\u7ec8\u53d1\u9001\u7684\u65e5\u5fd7\u683c\u5f0f\u53d8\u6210\uff1a \"message\": \"I0610 08:29:07.698664 Waiting for caches to sync\\n\" ... \u5728runtime\u4e3acontainerd\u65f6\uff0c\u539f\u59cb\u65e5\u5fd7\u5982\u4e0b\u6240\u793a\uff1a 2021-12-01T03:13:58.298476921Z stderr F INFO [main] Starting service [Catalina] \u4f1a\u9ed8\u8ba4\u52a0\u4e0a\u7c7b\u4f3c 2021-12-01T03:13:58.298476921Z stderr F \u7684\u524d\u7f00\uff0c\u4e00\u822c\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u8fd9\u4e2a\u65e5\u5fd7\uff0c\u53d1\u9001\u7684\u65f6\u5019\u53ea\u4fdd\u7559\u540e\u9762\u6570\u636e\u3002 \u548cdocker\u7684\u65b9\u5f0f\u7c7b\u4f3c\uff0c\u6211\u4eec\u53ef\u4ee5\u914d\u7f6esplit\u7b49\u65b9\u5f0f\u6765\u5207\u5206\u5904\u7406\u3002 \u53e6\u5916\uff0c\u7531\u4e8estdout\u7684\u65e5\u5fd7\u548caccess\u65e5\u5fd7\u683c\u5f0f\u4e0d\u4e00\u6837\uff0c\u6240\u4ee5\u4f7f\u7528\u4e86\u4e24\u4e2a\u4e0d\u540c\u7684normalize interceptor\uff0c\u914d\u7f6e\u4e86\u4e0d\u540c\u7684processor\uff0c\u9700\u8981\u6dfb\u52a0 name \u6765\u533a\u5206\u3002 \u6700\u91cd\u8981\u7684\u662f\uff0c\u8fd9\u91cc\u4f7f\u7528\u4e86 belongTo \u6307\u5b9a\u5173\u8054\u7684 source \uff0c\u8ba9stdout\u65e5\u5fd7\u548caccess\u65e5\u5fd7\u5206\u522b\u91c7\u7528\u4e0d\u540c\u7684\u5904\u7406\u903b\u8f91\u3002 logconfig \u00b6 \u914d\u7f6esource\u5982\u4e0b\u6240\u793a\uff1a Example apiVersion : loggie.io/v1beta1 kind : LogConfig metadata : name : tomcat namespace : default spec : selector : labelSelector : app : tomcat type : pod pipeline : interceptorRef : tomcat sinkRef : dev sources : | - type: file name: stdout paths: - stdout - type: file name: access paths: - /usr/local/tomcat/logs/localhost_access_log.*.txt \u6ce8\u610f\u8fd9\u91cc\u7684source.name\u548c\u4e0a\u9762interceptor\u914d\u7f6e\u7684belongTo\u9700\u8981\u5173\u8054\u4e0a\u3002 \u521b\u5efa\u5b8c\u4ee5\u4e0a\u7684cr\u540e\uff0c\u4fbf\u53ef\u4ee5\u91c7\u96c6\u6307\u5b9a\u7684Pod\u65e5\u5fd7\uff0c\u5e76\u8fdb\u884c\u5207\u5206\u5904\u7406\u3002","title":"\u65e5\u5fd7\u5207\u5206\u5904\u7406"},{"location":"user-guide/best-practice/log-process/#_1","text":"Loggie\u53ef\u4f7f\u7528 normalize interceptor \u6765\u8fdb\u884c\u65e5\u5fd7\u7684\u5207\u5206\u548c\u5904\u7406\uff0c\u5c06\u65e5\u5fd7\u6570\u636e\u8fdb\u884c\u7ed3\u6784\u5316\u7684\u63d0\u53d6\uff0c\u540c\u65f6\u53ef\u4ee5\u5bf9\u63d0\u53d6\u540e\u7684\u5b57\u6bb5\u8fdb\u884c\u5904\u7406\u3002 \u5efa\u8bae\u5148\u4e86\u89e3Loggie\u5185\u90e8\u65e5\u5fd7\u6570\u636e schema\u8bbe\u8ba1 \u3002","title":"\u65e5\u5fd7\u5207\u5206\u5904\u7406"},{"location":"user-guide/best-practice/log-process/#_2","text":"\u6700\u4e3b\u8981\u7684\u662f\u5bf9\u65e5\u5fd7\u8fdb\u884c\u5207\u5206\u89e3\u6790\u63d0\u53d6\u548c\u5904\u7406\u3002 \u6bd4\u5982\u4ee5\u4e0b\u65e5\u5fd7\uff1a 01-Dec-2021 03:13:58.298 INFO [main] Starting service [Catalina] \u6211\u4eec\u53ef\u80fd\u4f1a\u9700\u8981\u5c06\u5176\u4e2d\u7684\u65e5\u671f\u3001\u65e5\u5fd7\u7ea7\u522b\u89e3\u6790\u51fa\u6765\uff0c\u6700\u7ec8\u5f62\u6210\uff1a { \"time\" : \"01-Dec-2021 03:13:58.298\" , \"level\" : \"INFO\" , \"message\" : \"[main] Starting service [Catalina]\" } \u8fd9\u79cd\u7ed3\u6784\u5316\u7684\u6570\u636e\uff0c\u5b58\u50a8\u7684\u65f6\u5019\u4fbf\u4e8e\u8fc7\u6ee4\u67e5\u8be2\uff0c\u6216\u8005\u6839\u636e\u65e5\u5fd7\u91cc\u7684\u65f6\u95f4\u6765\u6392\u5e8f\uff0c\u800c\u4e0d\u662f\u91c7\u96c6\u7684\u65f6\u95f4\u6233\uff0c\u6216\u8005\u6839\u636e\u65e5\u5fd7\u7ea7\u522b\u8fdb\u884c\u4e00\u4e9b\u8fc7\u6ee4\uff0c\u53ef\u4ee5\u65b9\u4fbf\u67e5\u8be2\u5230ERROR\u7ea7\u522b\u7684\u65e5\u5fd7\u7b49\u7b49\u3002 \u5f53\u7136\u4e0d\u4ec5\u4ec5\u662f\u50cf\u4ee5\u4e0atomcat\u7684\u8fd0\u7ef4\u7c7b\u65e5\u5fd7\uff0c\u8fd8\u6709\u8bf8\u5982\u4e1a\u52a1\u7684\u4e00\u4e9b\u8ba2\u5355\u7b49\u7b49\u65e5\u5fd7\uff0c\u90fd\u6709\u7c7b\u4f3c\u7684\u9700\u6c42\u548c\u4f7f\u7528\u573a\u666f\u3002 \u5173\u4e8estdout\u65e5\u5fd7\u7684\u89e3\u6790\u63d0\u53d6 \u4ee5\u4e0b\u793a\u4f8b\u4ec5\u63d0\u4f9b\u65e5\u5fd7\u5207\u5206\u5904\u7406\u7684\u53c2\u8003\u601d\u8def\uff0c\u5982\u679c\u4f60\u9700\u8981\u63d0\u53d6\u5bb9\u5668\u6807\u51c6\u8f93\u51fa\u7684\u539f\u59cb\u65e5\u5fd7\uff0c\u8bf7\u53c2\u8003 \u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7 \u3002","title":"\u9700\u6c42\u573a\u666f"},{"location":"user-guide/best-practice/log-process/#_3","text":"\u76ee\u524d\u5df2\u7ecf\u652f\u6301\u7684\u529f\u80fd\u6709\uff1a regex: \u6b63\u5219\u5207\u5206\u63d0\u53d6\u65e5\u5fd7 jsonDecode: \u89e3\u6790\u63d0\u53d6json\u683c\u5f0f\u7684\u65e5\u5fd7 split: \u901a\u8fc7\u5206\u9694\u7b26\u6765\u63d0\u53d6\u65e5\u5fd7 add/rename/drop/copy/underRoot\u6307\u5b9a\u5b57\u6bb5 convert\u7c7b\u578b\u8f6c\u6362 timestamp: \u8f6c\u6362\u6307\u5b9a\u5b57\u6bb5\u7684\u65f6\u95f4\u683c\u5f0f normalize\u53ef\u4ee5\u914d\u7f6e\u5185\u90e8\u7684processor\u987a\u5e8f\u6267\u884c\u3002","title":"\u529f\u80fd"},{"location":"user-guide/best-practice/log-process/#_4","text":"\u65e5\u5fd7\u5207\u5206\u5904\u7406\u5728Loggie Agent\u7aef\u6216\u8005Loggie\u4e2d\u8f6c\u673a\u4fa7\u5747\u53ef\uff0c\u53d6\u51b3\u4e8e\u6211\u4eec\u662f\u5426\u9700\u8981\u4e2d\u8f6c\u673a\uff0c\u4ee5\u53ca\u5e0c\u671b\u65e5\u5fd7\u5904\u7406\u8fd9\u79cdCPU\u5bc6\u96c6\u578b\u7684\u8ba1\u7b97\u662f\u5206\u5e03\u5728Agent\u4e0a\uff0c\u7531\u5404\u4e2a\u8282\u70b9\u627f\u62c5\uff0c\u8fd8\u662f\u5e0c\u671b\u5728\u4e2d\u8f6c\u673a\u96c6\u7fa4\u4e2d\u96c6\u4e2d\u8fdb\u884c\u3002 \u4e0b\u9762\u4ee5\u91c7\u96c6tomcat\u670d\u52a1\u7684\u6807\u51c6\u8f93\u51fa\u548caccess\u65e5\u5fd7\u4e3a\u4f8b\uff0c\u5c55\u793a\u5982\u4f55\u5bf9\u6807\u51c6\u8f93\u51fa\u683c\u5f0f\u8fdb\u884c\u5904\u7406\u548caccess\u65e5\u5fd7\u8fdb\u884c\u5b57\u6bb5\u5207\u5206\u3002 \u7b80\u5355\u8d77\u89c1\uff0c\u793a\u4f8b\u4f7f\u7528CRD\u5b9e\u4f8b\u914d\u7f6e\u4e0b\u53d1\u5728Agent\uff0c\u540c\u65f6\u4f7f\u7528dev sink\u76f4\u63a5\u8f93\u51fa\u5904\u7406\u7ed3\u679c\u5c55\u793a\u3002","title":"\u914d\u7f6e\u793a\u4f8b"},{"location":"user-guide/best-practice/log-process/#sink","text":"\u521b\u5efa\u5982\u4e0b\u7684sink\u7528\u4e8e\u6f14\u793a\uff0c\u5c06\u91c7\u96c6\u5904\u7406\u540e\u7684\u65e5\u5fd7\u6253\u5370\u5728\u6240\u5c5e\u8282\u70b9Loggie\u7684\u65e5\u5fd7\u4e2d\u3002 Example apiVersion : loggie.io/v1beta1 kind : Sink metadata : name : default spec : sink : | type: dev printEvents: true codec: type: json pretty: true","title":"sink"},{"location":"user-guide/best-practice/log-process/#interceptor","text":"\u6839\u636e\u5b9e\u9645\u73af\u5883\u521b\u5efa\u5982\u4e0b\u7684interceptor\u3002 Example docker apiVersion : loggie.io/v1beta1 kind : Interceptor metadata : name : tomcat spec : interceptors : | - type: normalize name: stdproc belongTo: [\"stdout\"] processors: - jsonDecode: ~ - drop: targets: [\"stream\", \"time\", \"body\"] - rename: convert: - from: \"log\" to: \"message\" - type: normalize name: accproc belongTo: [\"access\"] processors: - regex: pattern: '(?<ip>\\S+) (?<id>\\S+) (?<u>\\S+) (?<time>\\[.*?\\]) (?<url>\\\".*?\\\") (?<status>\\S+) (?<size>\\S+)' containerd apiVersion : loggie.io/v1beta1 kind : Interceptor metadata : name : tomcat spec : interceptors : | - type: normalize name: stdproc belongTo: [\"stdout\"] processors: - split: separator: ' ' max: 4 keys: [\"time\", \"std\", \"F\", \"message\"] - drop: targets: [\"time\", \"std\", \"F\", \"body\"] - type: normalize name: accproc belongTo: [\"access\"] processors: - regex: pattern: '(?<ip>\\S+) (?<id>\\S+) (?<u>\\S+) (?<time>\\[.*?\\]) (?<url>\\\".*?\\\") (?<status>\\S+) (?<size>\\S+)' \u5982\u679c\u4f7f\u7528docker\u8fd0\u884c\u65f6\uff0c\u9ed8\u8ba4\u91c7\u96c6\u7684\u6807\u51c6\u8f93\u51fa\u4e3ajson\u683c\u5f0f\u3002 \u7c7b\u4f3c\uff1a { \"log\" : \"I0610 08:29:07.698664 Waiting for caches to sync\\n\" , \"stream\" : \"stderr\" , \"time\" : \"2021-06-10T08:29:07.698731204Z\" } \u6211\u4eec\u9700\u8981\u5c06json\u683c\u5f0f\u7684\u539f\u59cb\u65e5\u5fd7\u89e3\u6790\uff0c\u4e00\u822c\u8fd8\u9700\u8981drop stream \u548c time \u5b57\u6bb5\uff0c\u5e76\u5c06\u5176\u4e2d\u7684 log \u5b57\u6bb5key\u6539\u4e3a\u548c\u5176\u4ed6\u683c\u5f0f\u4e00\u81f4\u7684 body \u6216\u8005 message \u3002 \u4f7f\u7528filesource\u91c7\u96c6\u540e\uff0c\u5728Loggie\u91cc\u7684\u539f\u59cb\u683c\u5f0f\u4e3a\uff1a \"body\": '\"log\":\"I0610 08:29:07.698664 Waiting for caches to sync\\n\",\"stream\":\"stderr\", \"time\":\"2021-06-10T08:29:07.698731204Z\"' ... \u53ef\u5728normalize interceptors\u91cc\uff0c\u914d\u7f6e\u4ee5\u4e0bprocessor: jsonDecode : \u89e3\u6790\u5e76\u63d0\u53d6\u5b57\u6bb5\uff0c\u5c06Loggie\u91cc\u5b58\u50a8\u7684\u65e5\u5fd7\u683c\u5f0f\u53d8\u6210\uff1a \"body\": '\"log\":\"I0610 08:29:07.698664 Waiting for caches to sync\\n\",\"stream\":\"stderr\", \"time\":\"2021-06-10T08:29:07.698731204Z\"' \"log\": \"I0610 08:29:07.698664 Waiting for caches to sync\\n\" \"stream\":\"stderr\" \"time\":\"2021-06-10T08:29:07.698731204Z\" ... drop : \u5c06 body \u3001 stream \u548c time \u4e22\u5f03\u3002\uff08 body \u4e3a\u5185\u7f6e\u5b57\u6bb5\u8868\u793a\u539f\u59cb\u65e5\u5fd7\u6570\u636e\uff0c\u4ec5\u80fd\u4e22\u5f03\uff0c\u4e0d\u80fd\u4fee\u6539\uff09 rename : \u5c06 log \u6539\u540d\u4e3a\u7edf\u4e00\u7684\u5b57\u6bb5\u6bd4\u5982 message \u3002 \u6700\u7ec8\u53d1\u9001\u7684\u65e5\u5fd7\u683c\u5f0f\u53d8\u6210\uff1a \"message\": \"I0610 08:29:07.698664 Waiting for caches to sync\\n\" ... \u5728runtime\u4e3acontainerd\u65f6\uff0c\u539f\u59cb\u65e5\u5fd7\u5982\u4e0b\u6240\u793a\uff1a 2021-12-01T03:13:58.298476921Z stderr F INFO [main] Starting service [Catalina] \u4f1a\u9ed8\u8ba4\u52a0\u4e0a\u7c7b\u4f3c 2021-12-01T03:13:58.298476921Z stderr F \u7684\u524d\u7f00\uff0c\u4e00\u822c\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u8fd9\u4e2a\u65e5\u5fd7\uff0c\u53d1\u9001\u7684\u65f6\u5019\u53ea\u4fdd\u7559\u540e\u9762\u6570\u636e\u3002 \u548cdocker\u7684\u65b9\u5f0f\u7c7b\u4f3c\uff0c\u6211\u4eec\u53ef\u4ee5\u914d\u7f6esplit\u7b49\u65b9\u5f0f\u6765\u5207\u5206\u5904\u7406\u3002 \u53e6\u5916\uff0c\u7531\u4e8estdout\u7684\u65e5\u5fd7\u548caccess\u65e5\u5fd7\u683c\u5f0f\u4e0d\u4e00\u6837\uff0c\u6240\u4ee5\u4f7f\u7528\u4e86\u4e24\u4e2a\u4e0d\u540c\u7684normalize interceptor\uff0c\u914d\u7f6e\u4e86\u4e0d\u540c\u7684processor\uff0c\u9700\u8981\u6dfb\u52a0 name \u6765\u533a\u5206\u3002 \u6700\u91cd\u8981\u7684\u662f\uff0c\u8fd9\u91cc\u4f7f\u7528\u4e86 belongTo \u6307\u5b9a\u5173\u8054\u7684 source \uff0c\u8ba9stdout\u65e5\u5fd7\u548caccess\u65e5\u5fd7\u5206\u522b\u91c7\u7528\u4e0d\u540c\u7684\u5904\u7406\u903b\u8f91\u3002","title":"interceptor"},{"location":"user-guide/best-practice/log-process/#logconfig","text":"\u914d\u7f6esource\u5982\u4e0b\u6240\u793a\uff1a Example apiVersion : loggie.io/v1beta1 kind : LogConfig metadata : name : tomcat namespace : default spec : selector : labelSelector : app : tomcat type : pod pipeline : interceptorRef : tomcat sinkRef : dev sources : | - type: file name: stdout paths: - stdout - type: file name: access paths: - /usr/local/tomcat/logs/localhost_access_log.*.txt \u6ce8\u610f\u8fd9\u91cc\u7684source.name\u548c\u4e0a\u9762interceptor\u914d\u7f6e\u7684belongTo\u9700\u8981\u5173\u8054\u4e0a\u3002 \u521b\u5efa\u5b8c\u4ee5\u4e0a\u7684cr\u540e\uff0c\u4fbf\u53ef\u4ee5\u91c7\u96c6\u6307\u5b9a\u7684Pod\u65e5\u5fd7\uff0c\u5e76\u8fdb\u884c\u5207\u5206\u5904\u7406\u3002","title":"logconfig"},{"location":"user-guide/enterprise-practice/architecture-and-evolution/","text":"\u65e5\u5fd7\u7cfb\u7edf\u67b6\u6784\u4e0e\u6f14\u8fdb \u00b6 \u5728\u4e0d\u540c\u7684\u4e1a\u52a1\u7c7b\u578b\u3001\u4e0d\u540c\u7684\u4f7f\u7528\u573a\u666f\u3001\u4e0d\u540c\u7684\u65e5\u5fd7\u89c4\u6a21\u4e0b\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u91c7\u7528\u4e0d\u540c\u7684\u65e5\u5fd7\u7cfb\u7edf\u67b6\u6784\uff0c\u67b6\u6784\u4e0d\u5b58\u5728\u597d\u574f\uff0c\u53ea\u6709\u5408\u4e0d\u5408\u9002\u3002\u4e00\u4e2a\u7b80\u5355\u7684\u573a\u666f\u4e0b\uff0c\u4f7f\u7528\u590d\u6742\u7684\u67b6\u6784\u642d\u5efa\u51fa\u6765\u7684\u65e5\u5fd7\u7cfb\u7edf\uff0c\u5927\u6982\u4f1a\u5e26\u6765\u8fd0\u7ef4\u707e\u96be\u3002 \u8fd9\u91cc\u901a\u8fc7\u89c4\u6a21\u6f14\u8fdb\u7684\u89c6\u89d2\uff0c\u603b\u7ed3\u4e00\u4e0b\u5e38\u89c1\u7684\u65e5\u5fd7\u7cfb\u7edf\u67b6\u6784\uff0c\u5f53\u7136\u5b9e\u9645\u7684\u6280\u672f\u9009\u578b\u53ca\u53d8\u79cd\u6709\u5f88\u591a\uff0c\u6211\u4eec\u65e0\u6cd5\u4e00\u4e00\u5217\u51fa\uff0c\u76f8\u4fe1\u4f60\u53ef\u4ee5\u901a\u8fc7\u53c2\u8003\u4e0b\u6587\uff0c\u642d\u5efa\u9002\u5408\u81ea\u5df1\u4e1a\u52a1\u7684\u67b6\u6784\u3002 \u67b6\u6784\u6f14\u8fdb \u00b6 \u9700\u8981\u63d0\u524d\u8bf4\u660e\u7684\u662f: \u4e0b\u6587\u7684\u65e5\u5fd7\u5b58\u50a8\u793a\u4f8b\u4e3aElasticsearch\uff0c\u6d88\u606f\u961f\u5217\u4e3aKafka\uff0c \u5177\u4f53\u9009\u578b\u8bf7\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u6765\u505a\u51b3\u5b9a \u3002 \u4ee5\u4e0b\u89c4\u6a21\u6570\u636e\u91cf\u53ea\u662f\u4f5c\u4e3a\u4e00\u4e2a\u53c2\u8003\u503c\uff0c\u5177\u4f53\u7684\u843d\u5730\u60c5\u51b5\uff0c\u8fd8\u9700\u8981\u7efc\u5408\u8003\u8651\u66f4\u591a\u56e0\u7d20\uff0c\u540c\u65f6\u53ef\u4ee5\u878d\u5408\u4e0d\u540c\u7684\u9009\u578b\uff0c\u4ee5\u8fbe\u5230\u6700\u5408\u9002\u7684\u67b6\u6784\u3002 \u5c0f\u89c4\u6a21\u4e1a\u52a1\u573a\u666f \u00b6 \u6bcf\u5929\u7684\u65e5\u5fd7\u89c4\u6a21\u8f83\u5c0f\uff0c\u6bd4\u5982\u53ea\u6709\u51e0\u767eG\uff08\u9884\u4f30500G\u4ee5\u4e0b\uff09\u5de6\u53f3\uff0c\u65e5\u5fd7\u7684\u4f7f\u7528\u573a\u666f\u4ec5\u4ec5\u7528\u4e8e\u65e5\u5e38\u8fd0\u7ef4\u6392\u67e5\u95ee\u9898\uff0c\u53ef\u4ee5\u91c7\u7528Loggie\u76f4\u63a5\u53d1\u9001\u81f3Elasticsearch\u96c6\u7fa4\u7684\u65b9\u5f0f\u3002 \u67b6\u6784\u56fe\u5982\u4e0b\u6240\u793a\uff1a \u4f18\u70b9\uff1a \u67b6\u6784\u7b80\u5355\uff0c\u4fbf\u4e8e\u7ef4\u62a4 \u7f3a\u70b9\uff1a \u7531\u4e8eElasticsearch\u7684\u6027\u80fd\u6709\u9650\uff0c\u5728\u65e5\u5fd7\u91cf\u7ea7\u7a81\u7136\u589e\u5927\u65f6\uff0cAgent\u76f4\u63a5\u53d1\u9001\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5927\u91cf\u7684\u91cd\u8bd5\u6216\u8005\u5931\u8d25\uff0c\u5bfc\u81f4Elasticsearch\u4e0d\u7a33\u5b9a \u53ef\u6269\u5c55\u6027\u8f83\u5dee \u53d8\u79cd\uff1a \u56e0\u4e3a\u4e00\u76f4\u4ee5\u6765ELK\u67b6\u6784\u7684\u6d41\u884c\uff0cElasticsearch\u662f\u6700\u5e38\u7528\u7684\u65e5\u5fd7\u5b58\u50a8\u3002 \u5982\u679c\u6709\u5176\u4ed6\u670d\u52a1\u5bf9Elasticsearch\u7684\u4f9d\u8d56\uff0c\u6216\u8005\u6709Elasticsearch\u7684\u8fd0\u7ef4\u7ecf\u9a8c\uff0cElasticsearch\u662f\u4e00\u4e2a\u8fd8\u4e0d\u9519\u7684\u9009\u62e9\u3002 \u4f46\u662f\uff0cElasticsearch\u5bf9\u8d44\u6e90\u548c\u8fd0\u7ef4\u6709\u4e00\u5b9a\u7684\u8981\u6c42\uff0c\u5728\u67d0\u4e9b\u8f7b\u91cf\u7ea7\u548c\u8d44\u6e90\u654f\u611f\u7684\u73af\u5883\u4e0b\uff0c\u53ef\u4ee5\u8003\u8651\uff1a \u4f7f\u7528Loki\u5b58\u50a8 \u5982\u679c\u6709\u76f8\u5173\u7684\u6280\u672f\u50a8\u5907\uff0c\u8fd8\u53ef\u4ee5\u8003\u8651\u53d1\u9001\u81f3Clickhouse/Hive/Doris\u7b49\u3002 \u4e2d\u578b\u89c4\u6a21\u4e1a\u52a1\u573a\u666f \u00b6 \u5728\u6bcf\u5929\u7684\u65e5\u5fd7\u91cf\u7ea7\u7a0d\u5927\uff0c\u6bd4\u5982\u5728500G\u81f31T\u7684\u89c4\u6a21\uff0c\u67b6\u6784\u548c\u4e1a\u52a1\u4f7f\u7528\u4e0a\u6709\u6269\u5c55\u6027\u7684\u8003\u8651\uff0c\u53ef\u8003\u8651\u5f15\u5165Loggie\u4e2d\u8f6c\u96c6\u7fa4\u3002 \u4f18\u70b9\uff1a \u4e2d\u8f6c\u673a\u96c6\u7fa4\u53ef\u4ee5\u627f\u62c5\u65e5\u5fd7\u5207\u5206\u7b49\u80fd\u529b \u4e2d\u8f6c\u673a\u96c6\u7fa4\u6709\u4e00\u5b9a\u7684\u7f13\u51b2\u80fd\u529b \u7f3a\u70b9\uff1a \u7f13\u51b2\u80fd\u529b\u76f8\u6bd4\u6d88\u606f\u961f\u5217\u8f83\u5f31 \u5927\u578b\u89c4\u6a21\u4e1a\u52a1\u573a\u666f \u00b6 \u5982\u679c\u65e5\u5fd7\u91cf\u8f83\u5927\uff0c\u6bd4\u59821T\u4ee5\u4e0a\u573a\u666f\uff0c\u5bf9\u6027\u80fd\u4e0e\u7a33\u5b9a\u6027\u8981\u6c42\u6bd4\u8f83\u9ad8\uff0c\u53ef\u8003\u8651\u4f7f\u7528Kafka\u7b49\u6d88\u606f\u961f\u5217\u96c6\u7fa4\u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cKafka\u672c\u8eab\u5e76\u4e0d\u80fd\u76f4\u63a5\u53d1\u9001\u81f3\u540e\u7aef\uff0c\u6240\u4ee5\u8fd9\u91cc\u9700\u8981\u8003\u8651\u5982\u4f55\u5c06Kafka\u7684\u6570\u636e\u5b9e\u65f6\u5bfc\u5165\u5230\u540e\u7aef\u5b58\u50a8\u4e2d\u3002 \u8fd9\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u4e00\u4e9b\u7ec4\u4ef6\u6d88\u8d39Kafka\uff0c\u53d1\u9001\u81f3\u540e\u7aef\uff0c\u6bd4\u5982Loggie/Logstash/Kafka connect/Flink\u7b49\u3002 \u4f46\u662fFlink\u9002\u5408\u6709\u81ea\u5df1\u7684\u5b9e\u65f6\u6d41\u5e73\u53f0\u6216\u8005\u8fd0\u7ef4\u80fd\u529b\u7684\u4f01\u4e1a\uff0c\u5426\u5219\u53ef\u80fd\u5f15\u5165\u66f4\u591a\u8fd0\u7ef4\u6210\u672c\u3002 \u4f18\u70b9\uff1a \u4f7f\u7528\u6d88\u606f\u961f\u5217\u6bd4\u5982Kafka\uff0c\u53ef\u4ee5\u505a\u5230\u7f13\u5b58\u548c\u9ad8\u5cf0\u671f\u6d88\u5cf0 \u53ef\u4ee5\u8ba9\u66f4\u591a\u7684\u6d88\u8d39\u8005\u6d88\u8d39Kafka\uff0c\u63d0\u4f9b\u66f4\u591a\u53ef\u6269\u5c55\u6027 \u8d85\u5927\u578b\u89c4\u6a21\u4e1a\u52a1\u573a\u666f \u00b6 \u51e0\u5341TB\u81f3PB\u7ea7\uff0c\u76f8\u6bd4\u4e0a\u9762\u5927\u89c4\u6a21\u573a\u666f\uff0c\u96c6\u7fa4\u6570\u91cf\u591a\uff0c\u673a\u623f\u67b6\u6784\u590d\u6742\uff0c\u53ef\u4ee5\u6839\u636e\u4ee5\u4e0a\u67b6\u6784\u589e\u52a0\u66f4\u591a\u7075\u6d3b\u7684\u6269\u5c55\u3002 \u6bd4\u5982\uff1a \u4f7f\u7528Loggie\u7684\u591aPipeline\u7279\u6027\uff0c\u5c06\u4e1a\u52a1\u65e5\u5fd7\u62c6\u5206\u53d1\u9001\u81f3\u591a\u4e2aKafka\u96c6\u7fa4 \u5728\u5927\u89c4\u6a21\u67b6\u6784\u4e0b\u589e\u52a0\u524d\u7f6eLoggie\u4e2d\u8f6c\u96c6\u7fa4\uff0c\u63d0\u524d\u8fdb\u884c\u5206\u6d41\u548c\u8f6c\u53d1 \u66f4\u591a \u00b6 \u5b9e\u9645\u5728\u843d\u5730\u4e00\u5957\u5b8c\u5584\u7684\u65e5\u5fd7\u67b6\u6784\u548c\u5e73\u53f0\uff0c\u8fd8\u9700\u8981\u8003\u8651\uff1a \u53ef\u9760\u6027\uff1a\u91c7\u96c6\u3001\u4f20\u8f93\u3001\u5904\u7406\u3001\u67e5\u8be2\u6574\u4e2a\u94fe\u8def\u9700\u8981\u4fdd\u969c\u5c3d\u91cf\u4e0d\u4e22\u65e5\u5fd7\uff0c\u540c\u65f6\u65e5\u5fd7\u4e0d\u5f71\u54cd\u4e1a\u52a1\u7a33\u5b9a\u6027 \u53ef\u89c2\u6d4b\u6027\u548c\u53ef\u6392\u969c\u6027\uff1a\u7cfb\u7edf\u8981\u6709\u5b8c\u5584\u7684\u76d1\u63a7\u6307\u6807\uff0c\u51fa\u73b0\u95ee\u9898\u6216\u8005\u6545\u969c\u6709\u5feb\u901f\u6392\u67e5\u7684\u624b\u6bb5\u548c\u65b9\u5f0f\uff0c\u51cf\u5c11\u4eba\u529b\u8fd0\u7ef4\u7684\u6210\u672c \u6027\u80fd\uff1a\u91c7\u96c6\u3001\u4f20\u8f93\u548c\u5904\u7406\u9700\u8981\u8f7b\u91cf\u7ea7\uff0c\u4e0d\u5360\u7528\u592a\u591a\u8d44\u6e90\uff0c\u4f46\u662f\u5728\u6570\u636e\u91cf\u5927\u7684\u60c5\u51b5\u4e0b\uff0c\u4e5f\u9700\u8981\u6709\u8f83\u4f4e\u5ef6\u8fdf\u548c\u8f83\u5927\u7684\u541e\u5410\u91cf \u6613\u7528\u6027\uff1a\u65e5\u5fd7\u91c7\u96c6\u914d\u7f6e\u4f7f\u7528\u65b9\u4fbf\uff0c\u51cf\u5c11\u4e1a\u52a1\u4f7f\u7528\u6210\u672c\uff0c\u540c\u65f6\u4e0d\u5bf9\u5e94\u7528\u7684\u90e8\u7f72\u6709\u4fb5\u5165 \u529f\u80fd\u5b8c\u5584\uff1a\u6ee1\u8db3\u6240\u9700\u7684\u65e5\u5fd7\u5904\u7406\u3001\u67e5\u8be2\u3001\u76d1\u63a7\u62a5\u8b66\u7b49\u9700\u6c42","title":"\u65e5\u5fd7\u7cfb\u7edf\u67b6\u6784\u4e0e\u6f14\u8fdb"},{"location":"user-guide/enterprise-practice/architecture-and-evolution/#_1","text":"\u5728\u4e0d\u540c\u7684\u4e1a\u52a1\u7c7b\u578b\u3001\u4e0d\u540c\u7684\u4f7f\u7528\u573a\u666f\u3001\u4e0d\u540c\u7684\u65e5\u5fd7\u89c4\u6a21\u4e0b\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u91c7\u7528\u4e0d\u540c\u7684\u65e5\u5fd7\u7cfb\u7edf\u67b6\u6784\uff0c\u67b6\u6784\u4e0d\u5b58\u5728\u597d\u574f\uff0c\u53ea\u6709\u5408\u4e0d\u5408\u9002\u3002\u4e00\u4e2a\u7b80\u5355\u7684\u573a\u666f\u4e0b\uff0c\u4f7f\u7528\u590d\u6742\u7684\u67b6\u6784\u642d\u5efa\u51fa\u6765\u7684\u65e5\u5fd7\u7cfb\u7edf\uff0c\u5927\u6982\u4f1a\u5e26\u6765\u8fd0\u7ef4\u707e\u96be\u3002 \u8fd9\u91cc\u901a\u8fc7\u89c4\u6a21\u6f14\u8fdb\u7684\u89c6\u89d2\uff0c\u603b\u7ed3\u4e00\u4e0b\u5e38\u89c1\u7684\u65e5\u5fd7\u7cfb\u7edf\u67b6\u6784\uff0c\u5f53\u7136\u5b9e\u9645\u7684\u6280\u672f\u9009\u578b\u53ca\u53d8\u79cd\u6709\u5f88\u591a\uff0c\u6211\u4eec\u65e0\u6cd5\u4e00\u4e00\u5217\u51fa\uff0c\u76f8\u4fe1\u4f60\u53ef\u4ee5\u901a\u8fc7\u53c2\u8003\u4e0b\u6587\uff0c\u642d\u5efa\u9002\u5408\u81ea\u5df1\u4e1a\u52a1\u7684\u67b6\u6784\u3002","title":"\u65e5\u5fd7\u7cfb\u7edf\u67b6\u6784\u4e0e\u6f14\u8fdb"},{"location":"user-guide/enterprise-practice/architecture-and-evolution/#_2","text":"\u9700\u8981\u63d0\u524d\u8bf4\u660e\u7684\u662f: \u4e0b\u6587\u7684\u65e5\u5fd7\u5b58\u50a8\u793a\u4f8b\u4e3aElasticsearch\uff0c\u6d88\u606f\u961f\u5217\u4e3aKafka\uff0c \u5177\u4f53\u9009\u578b\u8bf7\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u6765\u505a\u51b3\u5b9a \u3002 \u4ee5\u4e0b\u89c4\u6a21\u6570\u636e\u91cf\u53ea\u662f\u4f5c\u4e3a\u4e00\u4e2a\u53c2\u8003\u503c\uff0c\u5177\u4f53\u7684\u843d\u5730\u60c5\u51b5\uff0c\u8fd8\u9700\u8981\u7efc\u5408\u8003\u8651\u66f4\u591a\u56e0\u7d20\uff0c\u540c\u65f6\u53ef\u4ee5\u878d\u5408\u4e0d\u540c\u7684\u9009\u578b\uff0c\u4ee5\u8fbe\u5230\u6700\u5408\u9002\u7684\u67b6\u6784\u3002","title":"\u67b6\u6784\u6f14\u8fdb"},{"location":"user-guide/enterprise-practice/architecture-and-evolution/#_3","text":"\u6bcf\u5929\u7684\u65e5\u5fd7\u89c4\u6a21\u8f83\u5c0f\uff0c\u6bd4\u5982\u53ea\u6709\u51e0\u767eG\uff08\u9884\u4f30500G\u4ee5\u4e0b\uff09\u5de6\u53f3\uff0c\u65e5\u5fd7\u7684\u4f7f\u7528\u573a\u666f\u4ec5\u4ec5\u7528\u4e8e\u65e5\u5e38\u8fd0\u7ef4\u6392\u67e5\u95ee\u9898\uff0c\u53ef\u4ee5\u91c7\u7528Loggie\u76f4\u63a5\u53d1\u9001\u81f3Elasticsearch\u96c6\u7fa4\u7684\u65b9\u5f0f\u3002 \u67b6\u6784\u56fe\u5982\u4e0b\u6240\u793a\uff1a \u4f18\u70b9\uff1a \u67b6\u6784\u7b80\u5355\uff0c\u4fbf\u4e8e\u7ef4\u62a4 \u7f3a\u70b9\uff1a \u7531\u4e8eElasticsearch\u7684\u6027\u80fd\u6709\u9650\uff0c\u5728\u65e5\u5fd7\u91cf\u7ea7\u7a81\u7136\u589e\u5927\u65f6\uff0cAgent\u76f4\u63a5\u53d1\u9001\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5927\u91cf\u7684\u91cd\u8bd5\u6216\u8005\u5931\u8d25\uff0c\u5bfc\u81f4Elasticsearch\u4e0d\u7a33\u5b9a \u53ef\u6269\u5c55\u6027\u8f83\u5dee \u53d8\u79cd\uff1a \u56e0\u4e3a\u4e00\u76f4\u4ee5\u6765ELK\u67b6\u6784\u7684\u6d41\u884c\uff0cElasticsearch\u662f\u6700\u5e38\u7528\u7684\u65e5\u5fd7\u5b58\u50a8\u3002 \u5982\u679c\u6709\u5176\u4ed6\u670d\u52a1\u5bf9Elasticsearch\u7684\u4f9d\u8d56\uff0c\u6216\u8005\u6709Elasticsearch\u7684\u8fd0\u7ef4\u7ecf\u9a8c\uff0cElasticsearch\u662f\u4e00\u4e2a\u8fd8\u4e0d\u9519\u7684\u9009\u62e9\u3002 \u4f46\u662f\uff0cElasticsearch\u5bf9\u8d44\u6e90\u548c\u8fd0\u7ef4\u6709\u4e00\u5b9a\u7684\u8981\u6c42\uff0c\u5728\u67d0\u4e9b\u8f7b\u91cf\u7ea7\u548c\u8d44\u6e90\u654f\u611f\u7684\u73af\u5883\u4e0b\uff0c\u53ef\u4ee5\u8003\u8651\uff1a \u4f7f\u7528Loki\u5b58\u50a8 \u5982\u679c\u6709\u76f8\u5173\u7684\u6280\u672f\u50a8\u5907\uff0c\u8fd8\u53ef\u4ee5\u8003\u8651\u53d1\u9001\u81f3Clickhouse/Hive/Doris\u7b49\u3002","title":"\u5c0f\u89c4\u6a21\u4e1a\u52a1\u573a\u666f"},{"location":"user-guide/enterprise-practice/architecture-and-evolution/#_4","text":"\u5728\u6bcf\u5929\u7684\u65e5\u5fd7\u91cf\u7ea7\u7a0d\u5927\uff0c\u6bd4\u5982\u5728500G\u81f31T\u7684\u89c4\u6a21\uff0c\u67b6\u6784\u548c\u4e1a\u52a1\u4f7f\u7528\u4e0a\u6709\u6269\u5c55\u6027\u7684\u8003\u8651\uff0c\u53ef\u8003\u8651\u5f15\u5165Loggie\u4e2d\u8f6c\u96c6\u7fa4\u3002 \u4f18\u70b9\uff1a \u4e2d\u8f6c\u673a\u96c6\u7fa4\u53ef\u4ee5\u627f\u62c5\u65e5\u5fd7\u5207\u5206\u7b49\u80fd\u529b \u4e2d\u8f6c\u673a\u96c6\u7fa4\u6709\u4e00\u5b9a\u7684\u7f13\u51b2\u80fd\u529b \u7f3a\u70b9\uff1a \u7f13\u51b2\u80fd\u529b\u76f8\u6bd4\u6d88\u606f\u961f\u5217\u8f83\u5f31","title":"\u4e2d\u578b\u89c4\u6a21\u4e1a\u52a1\u573a\u666f"},{"location":"user-guide/enterprise-practice/architecture-and-evolution/#_5","text":"\u5982\u679c\u65e5\u5fd7\u91cf\u8f83\u5927\uff0c\u6bd4\u59821T\u4ee5\u4e0a\u573a\u666f\uff0c\u5bf9\u6027\u80fd\u4e0e\u7a33\u5b9a\u6027\u8981\u6c42\u6bd4\u8f83\u9ad8\uff0c\u53ef\u8003\u8651\u4f7f\u7528Kafka\u7b49\u6d88\u606f\u961f\u5217\u96c6\u7fa4\u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cKafka\u672c\u8eab\u5e76\u4e0d\u80fd\u76f4\u63a5\u53d1\u9001\u81f3\u540e\u7aef\uff0c\u6240\u4ee5\u8fd9\u91cc\u9700\u8981\u8003\u8651\u5982\u4f55\u5c06Kafka\u7684\u6570\u636e\u5b9e\u65f6\u5bfc\u5165\u5230\u540e\u7aef\u5b58\u50a8\u4e2d\u3002 \u8fd9\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u4e00\u4e9b\u7ec4\u4ef6\u6d88\u8d39Kafka\uff0c\u53d1\u9001\u81f3\u540e\u7aef\uff0c\u6bd4\u5982Loggie/Logstash/Kafka connect/Flink\u7b49\u3002 \u4f46\u662fFlink\u9002\u5408\u6709\u81ea\u5df1\u7684\u5b9e\u65f6\u6d41\u5e73\u53f0\u6216\u8005\u8fd0\u7ef4\u80fd\u529b\u7684\u4f01\u4e1a\uff0c\u5426\u5219\u53ef\u80fd\u5f15\u5165\u66f4\u591a\u8fd0\u7ef4\u6210\u672c\u3002 \u4f18\u70b9\uff1a \u4f7f\u7528\u6d88\u606f\u961f\u5217\u6bd4\u5982Kafka\uff0c\u53ef\u4ee5\u505a\u5230\u7f13\u5b58\u548c\u9ad8\u5cf0\u671f\u6d88\u5cf0 \u53ef\u4ee5\u8ba9\u66f4\u591a\u7684\u6d88\u8d39\u8005\u6d88\u8d39Kafka\uff0c\u63d0\u4f9b\u66f4\u591a\u53ef\u6269\u5c55\u6027","title":"\u5927\u578b\u89c4\u6a21\u4e1a\u52a1\u573a\u666f"},{"location":"user-guide/enterprise-practice/architecture-and-evolution/#_6","text":"\u51e0\u5341TB\u81f3PB\u7ea7\uff0c\u76f8\u6bd4\u4e0a\u9762\u5927\u89c4\u6a21\u573a\u666f\uff0c\u96c6\u7fa4\u6570\u91cf\u591a\uff0c\u673a\u623f\u67b6\u6784\u590d\u6742\uff0c\u53ef\u4ee5\u6839\u636e\u4ee5\u4e0a\u67b6\u6784\u589e\u52a0\u66f4\u591a\u7075\u6d3b\u7684\u6269\u5c55\u3002 \u6bd4\u5982\uff1a \u4f7f\u7528Loggie\u7684\u591aPipeline\u7279\u6027\uff0c\u5c06\u4e1a\u52a1\u65e5\u5fd7\u62c6\u5206\u53d1\u9001\u81f3\u591a\u4e2aKafka\u96c6\u7fa4 \u5728\u5927\u89c4\u6a21\u67b6\u6784\u4e0b\u589e\u52a0\u524d\u7f6eLoggie\u4e2d\u8f6c\u96c6\u7fa4\uff0c\u63d0\u524d\u8fdb\u884c\u5206\u6d41\u548c\u8f6c\u53d1","title":"\u8d85\u5927\u578b\u89c4\u6a21\u4e1a\u52a1\u573a\u666f"},{"location":"user-guide/enterprise-practice/architecture-and-evolution/#_7","text":"\u5b9e\u9645\u5728\u843d\u5730\u4e00\u5957\u5b8c\u5584\u7684\u65e5\u5fd7\u67b6\u6784\u548c\u5e73\u53f0\uff0c\u8fd8\u9700\u8981\u8003\u8651\uff1a \u53ef\u9760\u6027\uff1a\u91c7\u96c6\u3001\u4f20\u8f93\u3001\u5904\u7406\u3001\u67e5\u8be2\u6574\u4e2a\u94fe\u8def\u9700\u8981\u4fdd\u969c\u5c3d\u91cf\u4e0d\u4e22\u65e5\u5fd7\uff0c\u540c\u65f6\u65e5\u5fd7\u4e0d\u5f71\u54cd\u4e1a\u52a1\u7a33\u5b9a\u6027 \u53ef\u89c2\u6d4b\u6027\u548c\u53ef\u6392\u969c\u6027\uff1a\u7cfb\u7edf\u8981\u6709\u5b8c\u5584\u7684\u76d1\u63a7\u6307\u6807\uff0c\u51fa\u73b0\u95ee\u9898\u6216\u8005\u6545\u969c\u6709\u5feb\u901f\u6392\u67e5\u7684\u624b\u6bb5\u548c\u65b9\u5f0f\uff0c\u51cf\u5c11\u4eba\u529b\u8fd0\u7ef4\u7684\u6210\u672c \u6027\u80fd\uff1a\u91c7\u96c6\u3001\u4f20\u8f93\u548c\u5904\u7406\u9700\u8981\u8f7b\u91cf\u7ea7\uff0c\u4e0d\u5360\u7528\u592a\u591a\u8d44\u6e90\uff0c\u4f46\u662f\u5728\u6570\u636e\u91cf\u5927\u7684\u60c5\u51b5\u4e0b\uff0c\u4e5f\u9700\u8981\u6709\u8f83\u4f4e\u5ef6\u8fdf\u548c\u8f83\u5927\u7684\u541e\u5410\u91cf \u6613\u7528\u6027\uff1a\u65e5\u5fd7\u91c7\u96c6\u914d\u7f6e\u4f7f\u7528\u65b9\u4fbf\uff0c\u51cf\u5c11\u4e1a\u52a1\u4f7f\u7528\u6210\u672c\uff0c\u540c\u65f6\u4e0d\u5bf9\u5e94\u7528\u7684\u90e8\u7f72\u6709\u4fb5\u5165 \u529f\u80fd\u5b8c\u5584\uff1a\u6ee1\u8db3\u6240\u9700\u7684\u65e5\u5fd7\u5904\u7406\u3001\u67e5\u8be2\u3001\u76d1\u63a7\u62a5\u8b66\u7b49\u9700\u6c42","title":"\u66f4\u591a"},{"location":"user-guide/enterprise-practice/sls/","text":"\u4f7f\u7528\u963f\u91cc\u4e91\u53ef\u89c2\u6d4b\u7edf\u4e00\u5b58\u50a8SLS \u00b6 \u4e0d\u7ba1\u4f60\u7684\u670d\u52a1\u90e8\u7f72\u5728\u963f\u91cc\u4e91\u8fd8\u662f\u4f7f\u7528\u6df7\u5408\u4e91\u7684\u67b6\u6784\uff0cLoggie\u540c\u6837\u652f\u6301\u91c7\u96c6\u65e5\u5fd7\u6570\u636e\u81f3 \u963f\u91cc\u4e91\u53ef\u89c2\u6d4b\u7edf\u4e00\u5b58\u50a8SLS \u3002 \u800c\u4f60\u53ea\u9700\u8981\u4f7f\u7528 sls sink \u5373\u53ef\u3002 \u51c6\u5907\uff1a\u521b\u5efaSLS Project \u00b6 \u4e3a\u4e86\u4f7f\u7528\u963f\u91cc\u4e91\u53ef\u89c2\u6d4b\u7edf\u4e00\u5b58\u50a8SLS\uff0c\u6211\u4eec\u9700\u8981\u5148\u521b\u5efa\u4e00\u4e2a\u5bf9\u5e94\u7684Project\u3002 \u5982\u4e0b\u6240\u793a\uff0c\u5728SLS\u9875\u9762\u4e2d\uff0c\u70b9\u51fb \u521b\u5efaProject \uff0c\u586b\u5165project\u540d\u79f0\u548c\u5bf9\u5e94\u7684\u5730\u57df\uff0c\u521b\u5efa\u5b8c\u4e4b\u540e\u540c\u6b65\u521b\u5efa\u76f8\u5e94\u7684Logstore\u3002 \u7136\u540e\u6211\u4eec\u53ef\u4ee5\u51c6\u5907\u4e00\u4e0b sls sink \u7684\u914d\u7f6e\uff0c\u793a\u4f8b\u5982\u4e0b\u6240\u793a\uff0c\u5177\u4f53\u53ef\u53c2\u8003 sls sink \u914d\u7f6e\u53c2\u6570 \uff1a sls sink sink : type : sls name : demo endpoint : cn-hangzhou.log.aliyuncs.com accessKeyId : xxxx accessKeySecret : xxxx project : test logstore : test1 topic : myservice \u91c7\u96c6ECS\u4e0a\u7684\u65e5\u5fd7 \u00b6 \u53c2\u8003 \u4e3b\u673a\u90e8\u7f72 \u7684\u65b9\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u4fee\u6539pipeline.yml\uff0c\u52a0\u4e0asls sink\u7684\u914d\u7f6e\u5373\u53ef\u3002 Pipeline\u914d\u7f6e\u53c2\u8003\u793a\u4f8b\u5982\u4e0b\uff1a sls pipeline pipelines : - name : test sources : - type : file name : demo addonMeta : true paths : - /tmp/log/*.log sink : type : sls endpoint : cn-hangzhou.log.aliyuncs.com accessKeyId : ${accessKeyId} accessKeySecret : ${accessKeySecret} project : loggietest logstore : demo1 topic : myservice \u91c7\u96c6ACK Kubernetes\u96c6\u7fa4\u7684\u65e5\u5fd7 \u00b6 \u548c\u81ea\u5efaKubernetes\u96c6\u7fa4\u4e00\u6837\uff0cLoggie\u540c\u6837\u53ef\u4ee5\u90e8\u7f72\u5728\u963f\u91cc\u4e91ACK\u7684Kubernetes\u96c6\u7fa4\u4e2d\u3002 \u6211\u4eec\u53ef\u4ee5\u6839\u636eACK\u63d0\u4f9b\u7684kubeconfig\u6587\u4ef6\uff0c\u4f7f\u7528kubectl\u6216\u8005helm\u6765\u90e8\u7f72\u3002\u53ef\u53c2\u8003 Kubernetes\u90e8\u7f72 \u3002 \u8bf7\u6ce8\u610f\uff1a \u5982\u679c\u5e0c\u671b\u91c7\u96c6\u672a\u6302\u8f7demptyDir/hostPath\u7684Pod\u65e5\u5fd7\uff0c\u8bf7\u786e\u4fddvalues.yaml\u91cc\u7cfb\u7edf\u914d\u7f6e\u4e2d discovery.kubernetes.rootFsCollectionEnabled \u8bbe\u7f6e\u4e3atrue\u3002 \u914d\u7f6e discovery.kubernetes.containerRuntime \u4e3a\u5339\u914d\u7684Kubernetes\u96c6\u7fa4\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u9ed8\u8ba4\u914d\u7f6e\u4e3acontainerd\u3002 \u90e8\u7f72\u5b8c\u4e4b\u540e\uff0c\u548c\u5e38\u89c4\u7684Kubernetes\u96c6\u7fa4\u4e0b\u7684\u4f7f\u7528\u59ff\u52bf\u7c7b\u4f3c\uff0c\u540c\u6837\u53ef\u4ee5\u4f7f\u7528ClusterLogConfig/LogConfig/Interceptor/Sink CR\u7684\u65b9\u5f0f\u3002 ACK\u63d0\u4f9b\u4e86CRD\u7684\u4f7f\u7528\u9875\u9762\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u8be5\u9875\u9762\u4e2d\u8fdb\u884c\u521b\u5efa\u548c\u4fee\u6539\u3002 \u91c7\u96c6\u67d0\u4e2a\u670d\u52a1\u7684\u65e5\u5fd7\u793a\u4f8b\u53c2\u8003\u5982\u4e0b\uff0c\u53ea\u9700\u4f7f\u7528 sls sink \u5373\u53ef\u3002\u5f53\u7136\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5355\u72ec\u521b\u5efa\u4e00\u4e2asink CR\u5b58\u50a8 sls sink \u914d\u7f6e\uff0c\u5728LogConfig\u4e2d\u901a\u8fc7sinkRef\u5f15\u7528\u3002 logconfig apiVersion : loggie.io/v1beta1 kind : LogConfig metadata : name : tomcat namespace : default spec : selector : labelSelector : app : tomcat type : pod pipeline : sources : | - type: file name: stdout paths: - stdout - type: file name: access ignoreOlder: 3d paths: - /usr/local/tomcat/logs/*.log sink : | type: sls endpoint: cn-hangzhou.log.aliyuncs.com accessKeyId: ${accessKeyId} accessKeySecret: ${accessKeySecret} project: loggietest logstore: demo1 topic: myservice \u67e5\u770b\u65e5\u5fd7 \u00b6 \u6211\u4eec\u53ef\u4ee5\u5728SLS\u5177\u4f53\u7684Project\u4e2d\u67e5\u770b\u91c7\u96c6\u7684\u65e5\u5fd7\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u5177\u4f53\u7684\u5143\u4fe1\u606f\u7684\u6dfb\u52a0\u548c\u65e5\u5fd7\u5b57\u6bb5\u4fee\u6539\uff0c\u53ef\u53c2\u8003 \u65e5\u5fd7\u5207\u5206\u5904\u7406 \u4ee5\u53ca \u65e5\u5fd7\u589e\u52a0\u5143\u4fe1\u606f \u3002","title":"\u4f7f\u7528\u963f\u91cc\u4e91\u53ef\u89c2\u6d4b\u7edf\u4e00\u5b58\u50a8SLS"},{"location":"user-guide/enterprise-practice/sls/#sls","text":"\u4e0d\u7ba1\u4f60\u7684\u670d\u52a1\u90e8\u7f72\u5728\u963f\u91cc\u4e91\u8fd8\u662f\u4f7f\u7528\u6df7\u5408\u4e91\u7684\u67b6\u6784\uff0cLoggie\u540c\u6837\u652f\u6301\u91c7\u96c6\u65e5\u5fd7\u6570\u636e\u81f3 \u963f\u91cc\u4e91\u53ef\u89c2\u6d4b\u7edf\u4e00\u5b58\u50a8SLS \u3002 \u800c\u4f60\u53ea\u9700\u8981\u4f7f\u7528 sls sink \u5373\u53ef\u3002","title":"\u4f7f\u7528\u963f\u91cc\u4e91\u53ef\u89c2\u6d4b\u7edf\u4e00\u5b58\u50a8SLS"},{"location":"user-guide/enterprise-practice/sls/#sls-project","text":"\u4e3a\u4e86\u4f7f\u7528\u963f\u91cc\u4e91\u53ef\u89c2\u6d4b\u7edf\u4e00\u5b58\u50a8SLS\uff0c\u6211\u4eec\u9700\u8981\u5148\u521b\u5efa\u4e00\u4e2a\u5bf9\u5e94\u7684Project\u3002 \u5982\u4e0b\u6240\u793a\uff0c\u5728SLS\u9875\u9762\u4e2d\uff0c\u70b9\u51fb \u521b\u5efaProject \uff0c\u586b\u5165project\u540d\u79f0\u548c\u5bf9\u5e94\u7684\u5730\u57df\uff0c\u521b\u5efa\u5b8c\u4e4b\u540e\u540c\u6b65\u521b\u5efa\u76f8\u5e94\u7684Logstore\u3002 \u7136\u540e\u6211\u4eec\u53ef\u4ee5\u51c6\u5907\u4e00\u4e0b sls sink \u7684\u914d\u7f6e\uff0c\u793a\u4f8b\u5982\u4e0b\u6240\u793a\uff0c\u5177\u4f53\u53ef\u53c2\u8003 sls sink \u914d\u7f6e\u53c2\u6570 \uff1a sls sink sink : type : sls name : demo endpoint : cn-hangzhou.log.aliyuncs.com accessKeyId : xxxx accessKeySecret : xxxx project : test logstore : test1 topic : myservice","title":"\u51c6\u5907\uff1a\u521b\u5efaSLS Project"},{"location":"user-guide/enterprise-practice/sls/#ecs","text":"\u53c2\u8003 \u4e3b\u673a\u90e8\u7f72 \u7684\u65b9\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u4fee\u6539pipeline.yml\uff0c\u52a0\u4e0asls sink\u7684\u914d\u7f6e\u5373\u53ef\u3002 Pipeline\u914d\u7f6e\u53c2\u8003\u793a\u4f8b\u5982\u4e0b\uff1a sls pipeline pipelines : - name : test sources : - type : file name : demo addonMeta : true paths : - /tmp/log/*.log sink : type : sls endpoint : cn-hangzhou.log.aliyuncs.com accessKeyId : ${accessKeyId} accessKeySecret : ${accessKeySecret} project : loggietest logstore : demo1 topic : myservice","title":"\u91c7\u96c6ECS\u4e0a\u7684\u65e5\u5fd7"},{"location":"user-guide/enterprise-practice/sls/#ack-kubernetes","text":"\u548c\u81ea\u5efaKubernetes\u96c6\u7fa4\u4e00\u6837\uff0cLoggie\u540c\u6837\u53ef\u4ee5\u90e8\u7f72\u5728\u963f\u91cc\u4e91ACK\u7684Kubernetes\u96c6\u7fa4\u4e2d\u3002 \u6211\u4eec\u53ef\u4ee5\u6839\u636eACK\u63d0\u4f9b\u7684kubeconfig\u6587\u4ef6\uff0c\u4f7f\u7528kubectl\u6216\u8005helm\u6765\u90e8\u7f72\u3002\u53ef\u53c2\u8003 Kubernetes\u90e8\u7f72 \u3002 \u8bf7\u6ce8\u610f\uff1a \u5982\u679c\u5e0c\u671b\u91c7\u96c6\u672a\u6302\u8f7demptyDir/hostPath\u7684Pod\u65e5\u5fd7\uff0c\u8bf7\u786e\u4fddvalues.yaml\u91cc\u7cfb\u7edf\u914d\u7f6e\u4e2d discovery.kubernetes.rootFsCollectionEnabled \u8bbe\u7f6e\u4e3atrue\u3002 \u914d\u7f6e discovery.kubernetes.containerRuntime \u4e3a\u5339\u914d\u7684Kubernetes\u96c6\u7fa4\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u9ed8\u8ba4\u914d\u7f6e\u4e3acontainerd\u3002 \u90e8\u7f72\u5b8c\u4e4b\u540e\uff0c\u548c\u5e38\u89c4\u7684Kubernetes\u96c6\u7fa4\u4e0b\u7684\u4f7f\u7528\u59ff\u52bf\u7c7b\u4f3c\uff0c\u540c\u6837\u53ef\u4ee5\u4f7f\u7528ClusterLogConfig/LogConfig/Interceptor/Sink CR\u7684\u65b9\u5f0f\u3002 ACK\u63d0\u4f9b\u4e86CRD\u7684\u4f7f\u7528\u9875\u9762\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u8be5\u9875\u9762\u4e2d\u8fdb\u884c\u521b\u5efa\u548c\u4fee\u6539\u3002 \u91c7\u96c6\u67d0\u4e2a\u670d\u52a1\u7684\u65e5\u5fd7\u793a\u4f8b\u53c2\u8003\u5982\u4e0b\uff0c\u53ea\u9700\u4f7f\u7528 sls sink \u5373\u53ef\u3002\u5f53\u7136\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5355\u72ec\u521b\u5efa\u4e00\u4e2asink CR\u5b58\u50a8 sls sink \u914d\u7f6e\uff0c\u5728LogConfig\u4e2d\u901a\u8fc7sinkRef\u5f15\u7528\u3002 logconfig apiVersion : loggie.io/v1beta1 kind : LogConfig metadata : name : tomcat namespace : default spec : selector : labelSelector : app : tomcat type : pod pipeline : sources : | - type: file name: stdout paths: - stdout - type: file name: access ignoreOlder: 3d paths: - /usr/local/tomcat/logs/*.log sink : | type: sls endpoint: cn-hangzhou.log.aliyuncs.com accessKeyId: ${accessKeyId} accessKeySecret: ${accessKeySecret} project: loggietest logstore: demo1 topic: myservice","title":"\u91c7\u96c6ACK Kubernetes\u96c6\u7fa4\u7684\u65e5\u5fd7"},{"location":"user-guide/enterprise-practice/sls/#_1","text":"\u6211\u4eec\u53ef\u4ee5\u5728SLS\u5177\u4f53\u7684Project\u4e2d\u67e5\u770b\u91c7\u96c6\u7684\u65e5\u5fd7\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u5177\u4f53\u7684\u5143\u4fe1\u606f\u7684\u6dfb\u52a0\u548c\u65e5\u5fd7\u5b57\u6bb5\u4fee\u6539\uff0c\u53ef\u53c2\u8003 \u65e5\u5fd7\u5207\u5206\u5904\u7406 \u4ee5\u53ca \u65e5\u5fd7\u589e\u52a0\u5143\u4fe1\u606f \u3002","title":"\u67e5\u770b\u65e5\u5fd7"},{"location":"user-guide/monitor/loggie-monitor/","text":"Loggie\u7684\u76d1\u63a7\u4e0e\u62a5\u8b66 \u00b6 Loggie\u7684monitor eventbus\u88ab\u8bbe\u8ba1\u4e3a\u53d1\u5e03\u548c\u8ba2\u9605\u6a21\u5f0f\uff0c\u5404\u4e2a\u7ec4\u4ef6\u53d1\u9001metrics\u5230\u6307\u5b9a\u7684topic\u4e2d\uff0c\u7531\u72ec\u7acb\u7684listener\u6765\u6d88\u8d39\u5904\u7406\u3002 \u6bd4\u5982 file source \u4f1a\u5c06\u91c7\u96c6\u65e5\u5fd7\u7684\u4e00\u4e9b\u6307\u6807\u6570\u636e\uff0c\u53d1\u9001\u81f3 filesource topic \uff0c\u7531 filesource listener \u6765\u6d88\u8d39\uff0c filesource listener \u4f1a\u5c06\u6570\u636e\u805a\u5408\u8ba1\u7b97\u4e4b\u540e\uff0c\u6253\u5370\u81f3\u65e5\u5fd7\uff0c\u66b4\u9732\u51faPrometheus\u6307\u6807\u3002 \u7ec4\u4ef6\u548ctopic\u4ee5\u53calistener\u4e4b\u95f4\u662f\u677e\u8026\u5408\u5173\u7cfb\uff0c\u6bd4\u5982 file source \u8fd8\u4f1a\u5b9a\u65f6\u5c06\u5168\u91cf\u5339\u914d\u7684\u65e5\u5fd7\u6587\u4ef6\u6307\u6807\u53d1\u9001\u81f3 filewatcher topic \uff0c filewatcher listener \u4f1a\u5904\u7406\u548c\u66b4\u9732\u6307\u6807\u3002 Monitor\u914d\u7f6e \u00b6 monitor eventbus\u914d\u7f6e\u5728\u5168\u5c40\u7684\u7cfb\u7edf\u914d\u7f6e\u4e2d\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a Config loggie : monitor : logger : period : 30s enabled : true listeners : filesource : ~ filewatcher : ~ reload : ~ queue : ~ sink : ~ http : enabled : true port : 9196 \u5176\u4e2d logger \u63a7\u5236\u6240\u6709\u7684metrics\u6307\u6807\u7684\u65e5\u5fd7\u6253\u5370\uff0c\u4f1a\u5728 period \u65f6\u95f4\u95f4\u9694\u5c06\u914d\u7f6elisteners\u4ea7\u751f\u7684metrics\u805a\u5408\u6253\u5370\u5728Loggie\u65e5\u5fd7\u4e2d\uff0c\u4fbf\u4e8e\u56de\u6eaf\u548c\u6392\u67e5\u95ee\u9898\u3002 listeners \u5219\u7528\u4e8e\u914d\u7f6e\u76f8\u5173\u7684listener\u662f\u5426\u5f00\u542f\u3002 Prometheus\u683c\u5f0fmetrics\u9ed8\u8ba4\u901a\u8fc7 http.port \u7aef\u53e3\u66b4\u9732\u5728 /metrics \u3002\u53ef\u4ee5\u901a\u8fc7 curl <podIp>:9196/metrics \u6765\u67e5\u770b\u5f53\u524d\u7684metrics\u6307\u6807\u3002 \u65e5\u5fd7\u91c7\u96c6\u6838\u5fc3\u6307\u6807 \u00b6 \u76ee\u524d\u6709\u4ee5\u4e0b\u7684listener\uff1a filesource : \u5f53\u524d\u65e5\u5fd7\u91c7\u96c6\u7684\u6307\u6807\u6570\u636e\uff0c\u6bd4\u5982\u5f53\u524d\u6709\u54ea\u4e9b\u6587\u4ef6\u5728\u91c7\u96c6\u4e2d\uff0c\u91c7\u96c6\u72b6\u6001\u5982\u4f55 filewatcher : \u5b9a\u65f6\u7684\u5168\u91cf\u904d\u5386\uff08\u9ed8\u8ba45min)\u914d\u7f6epath\u5339\u914d\u7684\u6240\u6709\u6587\u4ef6\uff0c\u76d1\u63a7\u5168\u5c40\u91c7\u96c6\u72b6\u6001\uff0c\u5224\u65ad\u662f\u5426\u6709\u672a\u53ca\u65f6\u91c7\u96c6\u7684\u6587\u4ef6\u7b49 reload : reload\u6b21\u6570 queue : \u961f\u5217\u72b6\u6001 sink : \u53d1\u9001\u7684\u6307\u6807\uff0c\u6bd4\u5982\u53d1\u751f\u6210\u529f\u6216\u8005\u5931\u8d25\u7684\u4e2a\u6570\u7b49 \u90e8\u7f72Prometheus\u548cGrafana \u00b6 \u53ef\u4ee5\u4f7f\u7528\u73af\u5883\u5df2\u6709\u7684Prometheus\u6216\u8005Grafana\uff0c\u5982\u679c\u9700\u8981\u65b0\u90e8\u7f72\uff0c\u53ef\u53c2\u8003\uff1a https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack \u3002 \u4f7f\u7528Helm\u90e8\u7f72: helm repo add prometheus-community https://prometheus-community.github.io/helm-charts helm repo update helm install prometheus prometheus-community/kube-prometheus-stack -nprometheus --create-namespace Note \u7531\u4e8e\u4f17\u6240\u5468\u77e5\u7684\u539f\u56e0\uff0c\u4f60\u7684\u73af\u5883\u91cc\u53ef\u80fd\u65e0\u6cd5\u4e0b\u8f7d\u5176\u4e2d\u7684\u67d0\u4e9b k8s.gcr.io \u955c\u50cf\uff0c\u53ef\u4ee5\u8003\u8651\u4e0b\u8f7dchart\u5305\u66ff\u6362\u540e\u518d\u91cd\u65b0\u90e8\u7f72\u3002 \u786e\u8ba4Pod\u6b63\u5e38running\u540e\uff0c\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u73af\u5883\u8bbf\u95eegrafana\u3002\u901a\u8fc7\u4ee3\u7406\u8bbf\u95eegrafana\u7684\u65b9\u5f0f\u53ef\u53c2\u8003\uff1a kubectl -nprometheus port-forward --address 0 .0.0.0 service/prometheus-grafana 8181 :80 Grafana\u7528\u6237\u540d\u548c\u5bc6\u7801\u53ef\u5728prometheus-grafana sercret\u4e2d\uff0c\u901a\u8fc7 base64 -d \u6765\u67e5\u770b\u3002 \u589e\u52a0Loggie Prometheus\u76d1\u63a7 \u00b6 \u5728\u90e8\u7f72\u4e86Loggie\u7684Kubernetes\u96c6\u7fa4\u4e2d\uff0c\u9700\u8981\u521b\u5efa\u5982\u4e0b\u7684ServiceMonitor\u6765\u8ba9Prometheus\u91c7\u96c6Loggie Agent\u6307\u6807\u3002 apiVersion : monitoring.coreos.com/v1 kind : ServiceMonitor metadata : labels : app : loggie release : prometheus name : loggie-agent namespace : prometheus spec : namespaceSelector : matchNames : - loggie endpoints : - port : monitor selector : matchLabels : app : loggie instance : loggie \u540c\u65f6\uff0c\u6211\u4eec\u9700\u8981\u5728Grafana\u4e2d\u6dfb\u52a0install\u5de5\u7a0b\u4e2d\u7684 json \u6765\u5c55\u793aLoggie\u7684\u76d1\u63a7\u63a7\u5236\u53f0\u3002 Note Kubernetes\u7248\u672c\u548cGrafana\u7248\u672c\u4e0d\u540c\uff0c\u53ef\u80fd\u5bfc\u81f4\u56fe\u8868\u5c55\u793a\u4e0d\u517c\u5bb9\uff0c\u9700\u8981\u6839\u636e\u60c5\u51b5\u8fdb\u884c\u4fee\u6539\u3002 \u5bfc\u5165\u7684Grafana\u56fe\u8868\u76ee\u524d\u5305\u542b\u76d1\u63a7\u5927\u76d8\u548c\u8282\u70b9Agent\u7684\u76d1\u63a7\u56fe\u8868\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a","title":"Loggie\u7684\u76d1\u63a7\u4e0e\u62a5\u8b66"},{"location":"user-guide/monitor/loggie-monitor/#loggie","text":"Loggie\u7684monitor eventbus\u88ab\u8bbe\u8ba1\u4e3a\u53d1\u5e03\u548c\u8ba2\u9605\u6a21\u5f0f\uff0c\u5404\u4e2a\u7ec4\u4ef6\u53d1\u9001metrics\u5230\u6307\u5b9a\u7684topic\u4e2d\uff0c\u7531\u72ec\u7acb\u7684listener\u6765\u6d88\u8d39\u5904\u7406\u3002 \u6bd4\u5982 file source \u4f1a\u5c06\u91c7\u96c6\u65e5\u5fd7\u7684\u4e00\u4e9b\u6307\u6807\u6570\u636e\uff0c\u53d1\u9001\u81f3 filesource topic \uff0c\u7531 filesource listener \u6765\u6d88\u8d39\uff0c filesource listener \u4f1a\u5c06\u6570\u636e\u805a\u5408\u8ba1\u7b97\u4e4b\u540e\uff0c\u6253\u5370\u81f3\u65e5\u5fd7\uff0c\u66b4\u9732\u51faPrometheus\u6307\u6807\u3002 \u7ec4\u4ef6\u548ctopic\u4ee5\u53calistener\u4e4b\u95f4\u662f\u677e\u8026\u5408\u5173\u7cfb\uff0c\u6bd4\u5982 file source \u8fd8\u4f1a\u5b9a\u65f6\u5c06\u5168\u91cf\u5339\u914d\u7684\u65e5\u5fd7\u6587\u4ef6\u6307\u6807\u53d1\u9001\u81f3 filewatcher topic \uff0c filewatcher listener \u4f1a\u5904\u7406\u548c\u66b4\u9732\u6307\u6807\u3002","title":"Loggie\u7684\u76d1\u63a7\u4e0e\u62a5\u8b66"},{"location":"user-guide/monitor/loggie-monitor/#monitor","text":"monitor eventbus\u914d\u7f6e\u5728\u5168\u5c40\u7684\u7cfb\u7edf\u914d\u7f6e\u4e2d\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a Config loggie : monitor : logger : period : 30s enabled : true listeners : filesource : ~ filewatcher : ~ reload : ~ queue : ~ sink : ~ http : enabled : true port : 9196 \u5176\u4e2d logger \u63a7\u5236\u6240\u6709\u7684metrics\u6307\u6807\u7684\u65e5\u5fd7\u6253\u5370\uff0c\u4f1a\u5728 period \u65f6\u95f4\u95f4\u9694\u5c06\u914d\u7f6elisteners\u4ea7\u751f\u7684metrics\u805a\u5408\u6253\u5370\u5728Loggie\u65e5\u5fd7\u4e2d\uff0c\u4fbf\u4e8e\u56de\u6eaf\u548c\u6392\u67e5\u95ee\u9898\u3002 listeners \u5219\u7528\u4e8e\u914d\u7f6e\u76f8\u5173\u7684listener\u662f\u5426\u5f00\u542f\u3002 Prometheus\u683c\u5f0fmetrics\u9ed8\u8ba4\u901a\u8fc7 http.port \u7aef\u53e3\u66b4\u9732\u5728 /metrics \u3002\u53ef\u4ee5\u901a\u8fc7 curl <podIp>:9196/metrics \u6765\u67e5\u770b\u5f53\u524d\u7684metrics\u6307\u6807\u3002","title":"Monitor\u914d\u7f6e"},{"location":"user-guide/monitor/loggie-monitor/#_1","text":"\u76ee\u524d\u6709\u4ee5\u4e0b\u7684listener\uff1a filesource : \u5f53\u524d\u65e5\u5fd7\u91c7\u96c6\u7684\u6307\u6807\u6570\u636e\uff0c\u6bd4\u5982\u5f53\u524d\u6709\u54ea\u4e9b\u6587\u4ef6\u5728\u91c7\u96c6\u4e2d\uff0c\u91c7\u96c6\u72b6\u6001\u5982\u4f55 filewatcher : \u5b9a\u65f6\u7684\u5168\u91cf\u904d\u5386\uff08\u9ed8\u8ba45min)\u914d\u7f6epath\u5339\u914d\u7684\u6240\u6709\u6587\u4ef6\uff0c\u76d1\u63a7\u5168\u5c40\u91c7\u96c6\u72b6\u6001\uff0c\u5224\u65ad\u662f\u5426\u6709\u672a\u53ca\u65f6\u91c7\u96c6\u7684\u6587\u4ef6\u7b49 reload : reload\u6b21\u6570 queue : \u961f\u5217\u72b6\u6001 sink : \u53d1\u9001\u7684\u6307\u6807\uff0c\u6bd4\u5982\u53d1\u751f\u6210\u529f\u6216\u8005\u5931\u8d25\u7684\u4e2a\u6570\u7b49","title":"\u65e5\u5fd7\u91c7\u96c6\u6838\u5fc3\u6307\u6807"},{"location":"user-guide/monitor/loggie-monitor/#prometheusgrafana","text":"\u53ef\u4ee5\u4f7f\u7528\u73af\u5883\u5df2\u6709\u7684Prometheus\u6216\u8005Grafana\uff0c\u5982\u679c\u9700\u8981\u65b0\u90e8\u7f72\uff0c\u53ef\u53c2\u8003\uff1a https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack \u3002 \u4f7f\u7528Helm\u90e8\u7f72: helm repo add prometheus-community https://prometheus-community.github.io/helm-charts helm repo update helm install prometheus prometheus-community/kube-prometheus-stack -nprometheus --create-namespace Note \u7531\u4e8e\u4f17\u6240\u5468\u77e5\u7684\u539f\u56e0\uff0c\u4f60\u7684\u73af\u5883\u91cc\u53ef\u80fd\u65e0\u6cd5\u4e0b\u8f7d\u5176\u4e2d\u7684\u67d0\u4e9b k8s.gcr.io \u955c\u50cf\uff0c\u53ef\u4ee5\u8003\u8651\u4e0b\u8f7dchart\u5305\u66ff\u6362\u540e\u518d\u91cd\u65b0\u90e8\u7f72\u3002 \u786e\u8ba4Pod\u6b63\u5e38running\u540e\uff0c\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u73af\u5883\u8bbf\u95eegrafana\u3002\u901a\u8fc7\u4ee3\u7406\u8bbf\u95eegrafana\u7684\u65b9\u5f0f\u53ef\u53c2\u8003\uff1a kubectl -nprometheus port-forward --address 0 .0.0.0 service/prometheus-grafana 8181 :80 Grafana\u7528\u6237\u540d\u548c\u5bc6\u7801\u53ef\u5728prometheus-grafana sercret\u4e2d\uff0c\u901a\u8fc7 base64 -d \u6765\u67e5\u770b\u3002","title":"\u90e8\u7f72Prometheus\u548cGrafana"},{"location":"user-guide/monitor/loggie-monitor/#loggie-prometheus","text":"\u5728\u90e8\u7f72\u4e86Loggie\u7684Kubernetes\u96c6\u7fa4\u4e2d\uff0c\u9700\u8981\u521b\u5efa\u5982\u4e0b\u7684ServiceMonitor\u6765\u8ba9Prometheus\u91c7\u96c6Loggie Agent\u6307\u6807\u3002 apiVersion : monitoring.coreos.com/v1 kind : ServiceMonitor metadata : labels : app : loggie release : prometheus name : loggie-agent namespace : prometheus spec : namespaceSelector : matchNames : - loggie endpoints : - port : monitor selector : matchLabels : app : loggie instance : loggie \u540c\u65f6\uff0c\u6211\u4eec\u9700\u8981\u5728Grafana\u4e2d\u6dfb\u52a0install\u5de5\u7a0b\u4e2d\u7684 json \u6765\u5c55\u793aLoggie\u7684\u76d1\u63a7\u63a7\u5236\u53f0\u3002 Note Kubernetes\u7248\u672c\u548cGrafana\u7248\u672c\u4e0d\u540c\uff0c\u53ef\u80fd\u5bfc\u81f4\u56fe\u8868\u5c55\u793a\u4e0d\u517c\u5bb9\uff0c\u9700\u8981\u6839\u636e\u60c5\u51b5\u8fdb\u884c\u4fee\u6539\u3002 \u5bfc\u5165\u7684Grafana\u56fe\u8868\u76ee\u524d\u5305\u542b\u76d1\u63a7\u5927\u76d8\u548c\u8282\u70b9Agent\u7684\u76d1\u63a7\u56fe\u8868\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a","title":"\u589e\u52a0Loggie Prometheus\u76d1\u63a7"},{"location":"user-guide/monitor/service-log-alarm/","text":"\u4e1a\u52a1\u65e5\u5fd7\u62a5\u8b66 \u00b6 \u9664\u4e86Loggie\u672c\u8eab\u7684\u62a5\u8b66\uff0c\u4e1a\u52a1\u65e5\u5fd7\u672c\u8eab\u7684\u76d1\u63a7\u62a5\u8b66\u4e5f\u662f\u4e00\u4e2a\u5e38\u7528\u7684\u529f\u80fd\uff0c\u6bd4\u5982\u5728\u65e5\u5fd7\u4e2d\u5305\u542b\u4e86ERROR\u65e5\u5fd7\uff0c\u53ef\u4ee5\u53d1\u9001\u62a5\u8b66\uff0c\u8fd9\u79cd\u62a5\u8b66\u4f1a\u66f4\u8d34\u8fd1\u4e1a\u52a1\u672c\u8eab\uff0c\u662f\u57fa\u4e8emetrics\u62a5\u8b66\u7684\u4e00\u79cd\u5f88\u597d\u7684\u8865\u5145\u3002 \u4f7f\u7528\u65b9\u5f0f \u00b6 \u6709\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\u53ef\u4ee5\u9009\u62e9\uff1a \u91c7\u96c6\u94fe\u8def\u68c0\u6d4b\u62a5\u8b66 \uff1aLoggie\u53ef\u4ee5\u5728Agent\u91c7\u96c6\u65e5\u5fd7\u7684\u65f6\u5019\uff0c\u6216\u8005\u5728\u4e2d\u8f6c\u673a\u8f6c\u53d1\u7684\u65f6\u5019\uff0c\u68c0\u6d4b\u5230\u5339\u914d\u7684\u5f02\u5e38\u65e5\u5fd7\uff0c\u7136\u540e\u53d1\u9001\u62a5\u8b66 \u72ec\u7acb\u94fe\u8def\u68c0\u6d4b\u62a5\u8b66 \uff1a\u5355\u72ec\u90e8\u7f72Loggie\uff0c\u4f7f\u7528Elasticsearch source\u6216\u8005\u5176\u4ed6\u7684source\u67e5\u8be2\u65e5\u5fd7\uff0c\u7136\u540e\u5339\u914d\u68c0\u6d4b\u53d1\u9001\u62a5\u8b66 \u91c7\u96c6\u94fe\u8def\u68c0\u6d4b \u00b6 \u539f\u7406 \u00b6 \u91c7\u96c6\u94fe\u8def\u4e0d\u9700\u8981\u72ec\u7acb\u90e8\u7f72Loggie\uff0c\u4f46\u662f\u7531\u4e8e\u5728\u91c7\u96c6\u7684\u6570\u636e\u94fe\u8def\u4e0a\u8fdb\u884c\u5339\u914d\uff0c\u7406\u8bba\u4e0a\u4f1a\u5bf9\u4f20\u8f93\u6027\u80fd\u9020\u6210\u4e00\u5b9a\u5f71\u54cd\uff0c\u4f46\u80dc\u5728\u65b9\u4fbf\u7b80\u5355\u3002 logAlert interceptor \u7528\u4e8e\u5728\u65e5\u5fd7\u4f20\u8f93\u7684\u65f6\u5019\u68c0\u6d4b\u5f02\u5e38\u65e5\u5fd7\uff0c\u5f02\u5e38\u65e5\u5fd7\u4f1a\u88ab\u5c01\u88c5\u6210\u62a5\u8b66\u7684\u4e8b\u4ef6\u53d1\u9001\u81f3monitor eventbus\u7684 logAlert topic\uff0c\u7531 logAlert listener \u6765\u6d88\u8d39\u3002\u76ee\u524d logAlert listener \u652f\u6301\u53d1\u9001\u81f3Prometheus AlertManager\u3002\u6709\u53d1\u9001\u81f3\u5176\u4ed6\u62a5\u8b66\u6e20\u9053\u7684\u9700\u6c42\uff0c\u6b22\u8fce\u63d0Issues\u6216\u8005PR\u3002 \u914d\u7f6e\u793a\u4f8b \u00b6 \u914d\u7f6e\u65b0\u589e logAlert listener \uff1a Config loggie : monitor : logger : period : 30s enabled : true listeners : logAlert : alertManagerAddress : [ \"http://127.0.0.1:9093\" ] bufferSize : 100 batchTimeout : 10s batchSize : 10 filesource : ~ filewatcher : ~ reload : ~ queue : ~ sink : ~ http : enabled : true port : 9196 \u589e\u52a0 logAlert interceptor \uff0c\u540c\u65f6\u5728ClusterLogConfig/LogConfig\u4e2d\u5f15\u7528\uff1a Config apiVersion : loggie.io/v1beta1 kind : Interceptor metadata : name : logalert spec : interceptors : | - type: logAlert matcher: contains: [\"err\"] \u53ef\u4ee5\u914d\u7f6ealertManager\u7684webhook\u53d1\u9001\u81f3\u5176\u4ed6\u670d\u52a1\u6765\u63a5\u6536\u62a5\u8b66\u3002 Config receivers : - name : webhook webhook_configs : - url : http://127.0.0.1:8787/webhook send_resolved : true \u53d1\u9001\u6210\u529f\u540e\u6211\u4eec\u5728alertManager\u91cc\u53ef\u4ee5\u67e5\u770b\u5230\u7c7b\u4f3c\u7684\u65e5\u5fd7\uff1a ts=2021-12-22T13:33:08.639Z caller=log.go:124 level=debug component=dispatcher msg=\"Received alert\" alert=[6b723d0][active] ts=2021-12-22T13:33:38.640Z caller=log.go:124 level=debug component=dispatcher aggrGroup={}:{} msg=flushing alerts=[[6b723d0][active]] ts=2021-12-22T13:33:38.642Z caller=log.go:124 level=debug component=dispatcher receiver=webhook integration=webhook[0] msg=\"Notify success\" attempts=1 \u540c\u65f6webhook\u63a5\u6536\u5230\u7c7b\u4f3c\u7684\u62a5\u8b66\uff1a Example { \"receiver\" : \"webhook\" , \"status\" : \"firing\" , \"alerts\" : [ { \"status\" : \"firing\" , \"labels\" : { \"host\" : \"fuyideMacBook-Pro.local\" , \"source\" : \"a\" }, \"annotations\" : { \"message\" : \"10.244.0.1 - - [13/Dec/2021:12:40:48 +0000] error \\\"GET / HTTP/1.1\\\" 404 683\" , \"reason\" : \"contained error\" }, \"startsAt\" : \"2021-12-22T21:33:08.638086+08:00\" , \"endsAt\" : \"0001-01-01T00:00:00Z\" , \"generatorURL\" : \"\" , \"fingerprint\" : \"6b723d0e395b14dc\" } ], \"groupLabels\" : {}, \"commonLabels\" : { \"host\" : \"node1\" , \"source\" : \"a\" }, \"commonAnnotations\" : { \"message\" : \"10.244.0.1 - - [13/Dec/2021:12:40:48 +0000] error \\\"GET / HTTP/1.1\\\" 404 683\" , \"reason\" : \"contained error\" }, \"externalURL\" : \"http://xxxxxx:9093\" , \"version\" : \"4\" , \"groupKey\" : \"{}:{}\" , \"truncatedAlerts\" : 0 } \u72ec\u7acb\u94fe\u8def\u68c0\u6d4b \u00b6 Info \u9a6c\u4e0a\u653e\u51fa\uff0c\u656c\u8bf7\u671f\u5f85","title":"\u65e5\u5fd7\u62a5\u8b66"},{"location":"user-guide/monitor/service-log-alarm/#_1","text":"\u9664\u4e86Loggie\u672c\u8eab\u7684\u62a5\u8b66\uff0c\u4e1a\u52a1\u65e5\u5fd7\u672c\u8eab\u7684\u76d1\u63a7\u62a5\u8b66\u4e5f\u662f\u4e00\u4e2a\u5e38\u7528\u7684\u529f\u80fd\uff0c\u6bd4\u5982\u5728\u65e5\u5fd7\u4e2d\u5305\u542b\u4e86ERROR\u65e5\u5fd7\uff0c\u53ef\u4ee5\u53d1\u9001\u62a5\u8b66\uff0c\u8fd9\u79cd\u62a5\u8b66\u4f1a\u66f4\u8d34\u8fd1\u4e1a\u52a1\u672c\u8eab\uff0c\u662f\u57fa\u4e8emetrics\u62a5\u8b66\u7684\u4e00\u79cd\u5f88\u597d\u7684\u8865\u5145\u3002","title":"\u4e1a\u52a1\u65e5\u5fd7\u62a5\u8b66"},{"location":"user-guide/monitor/service-log-alarm/#_2","text":"\u6709\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\u53ef\u4ee5\u9009\u62e9\uff1a \u91c7\u96c6\u94fe\u8def\u68c0\u6d4b\u62a5\u8b66 \uff1aLoggie\u53ef\u4ee5\u5728Agent\u91c7\u96c6\u65e5\u5fd7\u7684\u65f6\u5019\uff0c\u6216\u8005\u5728\u4e2d\u8f6c\u673a\u8f6c\u53d1\u7684\u65f6\u5019\uff0c\u68c0\u6d4b\u5230\u5339\u914d\u7684\u5f02\u5e38\u65e5\u5fd7\uff0c\u7136\u540e\u53d1\u9001\u62a5\u8b66 \u72ec\u7acb\u94fe\u8def\u68c0\u6d4b\u62a5\u8b66 \uff1a\u5355\u72ec\u90e8\u7f72Loggie\uff0c\u4f7f\u7528Elasticsearch source\u6216\u8005\u5176\u4ed6\u7684source\u67e5\u8be2\u65e5\u5fd7\uff0c\u7136\u540e\u5339\u914d\u68c0\u6d4b\u53d1\u9001\u62a5\u8b66","title":"\u4f7f\u7528\u65b9\u5f0f"},{"location":"user-guide/monitor/service-log-alarm/#_3","text":"","title":"\u91c7\u96c6\u94fe\u8def\u68c0\u6d4b"},{"location":"user-guide/monitor/service-log-alarm/#_4","text":"\u91c7\u96c6\u94fe\u8def\u4e0d\u9700\u8981\u72ec\u7acb\u90e8\u7f72Loggie\uff0c\u4f46\u662f\u7531\u4e8e\u5728\u91c7\u96c6\u7684\u6570\u636e\u94fe\u8def\u4e0a\u8fdb\u884c\u5339\u914d\uff0c\u7406\u8bba\u4e0a\u4f1a\u5bf9\u4f20\u8f93\u6027\u80fd\u9020\u6210\u4e00\u5b9a\u5f71\u54cd\uff0c\u4f46\u80dc\u5728\u65b9\u4fbf\u7b80\u5355\u3002 logAlert interceptor \u7528\u4e8e\u5728\u65e5\u5fd7\u4f20\u8f93\u7684\u65f6\u5019\u68c0\u6d4b\u5f02\u5e38\u65e5\u5fd7\uff0c\u5f02\u5e38\u65e5\u5fd7\u4f1a\u88ab\u5c01\u88c5\u6210\u62a5\u8b66\u7684\u4e8b\u4ef6\u53d1\u9001\u81f3monitor eventbus\u7684 logAlert topic\uff0c\u7531 logAlert listener \u6765\u6d88\u8d39\u3002\u76ee\u524d logAlert listener \u652f\u6301\u53d1\u9001\u81f3Prometheus AlertManager\u3002\u6709\u53d1\u9001\u81f3\u5176\u4ed6\u62a5\u8b66\u6e20\u9053\u7684\u9700\u6c42\uff0c\u6b22\u8fce\u63d0Issues\u6216\u8005PR\u3002","title":"\u539f\u7406"},{"location":"user-guide/monitor/service-log-alarm/#_5","text":"\u914d\u7f6e\u65b0\u589e logAlert listener \uff1a Config loggie : monitor : logger : period : 30s enabled : true listeners : logAlert : alertManagerAddress : [ \"http://127.0.0.1:9093\" ] bufferSize : 100 batchTimeout : 10s batchSize : 10 filesource : ~ filewatcher : ~ reload : ~ queue : ~ sink : ~ http : enabled : true port : 9196 \u589e\u52a0 logAlert interceptor \uff0c\u540c\u65f6\u5728ClusterLogConfig/LogConfig\u4e2d\u5f15\u7528\uff1a Config apiVersion : loggie.io/v1beta1 kind : Interceptor metadata : name : logalert spec : interceptors : | - type: logAlert matcher: contains: [\"err\"] \u53ef\u4ee5\u914d\u7f6ealertManager\u7684webhook\u53d1\u9001\u81f3\u5176\u4ed6\u670d\u52a1\u6765\u63a5\u6536\u62a5\u8b66\u3002 Config receivers : - name : webhook webhook_configs : - url : http://127.0.0.1:8787/webhook send_resolved : true \u53d1\u9001\u6210\u529f\u540e\u6211\u4eec\u5728alertManager\u91cc\u53ef\u4ee5\u67e5\u770b\u5230\u7c7b\u4f3c\u7684\u65e5\u5fd7\uff1a ts=2021-12-22T13:33:08.639Z caller=log.go:124 level=debug component=dispatcher msg=\"Received alert\" alert=[6b723d0][active] ts=2021-12-22T13:33:38.640Z caller=log.go:124 level=debug component=dispatcher aggrGroup={}:{} msg=flushing alerts=[[6b723d0][active]] ts=2021-12-22T13:33:38.642Z caller=log.go:124 level=debug component=dispatcher receiver=webhook integration=webhook[0] msg=\"Notify success\" attempts=1 \u540c\u65f6webhook\u63a5\u6536\u5230\u7c7b\u4f3c\u7684\u62a5\u8b66\uff1a Example { \"receiver\" : \"webhook\" , \"status\" : \"firing\" , \"alerts\" : [ { \"status\" : \"firing\" , \"labels\" : { \"host\" : \"fuyideMacBook-Pro.local\" , \"source\" : \"a\" }, \"annotations\" : { \"message\" : \"10.244.0.1 - - [13/Dec/2021:12:40:48 +0000] error \\\"GET / HTTP/1.1\\\" 404 683\" , \"reason\" : \"contained error\" }, \"startsAt\" : \"2021-12-22T21:33:08.638086+08:00\" , \"endsAt\" : \"0001-01-01T00:00:00Z\" , \"generatorURL\" : \"\" , \"fingerprint\" : \"6b723d0e395b14dc\" } ], \"groupLabels\" : {}, \"commonLabels\" : { \"host\" : \"node1\" , \"source\" : \"a\" }, \"commonAnnotations\" : { \"message\" : \"10.244.0.1 - - [13/Dec/2021:12:40:48 +0000] error \\\"GET / HTTP/1.1\\\" 404 683\" , \"reason\" : \"contained error\" }, \"externalURL\" : \"http://xxxxxx:9093\" , \"version\" : \"4\" , \"groupKey\" : \"{}:{}\" , \"truncatedAlerts\" : 0 }","title":"\u914d\u7f6e\u793a\u4f8b"},{"location":"user-guide/monitor/service-log-alarm/#_6","text":"Info \u9a6c\u4e0a\u653e\u51fa\uff0c\u656c\u8bf7\u671f\u5f85","title":"\u72ec\u7acb\u94fe\u8def\u68c0\u6d4b"},{"location":"user-guide/troubleshot/log-collection/","text":"\u65e5\u5fd7\u91c7\u96c6\u5feb\u901f\u6392\u969c\u6307\u5357 \u00b6 \u4e3a\u4ec0\u4e48\u6211\u7684\u65e5\u5fd7\u6ca1\u6709\u91c7\u96c6\uff1f \u65e5\u5fd7\u91c7\u96c6\u4e2d\uff0c\u6700\u4e3a\u5173\u952e\u6838\u5fc3\u7684\u95ee\u9898\u662f\uff0c\u65e5\u5fd7\u6709\u6ca1\u6709\u88ab\u91c7\u96c6\u5230\uff0c\u4e3a\u4ec0\u4e48\u6211\u914d\u7f6e\u7684\u65e5\u5fd7\u6ca1\u6709\u53d1\u9001\u8fc7\u53bb\uff1f \u4e0b\u9762\u63d0\u4f9b\u4e86\u6838\u5fc3\u7684\u6392\u67e5\u601d\u8def\u548c\u624b\u6bb5\u4f9b\u53c2\u8003\u3002 \u53e6\u5916\uff0c\u6700\u91cd\u8981\u7684\u662f\uff0c \u5728\u73af\u5883\u91cc\u914d\u7f6eLoggie\u7684Prometheus\u76d1\u63a7\u548cGrafana\u56fe\u8868 \uff0c\u53ef\u4ee5\u5feb\u901f\u53d1\u73b0\u95ee\u9898\u3002 \u65e5\u5fd7\u91c7\u96c6\u6838\u5fc3\u673a\u5236 \u00b6 \u4e86\u89e3\u5b9e\u73b0\u673a\u5236\u662f\u6392\u969c\u7684\u57fa\u7840\uff1a \u4e0b\u53d1\u91c7\u96c6\u4efb\u52a1\uff1a\u521b\u5efa\u65e5\u5fd7\u91c7\u96c6\u4efb\u52a1LogConfig CR\u81f3Kubernetes \u63a5\u6536\u65e5\u5fd7\u914d\u7f6e\uff1a\u8282\u70b9\u7684Agent Loggie\u76d1\u542c\u5230K8s\u76f8\u5e94\u4e8b\u4ef6\uff0c\u5c06LogConfig\u8f6c\u6362\u6210Pipelines\u914d\u7f6e\u6587\u4ef6 \u91c7\u96c6\u65e5\u5fd7\u6587\u4ef6\uff1aLoggie\u4f1a\u81ea\u52a8Reload\u7136\u540e\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\uff0c\u7136\u540e\u6839\u636e\u914d\u7f6e\u53d1\u9001\u76f8\u5e94\u7684\u65e5\u5fd7\u6570\u636e\u5230\u4e0b\u6e38\u670d\u52a1 \uff08\u9488\u5bf9\u975eKubernetes\u7684\u4e3b\u673a\u573a\u666f\uff0c\u53ea\u662f\u5c11\u4e86LogConfig CRD\u914d\u7f6e\u4e0b\u53d1\u7684\u6b65\u9aa4\uff0c\u5176\u4f59\u7c7b\u4f3c\uff09 \u6392\u67e5\u6b65\u9aa4 \u00b6 \u6392\u67e5\u95ee\u9898\u5173\u952e\u5148\u8981\u786e\u5b9a\u662f\u54ea\u4e00\u6b65\u51fa\u73b0\u4e86\u95ee\u9898\u3002 \u65e5\u5fd7\u91c7\u96c6\u4efb\u52a1\u6392\u67e5 \u00b6 \u67e5\u770b\u6211\u4eec\u8981\u6392\u67e5\u7684\u65e5\u5fd7\u91c7\u96c6\u4efb\u52a1LogConfig/ClusterLogConfig\u7684Events\u4e8b\u4ef6\uff1a kubectl -n ${ namespace } describe lgc ${ name } \u5982\u679c\u6ca1\u6709events\uff0c\u5219\u53ef\u80fd\u4e3a\uff1a Pod Label\u672a\u5339\u914d\uff1a logConfig\u4e2d labelSelector \u6307\u5b9a\u7684label\u672a\u548c\u6211\u4eec\u671f\u671b\u7684Pod\u5339\u914d\u3002\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b kubectl -n ${ namespace } get po -owide -l ${ labels } \u6bd4\u5982 kubectl -n ns1 get po -owide -l app=tomcat,service=web \u6765\u5224\u65ad\u4e00\u4e0b\u662f\u5426\u6709\u5339\u914d\u7684Pod\u3002 \u5982\u679c\u6ca1\u6709\u7c7b\u4f3csync success\u7684events\uff0c\u53ef\u6839\u636eevents\u540c\u65f6\u7ed3\u5408Loggie\u65e5\u5fd7\u6392\u67e5\u95ee\u9898\uff1a \u914d\u7f6e\u95ee\u9898\u6216\u8005Loggie\u5f02\u5e38\uff1a \u901a\u8fc7\u4e0b\u9762\u547d\u4ee4\u67e5\u770b kubectl -n ${ loggie -namespace } logs -f ${ loggie -pod-name } \u2014-tail = ${ N } \u6bd4\u5982 kubectl -nloggie logs -f loggie-5x6vf --tail=100 \u3002 \u67e5\u770b\u5bf9\u5e94\u8282\u70b9\u7684Loggie\u65e5\u5fd7\uff0c\u6839\u636e\u65e5\u5fd7\u60c5\u51b5\u8fdb\u884c\u5904\u7406\u3002 \u5e38\u89c1\u7684\u5f02\u5e38\u6709\uff1a \u627e\u4e0d\u5230\u65e5\u5fd7\u8def\u5f84\uff1a\u586b\u5199\u7684path\u6ca1\u6709\u4f7f\u7528volume\u6302\u8f7d\uff0c\u53ef\u4ee5\u4ed4\u7ec6\u68c0\u67e5\u4e00\u4e0bpath\u548cvolumeMount\u7684\u8def\u5f84\uff0cpath\u662f\u5426\u5305\u542b\u5728volumeMount\u5185\u90e8\u3002 \u65e5\u5fd7path\u672a\u5339\u914d\u5230\u5177\u4f53\u7684\u65e5\u5fd7\u6587\u4ef6\uff1apath\u9700\u8981\u586b\u5199glob\u8868\u8fbe\u5f0f\uff0c\u4f8b\u5982 /var/log/*.log \u3002\u6700\u5feb\u901f\u7684\u505a\u6cd5\u662f\uff0c\u5728\u9700\u8981\u91c7\u96c6\u7684\u4e1a\u52a1\u7684Pod\u91cc\uff0c\u6267\u884c ls <path> \uff0c\u56e0\u4e3als\u4e5f\u662f\u4f7f\u7528\u7684glob\u8868\u8fbe\u5f0f\u53bb\u5339\u914d\u65e5\u5fd7\u6587\u4ef6\u3002\u53e6\u5916\u4e5f\u9700\u989d\u5916\u6ce8\u610f\u662f\u5426\u914d\u7f6e\u4e86 ignoreOlder / excludeFiles \u7b49\u53c2\u6570\uff0c\u5ffd\u7565\u6216\u8005\u6392\u9664\u4e86\u6211\u4eec\u5e0c\u671b\u91c7\u96c6\u7684\u65e5\u5fd7\u6587\u4ef6\u3002 \u8282\u70b9\u65e5\u5fd7Agent\u6392\u67e5 \u00b6 1. \u627e\u5230logConfig\u5339\u914d\u7684pod\u6240\u5728\u8282\u70b9\u7684\u65e5\u5fd7Agent \u00b6 \u6839\u636e\u5728logConfig\u7684labelSelector\u627e\u5230\u4e00\u4e2a\u5339\u914d\u7684\u4e1a\u52a1pod\uff1a kubectl -n ${ namespace } get po -owide -l ${ labels } \u627e\u5230\u4efb\u610f\u4e00\u4e2a\u6240\u5728\u7684Node\u8282\u70b9 ${node-name} \uff0c\u7136\u540e\u901a\u8fc7\uff1a kubectl -n ${ loggie -namespace } get po -owide | grep ${ node -name } \u627e\u5230\u8be5\u8282\u70b9\u6240\u5728\u7684Loggie\u3002 2. \u67e5\u770b\u5bf9\u5e94\u8282\u70b9\u7684Loggie\u65e5\u5fd7 \u00b6 \u68c0\u67e5\u662f\u5426\u6709\u5f02\u5e38\uff0c\u5982\u679c\u6709\u5f02\u5e38\uff0c\u5219\u9700\u6839\u636e\u5f02\u5e38\u65e5\u5fd7\u518d\u505a\u5206\u6790\u5224\u65ad kubectl -n ${ loggie -namespace } logs -f ${ loggie -pod-name } \u2014-tail = ${ N } 3. \u67e5\u770b\u8282\u70b9Loggie\u6e32\u67d3\u751f\u6210\u7684\u914d\u7f6e \u00b6 \u8fdb\u5165\u5230\u5bb9\u5668\u4e2d\uff1a kubectl -n ${ loggie -namespace } exec -it ${ loggie -pod-name } bash \u67e5\u770b\u6e32\u67d3\u751f\u6210\u7684Pipeline\u914d\u7f6e\uff1a ls /opt/loggie/pipeline/ \u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u9009\u62e9\u901a\u8fc7\u8c03\u7528Loggie\u63a5\u53e3\u6765\u67e5\u770b\u6e32\u67d3\u751f\u6210\u7684Pipeline\u914d\u7f6e\uff1a curl ${loggie-pod-ip}:9196/api/v1/reload/config 4. \u67e5\u770b\u65e5\u5fd7\u91c7\u96c6\u6301\u4e45\u5316\u72b6\u6001 \u00b6 Loggie\u4f1a\u8bb0\u5f55\u6bcf\u4e2a\u65e5\u5fd7\u6587\u4ef6\u7684\u91c7\u96c6\u72b6\u6001\uff0c\u8fd9\u6837\u5373\u4f7fLoggie\u91cd\u542f\u540e\uff0c\u4e5f\u53ef\u4ee5\u7ee7\u7eed\u4fdd\u6301\u4e0a\u4e00\u6b21\u7684\u91c7\u96c6\u8fdb\u5ea6\uff0c\u907f\u514d\u91cd\u65b0\u91c7\u96c6\u65e5\u5fd7\u6587\u4ef6\u3002 \u53ef\u4ee5\u901a\u8fc7\u8c03\u7528\u63a5\u53e3\u6765\u67e5\u770b\uff1a curl ${loggie-pod-ip}:9196/api/v1/source/file/registry?format=text | grep XXX \u4e00\u822c\u8fd4\u56de\u7684\u7c7b\u4f3c\uff1a { \"id\": 85, \"pipelineName\": \"default/tomcat\", \"sourceName\": \"tomcat-7d64c4f6c9-cm8jm/tomcat/common\", \"filename\": \"/var/lib/kubelet/pods/9397b8be-8927-44ba-8b94-73e5a4459377/volumes/kubernetes.io~empty-dir/log/catalina.2022-06-02.log\", \"jobUid\": \"3670030-65025\", \"offset\": 4960, \"collectTime\": \"2022-06-06 12:44:12.861\", \"version\": \"0.0.1\" }, \u5176\u4e2d\u7684 filename \u4e3aLoggie\u8f6c\u6362\u540e\u7684\u5b9e\u9645\u8282\u70b9\u4e0a\u7684\u65e5\u5fd7\u8def\u5f84\uff0c jobUid \u7ec4\u6210\u4e3a\u6587\u4ef6\u7684 inode-deviceId \uff0c offset \u4e3asink\u53d1\u9001\u6210\u529f\u63a5\u6536\u5230ack\u540e\u7684offset\u3002 \u53e6\u5916\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5728Loggie\u5bb9\u5668\u4e2d\u6267\u884c\uff1a stat ${filename} \u67e5\u770b\u6587\u4ef6\u7684size/inode\u7b49\u4fe1\u606f\uff0c\u4f8b\u5982\uff1a stat File : /var/lib/kubelet/pods/9397b8be-8927-44ba-8b94-73e5a4459377/volumes/kubernetes.io~empty-dir/log/catalina.2022-06-02.log Size : 4960 Blocks : 16 IO Block : 4096 regular file Device : fe01h/65025d Inode : 3670030 Links : 1 Access : (0640/-rw-r-----) Uid : ( 0/ root) Gid : ( 0/ root) Access : 2022-06-06 12:44:12.859236003 +0000 Modify : 2022-06-02 08:54:33.177240007 +0000 Change : 2022-06-02 08:54:33.177240007 +0000 \u53ef\u901a\u8fc7\u6bd4\u8f83size\u548coffset\u6765\u5224\u65ad\u91c7\u96c6\u8fdb\u5ea6\u3002\u5982\u679csize=offset\uff0c\u5219\u8bf4\u660e\u5df2\u7ecf\u6587\u4ef6\u5df2\u7ecf\u5168\u90e8\u91c7\u96c6\u5e76\u53d1\u9001\u6210\u529f\u3002","title":"\u65e5\u5fd7\u91c7\u96c6\u5feb\u901f\u6392\u969c\u6307\u5357"},{"location":"user-guide/troubleshot/log-collection/#_1","text":"\u4e3a\u4ec0\u4e48\u6211\u7684\u65e5\u5fd7\u6ca1\u6709\u91c7\u96c6\uff1f \u65e5\u5fd7\u91c7\u96c6\u4e2d\uff0c\u6700\u4e3a\u5173\u952e\u6838\u5fc3\u7684\u95ee\u9898\u662f\uff0c\u65e5\u5fd7\u6709\u6ca1\u6709\u88ab\u91c7\u96c6\u5230\uff0c\u4e3a\u4ec0\u4e48\u6211\u914d\u7f6e\u7684\u65e5\u5fd7\u6ca1\u6709\u53d1\u9001\u8fc7\u53bb\uff1f \u4e0b\u9762\u63d0\u4f9b\u4e86\u6838\u5fc3\u7684\u6392\u67e5\u601d\u8def\u548c\u624b\u6bb5\u4f9b\u53c2\u8003\u3002 \u53e6\u5916\uff0c\u6700\u91cd\u8981\u7684\u662f\uff0c \u5728\u73af\u5883\u91cc\u914d\u7f6eLoggie\u7684Prometheus\u76d1\u63a7\u548cGrafana\u56fe\u8868 \uff0c\u53ef\u4ee5\u5feb\u901f\u53d1\u73b0\u95ee\u9898\u3002","title":"\u65e5\u5fd7\u91c7\u96c6\u5feb\u901f\u6392\u969c\u6307\u5357"},{"location":"user-guide/troubleshot/log-collection/#_2","text":"\u4e86\u89e3\u5b9e\u73b0\u673a\u5236\u662f\u6392\u969c\u7684\u57fa\u7840\uff1a \u4e0b\u53d1\u91c7\u96c6\u4efb\u52a1\uff1a\u521b\u5efa\u65e5\u5fd7\u91c7\u96c6\u4efb\u52a1LogConfig CR\u81f3Kubernetes \u63a5\u6536\u65e5\u5fd7\u914d\u7f6e\uff1a\u8282\u70b9\u7684Agent Loggie\u76d1\u542c\u5230K8s\u76f8\u5e94\u4e8b\u4ef6\uff0c\u5c06LogConfig\u8f6c\u6362\u6210Pipelines\u914d\u7f6e\u6587\u4ef6 \u91c7\u96c6\u65e5\u5fd7\u6587\u4ef6\uff1aLoggie\u4f1a\u81ea\u52a8Reload\u7136\u540e\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\uff0c\u7136\u540e\u6839\u636e\u914d\u7f6e\u53d1\u9001\u76f8\u5e94\u7684\u65e5\u5fd7\u6570\u636e\u5230\u4e0b\u6e38\u670d\u52a1 \uff08\u9488\u5bf9\u975eKubernetes\u7684\u4e3b\u673a\u573a\u666f\uff0c\u53ea\u662f\u5c11\u4e86LogConfig CRD\u914d\u7f6e\u4e0b\u53d1\u7684\u6b65\u9aa4\uff0c\u5176\u4f59\u7c7b\u4f3c\uff09","title":"\u65e5\u5fd7\u91c7\u96c6\u6838\u5fc3\u673a\u5236"},{"location":"user-guide/troubleshot/log-collection/#_3","text":"\u6392\u67e5\u95ee\u9898\u5173\u952e\u5148\u8981\u786e\u5b9a\u662f\u54ea\u4e00\u6b65\u51fa\u73b0\u4e86\u95ee\u9898\u3002","title":"\u6392\u67e5\u6b65\u9aa4"},{"location":"user-guide/troubleshot/log-collection/#_4","text":"\u67e5\u770b\u6211\u4eec\u8981\u6392\u67e5\u7684\u65e5\u5fd7\u91c7\u96c6\u4efb\u52a1LogConfig/ClusterLogConfig\u7684Events\u4e8b\u4ef6\uff1a kubectl -n ${ namespace } describe lgc ${ name } \u5982\u679c\u6ca1\u6709events\uff0c\u5219\u53ef\u80fd\u4e3a\uff1a Pod Label\u672a\u5339\u914d\uff1a logConfig\u4e2d labelSelector \u6307\u5b9a\u7684label\u672a\u548c\u6211\u4eec\u671f\u671b\u7684Pod\u5339\u914d\u3002\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b kubectl -n ${ namespace } get po -owide -l ${ labels } \u6bd4\u5982 kubectl -n ns1 get po -owide -l app=tomcat,service=web \u6765\u5224\u65ad\u4e00\u4e0b\u662f\u5426\u6709\u5339\u914d\u7684Pod\u3002 \u5982\u679c\u6ca1\u6709\u7c7b\u4f3csync success\u7684events\uff0c\u53ef\u6839\u636eevents\u540c\u65f6\u7ed3\u5408Loggie\u65e5\u5fd7\u6392\u67e5\u95ee\u9898\uff1a \u914d\u7f6e\u95ee\u9898\u6216\u8005Loggie\u5f02\u5e38\uff1a \u901a\u8fc7\u4e0b\u9762\u547d\u4ee4\u67e5\u770b kubectl -n ${ loggie -namespace } logs -f ${ loggie -pod-name } \u2014-tail = ${ N } \u6bd4\u5982 kubectl -nloggie logs -f loggie-5x6vf --tail=100 \u3002 \u67e5\u770b\u5bf9\u5e94\u8282\u70b9\u7684Loggie\u65e5\u5fd7\uff0c\u6839\u636e\u65e5\u5fd7\u60c5\u51b5\u8fdb\u884c\u5904\u7406\u3002 \u5e38\u89c1\u7684\u5f02\u5e38\u6709\uff1a \u627e\u4e0d\u5230\u65e5\u5fd7\u8def\u5f84\uff1a\u586b\u5199\u7684path\u6ca1\u6709\u4f7f\u7528volume\u6302\u8f7d\uff0c\u53ef\u4ee5\u4ed4\u7ec6\u68c0\u67e5\u4e00\u4e0bpath\u548cvolumeMount\u7684\u8def\u5f84\uff0cpath\u662f\u5426\u5305\u542b\u5728volumeMount\u5185\u90e8\u3002 \u65e5\u5fd7path\u672a\u5339\u914d\u5230\u5177\u4f53\u7684\u65e5\u5fd7\u6587\u4ef6\uff1apath\u9700\u8981\u586b\u5199glob\u8868\u8fbe\u5f0f\uff0c\u4f8b\u5982 /var/log/*.log \u3002\u6700\u5feb\u901f\u7684\u505a\u6cd5\u662f\uff0c\u5728\u9700\u8981\u91c7\u96c6\u7684\u4e1a\u52a1\u7684Pod\u91cc\uff0c\u6267\u884c ls <path> \uff0c\u56e0\u4e3als\u4e5f\u662f\u4f7f\u7528\u7684glob\u8868\u8fbe\u5f0f\u53bb\u5339\u914d\u65e5\u5fd7\u6587\u4ef6\u3002\u53e6\u5916\u4e5f\u9700\u989d\u5916\u6ce8\u610f\u662f\u5426\u914d\u7f6e\u4e86 ignoreOlder / excludeFiles \u7b49\u53c2\u6570\uff0c\u5ffd\u7565\u6216\u8005\u6392\u9664\u4e86\u6211\u4eec\u5e0c\u671b\u91c7\u96c6\u7684\u65e5\u5fd7\u6587\u4ef6\u3002","title":"\u65e5\u5fd7\u91c7\u96c6\u4efb\u52a1\u6392\u67e5"},{"location":"user-guide/troubleshot/log-collection/#agent","text":"","title":"\u8282\u70b9\u65e5\u5fd7Agent\u6392\u67e5"},{"location":"user-guide/troubleshot/log-collection/#1-logconfigpodagent","text":"\u6839\u636e\u5728logConfig\u7684labelSelector\u627e\u5230\u4e00\u4e2a\u5339\u914d\u7684\u4e1a\u52a1pod\uff1a kubectl -n ${ namespace } get po -owide -l ${ labels } \u627e\u5230\u4efb\u610f\u4e00\u4e2a\u6240\u5728\u7684Node\u8282\u70b9 ${node-name} \uff0c\u7136\u540e\u901a\u8fc7\uff1a kubectl -n ${ loggie -namespace } get po -owide | grep ${ node -name } \u627e\u5230\u8be5\u8282\u70b9\u6240\u5728\u7684Loggie\u3002","title":"1.  \u627e\u5230logConfig\u5339\u914d\u7684pod\u6240\u5728\u8282\u70b9\u7684\u65e5\u5fd7Agent"},{"location":"user-guide/troubleshot/log-collection/#2-loggie","text":"\u68c0\u67e5\u662f\u5426\u6709\u5f02\u5e38\uff0c\u5982\u679c\u6709\u5f02\u5e38\uff0c\u5219\u9700\u6839\u636e\u5f02\u5e38\u65e5\u5fd7\u518d\u505a\u5206\u6790\u5224\u65ad kubectl -n ${ loggie -namespace } logs -f ${ loggie -pod-name } \u2014-tail = ${ N }","title":"2.  \u67e5\u770b\u5bf9\u5e94\u8282\u70b9\u7684Loggie\u65e5\u5fd7"},{"location":"user-guide/troubleshot/log-collection/#3-loggie","text":"\u8fdb\u5165\u5230\u5bb9\u5668\u4e2d\uff1a kubectl -n ${ loggie -namespace } exec -it ${ loggie -pod-name } bash \u67e5\u770b\u6e32\u67d3\u751f\u6210\u7684Pipeline\u914d\u7f6e\uff1a ls /opt/loggie/pipeline/ \u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u9009\u62e9\u901a\u8fc7\u8c03\u7528Loggie\u63a5\u53e3\u6765\u67e5\u770b\u6e32\u67d3\u751f\u6210\u7684Pipeline\u914d\u7f6e\uff1a curl ${loggie-pod-ip}:9196/api/v1/reload/config","title":"3.  \u67e5\u770b\u8282\u70b9Loggie\u6e32\u67d3\u751f\u6210\u7684\u914d\u7f6e"},{"location":"user-guide/troubleshot/log-collection/#4","text":"Loggie\u4f1a\u8bb0\u5f55\u6bcf\u4e2a\u65e5\u5fd7\u6587\u4ef6\u7684\u91c7\u96c6\u72b6\u6001\uff0c\u8fd9\u6837\u5373\u4f7fLoggie\u91cd\u542f\u540e\uff0c\u4e5f\u53ef\u4ee5\u7ee7\u7eed\u4fdd\u6301\u4e0a\u4e00\u6b21\u7684\u91c7\u96c6\u8fdb\u5ea6\uff0c\u907f\u514d\u91cd\u65b0\u91c7\u96c6\u65e5\u5fd7\u6587\u4ef6\u3002 \u53ef\u4ee5\u901a\u8fc7\u8c03\u7528\u63a5\u53e3\u6765\u67e5\u770b\uff1a curl ${loggie-pod-ip}:9196/api/v1/source/file/registry?format=text | grep XXX \u4e00\u822c\u8fd4\u56de\u7684\u7c7b\u4f3c\uff1a { \"id\": 85, \"pipelineName\": \"default/tomcat\", \"sourceName\": \"tomcat-7d64c4f6c9-cm8jm/tomcat/common\", \"filename\": \"/var/lib/kubelet/pods/9397b8be-8927-44ba-8b94-73e5a4459377/volumes/kubernetes.io~empty-dir/log/catalina.2022-06-02.log\", \"jobUid\": \"3670030-65025\", \"offset\": 4960, \"collectTime\": \"2022-06-06 12:44:12.861\", \"version\": \"0.0.1\" }, \u5176\u4e2d\u7684 filename \u4e3aLoggie\u8f6c\u6362\u540e\u7684\u5b9e\u9645\u8282\u70b9\u4e0a\u7684\u65e5\u5fd7\u8def\u5f84\uff0c jobUid \u7ec4\u6210\u4e3a\u6587\u4ef6\u7684 inode-deviceId \uff0c offset \u4e3asink\u53d1\u9001\u6210\u529f\u63a5\u6536\u5230ack\u540e\u7684offset\u3002 \u53e6\u5916\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5728Loggie\u5bb9\u5668\u4e2d\u6267\u884c\uff1a stat ${filename} \u67e5\u770b\u6587\u4ef6\u7684size/inode\u7b49\u4fe1\u606f\uff0c\u4f8b\u5982\uff1a stat File : /var/lib/kubelet/pods/9397b8be-8927-44ba-8b94-73e5a4459377/volumes/kubernetes.io~empty-dir/log/catalina.2022-06-02.log Size : 4960 Blocks : 16 IO Block : 4096 regular file Device : fe01h/65025d Inode : 3670030 Links : 1 Access : (0640/-rw-r-----) Uid : ( 0/ root) Gid : ( 0/ root) Access : 2022-06-06 12:44:12.859236003 +0000 Modify : 2022-06-02 08:54:33.177240007 +0000 Change : 2022-06-02 08:54:33.177240007 +0000 \u53ef\u901a\u8fc7\u6bd4\u8f83size\u548coffset\u6765\u5224\u65ad\u91c7\u96c6\u8fdb\u5ea6\u3002\u5982\u679csize=offset\uff0c\u5219\u8bf4\u660e\u5df2\u7ecf\u6587\u4ef6\u5df2\u7ecf\u5168\u90e8\u91c7\u96c6\u5e76\u53d1\u9001\u6210\u529f\u3002","title":"4.  \u67e5\u770b\u65e5\u5fd7\u91c7\u96c6\u6301\u4e45\u5316\u72b6\u6001"},{"location":"user-guide/use-in-kubernetes/collect-container-logs/","text":"\u4f7f\u7528Loggie\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7 \u00b6 \u9605\u8bfb\u672c\u6587\u4e4b\u524d\uff0c\u5efa\u8bae\u5148\u53c2\u8003 Kubernetes\u4e0b\u65e5\u5fd7\u91c7\u96c6 \u95ee\u9898\u3002 Loggie\u5982\u4f55\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\uff1f \u00b6 \u7531\u4e8eKubernetes\u826f\u597d\u7684\u53ef\u6269\u5c55\u6027\uff0cKubernetes\u8bbe\u8ba1\u4e86\u4e00\u79cd\u81ea\u5b9a\u4e49\u8d44\u6e90CRD\u7684\u6982\u5ff5\uff0c\u7528\u6237\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49CRD\u8868\u793a\u81ea\u5df1\u7684\u671f\u671b\u72b6\u6001\uff0c\u5e76\u501f\u52a9\u4e00\u4e9bframework\u5f00\u53d1Controller\uff0c\u4f7f\u7528Controller\u5c06\u6211\u4eec\u7684\u671f\u671b\u53d8\u6210\u73b0\u5b9e\u3002 \u57fa\u4e8e\u8fd9\u4e2a\u601d\u8def\uff0c\u4e00\u4e2a\u670d\u52a1\u9700\u8981\u91c7\u96c6\u54ea\u4e9b\u65e5\u5fd7\uff0c\u9700\u8981\u4ec0\u4e48\u6837\u7684\u65e5\u5fd7\u914d\u7f6e\uff0c\u662f\u7528\u6237\u7684\u671f\u671b\uff0c\u800c\u8fd9\u5c31\u9700\u8981\u6211\u4eec\u5f00\u53d1\u4e00\u4e2a\u65e5\u5fd7\u91c7\u96c6\u7684Controller\u53bb\u5b9e\u73b0\u3002 \u6240\u4ee5\uff0c\u7528\u6237\u53ea\u9700\u8981\u5728\u6211\u4eec\u5b9a\u4e49\u7684CRD LogConfig\u4e2d\uff0c\u586b\u5199\u9700\u8981\u91c7\u96c6\u54ea\u4e9bPods\u7684\u65e5\u5fd7\uff0c\u5728Pod\u4e2d\u7684\u65e5\u5fd7\u8def\u5f84\u662f\u4ec0\u4e48\u3002 \u6838\u5fc3\u67b6\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff1a Loggie\u4f1a\u611f\u77e5\u5230Pod\u548cCRD\u7684\u4e8b\u4ef6\uff0c\u8fdb\u884c\u914d\u7f6e\u7684\u52a8\u6001\u66f4\u65b0\u3002\u540c\u65f6\uff0cLoggie\u53ef\u4ee5\u6839\u636e\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\u6302\u8f7d\u7684Volume\uff0c\u627e\u5230\u76f8\u5e94\u5728\u8282\u70b9\u7684\u6587\u4ef6\u8fdb\u884c\u91c7\u96c6\u3002\u53e6\u5916\u8fd8\u53ef\u4ee5\u6839\u636e\u914d\u7f6e\uff0c\u81ea\u52a8\u5c06Pod\u4e0a\u7684Env/Annotation/Label\u52a0\u5165\u5230\u65e5\u5fd7\u91cc\u4f5c\u4e3a\u5143\u4fe1\u606f\u3002 \u540c\u65f6\u76f8\u6bd4\u7c97\u66b4\u7684\u6240\u6709\u8282\u70b9\u6302\u8f7d\u76f8\u540c\u8def\u5f84\u8fdb\u884c\u901a\u914d\u91c7\u96c6\u7684\u65b9\u5f0f\uff0c\u4e5f\u89e3\u51b3\u4e86\u6ca1\u6cd5\u9488\u5bf9\u5355\u4e2a\u670d\u52a1\u7cbe\u7ec6\u5316\u914d\u7f6e\u3001\u91c7\u96c6\u65e0\u5173\u65e5\u5fd7\u7684\u95ee\u9898\u3002 \u5f53\u7136\u5e26\u6765\u7684\u597d\u5904\u4e0d\u4ec5\u4ec5\u8fd9\u4e9b\uff0cLoggie\u5728\u52a8\u6001\u914d\u7f6e\u4e0b\u53d1\u3001\u76d1\u63a7\u6307\u6807\u7b49\u65b9\u9762\u90fd\u53ef\u4ee5\u57fa\u4e8eKubernetes\u8fdb\u884c\u76f8\u5e94\u7684\u9002\u914d\u548c\u652f\u6301\u3002 CRD\u4f7f\u7528\u8bf4\u660e \u00b6 Loggie\u76ee\u524d\u6709\u4ee5\u4e0b\u51e0\u79cdCRD\uff1a LogConfig \uff1anamespace\u7ea7\u522bCRD\uff0c\u7528\u4e8e\u91c7\u96c6Pod\u5bb9\u5668\u65e5\u5fd7\uff0c\u5176\u4e2d\u4e3b\u8981\u586b\u5199\u91c7\u96c6\u7684source\u914d\u7f6e\uff0c\u4ee5\u53ca\u5173\u8054\u7684sink\u548cinterceptor\u3002 ClusterLogConfig \uff1acluster\u7ea7\u522bCRD\uff0c\u8868\u793a\u96c6\u7fa4\u7ea7\u522b\u7684\u91c7\u96c6Pod\u5bb9\u5668\u65e5\u5fd7\uff0c\u91c7\u96c6Node\u8282\u70b9\u4e0a\u7684\u65e5\u5fd7\uff0c\u4ee5\u53ca\u4e3a\u67d0\u4e2aLoggie\u96c6\u7fa4\u4e0b\u53d1\u901a\u7528\u7684pipeline\u914d\u7f6e\u3002 Sink \uff1a\u8868\u793a\u4e00\u4e2asink\u540e\u7aef\uff0c\u9700\u8981\u5728ClusterLogConfig/LogConfig\u4e2d\u88ab\u5173\u8054\u3002 Interceptor \uff1a\u8868\u793a\u4e00\u4e2ainterceptors\u7ec4\uff0c\u9700\u8981\u5728ClusterLogConfig/LogConfig\u4e2d\u88ab\u5173\u8054\u3002 \u4f7f\u7528CRD\u7684\u6d41\u7a0b\u67b6\u6784\u5982\u4e0b\u6240\u793a\uff1a \u51c6\u5907\u5de5\u4f5c \u00b6 \u90e8\u7f72\u67b6\u6784 \u00b6 \u6574\u4f53\u7684\u90e8\u7f72\u67b6\u6784\u662f\u4ec0\u4e48\uff1f Loggie Agent\u76f4\u63a5\u53d1\u9001\u7ed9\u540e\u7aef\u6bd4\u5982Elasticsearch\u8fd8\u662f\u5176\u4ed6\u5b58\u50a8\u7b49 Loggie Agent\u53d1\u9001\u81f3Loggie Aggregator\u4e2d\u8f6c\u5904\u7406\uff0c\u518d\u8f6c\u53d1\u81f3\u5176\u4ed6\u540e\u7aef\u5b58\u50a8 Loggie Agent\u53d1\u9001\u81f3Kafka\uff0cLoggie Aggregator\u6d88\u8d39Kafka\u518d\u53d1\u9001\u81f3\u540e\u7aef ... \u672c\u6587\u4ec5\u5173\u6ce8\u91c7\u96c6\u7aef\uff0c\u5982\u679c\u9700\u8981\u4f7f\u7528\u90e8\u7f72Loggie Aggregator\uff0c\u8bf7\u53c2\u8003 Loggie\u4e2d\u8f6c\u673a \u3002 \u5728\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\u4e4b\u524d\uff0c\u8bf7\u786e\u4fdd\u5df2\u7ecf\u5728Kubernetes\u4e2d\u90e8\u7f72\u4e86Loggie DaemonSet\u3002 \u5982\u4f55\u5728Kubernetes\u4e2d\u90e8\u7f72Loggie\uff1f Info \u6211\u4eec\u63a8\u8350\u4f7f\u7528DaemonSet\u7684\u65b9\u5f0f\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\uff0c\u540e\u7eedLoggie\u8ba1\u5212\u652f\u6301\u81ea\u52a8\u6ce8\u5165Loggie Sidecar\u7684\u65b9\u5f0f\u91c7\u96c6\u65e5\u5fd7\u3002 RoadMap \u4f7f\u7528\u65b9\u5f0f \u00b6 \u4e1a\u52a1Pod\u4f7f\u7528\u4ec0\u4e48\u65b9\u5f0f\u6302\u8f7d\u65e5\u5fd7\uff1f \u5efa\u8bae\u5982\u679c\u5bf9\u65e5\u5fd7\u53ef\u80fd\u6027\u7684\u4e22\u5931\u4e0d\u654f\u611f\uff0c\u6bd4\u5982\u8fd0\u7ef4\u7c7b\u7684\u65e5\u5fd7\uff0c\u53ef\u4ee5\u4f7f\u7528emptyDir\u3002\u5982\u679c\u65e5\u5fd7\u6bd4\u8f83\u91cd\u8981\uff0c\u4e0d\u5141\u8bb8\u4e22\u5931\uff0c\u8bf7\u4f7f\u7528hostPath\uff0c\u5e76\u5728volumeMount\u914d\u7f6esubPathExpr\u5b9e\u73b0\u8def\u5f84\u9694\u79bb\u3002 Example tomcat-emptydir.yml apiVersion : apps/v1 kind : Deployment metadata : labels : app : tomcat name : tomcat namespace : default spec : replicas : 1 selector : matchLabels : app : tomcat template : metadata : labels : app : tomcat spec : containers : - name : tomcat image : tomcat volumeMounts : - mountPath : /usr/local/tomcat/logs name : log volumes : - emptyDir : {} name : log tomcat-hostpath.yml apiVersion : apps/v1 kind : Deployment metadata : labels : app : tomcat name : tomcat namespace : default spec : replicas : 1 selector : matchLabels : app : tomcat template : metadata : labels : app : tomcat spec : containers : - env : - name : POD_NAME valueFrom : fieldRef : apiVersion : v1 fieldPath : metadata.name - name : NAMESPACE valueFrom : fieldRef : apiVersion : v1 fieldPath : metadata.namespace image : tomcat name : tomcat volumeMounts : - mountPath : /log name : datalog subPathExpr : $(NAMESPACE)/$(POD_NAME) volumes : - hostPath : path : /data/log type : \"\" name : datalog Caution \u8bf7\u786e\u4fddPod\u6302\u8f7d\u7684\u65e5\u5fd7\u8def\u5f84\u4e0d\u4f1a\u88ab\u591a\u4e2aPod\u5171\u4eab\u3002\u6bd4\u5982\u4e00\u4e2aDeployment\u4e0b\u7684\u4e24\u4e2aPod\uff0c\u4f7f\u7528\u672a\u914d\u7f6esubPathExpr\u7684hostPath\u6302\u8f7d\u65e5\u5fd7\u76ee\u5f55\uff0c\u5982\u679c\u4e24\u4e2aPod\u8c03\u5ea6\u5728\u76f8\u540c\u7684\u8282\u70b9\uff0c\u4f1a\u6253\u5370\u5230\u76f8\u540c\u7684\u65e5\u5fd7\u76ee\u5f55\u548c\u6587\u4ef6\u4e2d\uff0c\u6b64\u65f6\u53ef\u80fd\u5f15\u8d77\u91c7\u96c6\u5f02\u5e38\u3002 \u6211\u4eec\u9996\u5148\u521b\u5efa\u4ee5\u4e0a\u793a\u4f8b\u7684tomcat Deployment\u4f5c\u4e3a\u6211\u4eec\u88ab\u91c7\u96c6\u65e5\u5fd7\u7684\u5bf9\u8c61\u3002 kubectl apply -f tomcat-emptydir.yml \u63a5\u4e0b\u6765\u5c06\u6f14\u793a\u91c7\u96c6\u4e0a\u9762\u793a\u4f8b\u7684tomcat\u65e5\u5fd7\uff0c\u5e76\u53d1\u9001\u81f3Elasticsearch\u3002 \u5982\u679c\u4f60\u5e0c\u671b\u91c7\u96c6\u5176\u4ed6\u7684\u5bb9\u5668\u65e5\u5fd7\uff0c\u6216\u8005\u53d1\u9001\u81f3\u5176\u4ed6\u7684\u540e\u7aef\uff0c\u53ea\u9700\u8981\u4fee\u6539\u5176\u4e2d\u7684\u914d\u7f6e\u5373\u53ef\u3002 \u90e8\u7f72Elasticsearch\u548cKibana\uff08\u53ef\u9009\uff09 \u00b6 \u7531\u4e8e\u672c\u6587\u6f14\u793a\u53d1\u9001\u81f3Elasticsearch\uff0c\u6240\u4ee5\u8fd9\u91cc\u6211\u4eec\u90e8\u7f72\u4e00\u4e0bElasticsearch\u548cKibana\u3002 \u5982\u679c\u4f60\u7684\u73af\u5883\u4e2d\u5df2\u7ecf\u6709Elasticsearch\u548cKibana\uff0c\u8fd9\u4e00\u6b65\u53ef\u4ee5\u5ffd\u7565\u3002 \u5982\u679c\u5e0c\u671b\u81ea\u5df1\u642d\u5efa\u4e00\u5957Elasticsearch\u548cKibana\u8bd5\u7528\uff0c\u8fd9\u91cc\u5efa\u8bae\uff1a \u4f7f\u7528Helm\u90e8\u7f72Elasticsearch \u4f7f\u7528Helm\u90e8\u7f72Kibana \u5982\u679c\u672c\u5730\u6ca1\u6709helm\u5ba2\u6237\u7aef\uff0c\u9700\u8981\u4e0b\u8f7d helm \u3002 \u4f7f\u7528\u5982\u4e0b\u547d\u4ee4: helm repo add elastic https://helm.elastic.co helm install elasticsearch elastic/elasticsearch --set replicas = 1 helm install kibana elastic/kibana \u901a\u8fc7\uff1a kubectl port-forward service/kibana-kibana 5601 :http \u53ef\u4ee5\u76f4\u63a5\u5728\u6d4f\u89c8\u5668\u8f93\u5165 localhost:5601 \uff0c\u8bbf\u95eeKibana\u9875\u9762\u3002 \u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7 \u00b6 \u521b\u5efasink \u00b6 \u4e3a\u4e86\u8868\u660e\u6211\u4eec\u5373\u5c06\u91c7\u96c6\u65e5\u5fd7\u53d1\u9001\u5230\u7684Elasticsearch\uff0c\u9700\u8981\u914d\u7f6e\u5bf9\u5e94\u7684Sink\u3002 \u8fd9\u91cc\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a \u5982\u679c\u6574\u4e2a\u96c6\u7fa4\u53ea\u4f1a\u6709\u4e00\u4e2a\u5b58\u50a8\u540e\u7aef\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u5168\u5c40\u7684\u914d\u7f6e\u6587\u4ef6configMap\u91cc\uff0c\u914d\u7f6edefaults\u53c2\u6570\uff0c\u5177\u4f53\u53ef \u53c2\u8003 \u3002 \u4f7f\u7528Sink CRD\uff0c\u5e76\u5728logConfig\u4e2d\u5f15\u7528\u3002\u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u6269\u5c55\u4e3a\u591a\u4e2a\u540e\u7aef\uff0c\u4e0d\u540c\u7684logConfig\u53ef\u4ee5\u914d\u7f6e\u4f7f\u7528\u4e0d\u540c\u7684\u540e\u7aef\u5b58\u50a8\uff0c\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u8be5\u65b9\u5f0f\u3002 \u521b\u5efa\u4e00\u4e2aSink\u5982\u4e0b\uff0cSink\u4e3a\u96c6\u7fa4\u7ea7\u522bCRD\u3002\u53ef\u4ee5\u5728spec.sink\u4e2d\u4fee\u6539\u4e3a\u5176\u4ed6\u914d\u7f6e\u3002 Example cat << EOF | kubectl apply -f - apiVersion : loggie.io/v1beta1 kind : Sink metadata : name : default spec : sink : | type: elasticsearch index: \"loggie\" hosts: [\"elasticsearch-master.default.svc:9200\"] EOF \u53ef\u4ee5\u901a\u8fc7 kubectl get sink default \u67e5\u770b\u662f\u5426\u521b\u5efa\u6210\u529f\u3002 \u521b\u5efainterceptor(\u53ef\u9009) \u00b6 \u548cSink\u4e00\u6837\uff0c\u914d\u7f6einterceptor\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a \u5728\u5168\u5c40\u914d\u7f6e\u6587\u4ef6configMap\u4e2d\uff0c\u914d\u7f6edefaults\u53c2\u6570\u3002\u6b64\u65f6\u610f\u5473\u7740\u6240\u6709\u7684Loggie Agent\u90fd\u4f7f\u7528\u8be5default interceptors\u914d\u7f6e\u3002 \u4f7f\u7528Interceptor CRD\uff0c\u5e76\u5728logConfig\u4e2d\u88ab\u5f15\u7528\u3002\u8fd9\u79cd\u65b9\u5f0f\u4f1a\u66f4\u52a0\u7075\u6d3b\uff0c\u9002\u5408\u6709\u4e00\u5b9a\u8fd0\u7ef4\u548c\u529f\u80fd\u9700\u6c42\u7684\u573a\u666f\u3002 Loggie\u76ee\u524d\u9ed8\u8ba4\u5185\u7f6e\u4e86 metric \uff08\u76d1\u63a7\u6307\u6807\u53d1\u9001\uff09\u3001 maxbytes \uff08\u6700\u5927event\u5b57\u8282\u6570\u9650\u5236\uff09\u3001 retry \uff08\u91cd\u8bd5\uff09\u4e09\u4e2ainterceptors\u3002\u5373\u4f7f\u6211\u4eec\u6ca1\u6709\u4f7f\u7528\u4ee5\u4e0a\u4e24\u79cd\u65b9\u5f0f\u914d\u7f6e\uff0c\u4ecd\u7136\u4f1a\u81ea\u52a8\u4f7f\u7528\u8fd93\u4e2a\u9ed8\u8ba4interceptor\uff0c\u6240\u4ee5interceptor\u5176\u5b9e\u662f\u53ef\u9009\u9879\u3002 Caution \u5728\u5168\u5c40\u7684defaults\u4e2d\uff0c\u914d\u7f6einterceptors\uff0c\u4f1a\u8986\u76d6\u6389\u73b0\u6709\u7684\u5185\u7f6einterceptors\uff0c\u6240\u4ee5\u5982\u679c\u4f7f\u7528\u5168\u5c40defaults\u914d\u7f6einterceptors\uff0c\u8bf7\u628a\u5185\u7f6e\u7684interceptors\u90fd\u52a0\u4e0a\uff0c\u9664\u975e\u4f60\u786e\u5b9a\u4e0d\u9700\u8981\u3002 \u4f7f\u7528interceptor CRD\u914d\u7f6e\u7684logConfig\uff0c\u4e0d\u4f1a\u8986\u76d6\u9ed8\u8ba4\u548c\u5185\u7f6e\u7684interceptors\uff0c\u4f1a\u901a\u8fc7\u65b0\u589e\u7684\u65b9\u5f0f\u52a0\u5165\u6574\u4e2apipeline interceptors chain\u3002 \u521b\u5efa\u4e00\u4e2ainterceptor\u793a\u4f8b\u5982\u4e0b\uff1a Example cat << EOF | kubectl apply -f - apiVersion : loggie.io/v1beta1 kind : Interceptor metadata : name : default spec : interceptors : | - type: rateLimit qps: 90000 EOF \u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a rateLimit interceptor\uff0c\u53ef\u7528\u4e8e\u91c7\u96c6\u53d1\u9001\u65e5\u5fd7\u7684\u9650\u6d41\u3002 \u53ef\u4ee5\u901a\u8fc7 kubectl get interceptor default \u6216\u8005 kubectl get icp default \u67e5\u770b\u662f\u5426\u521b\u5efa\u6210\u529f\u3002 \u521b\u5efalogConfig \u00b6 \u521b\u5efa\u5b8csink\u548cinterceptor\u540e\uff0c\u6700\u91cd\u8981\u7684\u4fbf\u662f\u521b\u5efalogConfig\uff0c\u8868\u660e\u6211\u4eec\u5e0c\u671b\u91c7\u96c6\u54ea\u4e9bPod\u7684\u65e5\u5fd7\uff0c\u4ee5\u53ca\u91c7\u96c6Pod\u7684\u54ea\u4e9b\u65e5\u5fd7\u3002 logConfig\u91ccspec.selector\u90e8\u5206\u8868\u793a\u65e5\u5fd7\u914d\u7f6e\u7684\u4e0b\u53d1\u8303\u56f4\uff0c\u5bf9\u91c7\u96c6Pod\u65e5\u5fd7\u6765\u8bf4\uff0c\u9700\u8981\u914d\u7f6e type: pod \uff0c\u5e76\u4e14\u4f7f\u7528 labelSelector \u9009\u62e9\u6307\u5b9a\u7684Pods\uff0c\u5373\u91c7\u96c6\u8fd9\u4e9bPods\u7684\u65e5\u5fd7\u3002 \u793a\u4f8b\u5982\u4e0b\uff1a spec : selector : type : pod labelSelector : app : tomcat \u53e6\u5916\uff0c\u6211\u4eec\u9700\u8981\u5728pipeline.sources\u4e2d\u914d\u7f6efile source\uff0c\u5373\u91c7\u96c6Pods\u7684\u54ea\u4e9b\u65e5\u5fd7\u3002 pipeline : sources : | - type: file name: mylog paths: - stdout - /var/log/*.log \u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a path\u91cc\u586b stdout \uff0c\u8868\u793a\u91c7\u96c6\u5bb9\u5668\u7684\u6807\u51c6\u8f93\u51fa\u8def\u5f84\u3002 path\u91cc\u586b\u5199\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u662f\u5bb9\u5668\u91cc\u7684\u8def\u5f84\u3002\uff08\u6700\u7ec8\u751f\u6210\u914d\u7f6e\u7684\u65f6\u5019\uff0cLoggie\u4f1a\u81ea\u52a8\u66f4\u65b0\u6210\u8282\u70b9\u4e0a\u7684\u8def\u5f84\uff0c\u65e0\u9700\u7528\u6237\u5173\u5fc3\uff09 path\u8bf7\u4f7f\u7528glob\u8868\u8fbe\u5f0f\u586b\u5199\u3002 \u5f53 type: pod \u65f6\uff0cpipeline.name\u4f1a\u88abloggie\u81ea\u52a8\u6309\u7167 ${namespace}-${logConfigName} \u7684\u683c\u5f0f\u751f\u6210\uff0c\u6240\u4ee5\u8fd9\u91cc\u65e0\u9700\u586b\u5199\u3002 \u6700\u7ec8\u751f\u6210\u7684source.name\u4f1a\u6309\u7167 ${podName}-${containerName}-${sourceName} \u683c\u5f0f\u751f\u6210\u3002 \u6700\u540e\uff0c\u6211\u4eec\u4f7f\u7528sinkRef\u548cinterceptorRef\u5f15\u7528\u4e0a\u9762\u521b\u5efa\u7684sink\u548cinterceptor\u3002 \u6700\u7ec8\u521b\u5efa\u4e00\u4e2alogConfig\u793a\u4f8b\u5982\u4e0b\uff1a Example cat << EOF | kubectl apply -f - apiVersion : loggie.io/v1beta1 kind : LogConfig metadata : name : tomcat namespace : default spec : selector : type : pod labelSelector : app : tomcat pipeline : sources : | - type: file name: common paths: - stdout - /usr/local/tomcat/logs/*.log sinkRef : default interceptorRef : default EOF \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 kubectl get logconfig tomcat \u6216\u8005 kubectl get lgc tomcat \u6765\u67e5\u770b\u662f\u5426\u521b\u5efa\u6210\u529f\u3002 \u540c\u65f6\u53ef\u4ee5\u901a\u8fc7 kubectl describe lgc tomcat \u67e5\u770blogConfig\u7684events\uff0c\u7528\u4e8e\u6392\u67e5\u72b6\u6001\u3002 \u5982\u679c\u6709\u4ee5\u4e0b\u7c7b\u4f3c\u7684events\uff0c\u8bf4\u660e\u914d\u7f6e\u5df2\u7ecf\u4e0b\u53d1\u6210\u529f\u3002 Events: Type Reason Age From Message ---- ------ ---- ---- ------- Normal syncSuccess 55s loggie/kind-control-plane Sync type pod [tomcat-684c698b66-hvztn] success \u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7 kubectl -nloggie logs -f ${loggie-name} \u6765\u67e5\u770b\u6307\u5b9a\u8282\u70b9Loggie\u7684\u65e5\u5fd7\u6765\u5224\u65ad\u65e5\u5fd7\u91c7\u96c6\u60c5\u51b5\u3002 \u53d1\u9001\u6210\u529f\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728Kibana\u4e0a\u67e5\u8be2\u5230\u91c7\u96c6\u5230\u7684\u65e5\u5fd7\u3002 \u81ea\u52a8\u89e3\u6790\u5bb9\u5668\u6807\u51c6\u8f93\u51fa\u539f\u59cb\u65e5\u5fd7 \u00b6 \u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u91c7\u96c6\u5230\u7684\u6807\u51c6\u8f93\u51fa\u5e76\u4e0d\u662f\u6253\u5370\u7684\u65e5\u5fd7\u5185\u5bb9\uff0c\u800c\u662f\u88ab\u5bb9\u5668\u8fd0\u884c\u65f6\u589e\u52a0\u4e86\u4e00\u5c42\u5c01\u88c5\u3002 \u4f8b\u5982docker\u7684\u6807\u51c6\u8f93\u51fa\u4e3ajson\u5f62\u5f0f\uff1a { \"log\" : \"I0610 08:29:07.698664 Waiting for caches to sync\\n\" , \"stream\" : \"stderr\" , \"time:\" 2021-06-10 T 08 : 29 : 07.698731204 Z\"} \u4e1a\u52a1\u6253\u5370\u7684\u539f\u59cb\u65e5\u5fd7\u5185\u5bb9\u5b58\u50a8\u5728log\u5b57\u6bb5\u91cc\u3002 containerd\u7684\u6807\u51c6\u8f93\u51fa\u5f62\u5f0f\u7c7b\u4f3c\u5982\u4e0b\uff1a 2021-12-01T03:13:58.298476921Z stderr F INFO [main] Starting service [Catalina] \u524d\u9762 2021-12-01T03:13:58.298476921Z stderr F \u4e3a\u8fd0\u884c\u65f6\u589e\u52a0\u7684\u524d\u7f00\u5185\u5bb9\uff0c\u540e\u9762\u5219\u4e3a\u539f\u59cb\u7684\u65e5\u5fd7\u3002 \u7279\u522b\u662f\u5982\u679c\u6211\u4eec\u914d\u7f6e\u4e86\u65e5\u5fd7\u91c7\u96c6\u591a\u884c\u914d\u7f6e\uff0c\u56e0\u4e3a\u91c7\u96c6\u5230\u7684\u65e5\u5fd7\u5185\u5bb9\u548c\u4e1a\u52a1\u8f93\u51fa\u7684\u65e5\u5fd7\u4e0d\u4e00\u81f4\uff0c\u4f1a\u5bfc\u81f4\u91c7\u96c6\u6807\u51c6\u8f93\u51fa\u65e5\u5fd7\u5339\u914d\u591a\u884c\u6709\u95ee\u9898\u3002 \u6240\u4ee5\uff0cLoggie\u63d0\u4f9b\u4e86\u4e00\u952e\u5f00\u5173\u914d\u7f6e\uff0c\u5728\u7cfb\u7edf\u914d\u7f6e\u4e2d\uff0c\u5c06 parseStdout \u53c2\u6570\u8bbe\u7f6e\u4e3atrue\u5373\u53ef\u3002 parseStdout config : loggie : discovery : enabled : true kubernetes : parseStdout : true Loggie\u4f1a\u5728\u6e32\u67d3LogConfig\u7684\u65f6\u5019\u81ea\u52a8\u589e\u52a0source codec\u89e3\u6790\u51fa\u539f\u59cb\u7684\u4e1a\u52a1\u65e5\u5fd7\u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a \u4ec5\u5f53LogConfig\u914d\u7f6e\u91cc\u7684paths\u5355\u72ec\u4e3a stdout \u65f6\u6709\u6548\uff1a \u3010\u6709\u6548\u3011 sources : | - type: file name: common paths: - stdout \u3010\u65e0\u6548\u3011 sources : | - type: file name: common paths: - stdout - /usr/local/tomcat/logs/*.log \u4e0a\u9762\u9700\u8981\u6539\u6210\u4e24\u4e2asource\uff1a \u3010\u6709\u6548\u3011 sources : | - type: file name: stdout paths: - stdout - type: file name: tomcat paths: - /usr/local/tomcat/logs/*.log \u76ee\u524d\u53ea\u4f1a\u4fdd\u7559\u539f\u59cb\u7684\u65e5\u5fd7\u5185\u5bb9\u5230 body \u4e2d\uff0c\u5176\u4f59\u8fd0\u884c\u65f6\u9644\u52a0\u7684\u5b57\u6bb5\u4f1a\u88ab\u4e22\u5f03\u3002 \u81ea\u52a8\u89e3\u6790stdout\u5b9e\u9645\u4e0a\u662f\u5728LogConfig\u6e32\u67d3\u6210Pipeline\u914d\u7f6e\u65f6\u81ea\u52a8\u589e\u52a0source codec\u6765\u5b9e\u73b0\u3002 \u65e0\u9700\u6302\u8f7dvolume\u7684\u5bb9\u5668\u65e5\u5fd7\u91c7\u96c6 \u00b6 \u867d\u7136\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u6302\u8f7dvolume(emptyDir/hostPath+subPathExpr)\u7684\u65b9\u5f0f\u5c06\u65e5\u5fd7\u6587\u4ef6\u6302\u51fa\u7ed9Loggie\u91c7\u96c6\uff0c\u4f46\u4ecd\u7136\u5b58\u5728\u5f88\u591a\u60c5\u51b5\u6211\u4eec\u6ca1\u529e\u6cd5\u5c06\u4e1a\u52a1\u7684Pod\u7edf\u4e00\u6302\u8f7d\u51fa\u65e5\u5fd7\u8def\u5f84\u3002 \u6bd4\u5982\u4e00\u4e9b\u57fa\u7840\u7ec4\u4ef6\u65e0\u6cd5\u914d\u7f6e\u72ec\u7acb\u7684\u65e5\u5fd7volume\uff0c\u6216\u8005\u4e1a\u52a1\u5355\u7eaf\u7684\u4e0d\u613f\u610f\u6539\u90e8\u7f72\u914d\u7f6e\u3002 Loggie\u63d0\u4f9b\u4e86\u65e0\u9700\u6302\u8f7d\u5373\u53ef\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\u7684\u80fd\u529b\uff0c\u53ef\u81ea\u52a8\u8bc6\u522b\u5e76\u91c7\u96c6\u5bb9\u5668root filesystem\u91cc\u7684\u65e5\u5fd7\u6587\u4ef6\u3002 \u4f60\u53ea\u9700\u8981\u5c06\u90e8\u7f72\u7684helm chart\u4e2dvalues.yml\u91cc\u7684\u914d\u7f6e rootFsCollectionEnabled \u8bbe\u7f6e\u4e3atrue\uff0c \u540c\u65f6\u586b\u4e0a\u5b9e\u9645\u73af\u5883\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\uff08docker/containerd\uff09\uff0c\u5982\u4e0b\u6240\u793a\uff1a rootFsCollectionEnabled config : loggie : discovery : enabled : true kubernetes : containerRuntime : containerd rootFsCollectionEnabled : false \u4fee\u6539\u5b8c\u6210\u540e\uff0c\u91cd\u65b0helm upgrade\u5373\u53ef\u3002 helm\u6a21\u7248\u4f1a\u81ea\u52a8\u6e32\u67d3\u589e\u52a0\u989d\u5916\u7684\u4e00\u4e9b\u6302\u8f7d\u8def\u5f84\u548c\u914d\u7f6e\uff0c\u5982\u679c\u4f60\u4ece\u4f4e\u7248\u672c\u5347\u7ea7\uff0c\u9700\u8981\u989d\u5916\u4fee\u6539\u90e8\u7f72\u7684Daemonset yaml\u3002 \u5177\u4f53\u539f\u7406\u8bf7\u53c2\u8003issues #208 \u3002","title":"Loggie\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7"},{"location":"user-guide/use-in-kubernetes/collect-container-logs/#loggie","text":"\u9605\u8bfb\u672c\u6587\u4e4b\u524d\uff0c\u5efa\u8bae\u5148\u53c2\u8003 Kubernetes\u4e0b\u65e5\u5fd7\u91c7\u96c6 \u95ee\u9898\u3002","title":"\u4f7f\u7528Loggie\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7"},{"location":"user-guide/use-in-kubernetes/collect-container-logs/#loggie_1","text":"\u7531\u4e8eKubernetes\u826f\u597d\u7684\u53ef\u6269\u5c55\u6027\uff0cKubernetes\u8bbe\u8ba1\u4e86\u4e00\u79cd\u81ea\u5b9a\u4e49\u8d44\u6e90CRD\u7684\u6982\u5ff5\uff0c\u7528\u6237\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49CRD\u8868\u793a\u81ea\u5df1\u7684\u671f\u671b\u72b6\u6001\uff0c\u5e76\u501f\u52a9\u4e00\u4e9bframework\u5f00\u53d1Controller\uff0c\u4f7f\u7528Controller\u5c06\u6211\u4eec\u7684\u671f\u671b\u53d8\u6210\u73b0\u5b9e\u3002 \u57fa\u4e8e\u8fd9\u4e2a\u601d\u8def\uff0c\u4e00\u4e2a\u670d\u52a1\u9700\u8981\u91c7\u96c6\u54ea\u4e9b\u65e5\u5fd7\uff0c\u9700\u8981\u4ec0\u4e48\u6837\u7684\u65e5\u5fd7\u914d\u7f6e\uff0c\u662f\u7528\u6237\u7684\u671f\u671b\uff0c\u800c\u8fd9\u5c31\u9700\u8981\u6211\u4eec\u5f00\u53d1\u4e00\u4e2a\u65e5\u5fd7\u91c7\u96c6\u7684Controller\u53bb\u5b9e\u73b0\u3002 \u6240\u4ee5\uff0c\u7528\u6237\u53ea\u9700\u8981\u5728\u6211\u4eec\u5b9a\u4e49\u7684CRD LogConfig\u4e2d\uff0c\u586b\u5199\u9700\u8981\u91c7\u96c6\u54ea\u4e9bPods\u7684\u65e5\u5fd7\uff0c\u5728Pod\u4e2d\u7684\u65e5\u5fd7\u8def\u5f84\u662f\u4ec0\u4e48\u3002 \u6838\u5fc3\u67b6\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff1a Loggie\u4f1a\u611f\u77e5\u5230Pod\u548cCRD\u7684\u4e8b\u4ef6\uff0c\u8fdb\u884c\u914d\u7f6e\u7684\u52a8\u6001\u66f4\u65b0\u3002\u540c\u65f6\uff0cLoggie\u53ef\u4ee5\u6839\u636e\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\u6302\u8f7d\u7684Volume\uff0c\u627e\u5230\u76f8\u5e94\u5728\u8282\u70b9\u7684\u6587\u4ef6\u8fdb\u884c\u91c7\u96c6\u3002\u53e6\u5916\u8fd8\u53ef\u4ee5\u6839\u636e\u914d\u7f6e\uff0c\u81ea\u52a8\u5c06Pod\u4e0a\u7684Env/Annotation/Label\u52a0\u5165\u5230\u65e5\u5fd7\u91cc\u4f5c\u4e3a\u5143\u4fe1\u606f\u3002 \u540c\u65f6\u76f8\u6bd4\u7c97\u66b4\u7684\u6240\u6709\u8282\u70b9\u6302\u8f7d\u76f8\u540c\u8def\u5f84\u8fdb\u884c\u901a\u914d\u91c7\u96c6\u7684\u65b9\u5f0f\uff0c\u4e5f\u89e3\u51b3\u4e86\u6ca1\u6cd5\u9488\u5bf9\u5355\u4e2a\u670d\u52a1\u7cbe\u7ec6\u5316\u914d\u7f6e\u3001\u91c7\u96c6\u65e0\u5173\u65e5\u5fd7\u7684\u95ee\u9898\u3002 \u5f53\u7136\u5e26\u6765\u7684\u597d\u5904\u4e0d\u4ec5\u4ec5\u8fd9\u4e9b\uff0cLoggie\u5728\u52a8\u6001\u914d\u7f6e\u4e0b\u53d1\u3001\u76d1\u63a7\u6307\u6807\u7b49\u65b9\u9762\u90fd\u53ef\u4ee5\u57fa\u4e8eKubernetes\u8fdb\u884c\u76f8\u5e94\u7684\u9002\u914d\u548c\u652f\u6301\u3002","title":"Loggie\u5982\u4f55\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\uff1f"},{"location":"user-guide/use-in-kubernetes/collect-container-logs/#crd","text":"Loggie\u76ee\u524d\u6709\u4ee5\u4e0b\u51e0\u79cdCRD\uff1a LogConfig \uff1anamespace\u7ea7\u522bCRD\uff0c\u7528\u4e8e\u91c7\u96c6Pod\u5bb9\u5668\u65e5\u5fd7\uff0c\u5176\u4e2d\u4e3b\u8981\u586b\u5199\u91c7\u96c6\u7684source\u914d\u7f6e\uff0c\u4ee5\u53ca\u5173\u8054\u7684sink\u548cinterceptor\u3002 ClusterLogConfig \uff1acluster\u7ea7\u522bCRD\uff0c\u8868\u793a\u96c6\u7fa4\u7ea7\u522b\u7684\u91c7\u96c6Pod\u5bb9\u5668\u65e5\u5fd7\uff0c\u91c7\u96c6Node\u8282\u70b9\u4e0a\u7684\u65e5\u5fd7\uff0c\u4ee5\u53ca\u4e3a\u67d0\u4e2aLoggie\u96c6\u7fa4\u4e0b\u53d1\u901a\u7528\u7684pipeline\u914d\u7f6e\u3002 Sink \uff1a\u8868\u793a\u4e00\u4e2asink\u540e\u7aef\uff0c\u9700\u8981\u5728ClusterLogConfig/LogConfig\u4e2d\u88ab\u5173\u8054\u3002 Interceptor \uff1a\u8868\u793a\u4e00\u4e2ainterceptors\u7ec4\uff0c\u9700\u8981\u5728ClusterLogConfig/LogConfig\u4e2d\u88ab\u5173\u8054\u3002 \u4f7f\u7528CRD\u7684\u6d41\u7a0b\u67b6\u6784\u5982\u4e0b\u6240\u793a\uff1a","title":"CRD\u4f7f\u7528\u8bf4\u660e"},{"location":"user-guide/use-in-kubernetes/collect-container-logs/#_1","text":"","title":"\u51c6\u5907\u5de5\u4f5c"},{"location":"user-guide/use-in-kubernetes/collect-container-logs/#_2","text":"\u6574\u4f53\u7684\u90e8\u7f72\u67b6\u6784\u662f\u4ec0\u4e48\uff1f Loggie Agent\u76f4\u63a5\u53d1\u9001\u7ed9\u540e\u7aef\u6bd4\u5982Elasticsearch\u8fd8\u662f\u5176\u4ed6\u5b58\u50a8\u7b49 Loggie Agent\u53d1\u9001\u81f3Loggie Aggregator\u4e2d\u8f6c\u5904\u7406\uff0c\u518d\u8f6c\u53d1\u81f3\u5176\u4ed6\u540e\u7aef\u5b58\u50a8 Loggie Agent\u53d1\u9001\u81f3Kafka\uff0cLoggie Aggregator\u6d88\u8d39Kafka\u518d\u53d1\u9001\u81f3\u540e\u7aef ... \u672c\u6587\u4ec5\u5173\u6ce8\u91c7\u96c6\u7aef\uff0c\u5982\u679c\u9700\u8981\u4f7f\u7528\u90e8\u7f72Loggie Aggregator\uff0c\u8bf7\u53c2\u8003 Loggie\u4e2d\u8f6c\u673a \u3002 \u5728\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\u4e4b\u524d\uff0c\u8bf7\u786e\u4fdd\u5df2\u7ecf\u5728Kubernetes\u4e2d\u90e8\u7f72\u4e86Loggie DaemonSet\u3002 \u5982\u4f55\u5728Kubernetes\u4e2d\u90e8\u7f72Loggie\uff1f Info \u6211\u4eec\u63a8\u8350\u4f7f\u7528DaemonSet\u7684\u65b9\u5f0f\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\uff0c\u540e\u7eedLoggie\u8ba1\u5212\u652f\u6301\u81ea\u52a8\u6ce8\u5165Loggie Sidecar\u7684\u65b9\u5f0f\u91c7\u96c6\u65e5\u5fd7\u3002 RoadMap","title":"\u90e8\u7f72\u67b6\u6784"},{"location":"user-guide/use-in-kubernetes/collect-container-logs/#_3","text":"\u4e1a\u52a1Pod\u4f7f\u7528\u4ec0\u4e48\u65b9\u5f0f\u6302\u8f7d\u65e5\u5fd7\uff1f \u5efa\u8bae\u5982\u679c\u5bf9\u65e5\u5fd7\u53ef\u80fd\u6027\u7684\u4e22\u5931\u4e0d\u654f\u611f\uff0c\u6bd4\u5982\u8fd0\u7ef4\u7c7b\u7684\u65e5\u5fd7\uff0c\u53ef\u4ee5\u4f7f\u7528emptyDir\u3002\u5982\u679c\u65e5\u5fd7\u6bd4\u8f83\u91cd\u8981\uff0c\u4e0d\u5141\u8bb8\u4e22\u5931\uff0c\u8bf7\u4f7f\u7528hostPath\uff0c\u5e76\u5728volumeMount\u914d\u7f6esubPathExpr\u5b9e\u73b0\u8def\u5f84\u9694\u79bb\u3002 Example tomcat-emptydir.yml apiVersion : apps/v1 kind : Deployment metadata : labels : app : tomcat name : tomcat namespace : default spec : replicas : 1 selector : matchLabels : app : tomcat template : metadata : labels : app : tomcat spec : containers : - name : tomcat image : tomcat volumeMounts : - mountPath : /usr/local/tomcat/logs name : log volumes : - emptyDir : {} name : log tomcat-hostpath.yml apiVersion : apps/v1 kind : Deployment metadata : labels : app : tomcat name : tomcat namespace : default spec : replicas : 1 selector : matchLabels : app : tomcat template : metadata : labels : app : tomcat spec : containers : - env : - name : POD_NAME valueFrom : fieldRef : apiVersion : v1 fieldPath : metadata.name - name : NAMESPACE valueFrom : fieldRef : apiVersion : v1 fieldPath : metadata.namespace image : tomcat name : tomcat volumeMounts : - mountPath : /log name : datalog subPathExpr : $(NAMESPACE)/$(POD_NAME) volumes : - hostPath : path : /data/log type : \"\" name : datalog Caution \u8bf7\u786e\u4fddPod\u6302\u8f7d\u7684\u65e5\u5fd7\u8def\u5f84\u4e0d\u4f1a\u88ab\u591a\u4e2aPod\u5171\u4eab\u3002\u6bd4\u5982\u4e00\u4e2aDeployment\u4e0b\u7684\u4e24\u4e2aPod\uff0c\u4f7f\u7528\u672a\u914d\u7f6esubPathExpr\u7684hostPath\u6302\u8f7d\u65e5\u5fd7\u76ee\u5f55\uff0c\u5982\u679c\u4e24\u4e2aPod\u8c03\u5ea6\u5728\u76f8\u540c\u7684\u8282\u70b9\uff0c\u4f1a\u6253\u5370\u5230\u76f8\u540c\u7684\u65e5\u5fd7\u76ee\u5f55\u548c\u6587\u4ef6\u4e2d\uff0c\u6b64\u65f6\u53ef\u80fd\u5f15\u8d77\u91c7\u96c6\u5f02\u5e38\u3002 \u6211\u4eec\u9996\u5148\u521b\u5efa\u4ee5\u4e0a\u793a\u4f8b\u7684tomcat Deployment\u4f5c\u4e3a\u6211\u4eec\u88ab\u91c7\u96c6\u65e5\u5fd7\u7684\u5bf9\u8c61\u3002 kubectl apply -f tomcat-emptydir.yml \u63a5\u4e0b\u6765\u5c06\u6f14\u793a\u91c7\u96c6\u4e0a\u9762\u793a\u4f8b\u7684tomcat\u65e5\u5fd7\uff0c\u5e76\u53d1\u9001\u81f3Elasticsearch\u3002 \u5982\u679c\u4f60\u5e0c\u671b\u91c7\u96c6\u5176\u4ed6\u7684\u5bb9\u5668\u65e5\u5fd7\uff0c\u6216\u8005\u53d1\u9001\u81f3\u5176\u4ed6\u7684\u540e\u7aef\uff0c\u53ea\u9700\u8981\u4fee\u6539\u5176\u4e2d\u7684\u914d\u7f6e\u5373\u53ef\u3002","title":"\u4f7f\u7528\u65b9\u5f0f"},{"location":"user-guide/use-in-kubernetes/collect-container-logs/#elasticsearchkibana","text":"\u7531\u4e8e\u672c\u6587\u6f14\u793a\u53d1\u9001\u81f3Elasticsearch\uff0c\u6240\u4ee5\u8fd9\u91cc\u6211\u4eec\u90e8\u7f72\u4e00\u4e0bElasticsearch\u548cKibana\u3002 \u5982\u679c\u4f60\u7684\u73af\u5883\u4e2d\u5df2\u7ecf\u6709Elasticsearch\u548cKibana\uff0c\u8fd9\u4e00\u6b65\u53ef\u4ee5\u5ffd\u7565\u3002 \u5982\u679c\u5e0c\u671b\u81ea\u5df1\u642d\u5efa\u4e00\u5957Elasticsearch\u548cKibana\u8bd5\u7528\uff0c\u8fd9\u91cc\u5efa\u8bae\uff1a \u4f7f\u7528Helm\u90e8\u7f72Elasticsearch \u4f7f\u7528Helm\u90e8\u7f72Kibana \u5982\u679c\u672c\u5730\u6ca1\u6709helm\u5ba2\u6237\u7aef\uff0c\u9700\u8981\u4e0b\u8f7d helm \u3002 \u4f7f\u7528\u5982\u4e0b\u547d\u4ee4: helm repo add elastic https://helm.elastic.co helm install elasticsearch elastic/elasticsearch --set replicas = 1 helm install kibana elastic/kibana \u901a\u8fc7\uff1a kubectl port-forward service/kibana-kibana 5601 :http \u53ef\u4ee5\u76f4\u63a5\u5728\u6d4f\u89c8\u5668\u8f93\u5165 localhost:5601 \uff0c\u8bbf\u95eeKibana\u9875\u9762\u3002","title":"\u90e8\u7f72Elasticsearch\u548cKibana\uff08\u53ef\u9009\uff09"},{"location":"user-guide/use-in-kubernetes/collect-container-logs/#_4","text":"","title":"\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7"},{"location":"user-guide/use-in-kubernetes/collect-container-logs/#sink","text":"\u4e3a\u4e86\u8868\u660e\u6211\u4eec\u5373\u5c06\u91c7\u96c6\u65e5\u5fd7\u53d1\u9001\u5230\u7684Elasticsearch\uff0c\u9700\u8981\u914d\u7f6e\u5bf9\u5e94\u7684Sink\u3002 \u8fd9\u91cc\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a \u5982\u679c\u6574\u4e2a\u96c6\u7fa4\u53ea\u4f1a\u6709\u4e00\u4e2a\u5b58\u50a8\u540e\u7aef\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u5168\u5c40\u7684\u914d\u7f6e\u6587\u4ef6configMap\u91cc\uff0c\u914d\u7f6edefaults\u53c2\u6570\uff0c\u5177\u4f53\u53ef \u53c2\u8003 \u3002 \u4f7f\u7528Sink CRD\uff0c\u5e76\u5728logConfig\u4e2d\u5f15\u7528\u3002\u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u6269\u5c55\u4e3a\u591a\u4e2a\u540e\u7aef\uff0c\u4e0d\u540c\u7684logConfig\u53ef\u4ee5\u914d\u7f6e\u4f7f\u7528\u4e0d\u540c\u7684\u540e\u7aef\u5b58\u50a8\uff0c\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u8be5\u65b9\u5f0f\u3002 \u521b\u5efa\u4e00\u4e2aSink\u5982\u4e0b\uff0cSink\u4e3a\u96c6\u7fa4\u7ea7\u522bCRD\u3002\u53ef\u4ee5\u5728spec.sink\u4e2d\u4fee\u6539\u4e3a\u5176\u4ed6\u914d\u7f6e\u3002 Example cat << EOF | kubectl apply -f - apiVersion : loggie.io/v1beta1 kind : Sink metadata : name : default spec : sink : | type: elasticsearch index: \"loggie\" hosts: [\"elasticsearch-master.default.svc:9200\"] EOF \u53ef\u4ee5\u901a\u8fc7 kubectl get sink default \u67e5\u770b\u662f\u5426\u521b\u5efa\u6210\u529f\u3002","title":"\u521b\u5efasink"},{"location":"user-guide/use-in-kubernetes/collect-container-logs/#interceptor","text":"\u548cSink\u4e00\u6837\uff0c\u914d\u7f6einterceptor\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a \u5728\u5168\u5c40\u914d\u7f6e\u6587\u4ef6configMap\u4e2d\uff0c\u914d\u7f6edefaults\u53c2\u6570\u3002\u6b64\u65f6\u610f\u5473\u7740\u6240\u6709\u7684Loggie Agent\u90fd\u4f7f\u7528\u8be5default interceptors\u914d\u7f6e\u3002 \u4f7f\u7528Interceptor CRD\uff0c\u5e76\u5728logConfig\u4e2d\u88ab\u5f15\u7528\u3002\u8fd9\u79cd\u65b9\u5f0f\u4f1a\u66f4\u52a0\u7075\u6d3b\uff0c\u9002\u5408\u6709\u4e00\u5b9a\u8fd0\u7ef4\u548c\u529f\u80fd\u9700\u6c42\u7684\u573a\u666f\u3002 Loggie\u76ee\u524d\u9ed8\u8ba4\u5185\u7f6e\u4e86 metric \uff08\u76d1\u63a7\u6307\u6807\u53d1\u9001\uff09\u3001 maxbytes \uff08\u6700\u5927event\u5b57\u8282\u6570\u9650\u5236\uff09\u3001 retry \uff08\u91cd\u8bd5\uff09\u4e09\u4e2ainterceptors\u3002\u5373\u4f7f\u6211\u4eec\u6ca1\u6709\u4f7f\u7528\u4ee5\u4e0a\u4e24\u79cd\u65b9\u5f0f\u914d\u7f6e\uff0c\u4ecd\u7136\u4f1a\u81ea\u52a8\u4f7f\u7528\u8fd93\u4e2a\u9ed8\u8ba4interceptor\uff0c\u6240\u4ee5interceptor\u5176\u5b9e\u662f\u53ef\u9009\u9879\u3002 Caution \u5728\u5168\u5c40\u7684defaults\u4e2d\uff0c\u914d\u7f6einterceptors\uff0c\u4f1a\u8986\u76d6\u6389\u73b0\u6709\u7684\u5185\u7f6einterceptors\uff0c\u6240\u4ee5\u5982\u679c\u4f7f\u7528\u5168\u5c40defaults\u914d\u7f6einterceptors\uff0c\u8bf7\u628a\u5185\u7f6e\u7684interceptors\u90fd\u52a0\u4e0a\uff0c\u9664\u975e\u4f60\u786e\u5b9a\u4e0d\u9700\u8981\u3002 \u4f7f\u7528interceptor CRD\u914d\u7f6e\u7684logConfig\uff0c\u4e0d\u4f1a\u8986\u76d6\u9ed8\u8ba4\u548c\u5185\u7f6e\u7684interceptors\uff0c\u4f1a\u901a\u8fc7\u65b0\u589e\u7684\u65b9\u5f0f\u52a0\u5165\u6574\u4e2apipeline interceptors chain\u3002 \u521b\u5efa\u4e00\u4e2ainterceptor\u793a\u4f8b\u5982\u4e0b\uff1a Example cat << EOF | kubectl apply -f - apiVersion : loggie.io/v1beta1 kind : Interceptor metadata : name : default spec : interceptors : | - type: rateLimit qps: 90000 EOF \u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a rateLimit interceptor\uff0c\u53ef\u7528\u4e8e\u91c7\u96c6\u53d1\u9001\u65e5\u5fd7\u7684\u9650\u6d41\u3002 \u53ef\u4ee5\u901a\u8fc7 kubectl get interceptor default \u6216\u8005 kubectl get icp default \u67e5\u770b\u662f\u5426\u521b\u5efa\u6210\u529f\u3002","title":"\u521b\u5efainterceptor(\u53ef\u9009)"},{"location":"user-guide/use-in-kubernetes/collect-container-logs/#logconfig","text":"\u521b\u5efa\u5b8csink\u548cinterceptor\u540e\uff0c\u6700\u91cd\u8981\u7684\u4fbf\u662f\u521b\u5efalogConfig\uff0c\u8868\u660e\u6211\u4eec\u5e0c\u671b\u91c7\u96c6\u54ea\u4e9bPod\u7684\u65e5\u5fd7\uff0c\u4ee5\u53ca\u91c7\u96c6Pod\u7684\u54ea\u4e9b\u65e5\u5fd7\u3002 logConfig\u91ccspec.selector\u90e8\u5206\u8868\u793a\u65e5\u5fd7\u914d\u7f6e\u7684\u4e0b\u53d1\u8303\u56f4\uff0c\u5bf9\u91c7\u96c6Pod\u65e5\u5fd7\u6765\u8bf4\uff0c\u9700\u8981\u914d\u7f6e type: pod \uff0c\u5e76\u4e14\u4f7f\u7528 labelSelector \u9009\u62e9\u6307\u5b9a\u7684Pods\uff0c\u5373\u91c7\u96c6\u8fd9\u4e9bPods\u7684\u65e5\u5fd7\u3002 \u793a\u4f8b\u5982\u4e0b\uff1a spec : selector : type : pod labelSelector : app : tomcat \u53e6\u5916\uff0c\u6211\u4eec\u9700\u8981\u5728pipeline.sources\u4e2d\u914d\u7f6efile source\uff0c\u5373\u91c7\u96c6Pods\u7684\u54ea\u4e9b\u65e5\u5fd7\u3002 pipeline : sources : | - type: file name: mylog paths: - stdout - /var/log/*.log \u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a path\u91cc\u586b stdout \uff0c\u8868\u793a\u91c7\u96c6\u5bb9\u5668\u7684\u6807\u51c6\u8f93\u51fa\u8def\u5f84\u3002 path\u91cc\u586b\u5199\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u662f\u5bb9\u5668\u91cc\u7684\u8def\u5f84\u3002\uff08\u6700\u7ec8\u751f\u6210\u914d\u7f6e\u7684\u65f6\u5019\uff0cLoggie\u4f1a\u81ea\u52a8\u66f4\u65b0\u6210\u8282\u70b9\u4e0a\u7684\u8def\u5f84\uff0c\u65e0\u9700\u7528\u6237\u5173\u5fc3\uff09 path\u8bf7\u4f7f\u7528glob\u8868\u8fbe\u5f0f\u586b\u5199\u3002 \u5f53 type: pod \u65f6\uff0cpipeline.name\u4f1a\u88abloggie\u81ea\u52a8\u6309\u7167 ${namespace}-${logConfigName} \u7684\u683c\u5f0f\u751f\u6210\uff0c\u6240\u4ee5\u8fd9\u91cc\u65e0\u9700\u586b\u5199\u3002 \u6700\u7ec8\u751f\u6210\u7684source.name\u4f1a\u6309\u7167 ${podName}-${containerName}-${sourceName} \u683c\u5f0f\u751f\u6210\u3002 \u6700\u540e\uff0c\u6211\u4eec\u4f7f\u7528sinkRef\u548cinterceptorRef\u5f15\u7528\u4e0a\u9762\u521b\u5efa\u7684sink\u548cinterceptor\u3002 \u6700\u7ec8\u521b\u5efa\u4e00\u4e2alogConfig\u793a\u4f8b\u5982\u4e0b\uff1a Example cat << EOF | kubectl apply -f - apiVersion : loggie.io/v1beta1 kind : LogConfig metadata : name : tomcat namespace : default spec : selector : type : pod labelSelector : app : tomcat pipeline : sources : | - type: file name: common paths: - stdout - /usr/local/tomcat/logs/*.log sinkRef : default interceptorRef : default EOF \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 kubectl get logconfig tomcat \u6216\u8005 kubectl get lgc tomcat \u6765\u67e5\u770b\u662f\u5426\u521b\u5efa\u6210\u529f\u3002 \u540c\u65f6\u53ef\u4ee5\u901a\u8fc7 kubectl describe lgc tomcat \u67e5\u770blogConfig\u7684events\uff0c\u7528\u4e8e\u6392\u67e5\u72b6\u6001\u3002 \u5982\u679c\u6709\u4ee5\u4e0b\u7c7b\u4f3c\u7684events\uff0c\u8bf4\u660e\u914d\u7f6e\u5df2\u7ecf\u4e0b\u53d1\u6210\u529f\u3002 Events: Type Reason Age From Message ---- ------ ---- ---- ------- Normal syncSuccess 55s loggie/kind-control-plane Sync type pod [tomcat-684c698b66-hvztn] success \u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7 kubectl -nloggie logs -f ${loggie-name} \u6765\u67e5\u770b\u6307\u5b9a\u8282\u70b9Loggie\u7684\u65e5\u5fd7\u6765\u5224\u65ad\u65e5\u5fd7\u91c7\u96c6\u60c5\u51b5\u3002 \u53d1\u9001\u6210\u529f\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728Kibana\u4e0a\u67e5\u8be2\u5230\u91c7\u96c6\u5230\u7684\u65e5\u5fd7\u3002","title":"\u521b\u5efalogConfig"},{"location":"user-guide/use-in-kubernetes/collect-container-logs/#_5","text":"\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u91c7\u96c6\u5230\u7684\u6807\u51c6\u8f93\u51fa\u5e76\u4e0d\u662f\u6253\u5370\u7684\u65e5\u5fd7\u5185\u5bb9\uff0c\u800c\u662f\u88ab\u5bb9\u5668\u8fd0\u884c\u65f6\u589e\u52a0\u4e86\u4e00\u5c42\u5c01\u88c5\u3002 \u4f8b\u5982docker\u7684\u6807\u51c6\u8f93\u51fa\u4e3ajson\u5f62\u5f0f\uff1a { \"log\" : \"I0610 08:29:07.698664 Waiting for caches to sync\\n\" , \"stream\" : \"stderr\" , \"time:\" 2021-06-10 T 08 : 29 : 07.698731204 Z\"} \u4e1a\u52a1\u6253\u5370\u7684\u539f\u59cb\u65e5\u5fd7\u5185\u5bb9\u5b58\u50a8\u5728log\u5b57\u6bb5\u91cc\u3002 containerd\u7684\u6807\u51c6\u8f93\u51fa\u5f62\u5f0f\u7c7b\u4f3c\u5982\u4e0b\uff1a 2021-12-01T03:13:58.298476921Z stderr F INFO [main] Starting service [Catalina] \u524d\u9762 2021-12-01T03:13:58.298476921Z stderr F \u4e3a\u8fd0\u884c\u65f6\u589e\u52a0\u7684\u524d\u7f00\u5185\u5bb9\uff0c\u540e\u9762\u5219\u4e3a\u539f\u59cb\u7684\u65e5\u5fd7\u3002 \u7279\u522b\u662f\u5982\u679c\u6211\u4eec\u914d\u7f6e\u4e86\u65e5\u5fd7\u91c7\u96c6\u591a\u884c\u914d\u7f6e\uff0c\u56e0\u4e3a\u91c7\u96c6\u5230\u7684\u65e5\u5fd7\u5185\u5bb9\u548c\u4e1a\u52a1\u8f93\u51fa\u7684\u65e5\u5fd7\u4e0d\u4e00\u81f4\uff0c\u4f1a\u5bfc\u81f4\u91c7\u96c6\u6807\u51c6\u8f93\u51fa\u65e5\u5fd7\u5339\u914d\u591a\u884c\u6709\u95ee\u9898\u3002 \u6240\u4ee5\uff0cLoggie\u63d0\u4f9b\u4e86\u4e00\u952e\u5f00\u5173\u914d\u7f6e\uff0c\u5728\u7cfb\u7edf\u914d\u7f6e\u4e2d\uff0c\u5c06 parseStdout \u53c2\u6570\u8bbe\u7f6e\u4e3atrue\u5373\u53ef\u3002 parseStdout config : loggie : discovery : enabled : true kubernetes : parseStdout : true Loggie\u4f1a\u5728\u6e32\u67d3LogConfig\u7684\u65f6\u5019\u81ea\u52a8\u589e\u52a0source codec\u89e3\u6790\u51fa\u539f\u59cb\u7684\u4e1a\u52a1\u65e5\u5fd7\u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a \u4ec5\u5f53LogConfig\u914d\u7f6e\u91cc\u7684paths\u5355\u72ec\u4e3a stdout \u65f6\u6709\u6548\uff1a \u3010\u6709\u6548\u3011 sources : | - type: file name: common paths: - stdout \u3010\u65e0\u6548\u3011 sources : | - type: file name: common paths: - stdout - /usr/local/tomcat/logs/*.log \u4e0a\u9762\u9700\u8981\u6539\u6210\u4e24\u4e2asource\uff1a \u3010\u6709\u6548\u3011 sources : | - type: file name: stdout paths: - stdout - type: file name: tomcat paths: - /usr/local/tomcat/logs/*.log \u76ee\u524d\u53ea\u4f1a\u4fdd\u7559\u539f\u59cb\u7684\u65e5\u5fd7\u5185\u5bb9\u5230 body \u4e2d\uff0c\u5176\u4f59\u8fd0\u884c\u65f6\u9644\u52a0\u7684\u5b57\u6bb5\u4f1a\u88ab\u4e22\u5f03\u3002 \u81ea\u52a8\u89e3\u6790stdout\u5b9e\u9645\u4e0a\u662f\u5728LogConfig\u6e32\u67d3\u6210Pipeline\u914d\u7f6e\u65f6\u81ea\u52a8\u589e\u52a0source codec\u6765\u5b9e\u73b0\u3002","title":"\u81ea\u52a8\u89e3\u6790\u5bb9\u5668\u6807\u51c6\u8f93\u51fa\u539f\u59cb\u65e5\u5fd7"},{"location":"user-guide/use-in-kubernetes/collect-container-logs/#volume","text":"\u867d\u7136\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u6302\u8f7dvolume(emptyDir/hostPath+subPathExpr)\u7684\u65b9\u5f0f\u5c06\u65e5\u5fd7\u6587\u4ef6\u6302\u51fa\u7ed9Loggie\u91c7\u96c6\uff0c\u4f46\u4ecd\u7136\u5b58\u5728\u5f88\u591a\u60c5\u51b5\u6211\u4eec\u6ca1\u529e\u6cd5\u5c06\u4e1a\u52a1\u7684Pod\u7edf\u4e00\u6302\u8f7d\u51fa\u65e5\u5fd7\u8def\u5f84\u3002 \u6bd4\u5982\u4e00\u4e9b\u57fa\u7840\u7ec4\u4ef6\u65e0\u6cd5\u914d\u7f6e\u72ec\u7acb\u7684\u65e5\u5fd7volume\uff0c\u6216\u8005\u4e1a\u52a1\u5355\u7eaf\u7684\u4e0d\u613f\u610f\u6539\u90e8\u7f72\u914d\u7f6e\u3002 Loggie\u63d0\u4f9b\u4e86\u65e0\u9700\u6302\u8f7d\u5373\u53ef\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\u7684\u80fd\u529b\uff0c\u53ef\u81ea\u52a8\u8bc6\u522b\u5e76\u91c7\u96c6\u5bb9\u5668root filesystem\u91cc\u7684\u65e5\u5fd7\u6587\u4ef6\u3002 \u4f60\u53ea\u9700\u8981\u5c06\u90e8\u7f72\u7684helm chart\u4e2dvalues.yml\u91cc\u7684\u914d\u7f6e rootFsCollectionEnabled \u8bbe\u7f6e\u4e3atrue\uff0c \u540c\u65f6\u586b\u4e0a\u5b9e\u9645\u73af\u5883\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\uff08docker/containerd\uff09\uff0c\u5982\u4e0b\u6240\u793a\uff1a rootFsCollectionEnabled config : loggie : discovery : enabled : true kubernetes : containerRuntime : containerd rootFsCollectionEnabled : false \u4fee\u6539\u5b8c\u6210\u540e\uff0c\u91cd\u65b0helm upgrade\u5373\u53ef\u3002 helm\u6a21\u7248\u4f1a\u81ea\u52a8\u6e32\u67d3\u589e\u52a0\u989d\u5916\u7684\u4e00\u4e9b\u6302\u8f7d\u8def\u5f84\u548c\u914d\u7f6e\uff0c\u5982\u679c\u4f60\u4ece\u4f4e\u7248\u672c\u5347\u7ea7\uff0c\u9700\u8981\u989d\u5916\u4fee\u6539\u90e8\u7f72\u7684Daemonset yaml\u3002 \u5177\u4f53\u539f\u7406\u8bf7\u53c2\u8003issues #208 \u3002","title":"\u65e0\u9700\u6302\u8f7dvolume\u7684\u5bb9\u5668\u65e5\u5fd7\u91c7\u96c6"},{"location":"user-guide/use-in-kubernetes/collect-node-logs/","text":"\u4f7f\u7528Loggie\u91c7\u96c6Node\u8282\u70b9\u65e5\u5fd7 \u00b6 \u5728Kubernetes\u96c6\u7fa4\u4e2d\uff0c\u9664\u4e86\u91c7\u96c6Pod\u91cc\u7684\u65e5\u5fd7\uff0c\u8fd8\u53ef\u80fd\u6709\u91c7\u96c6Node\u8282\u70b9\u4e0a\u7684\u4e00\u4e9b\u8bf8\u5982kubelet\u65e5\u5fd7\u3001\u7cfb\u7edf\u65e5\u5fd7\u7b49\u9700\u6c42\u3002 \u914d\u7f6e\u8bf4\u660e \u00b6 \u548c\u91c7\u96c6\u5bb9\u5668\u4e0d\u540c\u7684\u662f\uff0c\u8282\u70b9\u65e5\u5fd7\u91c7\u96c6\u9700\u4f7f\u7528\u96c6\u7fa4\u7ea7\u522b\u7684ClusterLogConfig\uff0cselector\u4f7f\u7528 type: node \uff0c\u5e76\u4e14\u586b\u5199 nodeSelector \u7528\u4e8e\u9009\u62e9\u4e0b\u53d1\u914d\u7f6e\u5230\u54ea\u4e9b\u8282\u70b9\uff0c\u540c\u65f6\u9700\u786e\u4fddNode\u4e0a\u5305\u542b\u8fd9\u4e9blabels\u3002 \u793a\u4f8b\u5982\u4e0b\uff1a Example apiVersion : loggie.io/v1beta1 kind : ClusterLogConfig metadata : name : varlog spec : selector : type : node nodeSelector : nodepool : demo pipeline : sources : | - type: file name: varlog paths: - /var/log/*.log sinkRef : default interceptorRef : default \u53e6\u5916\u5e94\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u9700\u8981\u91c7\u96c6Node\u8282\u70b9\u4e0a\u67d0\u8def\u5f84\u7684\u65e5\u5fd7\uff0c\u9700\u8981Loggie\u540c\u6837\u6302\u8f7d\u76f8\u540c\u7684\u8def\u5f84\uff0c\u5426\u5219\u7531\u4e8e\u5bb9\u5668\u9694\u79bb\u6027Loggie\u65e0\u6cd5\u83b7\u53d6\u5230\u8282\u70b9\u7684\u65e5\u5fd7\u3002 \u6bd4\u5982\u91c7\u96c6Node\u4e0a /var/log/ \u8def\u5f84\u4e0b\u7684\u65e5\u5fd7\uff0c\u9700\u8981Loggie Agent\u589e\u52a0\u6302\u8f7d\u8be5\u8def\u5f84\u3002","title":"Loggie\u91c7\u96c6Node\u65e5\u5fd7"},{"location":"user-guide/use-in-kubernetes/collect-node-logs/#loggienode","text":"\u5728Kubernetes\u96c6\u7fa4\u4e2d\uff0c\u9664\u4e86\u91c7\u96c6Pod\u91cc\u7684\u65e5\u5fd7\uff0c\u8fd8\u53ef\u80fd\u6709\u91c7\u96c6Node\u8282\u70b9\u4e0a\u7684\u4e00\u4e9b\u8bf8\u5982kubelet\u65e5\u5fd7\u3001\u7cfb\u7edf\u65e5\u5fd7\u7b49\u9700\u6c42\u3002","title":"\u4f7f\u7528Loggie\u91c7\u96c6Node\u8282\u70b9\u65e5\u5fd7"},{"location":"user-guide/use-in-kubernetes/collect-node-logs/#_1","text":"\u548c\u91c7\u96c6\u5bb9\u5668\u4e0d\u540c\u7684\u662f\uff0c\u8282\u70b9\u65e5\u5fd7\u91c7\u96c6\u9700\u4f7f\u7528\u96c6\u7fa4\u7ea7\u522b\u7684ClusterLogConfig\uff0cselector\u4f7f\u7528 type: node \uff0c\u5e76\u4e14\u586b\u5199 nodeSelector \u7528\u4e8e\u9009\u62e9\u4e0b\u53d1\u914d\u7f6e\u5230\u54ea\u4e9b\u8282\u70b9\uff0c\u540c\u65f6\u9700\u786e\u4fddNode\u4e0a\u5305\u542b\u8fd9\u4e9blabels\u3002 \u793a\u4f8b\u5982\u4e0b\uff1a Example apiVersion : loggie.io/v1beta1 kind : ClusterLogConfig metadata : name : varlog spec : selector : type : node nodeSelector : nodepool : demo pipeline : sources : | - type: file name: varlog paths: - /var/log/*.log sinkRef : default interceptorRef : default \u53e6\u5916\u5e94\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u9700\u8981\u91c7\u96c6Node\u8282\u70b9\u4e0a\u67d0\u8def\u5f84\u7684\u65e5\u5fd7\uff0c\u9700\u8981Loggie\u540c\u6837\u6302\u8f7d\u76f8\u540c\u7684\u8def\u5f84\uff0c\u5426\u5219\u7531\u4e8e\u5bb9\u5668\u9694\u79bb\u6027Loggie\u65e0\u6cd5\u83b7\u53d6\u5230\u8282\u70b9\u7684\u65e5\u5fd7\u3002 \u6bd4\u5982\u91c7\u96c6Node\u4e0a /var/log/ \u8def\u5f84\u4e0b\u7684\u65e5\u5fd7\uff0c\u9700\u8981Loggie Agent\u589e\u52a0\u6302\u8f7d\u8be5\u8def\u5f84\u3002","title":"\u914d\u7f6e\u8bf4\u660e"},{"location":"user-guide/use-in-kubernetes/general-usage/","text":"Kubernetes\u4e0b\u7684\u65e5\u5fd7\u91c7\u96c6 \u00b6 Cite \u76f8\u6bd4\u4f20\u7edf\u7684\u4e3b\u673a\u65e5\u5fd7\u91c7\u96c6\uff0c\u5728Kubernetes\u96c6\u7fa4\u4e2d\uff0c\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\u6709\u4e00\u4e9b\u5dee\u5f02\uff0c\u4f7f\u7528\u65b9\u5f0f\u4e0a\u4e5f\u6709\u6240\u533a\u522b\u3002 \u8fd9\u91cc\u6211\u4eec\u7f57\u5217\u4e86\u4e00\u4e9b\u5e38\u89c4\u7684\u90e8\u7f72\u548c\u4f7f\u7528\u65b9\u5f0f\u4ee5\u4f9b\u53c2\u8003\u3002 1. \u4ece\u4e3b\u673a\u5230\u5bb9\u5668 \u00b6 \u5728\u4f20\u7edf\u7684\u4f7f\u7528\u865a\u62df\u673a/\u4e91\u4e3b\u673a/\u7269\u7406\u673a\u7684\u65f6\u4ee3\uff0c\u4e1a\u52a1\u8fdb\u7a0b\u90e8\u7f72\u5728\u56fa\u5b9a\u7684\u8282\u70b9\u4e0a\uff0c\u4e1a\u52a1\u65e5\u5fd7\u76f4\u63a5\u8f93\u51fa\u5230\u5bbf\u4e3b\u673a\u4e0a\uff0c\u8fd0\u7ef4\u53ea\u9700\u8981\u624b\u52a8\u6216\u8005\u4f7f\u7528\u81ea\u52a8\u5316\u5de5\u5177\u628a\u65e5\u5fd7\u91c7\u96c6Agent\u90e8\u7f72\u5728\u8282\u70b9\u4e0a\uff0c\u52a0\u4e00\u4e0bAgent\u7684\u914d\u7f6e\uff0c\u5c31\u53ef\u4ee5\u5f00\u59cb\u91c7\u96c6\u65e5\u5fd7\u4e86\u3002 \u800c\u5728Kubernetes\u73af\u5883\u4e2d\uff0c\u60c5\u51b5\u5c31\u6ca1\u8fd9\u4e48\u7b80\u5355\u4e86\uff1a \u52a8\u6001\u8fc1\u79fb \uff1a\u5728Kubernetes\u96c6\u7fa4\u4e2d\u7ecf\u5e38\u5b58\u5728Pod\u4e3b\u52a8\u6216\u8005\u88ab\u52a8\u7684\u8fc1\u79fb\uff0c\u9891\u7e41\u7684\u9500\u6bc1\u3001\u521b\u5efa\uff0c\u6211\u4eec\u65e0\u6cd5\u548c\u4f20\u7edf\u7684\u65b9\u5f0f\u4e00\u6837\u4eba\u4e3a\u7684\u7ed9\u6bcf\u4e2a\u670d\u52a1\u4e0b\u53d1\u65e5\u5fd7\u91c7\u96c6\u914d\u7f6e\u3002 \u65e5\u5fd7\u5b58\u50a8\u65b9\u5f0f\u591a\u6837\u6027 \uff1a\u5bb9\u5668\u7684\u65e5\u5fd7\u5b58\u50a8\u65b9\u5f0f\u6709\u5f88\u591a\u4e0d\u540c\u7684\u7c7b\u578b\uff0c\u4f8b\u5982stdout\u3001hostPath\u3001emptyDir\u3001pv\u7b49\u3002 Kubernetes\u5143\u4fe1\u606f \uff1a\u7531\u4e8e\u65e5\u5fd7\u6570\u636e\u91c7\u96c6\u540e\u4f1a\u88ab\u96c6\u4e2d\u5b58\u50a8\uff0c\u6240\u4ee5\u67e5\u8be2\u65e5\u5fd7\u65f6\uff0c\u9700\u8981\u6839\u636enamespace\u3001pod\u3001container\u3001node\uff0c\u751a\u81f3\u5305\u62ec\u5bb9\u5668\u7684\u73af\u5883\u53d8\u91cf\u3001label\u7b49\u7ef4\u5ea6\u6765\u68c0\u7d22\u3001\u8fc7\u6ee4\uff0c\u6b64\u65f6\u8981\u6c42Agent\u611f\u77e5\u5e76\u9ed8\u8ba4\u5728\u65e5\u5fd7\u91cc\u6ce8\u5165\u8fd9\u4e9b\u5143\u4fe1\u606f\u3002 \u4ee5\u4e0a\u90fd\u662f\u6709\u522b\u4e8e\u4f20\u7edf\u65e5\u5fd7\u91c7\u96c6\u914d\u7f6e\u65b9\u5f0f\u7684\u9700\u6c42\u548c\u75db\u70b9\uff0c\u7a76\u5176\u539f\u56e0\uff0c\u8fd8\u662f\u56e0\u4e3a\u4f20\u7edf\u7684\u65b9\u5f0f\u8131\u79bb\u4e86Kubernetes\uff0c\u65e0\u6cd5\u611f\u77e5Kubernetes\uff0c\u65e0\u6cd5\u548cKubernetes\u96c6\u6210\u3002 2. \u5728Kubernetes\u4e0b\u7684\u65e5\u5fd7\u5f62\u6001 \u00b6 \u4e3a\u4e86\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\uff0c\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0b\u5e02\u9762\u4e0a\u4e00\u822c\u90fd\u6709\u54ea\u4e9b\u89e3\u51b3\u65b9\u6848\u3002 2.1 \u91c7\u96c6\u7684\u65e5\u5fd7\u7c7b\u578b \u00b6 \u9996\u5148\uff0c\u9700\u8981\u63d0\u53ca\u7684\u662f\uff0c\u5728\u4e91\u539f\u751f\u768412\u8981\u7d20\u91cc\uff0c\u63a8\u8350\u4e1a\u52a1\u5bb9\u5668\u5c06\u65e5\u5fd7\u8f93\u51fa\u5230stdout\u4e2d\uff0c\u800c\u4e0d\u662f\u91c7\u7528\u6253\u5370\u65e5\u5fd7\u6587\u4ef6\u7684\u65b9\u5f0f\u3002\u5f53\u7136\uff0c\u5b9e\u9645\u60c5\u51b5\u662f\uff0c\u6211\u4eec\u5f88\u96be\u8fd9\u4e48\u505a\uff0c\u539f\u56e0\u5927\u6982\u6709\uff1a \u9700\u8981\u4e1a\u52a1\u65b9\u4fee\u6539\u65e5\u5fd7\u914d\u7f6e\uff0c\u6bd4\u8f83\u96be\u4ee5\u63a8\u5e7f \u6709\u4e9b\u590d\u6742\u7684\u4e1a\u52a1\u5bf9\u65e5\u5fd7\u6587\u4ef6\u6709\u5206\u7c7b\uff0c\u6bd4\u5982\u5ba1\u8ba1\u65e5\u5fd7\u3001\u8bbf\u95ee\u65e5\u5fd7\u7b49\uff0c\u4e00\u822c\u4f1a\u8f93\u51fa\u4e3a\u72ec\u7acb\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u65e5\u5fd7\u91c7\u96c6\u9700\u6839\u636e\u4e0d\u540c\u7684\u6587\u4ef6\u5206\u7c7b\u8fdb\u884c\u4e0d\u540c\u7684\u5904\u7406 \u6240\u4ee5\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u9700\u8981\u540c\u65f6\u91c7\u96c6\uff1a \u6807\u51c6\u8f93\u51fastdout \u65e5\u5fd7\u6587\u4ef6 2.2 Agent\u90e8\u7f72\u65b9\u5f0f \u00b6 \u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\uff0cAgent\u6709\u4e24\u79cd\u90e8\u7f72\u65b9\u5f0f\uff1a DaemonSet \uff1a\u6bcf\u4e2a\u8282\u70b9\u90e8\u7f72\u4e00\u4e2aAgent Sidecar \uff1a\u6bcf\u4e2aPod\u589e\u52a0\u4e00\u4e2aSidecar\u5bb9\u5668\uff0c\u8fd0\u884c\u65e5\u5fd7Agent \u4e24\u79cd\u90e8\u7f72\u65b9\u5f0f\u7684\u4f18\u52a3\u90fd\u663e\u800c\u6613\u89c1\uff1a \u8d44\u6e90\u5360\u7528\uff1aDaemonSet\u6bcf\u4e2a\u8282\u70b9\u4e0a\u4e00\u4e2a\uff0c\u800cSidecar\u6bcf\u4e2aPod\u91cc\u4e00\u4e2a\uff0c\u5bb9\u5668\u5316\u5f62\u6001\u4e0b\uff0c\u5f80\u5f80\u4e00\u4e2aNode\u4e0a\u53ef\u80fd\u4f1a\u8dd1\u5f88\u591a\u7684Pod\uff0c\u6b64\u65f6DaemonSet\u7684\u65b9\u5f0f\u8fdc\u5c0f\u4e8eSidecar\uff0c\u800c\u4e14\u8282\u70b9\u4e0aPod\u4e2a\u6570\u8d8a\u591a\u8d8a\u660e\u663e \u4fb5\u5165\u6027\uff1aSidecar\u7684\u65b9\u5f0f\uff0cAgent\u9700\u8981\u6ce8\u5165\u5230\u4e1a\u52a1Pod\u4e2d\uff0c\u4e0d\u7ba1\u662f\u5426\u6709\u5e73\u53f0\u5c01\u88c5\u8fd9\u4e00\u8fc7\u7a0b\uff0c\u8fd8\u662f\u91c7\u7528Kubernetes webhook\u7684\u65b9\u5f0f\u9ed8\u8ba4\u6ce8\u5165\uff0c\u4ecd\u7136\u6539\u53d8\u4e86\u539f\u672c\u7684\u90e8\u7f72\u65b9\u5f0f \u7a33\u5b9a\u6027\uff1a\u65e5\u5fd7\u91c7\u96c6\u5728\u5927\u90e8\u5206\u7684\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u4fdd\u969c\u7684\u662f\u7a33\u5b9a\u6027\uff0c\u6700\u91cd\u8981\u7684\u662f\u4e0d\u80fd\u5f71\u54cd\u4e1a\u52a1\uff0c\u5982\u679c\u91c7\u7528Sidecar\u7684\u65b9\u5f0f\uff0c\u5728Agent\u53d1\u751f\u5f02\u5e38\u6216\u8005oom\u7b49\u60c5\u51b5\uff0c\u5f88\u5bb9\u6613\u5bf9\u4e1a\u52a1\u5bb9\u5668\u9020\u6210\u5f71\u54cd\u3002\u53e6\u5916\uff0cAgent\u6bd4\u8f83\u591a\u7684\u65f6\u5019\uff0c\u5728\u8fde\u63a5\u6570\u7b49\u65b9\u9762\u4f1a\u5bf9\u4e0b\u6e38\u670d\u52a1\u6bd4\u5982Kafka\u9020\u6210\u4e00\u5b9a\u7684\u9690\u60a3\u3002 \u9694\u79bb\u6027\uff1aDaemonSet\u60c5\u51b5\u4e0b\uff0c\u8282\u70b9\u6240\u6709\u7684\u65e5\u5fd7\u90fd\u5171\u7528\u540c\u4e00\u4e2aAgent\uff0c\u800cSidecar\u65b9\u5f0f\uff0c\u53ea\u4f1a\u91c7\u96c6\u540c\u4e00\u4e2aPod\u5185\u7684\u4e1a\u52a1\u65e5\u5fd7\uff0c\u6b64\u65f6Sidecar\u7684\u9694\u79bb\u6027\u7406\u8bba\u4e0a\u4f1a\u597d\u4e00\u4e9b \u6027\u80fd\uff1aSidecar\u7531\u4e8e\u53ea\u4f1a\u91c7\u96c6\u8be5Pod\u91cc\u7684\u65e5\u5fd7\uff0c\u538b\u529b\u76f8\u5bf9\u8f83\u5c0f\uff0c\u6781\u7aef\u60c5\u51b5\u4e0b\uff0c\u8fbe\u5230Agent\u7684\u6027\u80fd\u74f6\u9888\u6bd4DaemonSet\u65b9\u5f0f\u6982\u7387\u4e5f\u4f1a\u5c0f\u5f88\u591a Tip \u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u4f18\u5148\u4f7f\u7528DaemonSet\u7684\u65b9\u5f0f\u91c7\u96c6\u65e5\u5fd7\uff0c\u5982\u679c\u5355\u4e2aPod\u65e5\u5fd7\u91cf\u7279\u522b\u5927\uff0c\u8d85\u8fc7\u4e00\u822cAgent\u53d1\u9001\u541e\u5410\u91cf\uff0c\u53ef\u4ee5\u5355\u72ec\u5bf9\u8be5Pod\u4f7f\u7528Sidecar\u7684\u65b9\u5f0f\u91c7\u96c6\u65e5\u5fd7\u3002 2.3 \u91c7\u96c6\u65b9\u5f0f \u00b6 DaemonSet + Stdout \u00b6 \u5982\u679c\u4f7f\u7528\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u662fdocker\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u6211\u4eec\u53ef\u4ee5\u5728\u8282\u70b9\u7684docker\u8def\u5f84\u4e2d\u627e\u5230\u5bb9\u5668\u7684stdout\u7684\u65e5\u5fd7\uff0c\u9ed8\u8ba4\u4e3a /var/lib/docker/containers/{containerId}/{containerId}-json.log \u3002 \u5728Kubernetes 1.14\u7248\u672c\u4e4b\u524d\uff0ckubelet\u4f1a\u5728 /var/log/pods/<podUID>/<containerName>/<num>.log \u5efa\u7acb\u4e00\u4e2a\u8f6f\u94fe\u63a5\u5230stdout\u6587\u4ef6\u4e2d\u3002 \u7c7b\u4f3c\u5982\u4e0b\u6240\u793a\uff1a root@master0:/var/log/pods# tree . | -- 6687e53201c01e3fad31e7d72fbb92a6 | ` -- kube-apiserver | | -- 865 .log -> /var/lib/docker/containers/3a35ae0a1d0b26455fbd9b267cd9d6ac3fbd3f0b12ee03b4b22b80dc5a1cde03/3a35ae0a1d0b26455fbd9b267cd9d6ac3fbd3f0b12ee03b4b22b80dc5a1cde03-json.log | ` -- 866 .log -> /var/lib/docker/containers/15a6924f14fcbf15dd37d1c185c5b95154fa2c5f3de9513204b1066bbe474662/15a6924f14fcbf15dd37d1c185c5b95154fa2c5f3de9513204b1066bbe474662-json.log | -- a1083c6d-3b12-11ea-9af1-fa163e28f309 | ` -- kube-proxy | | -- 3 .log -> /var/lib/docker/containers/4b63b5a90a8f9ca6b6f20b49b5ab2564f92df21a5590f46de2a46b031e55c80e/4b63b5a90a8f9ca6b6f20b49b5ab2564f92df21a5590f46de2a46b031e55c80e-json.log | ` -- 4 .log -> /var/lib/docker/containers/fc7c315d33935887ca3479a38cfca4cca66fad782b8a120c548ad0b9f0ff7207/fc7c315d33935887ca3479a38cfca4cca66fad782b8a120c548ad0b9f0ff7207-json.log \u5728Kubernetes 1.14\u7248\u672c\u4e4b\u540e\uff0c\u6539\u6210\u4e86 /var/log/pods/<namespace>_<pod_name>_<pod_id>/<container_name>/<num>.log \u7684\u5f62\u5f0f\u3002 root@master-0:/var/log/pods# tree . | -- kube-system_kube-apiserver-kind-control-plane_bd1c21fe1f0ef615e0b5e41299f1be61 | ` -- kube-apiserver | ` -- 0 .log | -- kube-system_kube-proxy-gcrfq_f07260b8-6055-4c19-9491-4a825579528f | ` -- kube-proxy | ` -- 0 .log ` -- loggie_loggie-csd4g_f1cc32e9-1002-4e64-bd58-fc6094394e06 ` -- loggie ` -- 0 .log \u6240\u4ee5\uff0c\u5bf9\u4e8eAgent\u91c7\u96c6\u6807\u51c6\u8f93\u51fa\u65e5\u5fd7\u6765\u8bf4\uff0c\u4e5f\u5c31\u662f\u91c7\u96c6\u8282\u70b9\u4e0a\u7684\u8fd9\u4e9b\u65e5\u5fd7\u6587\u4ef6\u3002 \u4e00\u79cd\u7b80\u5355\u7c97\u66b4\u7684\u91c7\u96c6\u65b9\u5f0f\u662f\uff0c\u4f7f\u7528DaemonSet\u90e8\u7f72\u65e5\u5fd7Agent\uff0c\u6302\u8f7d /var/log/pods \u76ee\u5f55\uff0cAgent\u7684\u914d\u7f6e\u6587\u4ef6\u4f7f\u7528\u7c7b\u4f3c /var/log/pod/*/*.log \u53bb\u901a\u914d\u65e5\u5fd7\u6587\u4ef6\uff0c\u91c7\u96c6\u8282\u70b9\u4e0a\u6240\u6709\u7684\u5bb9\u5668\u6807\u51c6\u8f93\u51fa\u3002 \u4f46\u662f\u8fd9\u6837\u7684\u5c40\u9650\u5728\u4e8e\uff1a \u65e0\u6cd5\u6ce8\u5165\u66f4\u591a\u5143\u4fe1\u606f\u6bd4\u5982\u4e00\u4e9bpod\u7684label/env\u7b49\uff0c\u7279\u522b\u662f\u5728k8s1.14\u7248\u672c\u4e4b\u524d\uff0c\u751a\u81f3\u65e0\u6cd5\u5728\u91c7\u96c6\u7684path\u91cc\u83b7\u53d6\u5230namespace/pod\u7b49\u4fe1\u606f \u5f88\u96be\u9488\u5bf9\u5355\u4e2a\u670d\u52a1\u914d\u7f6e\u7279\u6b8a\u7684\u914d\u7f6e\uff0c\u6bd4\u5982\u67d0\u4e2a\u6587\u4ef6\u9700\u8981\u4f7f\u7528\u7279\u6b8a\u7684\u591a\u884c\u65e5\u5fd7\u91c7\u96c6\uff0c\u9700\u8981\u914d\u7f6e\u9002\u5408\u670d\u52a1\u81ea\u8eab\u7684\u65e5\u5fd7\u683c\u5f0f\u5207\u5206\u7b49 \u4f1a\u91c7\u96c6\u5f88\u591a\u4e0d\u5fc5\u8981\u7684\u5bb9\u5668\u65e5\u5fd7\uff0c\u9020\u6210\u91c7\u96c6\u3001\u4f20\u8f93\u3001\u5b58\u50a8\u538b\u529b \u5f53\u7136\u73b0\u5728\u7684\u4e00\u4e9b\u65e5\u5fd7Agent\u6bd4\u5982Filebeat/Fluentd\u90fd\u9488\u5bf9\u6027\u7684\u505a\u4e86\u652f\u6301\uff0c\u6bd4\u5982\u53ef\u4ee5\u5c06namespace/pod\u7b49\u4fe1\u606f\u6ce8\u5165\u65e5\u5fd7\u4e2d\uff0c\u4f46\u4ecd\u7136\u6ca1\u6709\u89e3\u51b3\u5927\u90e8\u5206\u7684\u95ee\u9898\u3002 \u6240\u4ee5\uff0c\u8fd9\u79cd\u65b9\u5f0f\u53ea\u9002\u5408\u7b80\u5355\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u540e\u7eed\u4e5f\u96be\u4ee5\u6ee1\u8db3\u5176\u4ed6\u66f4\u591a\u7684\u65e5\u5fd7\u9700\u6c42\u3002 DaemonSet + \u65e5\u5fd7\u6587\u4ef6 \u00b6 \u5982\u679cPod\u91cc\u4e0d\u4ec5\u4ec5\u662f\u8f93\u51fastdout\uff0c\u8fd8\u5305\u62ec\u65e5\u5fd7\u6587\u4ef6\uff0c\u5c31\u9700\u8981\u8003\u8651\u5230\u6302\u8f7d\u65e5\u5fd7\u6587\u4ef6\u5230\u8282\u70b9\u4e0a\uff0c\u540c\u65f6\u91c7\u7528DaemonSet\u90e8\u7f72\u7684Agent\u4e5f\u9700\u8981\u6302\u8f7d\u76f8\u540c\u7684\u76ee\u5f55\uff0c\u5426\u5219\u91c7\u7528\u5bb9\u5668\u5316\u90e8\u7f72\u7684Agent\u65e0\u6cd5\u67e5\u770b\u5230\u76f8\u5e94\u7684\u6587\u4ef6\uff0c\u66f4\u65e0\u6cd5\u91c7\u96c6\u3002 \u4e1a\u52a1Pod\u6302\u8f7d\u65e5\u5fd7\u8def\u5f84\u7684\u65b9\u5f0f\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a (1) emtpyDir emtpyDir\u7684\u751f\u547d\u5468\u671f\u8ddf\u968fPod\uff0cPod\u9500\u6bc1\u540e\u5176\u4e2d\u5b58\u50a8\u7684\u65e5\u5fd7\u4e5f\u4f1a\u6d88\u5931\u3002 \u4f18\u70b9\uff1a\u4f7f\u7528\u7b80\u5355\uff0c\u4e0d\u540cPod\u90fd\u4f7f\u7528\u81ea\u5df1\u7684emtpyDir\uff0c\u6709\u4e00\u5b9a\u7684\u9694\u79bb\u6027\u3002 \u7f3a\u70b9\uff1a\u65e5\u5fd7\u5982\u679c\u91c7\u96c6\u4e0d\u53ca\u65f6\uff0c\u5728Pod\u6d88\u8017\u540e\uff0c\u5b58\u5728\u4e22\u5931\u7684\u53ef\u80fd\u6027\u3002 \u4f7f\u7528emptyDir\u6302\u8f7d\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u4e00\u822c\u5728\u8282\u70b9\u7684\u8def\u5f84\u5982\u4e0b\uff1a /var/lib/kubelet/pods/${pod.UID}/volumes/kubernetes.io~empty-dir/${volumeName} (2) hostPath \u751f\u547d\u5468\u671f\u548cPod\u65e0\u5173\uff0cPod\u8fc1\u79fb\u6216\u8005\u9500\u6bc1\uff0c\u65e5\u5fd7\u6587\u4ef6\u8fd8\u4fdd\u7559\u5728\u73b0\u6709\u78c1\u76d8\u4e0a\u3002 \u4f18\u70b9\uff1a\u751f\u547d\u5468\u671f\u548cPod\u65e0\u5173\uff0c\u5373\u4f7fPod\u9500\u6bc1\uff0c\u65e5\u5fd7\u6587\u4ef6\u4f9d\u7136\u5728\u8282\u70b9\u78c1\u76d8\u4e0a\uff0c\u5047\u8bbeAgent\u6ca1\u6709\u91c7\u96c6\u65e5\u5fd7\uff0c\u4ecd\u7136\u53ef\u4ee5\u627e\u5230\u65e5\u5fd7\u6587\u4ef6 \u7f3a\u70b9\uff1a\u9ed8\u8ba4\u65e0\u9694\u79bb\u6027\uff0c\u9700\u8981\u63a7\u5236\u6302\u8f7d\u7684\u65e5\u5fd7\u8def\u5f84\uff1b\u53e6\u5916\uff0cPod\u8fc1\u79fb\u8282\u70b9\u540e\uff0c\u6b8b\u7559\u7684\u65e5\u5fd7\u6587\u4ef6\u957f\u671f\u79ef\u7d2f\u5bb9\u6613\u5360\u636e\u78c1\u76d8\uff0c\u540c\u65f6\u65e5\u5fd7\u5360\u636e\u7684\u78c1\u76d8\u65e0\u6cd5\u63a7\u5236\u4f7f\u7528\u7684\u914d\u989d \u4e3a\u4e86\u89e3\u51b3\u9694\u79bb\u6027\uff0c\u907f\u514d\u591a\u4e2aPod\u6253\u5370\u65e5\u5fd7\u5230\u76f8\u540c\u7684\u8def\u5f84\u548c\u6587\u4ef6\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528 subPathExpr \u5b57\u6bb5\u4ece Downward API \u73af\u5883\u53d8\u91cf\u6784\u9020 subPath \u76ee\u5f55\u540d\u3002 \u8be5 VolumeSubpathEnvExpansion \u529f\u80fd\u4ece Kubernetes1.15 \u5f00\u59cb\u9ed8\u8ba4\u5f00\u542f\uff0c\u57281.17 GA\u3002\u53ef\u53c2\u8003 feature-gates \u548c using-subpath-expanded-environment \u3002 \u4f7f\u7528subPathExpr\u7684\u793a\u4f8b\u5982\u4e0b\u6240\u793a\uff1a apiVersion : apps/v1 kind : Deployment metadata : labels : app : nginx name : nginx namespace : default spec : selector : matchLabels : app : nginx template : metadata : labels : app : nginx spec : containers : - env : - name : POD_NAME valueFrom : fieldRef : apiVersion : v1 fieldPath : metadata.name - name : NAMESPACE valueFrom : fieldRef : apiVersion : v1 fieldPath : metadata.namespace image : nginx name : nginx resources : {} volumeMounts : - mountPath : /data/log name : datalog subPathExpr : $(NAMESPACE)/$(POD_NAME) volumes : - hostPath : path : /data/log type : \"\" name : datalog \u5728\u521b\u5efa\u5b8c\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6240\u5728\u8282\u70b9\u7684 /data/log \u4e0b\u53d1\u73b0\u7c7b\u4f3c\u7684\u76ee\u5f55\u7ed3\u6784\uff1a . `-- default |-- nginx-888dc6778-krfqr `-- nginx-888dc6778-sw8vd \u6bcf\u4e2aPod\u7684\u5b58\u653e\u7684\u65e5\u5fd7\u6587\u4ef6\u5373\u5728\u8282\u70b9\u7684 /data/log/$(NAMESPACE)/$(POD_NAME) \u8def\u5f84\u4e0b\u3002 (3) Pv Pv\u7684\u8bbf\u95ee\u6a21\u5f0f\u5305\u62ec\uff1a ReadWriteOnce\uff08RWO\uff09\uff1a\u8bfb\u5199\u6743\u9650\uff0c\u5e76\u4e14\u53ea\u80fd\u88ab\u5355\u4e2aNode\u6302\u8f7d\u3002 ReadOnlyMany\uff08ROX\uff09\uff1a\u53ea\u8bfb\u6743\u9650\uff0c\u5141\u8bb8\u88ab\u591a\u4e2aNode\u6302\u8f7d\u3002 ReadWriteMany\uff08RWX\uff09\uff1a\u8bfb\u5199\u6743\u9650\uff0c\u5141\u8bb8\u88ab\u591a\u4e2aNode\u6302\u8f7d\u3002 \u5bf9\u4e8e\u5927\u90e8\u5206\u7684\u4e1a\u52a1\u6765\u8bf4\uff0c\u90fd\u662fDeployment\u65e0\u72b6\u6001\u90e8\u7f72\uff0c\u9700\u8981\u6302\u8f7d\u540c\u4e00\u4e2aPv\u5171\u4eab\uff1b\u5bf9\u4e8e\u4e00\u4e9b\u4e2d\u95f4\u4ef6\u7b49\u6709\u72b6\u6001\u670d\u52a1\uff0c\u4e00\u822c\u4f1a\u4f7f\u7528StatefulSet\u90e8\u7f72\uff0c\u6bcf\u4e2aPod\u4f1a\u4f7f\u7528\u72ec\u7acb\u7684Pv\u3002 \u4f18\u70b9\uff1a\u5b58\u50a8\u65e5\u5fd7\u4e0d\u5bb9\u6613\u4e22\u5931\uff1b \u7f3a\u70b9\uff1a\u6709\u4e00\u5b9a\u7684\u4f7f\u7528\u548c\u8fd0\u7ef4\u590d\u6742\u5ea6\uff1b\u591a\u4e2aPod\u5171\u4eab\u540c\u4e00\u4e2aPv\u65f6\u5b58\u5728\u9694\u79bb\u6027\u95ee\u9898\uff1b\u5f88\u591a\u7684\u65e5\u5fd7Agent\u5bf9\u91c7\u96c6\u4e91\u76d8\u4e0a\u7684\u65e5\u5fd7\u6587\u4ef6\u652f\u6301\u4e0d\u591f\u6210\u719f\uff0c\u53ef\u80fd\u5b58\u5728\u4e00\u4e9b\u9690\u60a3\uff1b \u867d\u7136\u540c\u6837\u53ef\u4ee5\u5728Node\u4e0a\u627e\u5230\u4f7f\u7528Pv\u6302\u8f7d\u7684\u5bf9\u5e94\u65e5\u5fd7\u6587\u4ef6\uff0c\u4f46\u662fPv\u6839\u636e\u4e0d\u540c\u7684\u5e95\u5c42\u5b9e\u73b0\uff0c\u5728Node\u4e0a\u7684\u8def\u5f84\u4f1a\u6709\u4e00\u5b9a\u7684\u533a\u522b\u3002 \u76ee\u524d\u5e02\u9762\u4e0a\u5927\u90e8\u5206\u65e5\u5fd7Agent\u5747\u5bf9\u8fd9\u4e9b\u6302\u8f7d\u65b9\u5f0f\u6ca1\u6709\u611f\u77e5\uff0c\u6240\u4ee5\u4f60\u80fd\u505a\u7684\u548c\u4e0a\u9762\u4f7f\u7528stdout\u7684\u65b9\u5f0f\u7c7b\u4f3c\uff0c\u4e5f\u5c31\u662f\u7b80\u5355\u7c97\u66b4\u7684\u8ba9Agent\u5c06\u8def\u5f84\u90fd\u6302\u8f7d\uff0c\u4f7f\u7528\u901a\u914d\u7684\u65b9\u5f0f\u91c7\u96c6\u6240\u6709\u7684\u65e5\u5fd7\uff0c\u4f7f\u7528\u4e0a\u7684\u5c40\u9650\u548cstdout\u7684\u65b9\u5f0f\u540c\u6837\u4e00\u81f4\u3002 \u53e6\u5916\uff0c\u9274\u4e8e\u4e00\u4e9bAgent\u5bf9\u91c7\u96c6docker stdout\u6709\u4e00\u5b9a\u7684\u652f\u6301\uff0c\u6240\u4ee5\u8fd8\u5b58\u5728\u4e00\u4e9b\u4f7f\u7528\u4e0a\u53d8\u79cd\uff0c\u6bd4\u5982\u5229\u7528webhook\u6ce8\u5165\u4e00\u4e2asidecar\uff0c\u8bfb\u53d6Pod\u91cc\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u8f6c\u6362\u6210sidecar\u7684stdout\uff0c\u7136\u540e\u91c7\u96c6sidecar\u7684stdout\u65e5\u5fd7\uff0c\u8fd9\u91cc\u4e0d\u518d\u8be6\u8ff0\u3002 \uff084\uff09\u4e0d\u6302\u8f7d \u5f88\u591a\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u90fd\u758f\u4e8e\u6302\u8f7d\u65e5\u5fd7\u8def\u5f84volume\uff0c\u6216\u8005\u5bf9\u63a5\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u7cfb\u7edf\uff0c\u5f80\u5f80\u4e1a\u52a1\u65b9\u4e0d\u613f\u610f\u66f4\u6539\uff0c\u8fd9\u4e2a\u65f6\u5019\u80fd\u91c7\u96c6\u5bb9\u5668\u91cc\u7684\u65e5\u5fd7\u6587\u4ef6\u5417\uff1f Loggie\u5c1d\u8bd5\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u5f00\u542f\uff0c\u4e0d\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u4ecd\u7136\u9700\u8981\u66f4\u591a\u957f\u671f\u751f\u4ea7\u5b9e\u8df5\u7684\u68c0\u9a8c\u3002\u6b22\u8fce\u8bd5\u7528\uff0c\u5177\u4f53\u5f00\u5173\u8bf7\u53c2\u8003\u4e0b\u4e00\u8282\u3002 Sidecar + Stdout/\u65e5\u5fd7\u6587\u4ef6 \u00b6 \u5982\u679c\u9700\u8981\u91c7\u7528sidecar\u7684\u65b9\u5f0f\uff0c\u9700\u8981\u5c06\u65e5\u5fd7Agent\u540c\u65f6\u6302\u8f7d\u76f8\u540c\u7684\u65e5\u5fd7\u8def\u5f84\uff0cAgent\u7684\u914d\u7f6e\u6587\u4ef6\u4e5f\u4e00\u822c\u4f7f\u7528ConfigMap\u6302\u8f7d\u51fa\u6765\u3002 \u4f7f\u7528Sidecar\u7684\u90e8\u7f72\u65b9\u5f0f\u548cDaemonSet\u7684\u65b9\u5f0f\u4f18\u52a3\u5bf9\u6bd4\u8bf7\u53c2\u8003\u4e0a\u6587\u3002 \u603b\u7ed3 \uff1a \u5927\u90e8\u5206\u4e3b\u6d41\u7684\u5f00\u6e90Agent\uff0c\u53ea\u5bf9\u5bb9\u5668Stdout\u6709\u90e8\u5206\u652f\u6301\uff0c\u6bd4\u5982\u652f\u6301\u91c7\u96c6\u7684\u65f6\u5019\u7edf\u4e00\u52a0\u4e0a\u4e00\u4e9bK8s\u76f8\u5173\u5143\u4fe1\u606f\uff0c\u4f46\u4e0d\u652f\u6301\u5355\u72ec\u9488\u5bf9\u67d0\u4e9bPod\u8fdb\u884c\u914d\u7f6e\uff0c\u800c\u4e14\u5747\u6ca1\u6709\u5bf9\u5bb9\u5668\u4e2d\u7684\u65e5\u5fd7\u6587\u4ef6\u91c7\u96c6\u6709\u5f88\u597d\u7684\u652f\u6301\u3002 \u8fd9\u6837\u5bfc\u81f4\u5728\u5b9e\u9645\u590d\u6742\u7684\u5404\u7c7b\u4e1a\u52a1\u573a\u666f\u4e2d\uff0c\u6ca1\u529e\u6cd5\u6ee1\u8db3\u9700\u6c42\u3002 Loggie\u5982\u4f55\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff1f \u00b6 \u76f8\u4fe1\u4ee5\u4e0a\u5217\u51fa\u7684\u95ee\u9898\u5927\u5bb6\u90fd\u9047\u5230\u6216\u8005\u601d\u8003\u8fc7\uff0c\u90a3Loggie\u662f\u5982\u4f55\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u7684\u5462\uff1f \u8bf7\u770b\u4e0b\u4e00\u8282\u5982\u4f55 \u4f7f\u7528Loggie\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\uff1f","title":"Kubernetes\u4e0b\u7684\u65e5\u5fd7\u91c7\u96c6"},{"location":"user-guide/use-in-kubernetes/general-usage/#kubernetes","text":"Cite \u76f8\u6bd4\u4f20\u7edf\u7684\u4e3b\u673a\u65e5\u5fd7\u91c7\u96c6\uff0c\u5728Kubernetes\u96c6\u7fa4\u4e2d\uff0c\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\u6709\u4e00\u4e9b\u5dee\u5f02\uff0c\u4f7f\u7528\u65b9\u5f0f\u4e0a\u4e5f\u6709\u6240\u533a\u522b\u3002 \u8fd9\u91cc\u6211\u4eec\u7f57\u5217\u4e86\u4e00\u4e9b\u5e38\u89c4\u7684\u90e8\u7f72\u548c\u4f7f\u7528\u65b9\u5f0f\u4ee5\u4f9b\u53c2\u8003\u3002","title":"Kubernetes\u4e0b\u7684\u65e5\u5fd7\u91c7\u96c6"},{"location":"user-guide/use-in-kubernetes/general-usage/#1","text":"\u5728\u4f20\u7edf\u7684\u4f7f\u7528\u865a\u62df\u673a/\u4e91\u4e3b\u673a/\u7269\u7406\u673a\u7684\u65f6\u4ee3\uff0c\u4e1a\u52a1\u8fdb\u7a0b\u90e8\u7f72\u5728\u56fa\u5b9a\u7684\u8282\u70b9\u4e0a\uff0c\u4e1a\u52a1\u65e5\u5fd7\u76f4\u63a5\u8f93\u51fa\u5230\u5bbf\u4e3b\u673a\u4e0a\uff0c\u8fd0\u7ef4\u53ea\u9700\u8981\u624b\u52a8\u6216\u8005\u4f7f\u7528\u81ea\u52a8\u5316\u5de5\u5177\u628a\u65e5\u5fd7\u91c7\u96c6Agent\u90e8\u7f72\u5728\u8282\u70b9\u4e0a\uff0c\u52a0\u4e00\u4e0bAgent\u7684\u914d\u7f6e\uff0c\u5c31\u53ef\u4ee5\u5f00\u59cb\u91c7\u96c6\u65e5\u5fd7\u4e86\u3002 \u800c\u5728Kubernetes\u73af\u5883\u4e2d\uff0c\u60c5\u51b5\u5c31\u6ca1\u8fd9\u4e48\u7b80\u5355\u4e86\uff1a \u52a8\u6001\u8fc1\u79fb \uff1a\u5728Kubernetes\u96c6\u7fa4\u4e2d\u7ecf\u5e38\u5b58\u5728Pod\u4e3b\u52a8\u6216\u8005\u88ab\u52a8\u7684\u8fc1\u79fb\uff0c\u9891\u7e41\u7684\u9500\u6bc1\u3001\u521b\u5efa\uff0c\u6211\u4eec\u65e0\u6cd5\u548c\u4f20\u7edf\u7684\u65b9\u5f0f\u4e00\u6837\u4eba\u4e3a\u7684\u7ed9\u6bcf\u4e2a\u670d\u52a1\u4e0b\u53d1\u65e5\u5fd7\u91c7\u96c6\u914d\u7f6e\u3002 \u65e5\u5fd7\u5b58\u50a8\u65b9\u5f0f\u591a\u6837\u6027 \uff1a\u5bb9\u5668\u7684\u65e5\u5fd7\u5b58\u50a8\u65b9\u5f0f\u6709\u5f88\u591a\u4e0d\u540c\u7684\u7c7b\u578b\uff0c\u4f8b\u5982stdout\u3001hostPath\u3001emptyDir\u3001pv\u7b49\u3002 Kubernetes\u5143\u4fe1\u606f \uff1a\u7531\u4e8e\u65e5\u5fd7\u6570\u636e\u91c7\u96c6\u540e\u4f1a\u88ab\u96c6\u4e2d\u5b58\u50a8\uff0c\u6240\u4ee5\u67e5\u8be2\u65e5\u5fd7\u65f6\uff0c\u9700\u8981\u6839\u636enamespace\u3001pod\u3001container\u3001node\uff0c\u751a\u81f3\u5305\u62ec\u5bb9\u5668\u7684\u73af\u5883\u53d8\u91cf\u3001label\u7b49\u7ef4\u5ea6\u6765\u68c0\u7d22\u3001\u8fc7\u6ee4\uff0c\u6b64\u65f6\u8981\u6c42Agent\u611f\u77e5\u5e76\u9ed8\u8ba4\u5728\u65e5\u5fd7\u91cc\u6ce8\u5165\u8fd9\u4e9b\u5143\u4fe1\u606f\u3002 \u4ee5\u4e0a\u90fd\u662f\u6709\u522b\u4e8e\u4f20\u7edf\u65e5\u5fd7\u91c7\u96c6\u914d\u7f6e\u65b9\u5f0f\u7684\u9700\u6c42\u548c\u75db\u70b9\uff0c\u7a76\u5176\u539f\u56e0\uff0c\u8fd8\u662f\u56e0\u4e3a\u4f20\u7edf\u7684\u65b9\u5f0f\u8131\u79bb\u4e86Kubernetes\uff0c\u65e0\u6cd5\u611f\u77e5Kubernetes\uff0c\u65e0\u6cd5\u548cKubernetes\u96c6\u6210\u3002","title":"1. \u4ece\u4e3b\u673a\u5230\u5bb9\u5668"},{"location":"user-guide/use-in-kubernetes/general-usage/#2-kubernetes","text":"\u4e3a\u4e86\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\uff0c\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0b\u5e02\u9762\u4e0a\u4e00\u822c\u90fd\u6709\u54ea\u4e9b\u89e3\u51b3\u65b9\u6848\u3002","title":"2. \u5728Kubernetes\u4e0b\u7684\u65e5\u5fd7\u5f62\u6001"},{"location":"user-guide/use-in-kubernetes/general-usage/#21","text":"\u9996\u5148\uff0c\u9700\u8981\u63d0\u53ca\u7684\u662f\uff0c\u5728\u4e91\u539f\u751f\u768412\u8981\u7d20\u91cc\uff0c\u63a8\u8350\u4e1a\u52a1\u5bb9\u5668\u5c06\u65e5\u5fd7\u8f93\u51fa\u5230stdout\u4e2d\uff0c\u800c\u4e0d\u662f\u91c7\u7528\u6253\u5370\u65e5\u5fd7\u6587\u4ef6\u7684\u65b9\u5f0f\u3002\u5f53\u7136\uff0c\u5b9e\u9645\u60c5\u51b5\u662f\uff0c\u6211\u4eec\u5f88\u96be\u8fd9\u4e48\u505a\uff0c\u539f\u56e0\u5927\u6982\u6709\uff1a \u9700\u8981\u4e1a\u52a1\u65b9\u4fee\u6539\u65e5\u5fd7\u914d\u7f6e\uff0c\u6bd4\u8f83\u96be\u4ee5\u63a8\u5e7f \u6709\u4e9b\u590d\u6742\u7684\u4e1a\u52a1\u5bf9\u65e5\u5fd7\u6587\u4ef6\u6709\u5206\u7c7b\uff0c\u6bd4\u5982\u5ba1\u8ba1\u65e5\u5fd7\u3001\u8bbf\u95ee\u65e5\u5fd7\u7b49\uff0c\u4e00\u822c\u4f1a\u8f93\u51fa\u4e3a\u72ec\u7acb\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u65e5\u5fd7\u91c7\u96c6\u9700\u6839\u636e\u4e0d\u540c\u7684\u6587\u4ef6\u5206\u7c7b\u8fdb\u884c\u4e0d\u540c\u7684\u5904\u7406 \u6240\u4ee5\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u9700\u8981\u540c\u65f6\u91c7\u96c6\uff1a \u6807\u51c6\u8f93\u51fastdout \u65e5\u5fd7\u6587\u4ef6","title":"2.1 \u91c7\u96c6\u7684\u65e5\u5fd7\u7c7b\u578b"},{"location":"user-guide/use-in-kubernetes/general-usage/#22-agent","text":"\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\uff0cAgent\u6709\u4e24\u79cd\u90e8\u7f72\u65b9\u5f0f\uff1a DaemonSet \uff1a\u6bcf\u4e2a\u8282\u70b9\u90e8\u7f72\u4e00\u4e2aAgent Sidecar \uff1a\u6bcf\u4e2aPod\u589e\u52a0\u4e00\u4e2aSidecar\u5bb9\u5668\uff0c\u8fd0\u884c\u65e5\u5fd7Agent \u4e24\u79cd\u90e8\u7f72\u65b9\u5f0f\u7684\u4f18\u52a3\u90fd\u663e\u800c\u6613\u89c1\uff1a \u8d44\u6e90\u5360\u7528\uff1aDaemonSet\u6bcf\u4e2a\u8282\u70b9\u4e0a\u4e00\u4e2a\uff0c\u800cSidecar\u6bcf\u4e2aPod\u91cc\u4e00\u4e2a\uff0c\u5bb9\u5668\u5316\u5f62\u6001\u4e0b\uff0c\u5f80\u5f80\u4e00\u4e2aNode\u4e0a\u53ef\u80fd\u4f1a\u8dd1\u5f88\u591a\u7684Pod\uff0c\u6b64\u65f6DaemonSet\u7684\u65b9\u5f0f\u8fdc\u5c0f\u4e8eSidecar\uff0c\u800c\u4e14\u8282\u70b9\u4e0aPod\u4e2a\u6570\u8d8a\u591a\u8d8a\u660e\u663e \u4fb5\u5165\u6027\uff1aSidecar\u7684\u65b9\u5f0f\uff0cAgent\u9700\u8981\u6ce8\u5165\u5230\u4e1a\u52a1Pod\u4e2d\uff0c\u4e0d\u7ba1\u662f\u5426\u6709\u5e73\u53f0\u5c01\u88c5\u8fd9\u4e00\u8fc7\u7a0b\uff0c\u8fd8\u662f\u91c7\u7528Kubernetes webhook\u7684\u65b9\u5f0f\u9ed8\u8ba4\u6ce8\u5165\uff0c\u4ecd\u7136\u6539\u53d8\u4e86\u539f\u672c\u7684\u90e8\u7f72\u65b9\u5f0f \u7a33\u5b9a\u6027\uff1a\u65e5\u5fd7\u91c7\u96c6\u5728\u5927\u90e8\u5206\u7684\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u4fdd\u969c\u7684\u662f\u7a33\u5b9a\u6027\uff0c\u6700\u91cd\u8981\u7684\u662f\u4e0d\u80fd\u5f71\u54cd\u4e1a\u52a1\uff0c\u5982\u679c\u91c7\u7528Sidecar\u7684\u65b9\u5f0f\uff0c\u5728Agent\u53d1\u751f\u5f02\u5e38\u6216\u8005oom\u7b49\u60c5\u51b5\uff0c\u5f88\u5bb9\u6613\u5bf9\u4e1a\u52a1\u5bb9\u5668\u9020\u6210\u5f71\u54cd\u3002\u53e6\u5916\uff0cAgent\u6bd4\u8f83\u591a\u7684\u65f6\u5019\uff0c\u5728\u8fde\u63a5\u6570\u7b49\u65b9\u9762\u4f1a\u5bf9\u4e0b\u6e38\u670d\u52a1\u6bd4\u5982Kafka\u9020\u6210\u4e00\u5b9a\u7684\u9690\u60a3\u3002 \u9694\u79bb\u6027\uff1aDaemonSet\u60c5\u51b5\u4e0b\uff0c\u8282\u70b9\u6240\u6709\u7684\u65e5\u5fd7\u90fd\u5171\u7528\u540c\u4e00\u4e2aAgent\uff0c\u800cSidecar\u65b9\u5f0f\uff0c\u53ea\u4f1a\u91c7\u96c6\u540c\u4e00\u4e2aPod\u5185\u7684\u4e1a\u52a1\u65e5\u5fd7\uff0c\u6b64\u65f6Sidecar\u7684\u9694\u79bb\u6027\u7406\u8bba\u4e0a\u4f1a\u597d\u4e00\u4e9b \u6027\u80fd\uff1aSidecar\u7531\u4e8e\u53ea\u4f1a\u91c7\u96c6\u8be5Pod\u91cc\u7684\u65e5\u5fd7\uff0c\u538b\u529b\u76f8\u5bf9\u8f83\u5c0f\uff0c\u6781\u7aef\u60c5\u51b5\u4e0b\uff0c\u8fbe\u5230Agent\u7684\u6027\u80fd\u74f6\u9888\u6bd4DaemonSet\u65b9\u5f0f\u6982\u7387\u4e5f\u4f1a\u5c0f\u5f88\u591a Tip \u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u4f18\u5148\u4f7f\u7528DaemonSet\u7684\u65b9\u5f0f\u91c7\u96c6\u65e5\u5fd7\uff0c\u5982\u679c\u5355\u4e2aPod\u65e5\u5fd7\u91cf\u7279\u522b\u5927\uff0c\u8d85\u8fc7\u4e00\u822cAgent\u53d1\u9001\u541e\u5410\u91cf\uff0c\u53ef\u4ee5\u5355\u72ec\u5bf9\u8be5Pod\u4f7f\u7528Sidecar\u7684\u65b9\u5f0f\u91c7\u96c6\u65e5\u5fd7\u3002","title":"2.2 Agent\u90e8\u7f72\u65b9\u5f0f"},{"location":"user-guide/use-in-kubernetes/general-usage/#23","text":"","title":"2.3 \u91c7\u96c6\u65b9\u5f0f"},{"location":"user-guide/use-in-kubernetes/general-usage/#daemonset-stdout","text":"\u5982\u679c\u4f7f\u7528\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u662fdocker\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u6211\u4eec\u53ef\u4ee5\u5728\u8282\u70b9\u7684docker\u8def\u5f84\u4e2d\u627e\u5230\u5bb9\u5668\u7684stdout\u7684\u65e5\u5fd7\uff0c\u9ed8\u8ba4\u4e3a /var/lib/docker/containers/{containerId}/{containerId}-json.log \u3002 \u5728Kubernetes 1.14\u7248\u672c\u4e4b\u524d\uff0ckubelet\u4f1a\u5728 /var/log/pods/<podUID>/<containerName>/<num>.log \u5efa\u7acb\u4e00\u4e2a\u8f6f\u94fe\u63a5\u5230stdout\u6587\u4ef6\u4e2d\u3002 \u7c7b\u4f3c\u5982\u4e0b\u6240\u793a\uff1a root@master0:/var/log/pods# tree . | -- 6687e53201c01e3fad31e7d72fbb92a6 | ` -- kube-apiserver | | -- 865 .log -> /var/lib/docker/containers/3a35ae0a1d0b26455fbd9b267cd9d6ac3fbd3f0b12ee03b4b22b80dc5a1cde03/3a35ae0a1d0b26455fbd9b267cd9d6ac3fbd3f0b12ee03b4b22b80dc5a1cde03-json.log | ` -- 866 .log -> /var/lib/docker/containers/15a6924f14fcbf15dd37d1c185c5b95154fa2c5f3de9513204b1066bbe474662/15a6924f14fcbf15dd37d1c185c5b95154fa2c5f3de9513204b1066bbe474662-json.log | -- a1083c6d-3b12-11ea-9af1-fa163e28f309 | ` -- kube-proxy | | -- 3 .log -> /var/lib/docker/containers/4b63b5a90a8f9ca6b6f20b49b5ab2564f92df21a5590f46de2a46b031e55c80e/4b63b5a90a8f9ca6b6f20b49b5ab2564f92df21a5590f46de2a46b031e55c80e-json.log | ` -- 4 .log -> /var/lib/docker/containers/fc7c315d33935887ca3479a38cfca4cca66fad782b8a120c548ad0b9f0ff7207/fc7c315d33935887ca3479a38cfca4cca66fad782b8a120c548ad0b9f0ff7207-json.log \u5728Kubernetes 1.14\u7248\u672c\u4e4b\u540e\uff0c\u6539\u6210\u4e86 /var/log/pods/<namespace>_<pod_name>_<pod_id>/<container_name>/<num>.log \u7684\u5f62\u5f0f\u3002 root@master-0:/var/log/pods# tree . | -- kube-system_kube-apiserver-kind-control-plane_bd1c21fe1f0ef615e0b5e41299f1be61 | ` -- kube-apiserver | ` -- 0 .log | -- kube-system_kube-proxy-gcrfq_f07260b8-6055-4c19-9491-4a825579528f | ` -- kube-proxy | ` -- 0 .log ` -- loggie_loggie-csd4g_f1cc32e9-1002-4e64-bd58-fc6094394e06 ` -- loggie ` -- 0 .log \u6240\u4ee5\uff0c\u5bf9\u4e8eAgent\u91c7\u96c6\u6807\u51c6\u8f93\u51fa\u65e5\u5fd7\u6765\u8bf4\uff0c\u4e5f\u5c31\u662f\u91c7\u96c6\u8282\u70b9\u4e0a\u7684\u8fd9\u4e9b\u65e5\u5fd7\u6587\u4ef6\u3002 \u4e00\u79cd\u7b80\u5355\u7c97\u66b4\u7684\u91c7\u96c6\u65b9\u5f0f\u662f\uff0c\u4f7f\u7528DaemonSet\u90e8\u7f72\u65e5\u5fd7Agent\uff0c\u6302\u8f7d /var/log/pods \u76ee\u5f55\uff0cAgent\u7684\u914d\u7f6e\u6587\u4ef6\u4f7f\u7528\u7c7b\u4f3c /var/log/pod/*/*.log \u53bb\u901a\u914d\u65e5\u5fd7\u6587\u4ef6\uff0c\u91c7\u96c6\u8282\u70b9\u4e0a\u6240\u6709\u7684\u5bb9\u5668\u6807\u51c6\u8f93\u51fa\u3002 \u4f46\u662f\u8fd9\u6837\u7684\u5c40\u9650\u5728\u4e8e\uff1a \u65e0\u6cd5\u6ce8\u5165\u66f4\u591a\u5143\u4fe1\u606f\u6bd4\u5982\u4e00\u4e9bpod\u7684label/env\u7b49\uff0c\u7279\u522b\u662f\u5728k8s1.14\u7248\u672c\u4e4b\u524d\uff0c\u751a\u81f3\u65e0\u6cd5\u5728\u91c7\u96c6\u7684path\u91cc\u83b7\u53d6\u5230namespace/pod\u7b49\u4fe1\u606f \u5f88\u96be\u9488\u5bf9\u5355\u4e2a\u670d\u52a1\u914d\u7f6e\u7279\u6b8a\u7684\u914d\u7f6e\uff0c\u6bd4\u5982\u67d0\u4e2a\u6587\u4ef6\u9700\u8981\u4f7f\u7528\u7279\u6b8a\u7684\u591a\u884c\u65e5\u5fd7\u91c7\u96c6\uff0c\u9700\u8981\u914d\u7f6e\u9002\u5408\u670d\u52a1\u81ea\u8eab\u7684\u65e5\u5fd7\u683c\u5f0f\u5207\u5206\u7b49 \u4f1a\u91c7\u96c6\u5f88\u591a\u4e0d\u5fc5\u8981\u7684\u5bb9\u5668\u65e5\u5fd7\uff0c\u9020\u6210\u91c7\u96c6\u3001\u4f20\u8f93\u3001\u5b58\u50a8\u538b\u529b \u5f53\u7136\u73b0\u5728\u7684\u4e00\u4e9b\u65e5\u5fd7Agent\u6bd4\u5982Filebeat/Fluentd\u90fd\u9488\u5bf9\u6027\u7684\u505a\u4e86\u652f\u6301\uff0c\u6bd4\u5982\u53ef\u4ee5\u5c06namespace/pod\u7b49\u4fe1\u606f\u6ce8\u5165\u65e5\u5fd7\u4e2d\uff0c\u4f46\u4ecd\u7136\u6ca1\u6709\u89e3\u51b3\u5927\u90e8\u5206\u7684\u95ee\u9898\u3002 \u6240\u4ee5\uff0c\u8fd9\u79cd\u65b9\u5f0f\u53ea\u9002\u5408\u7b80\u5355\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u540e\u7eed\u4e5f\u96be\u4ee5\u6ee1\u8db3\u5176\u4ed6\u66f4\u591a\u7684\u65e5\u5fd7\u9700\u6c42\u3002","title":"DaemonSet + Stdout"},{"location":"user-guide/use-in-kubernetes/general-usage/#daemonset","text":"\u5982\u679cPod\u91cc\u4e0d\u4ec5\u4ec5\u662f\u8f93\u51fastdout\uff0c\u8fd8\u5305\u62ec\u65e5\u5fd7\u6587\u4ef6\uff0c\u5c31\u9700\u8981\u8003\u8651\u5230\u6302\u8f7d\u65e5\u5fd7\u6587\u4ef6\u5230\u8282\u70b9\u4e0a\uff0c\u540c\u65f6\u91c7\u7528DaemonSet\u90e8\u7f72\u7684Agent\u4e5f\u9700\u8981\u6302\u8f7d\u76f8\u540c\u7684\u76ee\u5f55\uff0c\u5426\u5219\u91c7\u7528\u5bb9\u5668\u5316\u90e8\u7f72\u7684Agent\u65e0\u6cd5\u67e5\u770b\u5230\u76f8\u5e94\u7684\u6587\u4ef6\uff0c\u66f4\u65e0\u6cd5\u91c7\u96c6\u3002 \u4e1a\u52a1Pod\u6302\u8f7d\u65e5\u5fd7\u8def\u5f84\u7684\u65b9\u5f0f\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a (1) emtpyDir emtpyDir\u7684\u751f\u547d\u5468\u671f\u8ddf\u968fPod\uff0cPod\u9500\u6bc1\u540e\u5176\u4e2d\u5b58\u50a8\u7684\u65e5\u5fd7\u4e5f\u4f1a\u6d88\u5931\u3002 \u4f18\u70b9\uff1a\u4f7f\u7528\u7b80\u5355\uff0c\u4e0d\u540cPod\u90fd\u4f7f\u7528\u81ea\u5df1\u7684emtpyDir\uff0c\u6709\u4e00\u5b9a\u7684\u9694\u79bb\u6027\u3002 \u7f3a\u70b9\uff1a\u65e5\u5fd7\u5982\u679c\u91c7\u96c6\u4e0d\u53ca\u65f6\uff0c\u5728Pod\u6d88\u8017\u540e\uff0c\u5b58\u5728\u4e22\u5931\u7684\u53ef\u80fd\u6027\u3002 \u4f7f\u7528emptyDir\u6302\u8f7d\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u4e00\u822c\u5728\u8282\u70b9\u7684\u8def\u5f84\u5982\u4e0b\uff1a /var/lib/kubelet/pods/${pod.UID}/volumes/kubernetes.io~empty-dir/${volumeName} (2) hostPath \u751f\u547d\u5468\u671f\u548cPod\u65e0\u5173\uff0cPod\u8fc1\u79fb\u6216\u8005\u9500\u6bc1\uff0c\u65e5\u5fd7\u6587\u4ef6\u8fd8\u4fdd\u7559\u5728\u73b0\u6709\u78c1\u76d8\u4e0a\u3002 \u4f18\u70b9\uff1a\u751f\u547d\u5468\u671f\u548cPod\u65e0\u5173\uff0c\u5373\u4f7fPod\u9500\u6bc1\uff0c\u65e5\u5fd7\u6587\u4ef6\u4f9d\u7136\u5728\u8282\u70b9\u78c1\u76d8\u4e0a\uff0c\u5047\u8bbeAgent\u6ca1\u6709\u91c7\u96c6\u65e5\u5fd7\uff0c\u4ecd\u7136\u53ef\u4ee5\u627e\u5230\u65e5\u5fd7\u6587\u4ef6 \u7f3a\u70b9\uff1a\u9ed8\u8ba4\u65e0\u9694\u79bb\u6027\uff0c\u9700\u8981\u63a7\u5236\u6302\u8f7d\u7684\u65e5\u5fd7\u8def\u5f84\uff1b\u53e6\u5916\uff0cPod\u8fc1\u79fb\u8282\u70b9\u540e\uff0c\u6b8b\u7559\u7684\u65e5\u5fd7\u6587\u4ef6\u957f\u671f\u79ef\u7d2f\u5bb9\u6613\u5360\u636e\u78c1\u76d8\uff0c\u540c\u65f6\u65e5\u5fd7\u5360\u636e\u7684\u78c1\u76d8\u65e0\u6cd5\u63a7\u5236\u4f7f\u7528\u7684\u914d\u989d \u4e3a\u4e86\u89e3\u51b3\u9694\u79bb\u6027\uff0c\u907f\u514d\u591a\u4e2aPod\u6253\u5370\u65e5\u5fd7\u5230\u76f8\u540c\u7684\u8def\u5f84\u548c\u6587\u4ef6\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528 subPathExpr \u5b57\u6bb5\u4ece Downward API \u73af\u5883\u53d8\u91cf\u6784\u9020 subPath \u76ee\u5f55\u540d\u3002 \u8be5 VolumeSubpathEnvExpansion \u529f\u80fd\u4ece Kubernetes1.15 \u5f00\u59cb\u9ed8\u8ba4\u5f00\u542f\uff0c\u57281.17 GA\u3002\u53ef\u53c2\u8003 feature-gates \u548c using-subpath-expanded-environment \u3002 \u4f7f\u7528subPathExpr\u7684\u793a\u4f8b\u5982\u4e0b\u6240\u793a\uff1a apiVersion : apps/v1 kind : Deployment metadata : labels : app : nginx name : nginx namespace : default spec : selector : matchLabels : app : nginx template : metadata : labels : app : nginx spec : containers : - env : - name : POD_NAME valueFrom : fieldRef : apiVersion : v1 fieldPath : metadata.name - name : NAMESPACE valueFrom : fieldRef : apiVersion : v1 fieldPath : metadata.namespace image : nginx name : nginx resources : {} volumeMounts : - mountPath : /data/log name : datalog subPathExpr : $(NAMESPACE)/$(POD_NAME) volumes : - hostPath : path : /data/log type : \"\" name : datalog \u5728\u521b\u5efa\u5b8c\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6240\u5728\u8282\u70b9\u7684 /data/log \u4e0b\u53d1\u73b0\u7c7b\u4f3c\u7684\u76ee\u5f55\u7ed3\u6784\uff1a . `-- default |-- nginx-888dc6778-krfqr `-- nginx-888dc6778-sw8vd \u6bcf\u4e2aPod\u7684\u5b58\u653e\u7684\u65e5\u5fd7\u6587\u4ef6\u5373\u5728\u8282\u70b9\u7684 /data/log/$(NAMESPACE)/$(POD_NAME) \u8def\u5f84\u4e0b\u3002 (3) Pv Pv\u7684\u8bbf\u95ee\u6a21\u5f0f\u5305\u62ec\uff1a ReadWriteOnce\uff08RWO\uff09\uff1a\u8bfb\u5199\u6743\u9650\uff0c\u5e76\u4e14\u53ea\u80fd\u88ab\u5355\u4e2aNode\u6302\u8f7d\u3002 ReadOnlyMany\uff08ROX\uff09\uff1a\u53ea\u8bfb\u6743\u9650\uff0c\u5141\u8bb8\u88ab\u591a\u4e2aNode\u6302\u8f7d\u3002 ReadWriteMany\uff08RWX\uff09\uff1a\u8bfb\u5199\u6743\u9650\uff0c\u5141\u8bb8\u88ab\u591a\u4e2aNode\u6302\u8f7d\u3002 \u5bf9\u4e8e\u5927\u90e8\u5206\u7684\u4e1a\u52a1\u6765\u8bf4\uff0c\u90fd\u662fDeployment\u65e0\u72b6\u6001\u90e8\u7f72\uff0c\u9700\u8981\u6302\u8f7d\u540c\u4e00\u4e2aPv\u5171\u4eab\uff1b\u5bf9\u4e8e\u4e00\u4e9b\u4e2d\u95f4\u4ef6\u7b49\u6709\u72b6\u6001\u670d\u52a1\uff0c\u4e00\u822c\u4f1a\u4f7f\u7528StatefulSet\u90e8\u7f72\uff0c\u6bcf\u4e2aPod\u4f1a\u4f7f\u7528\u72ec\u7acb\u7684Pv\u3002 \u4f18\u70b9\uff1a\u5b58\u50a8\u65e5\u5fd7\u4e0d\u5bb9\u6613\u4e22\u5931\uff1b \u7f3a\u70b9\uff1a\u6709\u4e00\u5b9a\u7684\u4f7f\u7528\u548c\u8fd0\u7ef4\u590d\u6742\u5ea6\uff1b\u591a\u4e2aPod\u5171\u4eab\u540c\u4e00\u4e2aPv\u65f6\u5b58\u5728\u9694\u79bb\u6027\u95ee\u9898\uff1b\u5f88\u591a\u7684\u65e5\u5fd7Agent\u5bf9\u91c7\u96c6\u4e91\u76d8\u4e0a\u7684\u65e5\u5fd7\u6587\u4ef6\u652f\u6301\u4e0d\u591f\u6210\u719f\uff0c\u53ef\u80fd\u5b58\u5728\u4e00\u4e9b\u9690\u60a3\uff1b \u867d\u7136\u540c\u6837\u53ef\u4ee5\u5728Node\u4e0a\u627e\u5230\u4f7f\u7528Pv\u6302\u8f7d\u7684\u5bf9\u5e94\u65e5\u5fd7\u6587\u4ef6\uff0c\u4f46\u662fPv\u6839\u636e\u4e0d\u540c\u7684\u5e95\u5c42\u5b9e\u73b0\uff0c\u5728Node\u4e0a\u7684\u8def\u5f84\u4f1a\u6709\u4e00\u5b9a\u7684\u533a\u522b\u3002 \u76ee\u524d\u5e02\u9762\u4e0a\u5927\u90e8\u5206\u65e5\u5fd7Agent\u5747\u5bf9\u8fd9\u4e9b\u6302\u8f7d\u65b9\u5f0f\u6ca1\u6709\u611f\u77e5\uff0c\u6240\u4ee5\u4f60\u80fd\u505a\u7684\u548c\u4e0a\u9762\u4f7f\u7528stdout\u7684\u65b9\u5f0f\u7c7b\u4f3c\uff0c\u4e5f\u5c31\u662f\u7b80\u5355\u7c97\u66b4\u7684\u8ba9Agent\u5c06\u8def\u5f84\u90fd\u6302\u8f7d\uff0c\u4f7f\u7528\u901a\u914d\u7684\u65b9\u5f0f\u91c7\u96c6\u6240\u6709\u7684\u65e5\u5fd7\uff0c\u4f7f\u7528\u4e0a\u7684\u5c40\u9650\u548cstdout\u7684\u65b9\u5f0f\u540c\u6837\u4e00\u81f4\u3002 \u53e6\u5916\uff0c\u9274\u4e8e\u4e00\u4e9bAgent\u5bf9\u91c7\u96c6docker stdout\u6709\u4e00\u5b9a\u7684\u652f\u6301\uff0c\u6240\u4ee5\u8fd8\u5b58\u5728\u4e00\u4e9b\u4f7f\u7528\u4e0a\u53d8\u79cd\uff0c\u6bd4\u5982\u5229\u7528webhook\u6ce8\u5165\u4e00\u4e2asidecar\uff0c\u8bfb\u53d6Pod\u91cc\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u8f6c\u6362\u6210sidecar\u7684stdout\uff0c\u7136\u540e\u91c7\u96c6sidecar\u7684stdout\u65e5\u5fd7\uff0c\u8fd9\u91cc\u4e0d\u518d\u8be6\u8ff0\u3002 \uff084\uff09\u4e0d\u6302\u8f7d \u5f88\u591a\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u90fd\u758f\u4e8e\u6302\u8f7d\u65e5\u5fd7\u8def\u5f84volume\uff0c\u6216\u8005\u5bf9\u63a5\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u7cfb\u7edf\uff0c\u5f80\u5f80\u4e1a\u52a1\u65b9\u4e0d\u613f\u610f\u66f4\u6539\uff0c\u8fd9\u4e2a\u65f6\u5019\u80fd\u91c7\u96c6\u5bb9\u5668\u91cc\u7684\u65e5\u5fd7\u6587\u4ef6\u5417\uff1f Loggie\u5c1d\u8bd5\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u5f00\u542f\uff0c\u4e0d\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u4ecd\u7136\u9700\u8981\u66f4\u591a\u957f\u671f\u751f\u4ea7\u5b9e\u8df5\u7684\u68c0\u9a8c\u3002\u6b22\u8fce\u8bd5\u7528\uff0c\u5177\u4f53\u5f00\u5173\u8bf7\u53c2\u8003\u4e0b\u4e00\u8282\u3002","title":"DaemonSet + \u65e5\u5fd7\u6587\u4ef6"},{"location":"user-guide/use-in-kubernetes/general-usage/#sidecar-stdout","text":"\u5982\u679c\u9700\u8981\u91c7\u7528sidecar\u7684\u65b9\u5f0f\uff0c\u9700\u8981\u5c06\u65e5\u5fd7Agent\u540c\u65f6\u6302\u8f7d\u76f8\u540c\u7684\u65e5\u5fd7\u8def\u5f84\uff0cAgent\u7684\u914d\u7f6e\u6587\u4ef6\u4e5f\u4e00\u822c\u4f7f\u7528ConfigMap\u6302\u8f7d\u51fa\u6765\u3002 \u4f7f\u7528Sidecar\u7684\u90e8\u7f72\u65b9\u5f0f\u548cDaemonSet\u7684\u65b9\u5f0f\u4f18\u52a3\u5bf9\u6bd4\u8bf7\u53c2\u8003\u4e0a\u6587\u3002 \u603b\u7ed3 \uff1a \u5927\u90e8\u5206\u4e3b\u6d41\u7684\u5f00\u6e90Agent\uff0c\u53ea\u5bf9\u5bb9\u5668Stdout\u6709\u90e8\u5206\u652f\u6301\uff0c\u6bd4\u5982\u652f\u6301\u91c7\u96c6\u7684\u65f6\u5019\u7edf\u4e00\u52a0\u4e0a\u4e00\u4e9bK8s\u76f8\u5173\u5143\u4fe1\u606f\uff0c\u4f46\u4e0d\u652f\u6301\u5355\u72ec\u9488\u5bf9\u67d0\u4e9bPod\u8fdb\u884c\u914d\u7f6e\uff0c\u800c\u4e14\u5747\u6ca1\u6709\u5bf9\u5bb9\u5668\u4e2d\u7684\u65e5\u5fd7\u6587\u4ef6\u91c7\u96c6\u6709\u5f88\u597d\u7684\u652f\u6301\u3002 \u8fd9\u6837\u5bfc\u81f4\u5728\u5b9e\u9645\u590d\u6742\u7684\u5404\u7c7b\u4e1a\u52a1\u573a\u666f\u4e2d\uff0c\u6ca1\u529e\u6cd5\u6ee1\u8db3\u9700\u6c42\u3002","title":"Sidecar + Stdout/\u65e5\u5fd7\u6587\u4ef6"},{"location":"user-guide/use-in-kubernetes/general-usage/#loggie","text":"\u76f8\u4fe1\u4ee5\u4e0a\u5217\u51fa\u7684\u95ee\u9898\u5927\u5bb6\u90fd\u9047\u5230\u6216\u8005\u601d\u8003\u8fc7\uff0c\u90a3Loggie\u662f\u5982\u4f55\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u7684\u5462\uff1f \u8bf7\u770b\u4e0b\u4e00\u8282\u5982\u4f55 \u4f7f\u7528Loggie\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\uff1f","title":"Loggie\u5982\u4f55\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff1f"},{"location":"user-guide/use-in-kubernetes/kube-event-source/","text":"\u91c7\u96c6Kubernetes Events \u00b6 \u9664\u4e86\u4f7f\u7528Logconfig\u91c7\u96c6\u65e5\u5fd7\u5916\uff0cLoggie\u540c\u6837\u53ef\u4ee5\u901a\u8fc7CRD\u914d\u7f6e\u4efb\u610f\u7684source/sink/interceptor\uff0c\u672c\u8d28\u4e0aLoggie\u5c31\u662f\u4e00\u4e2a\u652f\u6301\u591aPipeline\u7684\u6570\u636e\u6d41\uff0c\u96c6\u6210\u4e86\u901a\u7528\u7684\u8bf8\u5982\u961f\u5217\u91cd\u8bd5\u3001\u6570\u636e\u5904\u7406\u3001\u914d\u7f6e\u4e0b\u53d1\u3001\u76d1\u63a7\u62a5\u8b66\u7b49\u7b49\u529f\u80fd\uff0c\u51cf\u5c11\u4e86\u7c7b\u4f3c\u9700\u6c42\u7684\u7814\u53d1\u6210\u672c\u3002\u91c7\u96c6Kubernetes\u7684Events\u5c31\u662f\u5176\u4e2d\u4e00\u4e2a\u5f88\u597d\u7684\u4f8b\u5b50\u3002 Kubernetes Events\u662f\u7531Kubernetes\u672c\u8eab\u7ec4\u4ef6\u548c\u4e00\u4e9b\u63a7\u5236\u5668\u4ea7\u751f\u7684\u4e8b\u4ef6\uff0c\u6211\u4eec\u5e38\u7528\u7684 kubectl describe \u547d\u4ee4\u5c31\u53ef\u4ee5\u67e5\u770b\u5173\u8054\u8d44\u6e90\u7684\u4e8b\u4ef6\u4fe1\u606f\uff0c\u91c7\u96c6\u8bb0\u5f55\u8fd9\u4e9b\u4e8b\u4ef6\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u56de\u6eaf\u3001\u6392\u67e5\u3001\u5ba1\u8ba1\u3001\u603b\u7ed3\u95ee\u9898\uff0c\u66f4\u597d\u7684\u4e86\u89e3Kubernetes\u96c6\u7fa4\u5185\u90e8\u72b6\u6001\u3002 \u51c6\u5907 \u00b6 \u548cLoggie\u4e2d\u8f6c\u673a\u7c7b\u4f3c\uff0c\u6211\u4eec\u53ef\u4ee5\u5355\u72ec \u90e8\u7f72Aggregator \u96c6\u7fa4\u6216\u8005\u590d\u7528\u73b0\u6709\u7684\u4e2d\u8f6c\u673a\u96c6\u7fa4\u3002 \u914d\u7f6e\u793a\u4f8b \u00b6 \u914d\u7f6ekubeEvents source\uff0c\u5e76\u4e14\u4f7f\u7528 type: cluster \u4e0b\u53d1\u914d\u7f6e\u5230Aggregator\u96c6\u7fa4\u5373\u53ef\u3002 Config apiVersion : loggie.io/v1beta1 kind : ClusterLogConfig metadata : name : kubeevent spec : selector : type : cluster cluster : aggregator pipeline : sources : | - type: kubeEvent name: event sinkRef : dev \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4e0d\u7ba1\u662f\u53d1\u9001\u7ed9Elasticsearch\u8fd8\u662f\u5176\u4ed6\u7684sink\uff0c\u8f93\u51fa\u7684\u662f\u7c7b\u4f3c\u5982\u4e0b\u683c\u5f0f\u7684\u6570\u636e: event { \"body\" : \"{\\\"metadata\\\":{\\\"name\\\":\\\"loggie-aggregator.16c277f8fc4ff0d0\\\",\\\"namespace\\\":\\\"loggie-aggregator\\\",\\\"uid\\\":\\\"084cea27-cd4a-4ce4-97ef-12e70f37880e\\\",\\\"resourceVersion\\\":\\\"2975193\\\",\\\"creationTimestamp\\\":\\\"2021-12-20T12:58:45Z\\\",\\\"managedFields\\\":[{\\\"manager\\\":\\\"kube-controller-manager\\\",\\\"operation\\\":\\\"Update\\\",\\\"apiVersion\\\":\\\"v1\\\",\\\"time\\\":\\\"2021-12-20T12:58:45Z\\\",\\\"fieldsType\\\":\\\"FieldsV1\\\",\\\"fieldsV1\\\":{\\\"f:count\\\":{},\\\"f:firstTimestamp\\\":{},\\\"f:involvedObject\\\":{\\\"f:apiVersion\\\":{},\\\"f:kind\\\":{},\\\"f:name\\\":{},\\\"f:namespace\\\":{},\\\"f:resourceVersion\\\":{},\\\"f:uid\\\":{}},\\\"f:lastTimestamp\\\":{},\\\"f:message\\\":{},\\\"f:reason\\\":{},\\\"f:source\\\":{\\\"f:component\\\":{}},\\\"f:type\\\":{}}}]},\\\"involvedObject\\\":{\\\"kind\\\":\\\"DaemonSet\\\",\\\"namespace\\\":\\\"loggie-aggregator\\\",\\\"name\\\":\\\"loggie-aggregator\\\",\\\"uid\\\":\\\"7cdf4792-815d-4eba-8a81-d60131ad1fc4\\\",\\\"apiVersion\\\":\\\"apps/v1\\\",\\\"resourceVersion\\\":\\\"2975170\\\"},\\\"reason\\\":\\\"SuccessfulCreate\\\",\\\"message\\\":\\\"Created pod: loggie-aggregator-pbkjk\\\",\\\"source\\\":{\\\"component\\\":\\\"daemonset-controller\\\"},\\\"firstTimestamp\\\":\\\"2021-12-20T12:58:45Z\\\",\\\"lastTimestamp\\\":\\\"2021-12-20T12:58:45Z\\\",\\\"count\\\":1,\\\"type\\\":\\\"Normal\\\",\\\"eventTime\\\":null,\\\"reportingComponent\\\":\\\"\\\",\\\"reportingInstance\\\":\\\"\\\"}\" , \"systemPipelineName\" : \"default/kubeevent/\" , \"systemSourceName\" : \"event\" } \u4e3a\u4e86\u65b9\u4fbf\u5206\u6790\u5c55\u793a\uff0c\u6211\u4eec\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e9binterceptor\u5c06\u91c7\u96c6\u5230\u7684events\u6570\u636ejson decode\u3002 \u914d\u7f6e\u793a\u4f8b\u5982\u4e0b\uff0c\u5177\u4f53\u8bf7\u53c2\u8003 \u65e5\u5fd7\u5207\u5206\u4e0e\u5904\u7406 \u3002 Config interceptor apiVersion : loggie.io/v1beta1 kind : Interceptor metadata : name : jsondecode spec : interceptors : | - type: normalize name: json processors: - jsonDecode: ~ - drop: targets: [\"body\"] clusterLogConfig apiVersion : loggie.io/v1beta1 kind : ClusterLogConfig metadata : name : kubeevent spec : selector : type : cluster cluster : aggregator pipeline : sources : | - type: kubeEvent name: event interceptorRef : jsondecode sinkRef : dev \u7ecf\u8fc7normalize interceptor\u91ccjsonDecode\u540e\u7684\u6570\u636e\u5982\u4e0b\u6240\u793a\uff1a event { \"metadata\" : { \"name\" : \"loggie-aggregator.16c277f8fc4ff0d0\" , \"namespace\" : \"loggie-aggregator\" , \"uid\" : \"084cea27-cd4a-4ce4-97ef-12e70f37880e\" , \"resourceVersion\" : \"2975193\" , \"creationTimestamp\" : \"2021-12-20T12:58:45Z\" , \"managedFields\" : [ { \"fieldsType\" : \"FieldsV1\" , \"fieldsV1\" : { \"f:type\" : { }, \"f:count\" : { }, \"f:firstTimestamp\" : { }, \"f:involvedObject\" : { \"f:apiVersion\" : { }, \"f:kind\" : { }, \"f:name\" : { }, \"f:namespace\" : { }, \"f:resourceVersion\" : { }, \"f:uid\" : { } }, \"f:lastTimestamp\" : { }, \"f:message\" : { }, \"f:reason\" : { }, \"f:source\" : { \"f:component\" : { } } }, \"manager\" : \"kube-controller-manager\" , \"operation\" : \"Update\" , \"apiVersion\" : \"v1\" , \"time\" : \"2021-12-20T12:58:45Z\" } ] }, \"reportingComponent\" : \"\" , \"type\" : \"Normal\" , \"message\" : \"Created pod: loggie-aggregator-pbkjk\" , \"reason\" : \"SuccessfulCreate\" , \"reportingInstance\" : \"\" , \"source\" : { \"component\" : \"daemonset-controller\" }, \"count\" : 1 , \"lastTimestamp\" : \"2021-12-20T12:58:45Z\" , \"firstTimestamp\" : \"2021-12-20T12:58:45Z\" , \"eventTime\" : null , \"involvedObject\" : { \"kind\" : \"DaemonSet\" , \"namespace\" : \"loggie-aggregator\" , \"name\" : \"loggie-aggregator\" , \"uid\" : \"7cdf4792-815d-4eba-8a81-d60131ad1fc4\" , \"apiVersion\" : \"apps/v1\" , \"resourceVersion\" : \"2975170\" }, } \u5982\u679c\u89c9\u5f97\u6570\u636e\u5b57\u6bb5\u592a\u591a\u6216\u8005\u683c\u5f0f\u4e0d\u7b26\u5408\u9700\u6c42\uff0c\u8fd8\u53ef\u4ee5\u914d\u7f6enormalize interceptor\u8fdb\u884c\u4fee\u6539\u3002","title":"\u91c7\u96c6Kubernetes Events"},{"location":"user-guide/use-in-kubernetes/kube-event-source/#kubernetes-events","text":"\u9664\u4e86\u4f7f\u7528Logconfig\u91c7\u96c6\u65e5\u5fd7\u5916\uff0cLoggie\u540c\u6837\u53ef\u4ee5\u901a\u8fc7CRD\u914d\u7f6e\u4efb\u610f\u7684source/sink/interceptor\uff0c\u672c\u8d28\u4e0aLoggie\u5c31\u662f\u4e00\u4e2a\u652f\u6301\u591aPipeline\u7684\u6570\u636e\u6d41\uff0c\u96c6\u6210\u4e86\u901a\u7528\u7684\u8bf8\u5982\u961f\u5217\u91cd\u8bd5\u3001\u6570\u636e\u5904\u7406\u3001\u914d\u7f6e\u4e0b\u53d1\u3001\u76d1\u63a7\u62a5\u8b66\u7b49\u7b49\u529f\u80fd\uff0c\u51cf\u5c11\u4e86\u7c7b\u4f3c\u9700\u6c42\u7684\u7814\u53d1\u6210\u672c\u3002\u91c7\u96c6Kubernetes\u7684Events\u5c31\u662f\u5176\u4e2d\u4e00\u4e2a\u5f88\u597d\u7684\u4f8b\u5b50\u3002 Kubernetes Events\u662f\u7531Kubernetes\u672c\u8eab\u7ec4\u4ef6\u548c\u4e00\u4e9b\u63a7\u5236\u5668\u4ea7\u751f\u7684\u4e8b\u4ef6\uff0c\u6211\u4eec\u5e38\u7528\u7684 kubectl describe \u547d\u4ee4\u5c31\u53ef\u4ee5\u67e5\u770b\u5173\u8054\u8d44\u6e90\u7684\u4e8b\u4ef6\u4fe1\u606f\uff0c\u91c7\u96c6\u8bb0\u5f55\u8fd9\u4e9b\u4e8b\u4ef6\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u56de\u6eaf\u3001\u6392\u67e5\u3001\u5ba1\u8ba1\u3001\u603b\u7ed3\u95ee\u9898\uff0c\u66f4\u597d\u7684\u4e86\u89e3Kubernetes\u96c6\u7fa4\u5185\u90e8\u72b6\u6001\u3002","title":"\u91c7\u96c6Kubernetes Events"},{"location":"user-guide/use-in-kubernetes/kube-event-source/#_1","text":"\u548cLoggie\u4e2d\u8f6c\u673a\u7c7b\u4f3c\uff0c\u6211\u4eec\u53ef\u4ee5\u5355\u72ec \u90e8\u7f72Aggregator \u96c6\u7fa4\u6216\u8005\u590d\u7528\u73b0\u6709\u7684\u4e2d\u8f6c\u673a\u96c6\u7fa4\u3002","title":"\u51c6\u5907"},{"location":"user-guide/use-in-kubernetes/kube-event-source/#_2","text":"\u914d\u7f6ekubeEvents source\uff0c\u5e76\u4e14\u4f7f\u7528 type: cluster \u4e0b\u53d1\u914d\u7f6e\u5230Aggregator\u96c6\u7fa4\u5373\u53ef\u3002 Config apiVersion : loggie.io/v1beta1 kind : ClusterLogConfig metadata : name : kubeevent spec : selector : type : cluster cluster : aggregator pipeline : sources : | - type: kubeEvent name: event sinkRef : dev \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4e0d\u7ba1\u662f\u53d1\u9001\u7ed9Elasticsearch\u8fd8\u662f\u5176\u4ed6\u7684sink\uff0c\u8f93\u51fa\u7684\u662f\u7c7b\u4f3c\u5982\u4e0b\u683c\u5f0f\u7684\u6570\u636e: event { \"body\" : \"{\\\"metadata\\\":{\\\"name\\\":\\\"loggie-aggregator.16c277f8fc4ff0d0\\\",\\\"namespace\\\":\\\"loggie-aggregator\\\",\\\"uid\\\":\\\"084cea27-cd4a-4ce4-97ef-12e70f37880e\\\",\\\"resourceVersion\\\":\\\"2975193\\\",\\\"creationTimestamp\\\":\\\"2021-12-20T12:58:45Z\\\",\\\"managedFields\\\":[{\\\"manager\\\":\\\"kube-controller-manager\\\",\\\"operation\\\":\\\"Update\\\",\\\"apiVersion\\\":\\\"v1\\\",\\\"time\\\":\\\"2021-12-20T12:58:45Z\\\",\\\"fieldsType\\\":\\\"FieldsV1\\\",\\\"fieldsV1\\\":{\\\"f:count\\\":{},\\\"f:firstTimestamp\\\":{},\\\"f:involvedObject\\\":{\\\"f:apiVersion\\\":{},\\\"f:kind\\\":{},\\\"f:name\\\":{},\\\"f:namespace\\\":{},\\\"f:resourceVersion\\\":{},\\\"f:uid\\\":{}},\\\"f:lastTimestamp\\\":{},\\\"f:message\\\":{},\\\"f:reason\\\":{},\\\"f:source\\\":{\\\"f:component\\\":{}},\\\"f:type\\\":{}}}]},\\\"involvedObject\\\":{\\\"kind\\\":\\\"DaemonSet\\\",\\\"namespace\\\":\\\"loggie-aggregator\\\",\\\"name\\\":\\\"loggie-aggregator\\\",\\\"uid\\\":\\\"7cdf4792-815d-4eba-8a81-d60131ad1fc4\\\",\\\"apiVersion\\\":\\\"apps/v1\\\",\\\"resourceVersion\\\":\\\"2975170\\\"},\\\"reason\\\":\\\"SuccessfulCreate\\\",\\\"message\\\":\\\"Created pod: loggie-aggregator-pbkjk\\\",\\\"source\\\":{\\\"component\\\":\\\"daemonset-controller\\\"},\\\"firstTimestamp\\\":\\\"2021-12-20T12:58:45Z\\\",\\\"lastTimestamp\\\":\\\"2021-12-20T12:58:45Z\\\",\\\"count\\\":1,\\\"type\\\":\\\"Normal\\\",\\\"eventTime\\\":null,\\\"reportingComponent\\\":\\\"\\\",\\\"reportingInstance\\\":\\\"\\\"}\" , \"systemPipelineName\" : \"default/kubeevent/\" , \"systemSourceName\" : \"event\" } \u4e3a\u4e86\u65b9\u4fbf\u5206\u6790\u5c55\u793a\uff0c\u6211\u4eec\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e9binterceptor\u5c06\u91c7\u96c6\u5230\u7684events\u6570\u636ejson decode\u3002 \u914d\u7f6e\u793a\u4f8b\u5982\u4e0b\uff0c\u5177\u4f53\u8bf7\u53c2\u8003 \u65e5\u5fd7\u5207\u5206\u4e0e\u5904\u7406 \u3002 Config interceptor apiVersion : loggie.io/v1beta1 kind : Interceptor metadata : name : jsondecode spec : interceptors : | - type: normalize name: json processors: - jsonDecode: ~ - drop: targets: [\"body\"] clusterLogConfig apiVersion : loggie.io/v1beta1 kind : ClusterLogConfig metadata : name : kubeevent spec : selector : type : cluster cluster : aggregator pipeline : sources : | - type: kubeEvent name: event interceptorRef : jsondecode sinkRef : dev \u7ecf\u8fc7normalize interceptor\u91ccjsonDecode\u540e\u7684\u6570\u636e\u5982\u4e0b\u6240\u793a\uff1a event { \"metadata\" : { \"name\" : \"loggie-aggregator.16c277f8fc4ff0d0\" , \"namespace\" : \"loggie-aggregator\" , \"uid\" : \"084cea27-cd4a-4ce4-97ef-12e70f37880e\" , \"resourceVersion\" : \"2975193\" , \"creationTimestamp\" : \"2021-12-20T12:58:45Z\" , \"managedFields\" : [ { \"fieldsType\" : \"FieldsV1\" , \"fieldsV1\" : { \"f:type\" : { }, \"f:count\" : { }, \"f:firstTimestamp\" : { }, \"f:involvedObject\" : { \"f:apiVersion\" : { }, \"f:kind\" : { }, \"f:name\" : { }, \"f:namespace\" : { }, \"f:resourceVersion\" : { }, \"f:uid\" : { } }, \"f:lastTimestamp\" : { }, \"f:message\" : { }, \"f:reason\" : { }, \"f:source\" : { \"f:component\" : { } } }, \"manager\" : \"kube-controller-manager\" , \"operation\" : \"Update\" , \"apiVersion\" : \"v1\" , \"time\" : \"2021-12-20T12:58:45Z\" } ] }, \"reportingComponent\" : \"\" , \"type\" : \"Normal\" , \"message\" : \"Created pod: loggie-aggregator-pbkjk\" , \"reason\" : \"SuccessfulCreate\" , \"reportingInstance\" : \"\" , \"source\" : { \"component\" : \"daemonset-controller\" }, \"count\" : 1 , \"lastTimestamp\" : \"2021-12-20T12:58:45Z\" , \"firstTimestamp\" : \"2021-12-20T12:58:45Z\" , \"eventTime\" : null , \"involvedObject\" : { \"kind\" : \"DaemonSet\" , \"namespace\" : \"loggie-aggregator\" , \"name\" : \"loggie-aggregator\" , \"uid\" : \"7cdf4792-815d-4eba-8a81-d60131ad1fc4\" , \"apiVersion\" : \"apps/v1\" , \"resourceVersion\" : \"2975170\" }, } \u5982\u679c\u89c9\u5f97\u6570\u636e\u5b57\u6bb5\u592a\u591a\u6216\u8005\u683c\u5f0f\u4e0d\u7b26\u5408\u9700\u6c42\uff0c\u8fd8\u53ef\u4ee5\u914d\u7f6enormalize interceptor\u8fdb\u884c\u4fee\u6539\u3002","title":"\u914d\u7f6e\u793a\u4f8b"},{"location":"user-guide/use-in-kubernetes/sidecar/","text":"Loggie Sidecar\u65b9\u5f0f\u91c7\u96c6\u65e5\u5fd7 \u00b6 \u867d\u7136\u9ed8\u8ba4\u4e0d\u63a8\u8350\u4f7f\u7528Sidecar\u65b9\u5f0f\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\uff0c\u4f46\u662f\u5728\u67d0\u4e9b\u53d7\u9650\u573a\u666f\u4e0b\u53ea\u80fd\u9009\u62e9\u4f7f\u7528Sidecar\u7684\u65b9\u5f0f\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\uff0c\u8fd9\u91cc\u6211\u4eec\u7ed9\u51fa\u4e00\u4e2a\u53c2\u8003\u7684\u793a\u4f8b\u3002 \u603b\u4f53\u601d\u8def \u00b6 \u5982\u4e0b\u56fe\u6240\u793a\uff1a Loggie\u548c\u4e1a\u52a1container\u90e8\u7f72\u5728\u540c\u4e00\u4e2aPod\u91cc\uff0c\u540c\u65f6\u9700\u8981\u6302\u8f7d\u76f8\u540c\u7684\u65e5\u5fd7\u6587\u4ef6volume\uff0c\u53e6\u5916Loggie\u7684\u914d\u7f6e\u53ef\u901a\u8fc7configMap\u7684\u65b9\u5f0f\u6302\u8f7d\u5230\u5bb9\u5668\u4e2d\uff0cLoggie\u6839\u636e\u63d0\u4f9b\u7684configMap\u914d\u7f6e\u6587\u4ef6\uff0c\u91c7\u96c6\u5bb9\u5668\u7684\u65e5\u5fd7\uff0c\u5e76\u53d1\u9001\u5230\u540e\u7aef\u3002 \u6ce8\u5165Loggie sidecar \u00b6 apiVersion : apps/v1 kind : Deployment metadata : labels : app : tomcat name : tomcat namespace : default spec : replicas : 1 selector : matchLabels : app : tomcat template : metadata : labels : app : tomcat spec : containers : - name : tomcat image : tomcat volumeMounts : - mountPath : /usr/local/tomcat/logs name : log - name : loggie args : - -config.system=/opt/loggie/loggie.yml - -config.pipeline=/opt/loggie/pipeline.yml image : hub.c.163.com/loggie-io/loggie:lastest volumeMounts : # loggie\u548c\u4e1a\u52a1container\u6302\u8f7d\u76f8\u540c\u7684log volume - mountPath : /usr/local/tomcat/logs name : log # \u6302\u8f7d\u65e5\u5fd7\u914d\u7f6econfigMap - mountPath : /opt/loggie name : loggie-config # \u6302\u8f7dloggie\u81ea\u8eab\u6301\u4e45\u5316\u7684\u6570\u636e - mountPath : /data name : registry volumes : - emptyDir : {} name : log - emptyDir : {} name : registry - name : loggie-config configMap : name : tomcat-loggie-config --- apiVersion : v1 kind : ConfigMap metadata : name : tomcat-loggie-config namespace : default data : loggie.yml : | loggie: reload: enabled: true period: 10s monitor: logger: period: 30s enabled: true listeners: filesource: ~ filewatcher: ~ reload: ~ sink: ~ http: enabled: true port: 9196 pipeline.yml : | pipelines: - name: \"tomcat\" sources: - type: \"file\" name: \"tomcatlog\" paths: - \"/usr/local/tomcat/logs/*.log\" fields: namespace: default deployment: tomcat fieldsFromEnv: podname: HOSTNAME sink: type: \"dev\" printEvents: true codec: pretty: true \u53ef\u4ee5\u53c2\u8003\u4ee5\u4e0a\u7684\u90e8\u7f72\u65b9\u5f0f\u901a\u8fc7loggie sidecar\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a \u76ee\u524d\u4e0d\u5efa\u8bae\u5728\u914d\u7f6e\u6587\u4ef6\u4e2denable kubernetes discovery\uff0c\u7531\u4e8e\u6253\u5f00\u540e\u4f1a\u8bf7\u6c42Kubernetes\uff0c\u5728Pods\u6bd4\u8f83\u591a\u7684\u65f6\u5019\uff0c\u4f1a\u5bf9Kubernetes\u9020\u6210\u4e00\u5b9a\u538b\u529b\uff0c\u6240\u4ee5\u65e0\u6cd5\u4f7f\u7528LogConfig CRD\uff0c\u9700\u8981\u4f7f\u7528configMap\u6302\u8f7d\u914d\u7f6e\u6587\u4ef6\u3002 \u7531\u4e8e\u4e0d\u4f7f\u7528Kubernetes discovery\uff0c\u8fd9\u91cc\u7684fields\u5e76\u4e0d\u4f1a\u88ab\u81ea\u52a8\u52a0\u4e0aPod\u7684\u5143\u4fe1\u606f\uff0c\u9700\u8981\u4f7f\u7528fieldsFromEnv\u7684\u65b9\u5f0f\u4ecePod\u7684\u73af\u5883\u53d8\u91cf\u91cc\u83b7\u53d6\u3002 Tips namespace\u7b49\u56fa\u5b9a\u4fe1\u606f\u53ef\u4ee5\u914d\u7f6e\u5230fields\u91cc\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528downward API\u7684\u65b9\u5f0f\u5f15\u7528\u5230env\u91cc fieldsFromEnv\u83b7\u53d6\u5230\u7684Env\u73af\u5883\u53d8\u91cf\u4e0d\u4ec5\u4ec5\u5c40\u9650\u5728Pod yaml\u91cc\u914d\u7f6e\u7684env\u5b57\u6bb5\uff0cLoggie\u5bb9\u5668\u91cc\u4efb\u610f\u7684\u73af\u5883\u53d8\u91cf\u5747\u53ef\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u5bb9\u5668\u91cc\u6267\u884c env \u547d\u4ee4\u67e5\u770b\u3002 \u4fee\u6539configMap\u4e2d\u7684\u53c2\u6570\uff0c\u9700\u8981\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u540e\u624d\u4f1a\u88ab\u5237\u65b0\u5230Pod\u91cc\uff0c\u5982\u679c\u5e0c\u671b\u7acb\u5373\u751f\u6548\uff0c\u9700\u8981\u91cd\u5efaPod\uff0c\u8bf7\u6ce8\u610f\u662f\u5426\u5f71\u54cd\u4e1a\u52a1 Info Loggie\u540e\u7eed\u4f1a\u652f\u6301\u81ea\u52a8Sidecar\u6ce8\u5165\u548c\u901a\u8fc7LogConfig\u81ea\u52a8\u751f\u6210ConfigMap\u6302\u8f7d\u7684\u65b9\u5f0f\uff0c\u4ece\u800c\u8fbe\u5230\u548c\u4f7f\u7528DaemonSet\u4e00\u81f4\u7684\u4f53\u9a8c\u3002","title":"Sidecar\u65b9\u5f0f\u91c7\u96c6\u65e5\u5fd7"},{"location":"user-guide/use-in-kubernetes/sidecar/#loggie-sidecar","text":"\u867d\u7136\u9ed8\u8ba4\u4e0d\u63a8\u8350\u4f7f\u7528Sidecar\u65b9\u5f0f\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\uff0c\u4f46\u662f\u5728\u67d0\u4e9b\u53d7\u9650\u573a\u666f\u4e0b\u53ea\u80fd\u9009\u62e9\u4f7f\u7528Sidecar\u7684\u65b9\u5f0f\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\uff0c\u8fd9\u91cc\u6211\u4eec\u7ed9\u51fa\u4e00\u4e2a\u53c2\u8003\u7684\u793a\u4f8b\u3002","title":"Loggie Sidecar\u65b9\u5f0f\u91c7\u96c6\u65e5\u5fd7"},{"location":"user-guide/use-in-kubernetes/sidecar/#_1","text":"\u5982\u4e0b\u56fe\u6240\u793a\uff1a Loggie\u548c\u4e1a\u52a1container\u90e8\u7f72\u5728\u540c\u4e00\u4e2aPod\u91cc\uff0c\u540c\u65f6\u9700\u8981\u6302\u8f7d\u76f8\u540c\u7684\u65e5\u5fd7\u6587\u4ef6volume\uff0c\u53e6\u5916Loggie\u7684\u914d\u7f6e\u53ef\u901a\u8fc7configMap\u7684\u65b9\u5f0f\u6302\u8f7d\u5230\u5bb9\u5668\u4e2d\uff0cLoggie\u6839\u636e\u63d0\u4f9b\u7684configMap\u914d\u7f6e\u6587\u4ef6\uff0c\u91c7\u96c6\u5bb9\u5668\u7684\u65e5\u5fd7\uff0c\u5e76\u53d1\u9001\u5230\u540e\u7aef\u3002","title":"\u603b\u4f53\u601d\u8def"},{"location":"user-guide/use-in-kubernetes/sidecar/#loggie-sidecar_1","text":"apiVersion : apps/v1 kind : Deployment metadata : labels : app : tomcat name : tomcat namespace : default spec : replicas : 1 selector : matchLabels : app : tomcat template : metadata : labels : app : tomcat spec : containers : - name : tomcat image : tomcat volumeMounts : - mountPath : /usr/local/tomcat/logs name : log - name : loggie args : - -config.system=/opt/loggie/loggie.yml - -config.pipeline=/opt/loggie/pipeline.yml image : hub.c.163.com/loggie-io/loggie:lastest volumeMounts : # loggie\u548c\u4e1a\u52a1container\u6302\u8f7d\u76f8\u540c\u7684log volume - mountPath : /usr/local/tomcat/logs name : log # \u6302\u8f7d\u65e5\u5fd7\u914d\u7f6econfigMap - mountPath : /opt/loggie name : loggie-config # \u6302\u8f7dloggie\u81ea\u8eab\u6301\u4e45\u5316\u7684\u6570\u636e - mountPath : /data name : registry volumes : - emptyDir : {} name : log - emptyDir : {} name : registry - name : loggie-config configMap : name : tomcat-loggie-config --- apiVersion : v1 kind : ConfigMap metadata : name : tomcat-loggie-config namespace : default data : loggie.yml : | loggie: reload: enabled: true period: 10s monitor: logger: period: 30s enabled: true listeners: filesource: ~ filewatcher: ~ reload: ~ sink: ~ http: enabled: true port: 9196 pipeline.yml : | pipelines: - name: \"tomcat\" sources: - type: \"file\" name: \"tomcatlog\" paths: - \"/usr/local/tomcat/logs/*.log\" fields: namespace: default deployment: tomcat fieldsFromEnv: podname: HOSTNAME sink: type: \"dev\" printEvents: true codec: pretty: true \u53ef\u4ee5\u53c2\u8003\u4ee5\u4e0a\u7684\u90e8\u7f72\u65b9\u5f0f\u901a\u8fc7loggie sidecar\u91c7\u96c6\u5bb9\u5668\u65e5\u5fd7\u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a \u76ee\u524d\u4e0d\u5efa\u8bae\u5728\u914d\u7f6e\u6587\u4ef6\u4e2denable kubernetes discovery\uff0c\u7531\u4e8e\u6253\u5f00\u540e\u4f1a\u8bf7\u6c42Kubernetes\uff0c\u5728Pods\u6bd4\u8f83\u591a\u7684\u65f6\u5019\uff0c\u4f1a\u5bf9Kubernetes\u9020\u6210\u4e00\u5b9a\u538b\u529b\uff0c\u6240\u4ee5\u65e0\u6cd5\u4f7f\u7528LogConfig CRD\uff0c\u9700\u8981\u4f7f\u7528configMap\u6302\u8f7d\u914d\u7f6e\u6587\u4ef6\u3002 \u7531\u4e8e\u4e0d\u4f7f\u7528Kubernetes discovery\uff0c\u8fd9\u91cc\u7684fields\u5e76\u4e0d\u4f1a\u88ab\u81ea\u52a8\u52a0\u4e0aPod\u7684\u5143\u4fe1\u606f\uff0c\u9700\u8981\u4f7f\u7528fieldsFromEnv\u7684\u65b9\u5f0f\u4ecePod\u7684\u73af\u5883\u53d8\u91cf\u91cc\u83b7\u53d6\u3002 Tips namespace\u7b49\u56fa\u5b9a\u4fe1\u606f\u53ef\u4ee5\u914d\u7f6e\u5230fields\u91cc\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528downward API\u7684\u65b9\u5f0f\u5f15\u7528\u5230env\u91cc fieldsFromEnv\u83b7\u53d6\u5230\u7684Env\u73af\u5883\u53d8\u91cf\u4e0d\u4ec5\u4ec5\u5c40\u9650\u5728Pod yaml\u91cc\u914d\u7f6e\u7684env\u5b57\u6bb5\uff0cLoggie\u5bb9\u5668\u91cc\u4efb\u610f\u7684\u73af\u5883\u53d8\u91cf\u5747\u53ef\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u5bb9\u5668\u91cc\u6267\u884c env \u547d\u4ee4\u67e5\u770b\u3002 \u4fee\u6539configMap\u4e2d\u7684\u53c2\u6570\uff0c\u9700\u8981\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u540e\u624d\u4f1a\u88ab\u5237\u65b0\u5230Pod\u91cc\uff0c\u5982\u679c\u5e0c\u671b\u7acb\u5373\u751f\u6548\uff0c\u9700\u8981\u91cd\u5efaPod\uff0c\u8bf7\u6ce8\u610f\u662f\u5426\u5f71\u54cd\u4e1a\u52a1 Info Loggie\u540e\u7eed\u4f1a\u652f\u6301\u81ea\u52a8Sidecar\u6ce8\u5165\u548c\u901a\u8fc7LogConfig\u81ea\u52a8\u751f\u6210ConfigMap\u6302\u8f7d\u7684\u65b9\u5f0f\uff0c\u4ece\u800c\u8fbe\u5230\u548c\u4f7f\u7528DaemonSet\u4e00\u81f4\u7684\u4f53\u9a8c\u3002","title":"\u6ce8\u5165Loggie sidecar"}]}